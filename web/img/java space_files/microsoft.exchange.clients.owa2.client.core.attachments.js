try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.$1D8=function(n,t,i,r){_at.$1D8.initializeBase(this);this.$5i=n;this.$1ZP=t;this.$3D=i;this.$ML=r};_at.$1D8.prototype={$1ZP:null,$3D:null,$ML:null,$5i:null,$3Fg:null,$6OS:function(n){var t=new _g.$1D9(this.$2k);n.$5tq(this.$5i,this.$1ZP,this.$3D,this.$ML,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){try{_a.$4.$1s(n,"result");this.$3Fg=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.prototype={$2FT:function(n,t,i){var r=n.$2(_g.$O).get_$2dq();if(t.get_$8a()){var e=this;n.$r(_at.$Vp).$1I().$t(function(){var t=_bc.$Og.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;return new _at.$4Z(n.$2(_a.$3G),t?t.get_$4R().get_$2E4():null,t?t.get_$A8D():null)})}else{var o=this;n.$r(_at.$Vp).$1I().$t(function(){return new _at.$1Pd})}var u=this;n.$r(IAttachmentViewModelFactory).$t(function(){return new _at.$1BA(n.$2(IInferenceTracker),n.$2(_y.$W),n.$2(_at.$Vp),n.$2(_a.$t),n.$2(_a.$3G),n.$36(IAttachmentProviderItemViewModelFactory),n.$2(_a.$1d),n.$36(IAttachmentPreviewViewModelFactory),n.$36(IItemStoreGetterFactory),n.$2(IUriFileAttachmentViewModelFactory),n.$3J(ISmimeCommandFactory),n.$2(_a.$I9),r)});var f=this;n.$r(_at.$19o).$2a(IUriFileAttachmentViewModelFactory).$1I().$t(function(){return new _at.$19o(n.$2(_a.$Oe),n.$2(_a.$2Y),n.$2(IInferenceTracker),n.$2(_a.$1d),n.$36(IAttachmentPreviewViewModelFactory),n.$36(IItemStoreGetterFactory),n.$3J(ISmimeCommandFactory),n.$2(_a.$I9),r,n.$2(_a.$3G))})},$Bl2:function(){return null}};_at.$4v=function(n){this.$$d_$6Ju=Function.createDelegate(this,this.$6Ju);this.$$d_$7p6=Function.createDelegate(this,this.$7p6);this.$$d_$Eyy=Function.createDelegate(this,this.$Eyy);this.$$d_$Eyz=Function.createDelegate(this,this.$Eyz);this.$$d_$ByJ=Function.createDelegate(this,this.$ByJ);_at.$4v.initializeBase(this,[n]);this.set_$Br("about:blank");this.set_$g(-1);this.get_$S().load(this.$$d_$ByJ)};_at.$4v.prototype={$1Rr:null,$Zd:null,$Bs:0,$4yM:!1,$2H:null,$qZ:0,$4J8:null,$4Ur:!1,$5fb:null,get_$9P:function(){return this.$w(_at.$4v.$5mb)},set_$9P:function(n){this.$P(_at.$4v.$5mb,n);return n},get_$F7:function(){return this.$w(_at.$4v.$6sR)},set_$F7:function(n){this.$P(_at.$4v.$6sR,n);return n},set_$2t:function(n){n||(this.$Bs=-1);this.$P(_at.$4v.$2No,n);return n},get_$4eS:function(){return this.$w(_at.$4v.$632)},set_$4eS:function(n){this.$P(_at.$4v.$632,n);return n},get_$3eU:function(){return this.$w(_at.$4v.$5fc)},set_$3eU:function(n){this.$P(_at.$4v.$5fc,n);return n},set_$9wo:function(n){if(this.$5fb===n)return n;this.$5fb=n;this.$4("UploadAndShareAttachmentCommand");return n},get_$5fd:function(){return this.$w(_at.$4v.$7Nu)},set_$5fd:function(n){this.$P(_at.$4v.$7Nu,n);return n},set_$Kt:function(n){this.$2H=n;this.$4("Error");return n},set_$32Q:function(n){this.$qZ=n;this.$4("AttachmentError");return n},set_$5av:function(n){this.$4J8=n;this.$4("SuccessResponse");return n},$8i:function(){_js.$F.prototype.$8i.call(this);this.$P(_at.$4v.$5fc,new _C(this.$$d_$Eyz,_at.$4v.$L));this.set_$9wo(new _C(this.$$d_$Eyy,_at.$4v.$L))},$ByJ:function(n){if(this.$Bs){if(this.$Bs===2){_js.Trace.logInfo(_at.$4v.$L,"Response received.");var t="";try{t=this.get_$S()[0].contentWindow.document.body.innerText}catch(u){if(!(_a.UserAgent.getInstance().$Ec&&u.number===-2146828218)){_js.Trace.logException(_at.$4v.$L,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$4yM)_js.$9.$o(t)&&this.$6oq(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.$Cu.$Bxe(t,this.get_$9P(),this.get_$F7(),_g.$1H.$1Q,function(n){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse completed.");r.$6oq(n,null,0)},function(n,t){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.get_$9P().get_$CA()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.$6b.$8Eo(t)||_at.$6b.$3sd(n);i.$6oq(null,f,r)})}}}else{_js.Trace.logInfo(_at.$4v.$L,"Initializing.");this.$Bs=1;this.$C4x();_js.$D.get_$Q().$2V(_at.$4v.$L,"ExecuteOpenFilePicker",this.$$d_$7p6,0)}},$6oq:function(n,t,i){this.set_$5av(n);this.set_$Kt(t);this.set_$32Q(i);this.$Bs=3;this.get_$5fd().$11();this.$4Ur=!1},$C4x:function(){var n=this.get_$S()[0];n.contentWindow.document.body.innerHTML="";this.$1Rr=n.contentWindow.document.createElement("form");this.$1Rr.method="POST";this.$1Rr.encType="multipart/form-data";this.$1Rr.encoding="multipart/form-data";this.$A2p(this.$1Rr);this.$Zd=$(n.contentWindow.document.createElement("input"));this.$Zd.attr("type","file");this.$Zd.attr("name","fileInput");var t=this;this.$Zd.change(function(n){t.$6Ju()});_a.UserAgent.getInstance().$Ec&&this.$Zd[0].attachEvent("onchange",this.$$d_$6Ju);this.$1Rr.appendChild(this.$Zd[0])},$A2p:function(n){this.get_$S()[0].contentWindow.document.body.appendChild(n)},$6Ju:function(){if(!this.$4Ur){this.$4Ur=!0;var n=this.$Zd[0].value;if(!_js.$9.$o(n)){this.get_$9P().set_$1x(this.$EqT(n));this.get_$4eS().$11()}}},$EqT:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},$7p6:function(){this.$Zd[0].click()},$Eyz:function(){this.$4yM=!1;this.$1Rr.action=_g.$3U.get_$7Wn();this.$7oz()},$Eyy:function(){this.$4yM=!0;this.$1Rr.action=_g.$3U.get_$A8H();this.$30p("subscriptionId",this.get_$k().get_$VW());this.$7oz()},$7oz:function(){_js.Trace.logInfo(_at.$4v.$L,"Uploading attachment via form submit.");this.$30p("parentItemId",this.get_$F7().Id);this.$30p("parentChangeKey",this.get_$F7().ChangeKey);this.$30p("isInline",this.get_$9P().get_$CA().toString());this.$30p("cancellationId",this.get_$k().get_$1C6());this.$30p(_a.$2D.$1nT(),_a.$2D.$221());this.$1Rr.submit();this.$Bs=2},$30p:function(n,t){var i=$(this.$1Rr.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.$1Rr.appendChild(i[0])}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1VO=function(){};_at.$1VO.registerInterface("_at.$1VO");_at.$64=function(n,t){this.$CY=n||_at.$64.$Buc();this.$3ak=t;this.$1R9=this.$3ak?this.$CY.DirectFileAccessOnPublicComputersEnabled:this.$CY.DirectFileAccessOnPrivateComputersEnabled;if(this.$1R9){this.$635=_at.$64.$7iT(this.$CY.BlockedFileTypes,this.$CY.ForceSaveFileTypes,this.$CY.AllowedFileTypes);this.$6ku=_at.$64.$7iT(this.$CY.BlockedMimeTypes,this.$CY.ForceSaveMimeTypes,this.$CY.AllowedMimeTypes)}this.$6uB=_at.$64.$AJx(this.$CY.ActionForUnknownFileAndMIMETypes)};_at.$64.get_$Q=function(){_at.$64.$1Q||(_at.$64.$1Q=new _at.$64(_g.$O.get_$Q().get_$2dq(),_g.$O.get_$Q().get_$Eci()));return _at.$64.$1Q};_at.$64.$AJx=function(n){var t;try{t=_js.$1I.$Ba(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$64.$8HZ=function(n,t){return n[t]||0};_at.$64.$7iT=function(n,t,i){var r={};_at.$64.$5jG(r,i,3);_at.$64.$5jG(r,t,2);_at.$64.$5jG(r,n,1);return r};_at.$64.$5jG=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.$64.$Buc=function(){var n=new _g.$ZJ;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$64.$39T=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.$64.prototype={$3ak:!1,$1R9:!1,$6uB:0,$CY:null,$635:null,$6ku:null,$4og:function(n,t,i,r){$C(i)&&(i=!0);$C(n)||(n=n.toLowerCase());var e;e=this.$1R9?this.$Bn7(n,t):1;var f=!1;var u=!1;var s=!1;var o=!1;if(i&&!r){this.$CGM(n)&&(u=!0);this.$CFR(n,t)&&(f=!0);s=this.$CB1(this.$3ak,u,f);u&&this.$CY.WacEditableFileTypes&&n&&(o=_at.$64.$39T(this.$CY.WacEditableFileTypes,n))}return new _at.$1B6(this.$1R9,e,u,f,s,o)},$Bn7:function(n,t){var r=_at.$64.$8HZ(this.$635,n);if(r===1)return 1;var i=_at.$64.$8HZ(this.$6ku,t);return i===1?1:r===2||i===2?2:r===3||i===3?3:this.$6uB},$CGM:function(n){var t=this.$3ak?this.$CY.WacViewingOnPublicComputersEnabled:this.$CY.WacViewingOnPrivateComputersEnabled;return t&&this.$F0a(n)},$CFR:function(n,t){var i=this.$3ak?this.$CY.WebReadyDocumentViewingOnPublicComputersEnabled:this.$CY.WebReadyDocumentViewingOnPrivateComputersEnabled;return i&&this.$EkC(n,t)},$CB1:function(n,t,i){return!t&&!i?!1:n?t?this.$CY.ForceWacViewingFirstOnPublicComputers:this.$CY.ForceWebReadyDocumentViewingFirstOnPublicComputers:t?this.$CY.ForceWacViewingFirstOnPrivateComputers:this.$CY.ForceWebReadyDocumentViewingFirstOnPrivateComputers},$F0a:function(n){return _at.$64.$39T(this.$CY.WacViewableFileTypes,n)},$EkC:function(n,t){if(_js.$9.$o(n)){if(!_js.$9.$o(t))return this.$CY.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$39T(this.$CY.WebReadyDocumentViewingSupportedMimeTypes,t):_at.$64.$39T(this.$CY.WebReadyMimeTypes,t)}else return this.$CY.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$39T(this.$CY.WebReadyDocumentViewingSupportedFileTypes,n):_at.$64.$39T(this.$CY.WebReadyFileTypes,n);return!1}};_at.$1B6=function(n,t,i,r,u,f){!n;this.$1R9=n;this.$1Iv=t;this.$2zp=i;this.$1ZT=r;this.$3A7=u;this.$300=f};_at.$1B6.prototype={$1Iv:0,$1R9:!1,$3A7:!1,$2zp:!1,$1ZT:!1,$300:!1,get_$4z5:function(){return this.$1ZT||this.$2zp},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$1Iv,this.$1R9,this.$2zp,this.$1ZT,this.$3A7,this.$300)}};_at.$sv=function(){this.$32h=new FileReader};_at.$sv.prototype={$32h:null,$61r:null,get_$Kt:function(){return this.$32h.error},get_$38z:function(){return this.$61r},get_$4d:function(){return this.$32h.result},set_$9AE:function(n){this.$32h.onloadend=n;return n},$9KD:function(n){var t=n;this.$32h.readAsDataURL(t.$32g)},$5L4:function(n,t,i,r){var u=this;this.set_$9AE(function(){if(!u.get_$Kt()&&u.get_$4d()){var f=u.get_$4d().indexOf(",");var n=u.get_$4d().substring(f+1,u.get_$4d().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$4d().substring(0,f).indexOf("base64")!==-1?t(n):t(_a.$5u.$Jh(n))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$Kt());i()}});try{this.$9KD(n)}catch(f){this.$61r=f;_a.UserAgent.getInstance().$a6&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+f.message);i()}}};_at.$11n=function(){};_at.$11n.prototype={$5uK:function(){return new _at.$sv}};_at.$1CI=function(n){_at.$1CI.initializeBase(this);this.$xn=n};_at.$1CI.prototype={$xn:null,$6OS:function(n){var t=new _g.$1CJ(this.$2k);n.$4UA(this.$xn,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){n?t():i(null)}};_at.$Cu=function(n,t,i,r){_at.$Cu.initializeBase(this);this.$np=n;this.$1w=t;this.$HJ=i;this.$xn=r};_at.$Cu.$Bxe=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$Cu.$L,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.set_$6J(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.set_$8D(e.Size||0);t.set_$KN(e.ContentType);t.get_$CA()&&t.set_$SF(e.ContentId);u(o)}}else{_js.Trace.logError(_at.$Cu.$L,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$Cu.$L,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_js.Trace.logError(_at.$Cu.$L,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.$Cu.$9IH=function(n,t,i){if(!n.IsCancelled){t.set_$6J(n.Attachments[0].AttachmentId);t.get_$CA()&&t.set_$SF(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$8D(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}};_at.$Cu.prototype={$np:0,$1w:null,$HJ:null,$Ce:null,$xn:null,$BuH:function(){if(this.$2H||!this.$68||!this.$68.response){_js.Trace.logInfo(_at.$Cu.$L,"No success response because there's an error, or action is not complete.  Error: {0}",this.$2H);return null}return this.$68.response.result},$6OS:function(n){this.$Ce=this.$u4();var i=new _g.$10d(this.$2k);if(this.$xn){var t=new _g.$1D7(this.$2k);t.clientStoreItem=this.$np;t.isQueued=!1;t.palContext=new _g.$oD(!1);n.$5tp(this.$Ce,t,this.$$d_$6qf,this.$$d_$1Mz)}else{i.clientStoreItem=this.$np;i.isQueued=!1;i.palContext=new _g.$oD(!1);n.$2Fj(this.$Ce,i,this.$$d_$6qf,this.$$d_$1Mz)}},$wU:function(n){this.$9II(n)},$9II:function(n){_at.$Cu.$9IH(n,this.$1w,this.$HJ)},$u4:function(){var i=new _g.$1T(this.$HJ.Id);i.ChangeKey=this.$HJ.ChangeKey;var t=this.$1w.$3sG();var n=new _g.$UE(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.$xn;return new _g.$UD(this.get_$7h(),n)}};_at.$1DA=function(n,t,i,r){_at.$1DA.initializeBase(this,[n,t,i,r]);var u=t.$LJ;this.$5wl=u};_at.$1DA.prototype={$5wl:null,$6OS:function(n){var u=this.$u4();var t=new _g.$10d(this.$2k);t.clientStoreItem=this.$np;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.$oD(!0);t.dataFile=this.$5wl.$TZ();n.$2Fj(u,t,this.$$d_$6qf,this.$$d_$1Mz)},$wU:function(n){this.$9II(n)}};_at.$1Dg=function(n,t,i){_at.$1Dg.initializeBase(this);this.$np=n;this.$1w=t;this.$HJ=i;this.$D3=t.get_$6J()||t.get_$ax()};_at.$1Dg.prototype={$np:0,$1w:null,$D3:null,$HJ:null,$wU:function(n){this.$HJ.Id=n.RootItemId.RootItemId;this.$HJ.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1w.get_$ax()&&this.$1w.set_$6J(this.$1w.get_$ax())},$6OS:function(n){var r=new _g.$UK;r.ClientSupportsIrm=!0;var i=new _g.$1Dh(this.$2k);i.itemContexts=new Array(1);var t=new _g.$1Di;t.clientStoreItem=this.$np;t.parentItemId=new _g.$1T(this.$HJ.Id);t.parentItemId.ChangeKey=this.$HJ.ChangeKey;r.AttachmentIds=[new _g.$DC(this.$D3.Id)];var u=new _g.$al(this.get_$7h());u.Body=r;i.itemContexts[0]=t;n.$2g3(u,i,this.$$d_$6qf,this.$$d_$1Mz)}};_at.$V0=function(n){_at.$V0.initializeBase(this);this.$384=_a.$6.$1g(_at.$V0.$L,"DownloadAttachment");this.$D3=n};_at.$V0.prototype={$D3:null,$365:null,$384:null,$6OS:function(n){var i=new _g.$1Fe(this.$2k);var t=new _g.$c7(this.get_$7h());t.Body.AttachmentIds=[new _g.$DC(this.$D3)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$f.get_$CGX();n.$6FU(t,i,this.$$d_$6qf,this.$$d_$1Mz)},$wU:function(n){var u=n.Attachments.length;if(u!==1){var f=String.format("GetAttachment response length = {0}",u);_a.$6.$1G(this.$384,"DownloadAttachment",f);_js.Trace.logWarning(_a.$0.$1m,f);return}var e=n.Attachments[0];if(!e){var t="GetAttachment response contained null attachment";_a.$6.$1G(this.$384,"DownloadAttachment",t);_js.Trace.logWarning(_a.$0.$1m,t);return}var i=_a.$1A.$C5(_g.$7d,e);this.$365=i.get_$E();if(!this.$365){var r="GetAttachment response contained null item";_a.$6.$1G(this.$384,"DownloadAttachment",r);_js.Trace.logWarning(_a.$0.$1m,r);return}_js.Trace.logInfo(_a.$0.$1m,"GetAttachment succeeded for '{0}' on '{1}'",i.get_$1x(),this.$365.get_$3o());_a.$6.$1G(this.$384,"DownloadAttachment")}};_at.$1Fd=function(n,t){_at.$1Fd.initializeBase(this);this.$2D=n;this.$1w=t;this.$D3=t.get_$6J()||t.get_$ax();if(!_g.$54.isInstanceOfType(t)&&!_g.$7d.isInstanceOfType(t)&&!_g.$7R.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.$1Fd.prototype={$2D:null,$1w:null,$D3:null,$988:function(){if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;if(_a.$1Iw.isInstanceOfType(n.$LJ)){var u=n.$LJ;var r=new _at.$11n;var f=r.$5uK();var t=this,i=this;f.$5L4(u,function(i){n.set_$DY(t.$64n(i));t.$Ph(null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1x());_js.Trace.logWarning(i.$2D,t);i.$Ph(Error.create(t))},this.$2D);return 1}else return this.$8Ex()}else return _g.$7d.isInstanceOfType(this.$1w)?this.$8Ex():_h.$1az.prototype.$988.call(this)},$6vl:function(n,t,i){var r=this.$1w;if(_js.$9.$o(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$y().Id)));else{r.set_$c4(this.$64n(n));t()}},$6OS:function(n){var t=new _g.$1T(this.$1w.get_$y().Id);n.$6HI(t,null,this.$$d_$6qf,this.$$d_$1Mz)},$8Ex:function(){var t=new XMLHttpRequest;var i=String.format(_g.$7d.isInstanceOfType(this.$1w)?_g.$3U.get_$32P():_g.$3U.get_$7Wk(),encodeURIComponent(this.$D3.Id));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.$64n(t.responseText);_g.$54.isInstanceOfType(n.$1w)?n.$1w.set_$DY(r):_g.$7d.isInstanceOfType(n.$1w)&&n.$1w.set_$c4(r);n.$Ph(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$D3.Id,t.responseText,t.statusText);_js.Trace.logError(n.$2D,i);n.$Ph(Error.create(i))}};t.open("GET",i,!0);_a.$c.$9nM(t);t.send(null);return 1},$64n:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1VN=function(){};_at.$1VN.registerInterface("_at.$1VN");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$Vp=function(){};_at.$Vp.registerInterface("_at.$Vp");_at.$1VM=function(){};_at.$1VM.registerInterface("_at.$1VM");_at.$AS=function(n,t,i,r,u){this.$Y0=_js.$9.$o(n)?"#":n;this.$gA=t;this.$Ls=i;this.$8A=r;this.$8WF=u;this.$3V=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1m,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$8A,this.$gA,this.$3V,this.$Y0)};_at.$AS.get_$8MV=function(){_at.$AS.$4qs||(_at.$AS.$4qs=new _at.$AS("#",!0,null,!0,!1));return _at.$AS.$4qs};_at.$AS.$9=function(n,t,i){_a.$4.$X(n,"viewModel");_a.$4.$X(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.$AS.$AC7(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.$AS.$7Yz(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.$34.isInstanceOfType(n)){var a=n;a.$sd.get_$1QB()&&(r=!0)}return new _at.$AS(f,r,u,!1,t)};_at.$AS.$7Yz=function(n,t,i,r){var u=!1;if(_at.$34.isInstanceOfType(n)){var f=n;u=f.$sd.get_$1QB()}if(!n.$PG.$1R9||u||n.$PG.$3A7||n.$1w.get_$X8()){i.val=!0;t.val="#";r.val=n.$19s;return}switch(n.$PG.$1Iv){case 3:i.val=!1;t.val=n.$Y0;r.val=n.$7CR;break;case 2:i.val=!0;r.val=n.$19s;t.val=n.$Y0;break;case 1:i.val=!0;t.val="#";r.val=n.$19s;break;case 0:default:i.val=!0;t.val="#";r.val=n.$19s;break}};_at.$AS.$AC7=function(n,t,i,r){if(n.$1w.get_$X8()){i.val=!0;t.val="#";r.val=n.$19s;return}switch(n.get_$HO()){case 5:i.val=!0;t.val="#";r.val=n.$6qp;break;case 3:i.val=!0;t.val="#";r.val=n.$27v;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$PG.$1Iv===3?new _C(function(){n.$9h&&n.$9h.$EeR(n)},_a.$0.$1m):n.$19s;break;default:_at.$AS.$7Yz(n,t,i,r);break}};_at.$AS.prototype={$gA:!1,$Y0:null,$Ls:null,$3V:null,$8A:!1,$8WF:!1};_at.$r4=function(n,t,i,r,u){_at.$r4.initializeBase(this,[_at.$r4.$3EH(),"AttachmentUploadDatapoint"]);this.$P("S",n);this.$P("T",t.toString());this.$P("E",i);this.$P("X",r);this.$P("Z",u.toString())};_at.$r4.$3EH=function(){return 1};_at.$GS=function(){};_at.$GS.$$cctor=function(){_at.$GS.$3hd={}};_at.$GS.$A2J=function(n){if(n){var t=_a.$5V.$4s(n);var i=t.$ZA.toString();_at.$GS.$3hd[i]=t}};_at.$GS.$A2I=function(n,t,i,r){if(n){var u=n;var f=u.$ZA.toString();u=_at.$GS.$3hd[f];if(u){_at.$GS.$3hd[f]=null;u.$328();var e=new _at.$r4(u.$3D,u.$1dJ,t,i,r);_a.$i.$qs.$JY(e)}}};_at.$1j=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$62z=Function.createDelegate(this,this.$62z);this.$$d_$745=Function.createDelegate(this,this.$745);this.$$d_$ACu=Function.createDelegate(this,this.$ACu);this.$$d_$ACv=Function.createDelegate(this,this.$ACv);this.$$d_$35J=Function.createDelegate(this,this.$35J);this.$$d_$4X7=Function.createDelegate(this,this.$4X7);this.$$d_$5xg=Function.createDelegate(this,this.$5xg);this.$$d_$AUh=Function.createDelegate(this,this.$AUh);this.$$d_$7Wr=Function.createDelegate(this,this.$7Wr);this.$$d_$Ez3=Function.createDelegate(this,this.$Ez3);this.$$d_$ALE=Function.createDelegate(this,this.$ALE);this.$$d_$DXh=Function.createDelegate(this,this.$DXh);this.$$d_$2g3=Function.createDelegate(this,this.$2g3);this.$$d_$DnW=Function.createDelegate(this,this.$DnW);this.$$d_$WU=Function.createDelegate(this,this.$WU);this.$$d_$5GJ=Function.createDelegate(this,this.$5GJ);this.$$d_$EZ6=Function.createDelegate(this,this.$EZ6);this.$$d_$4bk=Function.createDelegate(this,this.$4bk);this.$$d_$aT=Function.createDelegate(this,this.$aT);this.$631=new _at.$11n;_at.$1j.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_at.$1j.initializeBase(this);this.$2Y=f;this.$1D=o;this.$1Bq=s;this.$Pi=h;this.$6R=c;this.set_$9P(n);this.$I=t;this.set_$Dop(u);this.$1E=e;this.$Mm_4=a;this.$l_4=y;_g.$54.isInstanceOfType(n)&&(this.$yM=n.get_$DY());u&&(this.$99=u.get_$1ao());this.$7u=i;this.$Dg=r;this.$CY=v;this.set_$1J6(!this.$7u);this.set_$7q3(_a.$69.$li(n.get_$1x()));this.set_$9Gm(_at.$64.get_$Q().$4og(this.$1Js,this.$1w.get_$KN(),_y.$6j.$6UX(this.$I,this.$1E),this.get_$3Jo()));this.$1w&&this.$1w.get_$6J()&&this.set_$3Sh(this.$PG.get_$4z5());this.$4Kt();this.$3eM();this.$9vR();this.$9wG();this.$7N8();this.$19s=new _C(this.$$d_$aT,_at.$1j.$L);this.$1zI=new _C(this.$$d_$4bk,_at.$1j.$L);this.$7CR=new _C(this.$$d_$EZ6,_at.$1j.$L);this.$6qp=new _C(this.$$d_$5GJ,_at.$1j.$L);this.$27v=new _C(this.$$d_$WU,_at.$1j.$L);this.$6Xw=new _C(this.$$d_$DnW,_at.$1j.$L);if(!this.get_$C90()){this.$IC=new _C(this.$$d_$2g3,_at.$1j.$L);this.$47i=new _C(this.$$d_$DXh,_at.$1j.$L);this.$47l=new _C(this.$$d_$ALE,_at.$1j.$L)}this.$Qa=new _y.$NJ;this.$Bq=l;this.$3e5();this.$wa()};_at.$1j.prototype={$19s:null,$1zI:null,$7CR:null,$6qp:null,$27v:null,$IC:null,$47i:null,$47l:null,$6Xw:null,$Qa:null,$7u:!1,$Dg:!1,$I:null,$1E:null,$l_4:null,$99:null,$1D:null,$1Bq:null,$2Y:null,$1w:null,$Y0:null,$3K2:!1,$2ee:!1,$4SC:!1,$7Nw:!1,$6qn:!1,$PG:null,$9h:null,$3p:!1,$qE:!1,$3c5:null,$5ae:null,$1jH:0,$1lh:null,$2IZ:0,$3eV:null,$D3:null,$2so:!1,$Ys:!1,$2Eg:!1,$qZ:0,$5mQ:null,$ha:!1,$4x3:!1,$1Js:null,$3UU:null,$22j:null,$5XH:!1,$5Xy:!1,$3us:null,$2aR:null,$KO:null,$3ws:!1,$yM:null,$2E5:null,$32J:null,$2dt:null,$288:null,$1dh:!1,$5wD:null,$uG:null,$2F:null,$mU:2,$23T:!1,$Pi:null,$6R:null,$4ID:null,$Bq:null,$Mm_4:null,$3wK:!1,$ja:!1,$xn:null,$CY:null,$5LZ:null,$7Gl:function(){_js.Trace.logInfo(_at.$1j.$L,"Starting attachment upload.");var t=this,n=this;_g.$1H.$1Q.$4dl("CreateAttachment",this.$$d_$Ez3,this.$APT(),function(n){_js.Trace.logInfo(_at.$1j.$L,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1j.$L,"Enqueueing upload attachment failed: {0}",t.message);n.$2dp(1,_at.$6b.$3sd(t),!0);n.$4S0(null)})},add_$1GC:function(n){this.$32("OnUploadCompleteEvent",n)},remove_$1GC:function(n){this.$5d("OnUploadCompleteEvent",n)},add_$5GA:function(n){this.$32("OnUploadFailedEvent",n)},remove_$5GA:function(n){this.$5d("OnUploadFailedEvent",n)},add_$1s4:function(n){this.$32("OnDeleteCompleteEvent",n)},remove_$1s4:function(n){this.$5d("OnDeleteCompleteEvent",n)},add_$97o:function(n){this.$32("OnDownloadCompleteEvent",n)},remove_$97o:function(n){this.$5d("OnDownloadCompleteEvent",n)},add_$96b:function(n){this.$32("OnCancelCompleteEvent",n)},remove_$96b:function(n){this.$5d("OnCancelCompleteEvent",n)},set_$5mJ:function(n){this.$32J=n;return n},get_$HO:function(){this.$1jH||(this.$1jH=this.$6FV());return this.$1jH},get_$9P:function(){return this.$1w},set_$9P:function(n){var t=this.$1w;if(t!==n){$C(t)||t.remove_$EE(this.$$d_$7Wr);this.$1w=n;var i=$C(n);if(!i){n.add_$EE(this.$$d_$7Wr);_js.Trace.logInfo(_a.$0.$1m,"Attachment: {0}",n.get_$1x())}this.$8Ka(i?null:n.get_$6J());this.$4("Attachment");this.$4("ReferenceAttachment");this.$4("ReferenceAttachmentProviderTypeInfo");this.$7N8();this.$9wF()}return n},get_$R8:function(){return this.$mU},set_$R8:function(n){if(this.$mU!==n){this.$mU=n;this.$7N8()}return n},get_$2ty:function(){return _g.$7i.isInstanceOfType(this.$1w)?this.$1w:null},get_$DxT:function(){return this.get_$2ty()&&this.get_$2ty().get_$14i()?String.format(_nbs.NonBootStrings.l_ReferenceLinkShared_Text,_nbs.NonBootStrings.l_OneDriveProviderName_Text):""},get_$6J:function(){return this.$1w?this.$1w.get_$6J().Id:null},get_$8WZ:function(){return!!this.get_$2ty()&&(this.get_$HO()===1||this.get_$HO()===2)},get_$CEQ:function(){return this.get_$8WZ()&&this.$1E.get_$8a()},set_$2f:function(n){this.$3p=n;this.$4("IsSelected");return n},set_$5zm:function(n){if(this.$Y0!==n){this.$Y0=n;_js.Trace.logInfo(_at.$1j.$L,"Attachment download URL: {0}",this.$Y0);this.$4("DownloadUrl")}return n},set_$CFt:function(n){if(this.$3K2!==n){this.$3K2=n;this.$4("IsTriggeredPolicyTip")}return n},set_$1J6:function(n){this.$2ee=n;this.$3i("CanDelete","ShowDeleteButton");return n},set_$4SD:function(n){this.$4SC=n;this.$3i("AttachmentWellPendingRefresh","ShowDeleteButton");return n},get_$5Xq:function(){return this.$2ee||this.$4SC},set_$7Nx:function(n){this.$7u||this.get_$5qF()||this.set_$1J6(!n);this.$7Nw=n;this.$4("UploadInProgress");return n},get_$3Sh:function(){return this.$6qn},set_$3Sh:function(n){this.$6qn=n;this.$4("OpenDocumentInBrowserLinkVisible");return n},set_$9Gm:function(n){this.$PG=n;this.$1jH=this.$6FV();return n},get_$C8B:function(){return this.$9h},set_$Dop:function(n){this.$9h=n;this.$4("ParentWell");return n},get_$kd:function(){return this.$qE},set_$kd:function(n){if(this.$qE!==n){this.$qE=n;this.$9h&&this.$9h.$C00(this);this.$4("ShouldBeHidden")}return n},set_$6so:function(n){if(this.$2so!==n){this.$2so=n;this.$4("PendingNonHtml5Upload")}return n},get_$4HA:function(){return this.$5XH},set_$4HA:function(n){if(this.$5XH!==n){this.$5XH=n;this.$4("ShouldSizeBeHidden")}return n},get_$9jv:function(){return!this.$1w||!this.$1w.get_$6J()||!this.get_$2fP()||!this.get_$2fP().$1a.get_$A()},get_$3yr:function(){return!1},get_$9Eo:function(){return!1},set_$9l5:function(n){if(this.$5Xy!==n){this.$5Xy=n;this.$4("ShowEditPermissionsInCompose")}return n},set_$7q3:function(n){if(this.$1Js!==n){this.$1Js=n;this.$4("FileExtension")}return n},set_$7HN:function(n){this.$3c5=n;this.$4("SubmitUploadFormCommand");return n},set_$Ekv:function(n){this.$5ae=n;this.$4("SubmitUploadAndShareFormCommand");return n},get_$VW:function(){throw Error.notImplemented("This getter must be overridden");},get_$IR:function(){this.$2F||(this.$2F=new _bc.$3e);return this.$2F},get_$6qk:function(){return this.$19s},get_$1Cg:function(){return this.$IC},set_$64u:function(n){this.$1lh=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error: {0}",this.$1lh);this.$4("FormUploadError");return n},set_$64t:function(n){this.$2IZ=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error code: {0}",this.$2IZ);this.$4("FormUploadAttachmentError");return n},set_$5fe:function(n){this.$3eV=n;this.$4("UploadSuccessResponse");return n},get_$95X:function(){return!1},get_$3Sn:function(){return this.$Ys},get_$32Q:function(){return this.$qZ},get_$om:function(){return this.$22j},set_$om:function(n){this.$22j=n;return n},get_$vD:function(){var n=_y.$6j.$4n2(this.$1w.get_$6J(),this.$Dg,_g.$3U.get_$8O1());_js.Trace.logInfo(_at.$1j.$L,"Image preview URL: {0}",n);return n},get_$jf:function(){return this.$1E.get_$1LT()},get_$4uc:function(){return this.$1E.get_$22w()},get_$3I9:function(){return this.get_$HO()!==2&&this.get_$HO()!==1||this.$1w.get_$CA()?!1:this.$PG.$1Iv===3},get_$6Pw:function(){return this.get_$HO()!==2?!1:this.$PG.$1Iv===3},get_$C0j:function(){return this.get_$HO()!==2&&this.get_$HO()!==4},get_$C0l:function(){return!this.$1w.get_$X8()&&(this.get_$HO()===2||this.get_$HO()===1)},get_$6M9:function(){if(this.$3us)return this.$3us;var n;n=OwaApplication.$Oy&&this.get_$HO()===5?!1:this.get_$33m()?this.get_$HO()===5||!this.get_$4Gq()&&(!this.$Dg||this.$Dg&&this.get_$HO()!==3):this.get_$HO()===5||this.$I.get_$U()==="Mouse"&&this.get_$HO()!==3;_js.Trace.logInfo(_at.$1j.$L,"IconLinkViewModel preview = {0}",n);this.$3us=_at.$AS.$9(this,n,this.$I);return this.$3us},get_$Ena:function(){if(this.$2aR)return this.$2aR;if(this.$I.get_$U()!=="Mouse"){this.$2aR=_at.$AS.get_$8MV();return this.$2aR}var t=!1;var n=!1;if(this.$1w.get_$X8()){n=_g.$7d.isInstanceOfType(this.$1w);t=n}else switch(this.get_$HO()){case 3:n=!1;t=this.get_$6Py()?!1:!this.$Dg;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:if(OwaApplication.$Oy){t=!1;n=!1}else n=!0;break;case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel is hidden");this.$2aR=_at.$AS.get_$8MV()}else{_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel preview = {0}",t);this.$2aR=_at.$AS.$9(this,t,this.$I)}return this.$2aR},get_$2fP:function(){if(!this.$KO){var n=new Array(0);this.$KO=new _fm.$1u(n)}return this.$KO},set_$2fP:function(n){this.$KO=n;this.$4("ContextMenu");return n},get_$16l:function(){return this.$I.get_$U()!=="Mouse"},get_$1ao:function(){return this.$99},get_$3u:function(){var n=this.get_$HO();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1w.get_$1x();case 5:return OwaApplication.$Oy?this.$1w.get_$1x():_nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},set_$4vE:function(n){if(this.$3ws!==n){this.$3ws=n;this.$3eM()}return n},get_$1dX:function(){return this.$ha},set_$1dX:function(n){if(this.$ha!==n){this.$ha=n;this.$4("IsDeleted")}return n},set_$lw:function(n){this.$ja!==n&&(this.$ja=n);return n},set_$8Sv:function(n){if(this.$3wK!==n){this.$3wK=n;this.$4("IsCancelling")}return n},get_$2gm:function(){_a.$4.$FY(this.get_$HO()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1w.get_$HO()},get_$6Py:function(){return!!this.$1D&&(this.$1D.$2r("DocCollab")||this.$1D.$2r("ModernAttachments"))},get_$CAh:function(){return!!this.$1D&&!!this.$CY&&this.$1D.$2r("AttachmentsFilePicker")&&this.$CY.AttachmentDataProviderAvailable},get_$33m:function(){return this.get_$6Py()&&this.$I.get_$U()!=="TouchNarrow"&&(this.$PG.$2zp||this.get_$HO()===1||this.get_$HO()===2)&&!this.get_$3Jo()},get_$4Gq:function(){return this.$1E.get_$fP()||this.$1E.get_$JM()||this.$I.get_$U()==="TouchNarrow"||!this.$7u&&this.$I.get_$U()==="TouchWide"},set_$A8Q:function(n){if(this.$2E5!==n){this.$2E5=n;this.$4("AttachmentPreviewViewModel")}return n},get_$1Le:function(){return this.$1dh},set_$1Le:function(n){this.$1dh=n;n&&this.set_$3Sh(!1);return n},set_$4xB:function(n){this.$23T=n;this.$4("IsOpenedInLightBox");this.$4("IsComposedInLightBox");this.get_$6PS()&&this.set_$1J6(!1);return n},get_$6PS:function(){_js.Trace.logInfo(_a.$0.$16,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.$9h,this.$23T,this.$9h.get_$HC(),this.$PG.$300,this.$1w?this.$1w.get_$1x():"null",this.$23T&&!this.$9h.get_$HC()&&this.$PG.$300);return this.$9h?this.$23T&&!this.$9h.get_$HC()&&this.$PG.$300:!1},get_$1C6:function(){!this.$xn&&this.get_$5qF()&&(this.$xn=(+new Date).toString());return this.$xn},get_$5qF:function(){var n=!!this.$1D&&this.$1D.$2r("ModernAttachments");return!n||this.$1E.get_$8a()||this.$1E.get_$4S3()?!1:!this.$9h.get_$132()||!!this.$Mm_4&&this.$Mm_4.$2Nq(this.$9h.get_$132(),"AttachmentUploadCancellation")},get_$5py:function(){var n=!!this.$1w.get_$6J();var i=n?this.$1w.get_$6J().Id:null;var t=i?_bc.$9F.$8Sy(i):!1;var r=this.$PG.$1Iv===1;_js.Trace.logInfo(_at.$1j.$L,"UpdateDownloadUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.$PG.toString());return n&&!r&&!t&&!this.$1w.get_$23p()},get_$C90:function(){return!this.$9h},get_$ADi:function(){_js.Trace.logInfo(_at.$1j.$L,"Attachment class: {0}",this.$1jH);var n;switch(this.get_$HO()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1j.$L,"Embedded item class: {0}",this.get_$2gm());switch(this.get_$2gm()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1j.$L,"Can open: {0}",n);return n},get_$3Jo:function(){return this.$1w.get_$X8()||this.$1w.get_$23p()},$3eM:function(){this.$9h?this.set_$kd(this.$3ws||this.$1w.get_$CA()&&this.$9h.get_$C2C()&&!_g.$7i.isInstanceOfType(this.$1w)):this.set_$kd(this.$3ws||this.$1w.get_$CA());this.set_$kd(this.$qE||this.$1w.get_$2mt())},$DXh:function(){_js.Trace.logInfo(_at.$1j.$L,"File selected.");this.set_$4vE(!1);this.$9h&&this.$9h.$DXg(this)},$2bg:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting upload to server");this.$Ys=!1;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;this.$9wq(n)}else(_g.$7R.isInstanceOfType(this.$1w)||_g.$7d.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))&&this.$7Gl()},$7HG:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting delete to server");this.$Ys=!1;var n=new _at.$1Dg(2,this.$1w,this.$9h.get_$F7());n.add_$2b(this.$$d_$AUh);n.add_$4Q(this.$$d_$5xg);OwaApplication.$2B.$1U(n)},$6Gi:function(){var i=this.$1w;var r=i.$LJ;var n=this.$631.$5uK();var t=this;n.set_$9AE(function(){if(n.get_$Kt())_js.Trace.logWarning(_at.$1j.$L,"HTML5 file reader attach failed with error code {0}",n.get_$Kt());else{var r=n.get_$4d().indexOf(",");var i=n.get_$4d().substring(r+1,n.get_$4d().length);t.$yM=n.get_$4d().substring(0,r).indexOf("base64")!==-1?i:_a.$5u.$Jh(i);t.$AQ("OnUploadCompleteEvent",t)}});try{n.$9KD(r)}catch(u){this.$1E.get_$1LT()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1j.$L,"Firefox: failed to read an attachment. Exception: {0}",u.message):_js.Trace.logException(_at.$1j.$L,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$6wM:function(){this.$yM=null;this.$AQ("OnDeleteCompleteEvent",this);if(this.$uG){_a.$6.$1G(this.$uG,null,"",null,this.$36J(1));this.$uG=null}},$7Km:function(){this.$288=_a.$6.$1g(_a.$0.$1m,"AttachmentUploadQueue",!0)},$5d8:function(n){if(this.$288){_a.$6.$1G(this.$288,null,n,null,this.$Lv());this.$288=null}},$7Kn:function(){if(this.$288){_a.$6.$1G(this.$288,null,null,null,this.$Lv());this.$288=null}if(this.$32J){this.$2dt=_a.$6.$1g(_a.$0.$1m,this.$32J,!0);_at.$GS.$A2J(this.$2dt)}},$5d9:function(){if(this.$2dt){var n="";this.$Ys&&(n=this.$5mQ);_a.$6.$1G(this.$2dt,null,n,null,this.$Lv());_at.$GS.$A2I(this.$2dt,n,this.$1Js,this.$1w.get_$8D());this.$2dt=null}},$1l4:function(){_js.Trace.logInfo(_at.$1j.$L,"Getting attachment content from server");this.$Ys=!1;var n=new _at.$1Fd(_at.$1j.$L,this.$1w);var i=this;n.add_$4Q(function(){i.$AQ("OnDownloadCompleteEvent",i);i.set_$3Sh(!1)});var t=this;n.add_$2b(function(){_js.Trace.logWarning(_at.$1j.$L,"Download failed with error: {0}",n.$2H.message);t.$Ys=!0;t.$1dh||t.$4X7(n)});OwaApplication.$2B.$1U(n)},$8RI:function(n){if(_g.$7R.isInstanceOfType(this.$1w)||_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$1j.$L,"Uploading item or id attachment.");this.$Ez1()}else if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;if(this.$yM){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with pasted image from clipboard.");this.$745(this.$yM)}else if(t.get_$DY()){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with content.");this.$745(null)}else if(t.get_$CA()&&_a.$RV.isInstanceOfType(this.$1w.$LJ)&&_at.$34.isInstanceOfType(this)){_js.Trace.logInfo(_at.$1j.$L,"Uploading inline PAL image with content.");this.$9wt()}else if(this.$1E.get_$5mS()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 file attachment.");this.$9wr(t.$LJ)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 file attachment.");this.$9ws()}}else if(_g.$7i.isInstanceOfType(this.$1w)){this.$4x3=!0;if(this.$1E.get_$5mS()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 reference attachment.");var i=this.$1w;this.$9wr(i.$LJ)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 reference attachment.");this.$9ws()}}else{_js.Trace.logError(_at.$1j.$L,"Unsupported upload type.");n(null)}},$6FV:function(){var n=0;if(_g.$54.isInstanceOfType(this.$1w))if(this.$PG.get_$4z5())n=3;else{var i,t;(t=_y.$6j.$7De(this.$1w,i={val:n}),n=i.val,t)||(n=this.$PG.$1Iv===1?4:6)}else n=_g.$7d.isInstanceOfType(this.$1w)?5:_g.$7R.isInstanceOfType(this.$1w)?0:4;return n},$4Kt:function(){this.get_$5py()?this.set_$5zm(_y.$6j.$4n2(this.$1w.get_$6J(),this.$Dg)):this.set_$5zm(null)},$4X7:function(n){this.$2dp(1,_at.$6b.$2kD(n),!0)},$2dp:function(n,t,i){this.$Ys=!0;if(this.$ja)_js.Trace.logInfo(_at.$1j.$L,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.get_$1C6(),n,t);else{_js.Trace.logWarning(_at.$1j.$L,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.get_$1C6(),n,t);this.$qZ=n;this.$5mQ=t;this.$9h&&this.$9h.$3yk(this.$99)&&this.$9h.$1X2(this,!1)}this.$AQ("OnUploadFailedEvent",this)},$35J:function(n){this.$4S0(n)},$9vR:function(){this.set_$6so(!this.$7u&&this.$1E.get_$4S3()&&$C(this.$1w.get_$6J())&&!_g.$7R.isInstanceOfType(this.$1w))},$7Wr:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$7q3(_a.$69.$li(this.$1w.get_$1x()));if(t==="ContentType"||t==="Name"){this.set_$9Gm(_at.$64.get_$Q().$4og(this.$1Js,this.$1w.get_$KN(),this.$I.get_$U()==="Mouse"||this.$1E.get_$2P6(),this.get_$3Jo()));this.$3eM()}if(t==="AttachmentId"){this.$8Ka(this.$1w.get_$6J());this.$9vR();this.$9wF()}this.$4Kt()}},$745:function(n){var t=this.$1w;n&&t.set_$DY(n);this.$E9O(t)},$9ws:function(){this.$3c5.$11()},$ALE:function(){_js.$9.$o(this.$1lh)||this.$2dp(this.$2IZ,this.$1lh,!1);this.$4S0(null)},$44:function(n){this.$2F?this.get_$IR().$44(0,n,null):_a.$3m.$44(n,1)},$9wq:function(n){this.$7Gl()},$9wt:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for PAL attachment upload.");var n=new _at.$1DA(2,this.$1w,this.$9h.get_$F7(),this.get_$1C6());n.add_$2b(this.$$d_$4X7);n.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1U(n)},$7kQ:function(n){_js.Trace.logInfo(_at.$1j.$L,"Not a PAL file attachment.")},$6qj:function(){_js.Trace.logWarning(_at.$1j.$L,"Opening attachment with download URL {0}",this.$Y0);if(this.$1E.get_$8a())if(this.$l_4.$8G(this.$l_4.get_$IF())&&this.$l_4.get_$IF().get_$2H7().get_$2PY()){_js.Trace.logInfo(_at.$1j.$L,"Launch URL from nativeBridge");this.$l_4.get_$IF().$2PX(this.$Y0)}else{_js.Trace.logInfo(_at.$1j.$L,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var t=document.createElement("a");t.href=this.$Y0;var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!1,!1,window.self,0,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,null);t.dispatchEvent(n)}else this.$7u?this.$Qa.$3Si(this.$Y0,"_self"):this.$Qa.$3Si(this.$Y0,"_blank")},$961:function(n,t){this.$D3=t;_js.Trace.logInfo(_at.$1j.$L,"Attachment ID: {0}",this.$D3?this.$D3.Id:"null")},$3e5:function(){var n=new _fm.$1u(new Array(0));this.get_$CAh()&&this.get_$2ty()&&!this.$7u&&n.$1a.$F(new _fm.$d(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,this.$6Xw));if(this.get_$HO()===4||this.$PG.$1Iv===2||this.get_$4Gq())this.get_$4Gq()&&this.get_$33m()&&!this.get_$CEQ()&&n.$1a.$F(new _fm.$d(_nbs.NonBootStrings.l_Preview_Text,null,this.$27v));else{var i=this.get_$8WZ()?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;var t=this.$1E.get_$8a()?_nbs.NonBootStrings.l_OpenInDevice_Text:i;n.$1a.$F(new _fm.$d(t,null,this.$1zI))}this.set_$2fP(n)},$DnW:function(){this.$9h.$Dnd(this)},$E9O:function(n){_js.Trace.logInfo(_at.$1j.$L,"Submitting server action for file attachment with content.");var t=new _at.$Cu(2,n,this.$9h.get_$F7(),this.get_$1C6());t.add_$2b(this.$$d_$4X7);t.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1U(t)},set_$6xL:function(n){this.$5LZ=n;return n},$2g3:function(){if(!this.$8L7(0)){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment.");this.$uG=_a.$6.$1g(_a.$0.$1m,"AttachmentDeleteAttachment",!0);this.set_$1dX(!0);var n="";var i=!!this.$1w.get_$6J()&&!!this.$1w.get_$6J().Id&&!this.$1w.get_$6J().Id.startsWith("smime-");if(i){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment from server.");this.$9h.$1X2(this,!1);this.$9h.$5Kq(this)}else if(this.$7Nw)if(this.get_$5qF())this.$4UA();else{_js.Trace.logError(_at.$1j.$L,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");_a.$6.$1G(this.$uG,null,n="DeleteInProcessAttachment",null,this.$36J(0));this.$uG=null}else{if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;this.$7kQ(t)}else _js.Trace.logInfo(_at.$1j.$L,"Not a file attachment.");this.$9h.$1X2(this,!0);_a.$6.$1G(this.$uG,null,"",null,this.$36J(0));this.$uG=null;n="DeletedWhileInQueue"}this.$288&&this.$5d8(n)}},$4UA:function(){if(!this.$3wK){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment with cancellationId {0}",this.get_$1C6());this.$2Eg=!1;this.set_$8Sv(!0);var n=new _at.$1CI(this.get_$1C6());n.add_$2s(this.$$d_$ACv);n.add_$2b(this.$$d_$ACu);OwaApplication.$2B.$1U(n)}},$Ez3:function(n,t,i){this.set_$7Nx(!0);if(this.$ha){_js.Trace.logInfo(_at.$1j.$L,"Attachment skipped because it's been deleted while it was pending.",this.$1w.get_$1x());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$9h.get_$F7().Id=r.Id;this.$9h.get_$F7().ChangeKey=r.ChangeKey;this.$3UU=t;this.$8RI(t)},$9wr:function(n){var t=this.$5wD=this.$631.$5uK();t.$5L4(n,this.$$d_$745,this.$$d_$62z,_at.$1j.$L)},$62z:function(){this.$2dp(2,_at.$6b.$Bmw(this.$5wD),!1);this.$4S0(null)},$Ez1:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for item or id attachment.");var n=new _at.$Cu(2,this.$1w,this.$9h.get_$F7(),this.get_$1C6());n.add_$2b(this.$$d_$4X7);n.add_$4Q(this.$$d_$35J);OwaApplication.$2B.$1U(n)},$APT:function(){var t=this.$9h.get_$F7();var n=new _g.$1T(t.Id);n.ChangeKey=t.ChangeKey;var i=new _g.$UE(n);return new _g.$UD(null,i)},$4S0:function(n){var t=this.$Ys?_y.$Lb.toString(this.$qZ):"";_js.Trace.logInfo(_at.$1j.$L,"Attachment create completed. Status: {0} CancellationId: {1}",t,this.get_$1C6());if(!this.$ja){if(this.$3UU){n&&this.set_$5fe(n.$BuH());this.$3UU(this.$3eV)}this.set_$7Nx(!1);this.set_$3Sh(!this.$Ys&&this.$PG.get_$4z5());this.$3e5();if(_g.$7d.isInstanceOfType(this.$1w)){this.$9h.$1X2(this,!1);this.set_$9P(n.$1w);this.$4Kt();this.$9h.$1iv(this)}if(this.$Ebn()){_js.Trace.logInfo(_at.$1j.$L,"Incrementing parent well size.");(!n||this.$9h.$3yk(this.$99))&&this.$9h.$hY(this.$1w.get_$8D());this.$9wG()}}this.$AQ("OnUploadCompleteEvent",this)},$Ebn:function(){if(this.$Ys||this.$ja)return!1;if(this.$1E.get_$4S3()||_g.$7R.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))return!0;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w.$LJ;if(_y.$mk.isInstanceOfType(n))return!0;if(_y.$HR.isInstanceOfType(n))return n.get_$8XF()}return!1},$ACv:function(n){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment succeeded with cancellationId {0}",this.get_$1C6());this.set_$7Nx(!1);this.$9h&&this.$9h.$3yk(this.$99)&&this.$9h.$1X2(this,!1);this.$7Zk(n)},$ACu:function(n){_js.Trace.logWarning(_at.$1j.$L,"cancel failed with error: {0} and cancellationId: {1}",n&&n.$2H?n.$2H.message:"N/A",this.get_$1C6());this.$2Eg=!0;this.$7Zk(n)},$7Zk:function(n){this.$3UU&&this.$3UU(null);this.set_$8Sv(!1);this.set_$lw(!this.$2Eg);this.$AQ("OnCancelCompleteEvent",this);var t=this.$2Eg?_at.$6b.$2kD(n):"";if(this.$uG){_a.$6.$1G(this.$uG,null,t,n?n.$FJ():null,this.$36J(2));this.$uG=null}},$AUh:function(n){_js.Trace.logWarning(_at.$1j.$L,"delete failed with error: {0}",n.$2H.message);this.$Ys=!0;this.set_$1dX(!1);this.$9h.$3yk(this.$99)&&!this.$1dh&&this.$9h.$1iv(this);if(this.$uG){_a.$6.$1G(this.$uG,null,_at.$6b.$2kD(n),n?n.$FJ():null,this.$36J(1));this.$uG=null}},$5xg:function(n){this.$AQ("OnDeleteCompleteEvent",this);if(this.$uG){_a.$6.$1G(this.$uG,null,"",n?n.$FJ():null,this.$36J(1));this.$uG=null}},$EZ6:function(){_y.$9Q.$4HD=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3yr();this.$2Y&&this.$9h&&this.$9h.get_$F7()&&this.$2Y.$5GE(this.$9h.get_$F7())},$aT:function(){(this.$7u||this.$1w.get_$6J())&&(this.$8L7(1)||(this.get_$33m()&&!this.get_$4Gq()?this.$WU():this.$4bk()))},$8L7:function(n){if(this.$4SC&&this.$5LZ){_js.Trace.logInfo(_at.$1j.$L,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.set_$4SD(!1);this.$5LZ(this.$1w,n);return!0}return!1},$4bk:function(){this.get_$6Py()&&(_y.$9Q.$4HD=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3yr());if(this.$1w.get_$6J())if(OwaApplication.$Oy){_js.Trace.logInfo(_at.$1j.$L,"GenericMailMode, always download the attachment.");this.$5OE()}else if(_g.$7d.isInstanceOfType(this.$1w))this.$5GJ();else if(_g.$54.isInstanceOfType(this.$1w))this.$5OE();else if(_g.$7R.isInstanceOfType(this.$1w)){var n=this.$1w;n.get_$y()?this.$5GJ():n.get_$a5()?this.$5GJ():this.$5OE()}else this.$5OE()},$5GJ:function(){if(!this.get_$ADi()){_js.Trace.logInfo(_at.$1j.$L,"Unsupported item.");this.$44(_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}if(this.$1w.get_$23p()){var n=this;this.$uP(function(t){t.$A3R();n.$9Dl()})}else this.$9Dl()},$9Dl:function(){var n={};n.AttachmentItemID=this.$1w.get_$6J().Id;_js.Trace.logInfo(_at.$1j.$L,"Opening item attachment in pop-out window.");this.$I.$9z(IItemAttachmentPopOutFactory,null,n,_bc.$2I.get_$s6())},$5OE:function(){this.$EtN();this.$1w?this.$1w.get_$6J()?_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Name={0}, ID={1}",this.$1w.get_$1x(),this.$1w.get_$6J().Id):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Policy={0}",this.$PG.toString());if(this.$PG.$3A7){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces browser viewing.");this.$I.get_$U()==="Mouse"?this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!this.$PG.$1R9){this.$44(_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(this.$PG.$1Iv===1){this.$44(_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(this.get_$3Jo()){var n=this;this.$uP(function(n){n.$E6M()});return}if(this.$PG.$1Iv===2){this.$EeI();return}this.$1w&&this.get_$5py()&&this.$6qj()},$EeI:function(){if(this.$I.get_$U()==="Mouse"){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save.");this.$1E.get_$Df()?this.$44(_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):this.$44(_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save, but device doesn't support download.");this.$44(_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}},$WU:function(){if(this.$2E5){this.$2E5.$3w8()&&this.$9h.$4GB(this.$1w.get_$6J());this.$2E5.$WU();return}if(this.$1Bq){var n=this;this.$1Bq.$9(function(t){if(!n.$9h){_js.Trace.logError(_a.$0.$1m,"Preview: Parent well is null.");return}n.set_$A8Q(t.$9(n,n.$9h.get_$7Ww(),n.$Pi,n.$6R));n.$2E5.$3w8()&&n.$9h.$4GB(n.$1w.get_$6J());n.$2E5.$WU()})}},$8Ka:function(n){var t=this.$D3;t!==n&&this.$961(t,n)},$9wG:function(){this.set_$4HA(this.$2so||_g.$7R.isInstanceOfType(this.$1w)&&!this.$1w.get_$8D()||_g.$54.isInstanceOfType(this.$1w)&&_y.$mk.isInstanceOfType(this.$1w.$LJ)&&!this.$1w.get_$8D()||_g.$54.isInstanceOfType(this.$1w)&&_y.$HR.isInstanceOfType(this.$1w.$LJ)&&!this.$1w.get_$8D())},$7N8:function(){this.get_$2ty()&&(this.$mU===2?this.set_$9l5(!0):this.set_$9l5(!1))},$EtN:function(){if(!this.get_$3Jo()&&this.get_$95X()){var n=_g.$1H.$1Q.$1d4(this.$1w.get_$6J());this.$1w.get_$6J().Id!==n.Id&&this.$1w.set_$6J(n)}},$Lv:function(){var n=new _a.$3z;n.$5H("S",this.$1w.get_$8D());n.$5H("W",this.$9h.get_$132()?1:0);n.$5H("C",this.$ja?1:0);n.$CX("E",this.$1Js);return n.toString()},$36J:function(n){var t=new _a.$3z;t.$5H("S",this.$1w.get_$8D());var i="A";_at.$Uj.isInstanceOfType(this)?i="C":this.get_$HO()===5?i="T":this.$1w.get_$CA()&&(i="I");t.$CX("T",i);t.$5H("O",n);t.$5H("W",this.$9h.get_$132()?1:0);this.$32J&&t.$CX("Q",this.$32J);t.$CX("E",this.$1Js);return t.toString()},$9wF:function(){this.$4("ShouldAffordanceMenuBeHidden")},$uP:function(n){if(this.get_$3Jo()){_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4ID){_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.$4ID=i.$ALM();t.$4ID.$3e(t.$1w)}_js.Trace.logInfo(_a.$0.$53,"[AttachmentViewModel] Executing smime operation.");n(t.$4ID)})}}};_at.$1BA=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$9yH=_at.$1j;_a.$4.$X(t,"owaShell");_a.$4.$X(i,"palDownloadManager");_a.$4.$X(r,"userAgent");_a.$4.$X(u,"nativeBridge");_a.$4.$X(s,"itemStoreGetterFactory");this.$2Y=n;this.$I=t;this.$sd=i;this.$1E=r;this.$l=u;this.$32S=f;this.$9I=e;this.$1Bq=o;this.$1e3=s;this.$5fg=h;this.$Bq=c;this.$Mm=l;this.$CY=a};_at.$1BA.prototype={$I:null,$1E:null,$sd:null,$l:null,$9I:null,$1Bq:null,$1e3:null,$2Y:null,$Mm:null,$32S:null,$3hi:null,$9yH:null,$5fg:null,$Bq:null,$CY:null,$9:function(n,t,i,r,u,f){if(this.$8SV()&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LJ))){if(!this.$3hi&&this.$32S){var e=this;this.$32S.$9(function(n){e.$3hi=n})}_a.$4.$z(this.$3hi,"attachmentProviderItemViewModelFactory");return this.$3hi.$9(n,this.$I,t,i,r,this.$1E)}else if(_g.$54.isInstanceOfType(n)&&_y.$mk.isInstanceOfType(n.$LJ)){_a.$4.$z(this.$5fg,"uriFileAttachmentViewModelFactory");return this.$5fg.$9(n,this.$I,t,i,r,this.$1E)}else return new _at.$34(n,this.$I,t,i,r,this.$sd,this.$2Y,this.$l,this.$1E,this.$9I,this.$1Bq,this.$1e3,u,f,this.$Bq,this.$Mm,this.$CY)},$4X6:function(n,t,i,r,u,f,e){if(this.$8SV()&&this.$32S&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LJ))){var o=this;var h=function(f){var e=f.$9(n,o.$I,t,i,r,o.$1E);u(e)};this.$32S.$9(h)}else{var s=new _at.$34(n,this.$I,t,i,r,this.$sd,this.$2Y,this.$l,this.$1E,this.$9I,this.$1Bq,this.$1e3,f,e,this.$Bq,this.$Mm,this.$CY);u(s)}},$AL7:function(n,t,i,r,u,f,e){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.$7iC(n,0,new Array(0),t,i,r,u,f,e)},$7iC:function(n,t,i,r,u,f,e,o,s){var h=this;this.$4X6(n[t],r,u,f,function(c){Array.add(i,c);t<n.length-1?h.$7iC(n,t+1,i,r,u,f,e,o,s):e(i)},o,s)},$8SV:function(){return!this.$9I||!this.$CY?!1:this.$9I.$2r("AttachmentsFilePicker")&&this.$CY.AttachmentDataProviderAvailable}};_at.$TP=function(n){this.$3hl=n};_at.$TP.prototype={$3hl:null};_at.$6b=function(){};_at.$6b.$2kD=function(n){var t;if(n){if(_h.$12o.isInstanceOfType(n)&&(t=n.get_$2Ci())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$6b.$8Eo(r);if(i)return i}if(t.response.statusCode)return _at.$6b.$64o(t.response.statusCode)}}if(n.$2H)return _at.$6b.$3sd(n.$2H)}return"UnknownError_Action"};_at.$6b.$3sd=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$6b.$8Ep(t.toString());if(t=n.ErrorCode)return _at.$6b.$64o(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.$6b.$8Eo=function(n){if(n){if(n.ResponseCode)return n.ResponseCode;if(n.StackTrace)return _at.$6b.$8Ep(n.StackTrace);if(n.ErrorCode)return _at.$6b.$64o(n.ErrorCode)}return null};_at.$6b.$8Ep=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.$6b.$64o=function(n){return"HTTP_"+n};_at.$6b.$Bmw=function(n){var i=n.get_$Kt();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.$6b.$630.length?_at.$6b.$630[t]:_at.$6b.$3sd(i)}return n.get_$38z()?_at.$6b.$3sd(n.get_$38z()):"UnknownError_FileReader"};_at.$Uj=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$ALD=Function.createDelegate(this,this.$ALD);this.$$d_$ALK=Function.createDelegate(this,this.$ALK);this.$$d_$A7w=Function.createDelegate(this,this.$A7w);_at.$Uj.initializeBase(this,[n,t,i,r,u,s,f,h,c,l,a,v,y,p,w]);this.$PD=e;this.$n=o};_at.$Uj.$AJm=function(n){return n&&n.ResultCode===10?5:1};_at.$Uj.prototype={$n:null,$PD:null,$5Li:function(){var n=_g.$1H.$Yv;n?n.$DyD(this.get_$VW(),this.$$d_$A7w,this.get_$Br()):this.$PD.$28S(this.get_$VW(),_a.$0.$4W,this.get_$Br(),this.$$d_$A7w,0)},$9t5:function(){var n=_g.$1H.$Yv;n?n.$EsO(this.get_$VW(),this.$$d_$A7w):this.$PD.$2zS(this.get_$VW(),this.$$d_$A7w)},$35J:function(n){this.$9t5();_at.$1j.prototype.$35J.call(this,n)},$ALK:function(n){},$ALD:function(n){this.$4X7(n);this.$35J(null)},$A7w:function(n){var i=null;var t=n;i=n?this.$9IO(t.Response):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.$2dp(_at.$Uj.$AJm(t),i,!0)}else this.$9Il(t);this.$35J(null)},$9Il:function(n){},$9IO:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.$1w.set_$8D(i.Attachments[0].Size);_at.$Cu.$9IH(i,this.$1w,this.$9h.get_$F7());if(_g.$7i.isInstanceOfType(this.$1w)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.$1w.set_$2do(t.AttachLongPathName);this.$1w.set_$14i(t.ProviderType);this.$1w.set_$1so(t.ProviderEndpointUrl);this.$1w.set_$SF(t.ContentId)}this.$1w.set_$1x(t.Name)}}else r="The response message received is null";return r}};_at.$yA=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_at.$yA.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,null,null,l,a,v,y])};_at.$yA.$4gE=function(){return"UriFileAttachmentNotification"+(_a.$8.get_$38().$8Z()+_ff.$8d.$3Uh(0,1e3)).toString()};_at.$yA.prototype={$ML:null,get_$VW:function(){this.$ML||(this.$ML=_at.$yA.$4gE());return this.$ML},set_$VW:function(n){this.$ML=n;return n},get_$Br:function(){return"UriFileAttachmentViewModel"},get_$5qF:function(){return!1},$8RI:function(n){if(_g.$54.isInstanceOfType(this.$1w)&&_y.$mk.isInstanceOfType(this.$1w.$LJ)){_js.Trace.logInfo(_a.$0.$4W,"Uploading attachment from URL");var i=this.$1w.$LJ;this.$5Li();var t=new _at.$1D8(this.$9h.get_$F7(),i.get_$EzB(),i.get_$1x(),this.get_$VW());t.add_$2s(this.$$d_$ALK);t.add_$2b(this.$$d_$ALD);this.$n.$1U(t)}else{_js.Trace.logError(_a.$0.$4W,"Unsupported upload type detected in addFileAttachment");n(null)}},$9vR:function(){this.set_$6so(!1)}};_at.$19o=function(n,t,i,r,u,f,e,o,s,h){this.$PD=n;this.$n=t;this.$2Y=i;this.$1D=r;this.$1Bq=u;this.$Bq=e;this.$CY=s;this.$l=h};_at.$19o.prototype={$PD:null,$n:null,$2Y:null,$1D:null,$Mm:null,$1Bq:null,$l:null,$Bq:null,$CY:null,$9:function(n,t,i,r,u,f){return new _at.$yA(n,t,i,r,u,f,this.$PD,this.$n,this.$2Y,this.$1D,this.$1Bq,this.$Bq,this.$Mm,this.$CY,this.$l)}};_at.$1Et=function(n){this.$2D=n;this.$3Kj={};this.$24K=new(_ff.$18.$$(_at.$PI))};_at.$1Et.prototype={$2D:null,$3Kj:null,$24K:null,get_$A:function(){return this.$24K.get_$A()},$5l:function(n){_a.$4.$1s(n,"attachmentId");return n in this.$3Kj},$F:function(n){this.$5qd(n);if(!this.$5l(n.$D3)){this.$3fC("FastLookupQueue. Adding {0}",n);this.$24K.$F(n);this.$3Kj[n.$D3]=""}},$6i:function(n,t){this.$5qd(t);if(!this.$5l(t.$D3)){this.$3fC("FastLookupQueue. InsertAt {0}",t);this.$24K.$1EZ(n,t);this.$3Kj[t.$D3]=""}},$AVe:function(){this.$3fC("FastLookupQueue. DeQueue. Current count {0}",this.get_$A());if(this.get_$A()>0){var n=this.$24K.get_$E(0);this.$3M(n);return n}else return null},$3M:function(n){this.$5qd(n);this.$3fC("FastLookupQueue. Remove. Current count {0}",this.get_$A());if(this.$5l(n.$D3)){this.$3fC("FastLookupQueue. Remove. Found {0}",n);delete this.$3Kj[n.$D3];for(var i=-1,t=0;t<this.$24K.get_$A();t++)if(this.$24K.get_$E(t).$D3===n.$D3){i=t;break}if(i!==-1){this.$24K.$5W(i);this.$3fC("FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$A())}}},$5qd:function(n){_a.$4.$X(n,"parameter");_a.$4.$X(n.$D3,"AttachmentId")},$3fC:function(n,t){}};_at.$Ae=function(){};_at.$Ae.$6qj=function(n,t,i,r,u,f,e){_a.$4.$X(n,"initNativeBridge");_a.$4.$X(t,"initClientStore");_a.$4.$X(i,"initAttachmentInfoRecord");_a.$4.$1s(r,"initMimeType");_a.$4.$1s(u,"fileName");_a.$4.$X(f,"initOnOpenAttachmentSuccess");_a.$4.$X(e,"initOnOpenAttachmentError");if(_at.$Ae.$4xD){_js.Trace.logInfo(_at.$Ae.$L,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$Ae.$L,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$Ae.$4xD=!0;n.get_$IF().$DnG(i.DataID,r,u,function(n){_at.$Ae.$DeS(n,i,t,f,e)});t.$8D7(i.AttachmentId,function(n){},null)};_at.$Ae.$Bmv=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$Ae.$L,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$Ae.$DeS=function(n,t,i,r,u){_at.$Ae.$4xD=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$7kF(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$Ae.$L,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$Ae.$L,"OnOpenDocument succeeded");r()}};_at.$4Z=function(n,t,i){this.$$d_$DWT=Function.createDelegate(this,this.$DWT);this.$$d_$DdY=Function.createDelegate(this,this.$DdY);this.$$d_$9By=Function.createDelegate(this,this.$9By);_a.$4.$X(n,"initNativeBridge");var r=t?t.get_$4Ip():null;this.$l=n;this.$4VI=i;this.$43=n.get_$6sF().$6S9(r);this.$3e(t)};_at.$4Z.prototype={$43:!1,$1Jb:null,$UV:null,$1aV:null,$3l3:0,$2gX:null,$l:null,$4VI:null,$9j:null,get_$1QB:function(){if(!this.$43&&_g.$1H.$1Q){var n=_bc.$Og.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;this.$43=this.$l.get_$6sF().$6S9(n?n.get_$9v():null);this.$3e(n?n.get_$4R().get_$2E4():null)}return this.$43},$1k:function(n,t){_a.$4.$1s(n,"attachmentId");_a.$4.$X(t,"callbacks");if(this.get_$1QB()){this.$2gX[n]=t;this.$AqN(n,t)}else _js.Trace.logInfo(_at.$4Z.$L,"PAL does not support download.")},$2bM:function(n){_a.$4.$1s(n,"attachmentId");this.get_$1QB()&&n in this.$2gX&&delete this.$2gX[n]},$4bk:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_a.$4.$X(n.$Y0,"DownloadUrl");_js.Trace.logInfo(_at.$4Z.$L,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$1QB()){if(!(n.$D3 in this.$2gX))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.$EbY(n);if(_js.$9.$o(t)){if((!this.$UV||this.$UV.$D3!==n.$D3)&&!this.$1Jb.$5l(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"Starting download for {0}",n);if(n.$6Qo){this.$1Jb.$6i(0,n);if(this.$UV){this.$7Zo();this.$1Jb.$6i(1,this.$1aV);this.$2VH(this.$1aV,2)}else{this.$2VH(n,2);this.$5a5()}}else{this.$1Jb.$F(n);this.$2VH(n,2);this.$5a5()}}}else this.$6wW(n,t)}},$Gf:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_js.Trace.logInfo(_at.$4Z.$L,"Cancel download for parameters {0}",n);if(this.get_$1QB())if(this.$1Jb.$5l(n.$D3)){this.$1Jb.$3M(n);_js.Trace.logInfo(_at.$4Z.$L,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$1Jb.get_$A());this.$2VH(n,1)}else if(this.$UV&&this.$UV.$D3===n.$D3){_js.Trace.logInfo(_at.$4Z.$L,"Current Download was canceled. {0}",this.$UV);this.$7Zo();this.$2VH(this.$1aV,1)}},$Bxs:function(n){var t=null;switch(n){case 0:break;case 7:break;case 3:t=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,i=this;this.$4VI.$AFa(this.$9j,this.$l,function(){_js.Trace.logInfo(_at.$4Z.$L,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$4Z.$L,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:t=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:t=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:t=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return t},$3e:function(n){if(this.$43){this.$9j=n;this.$1Jb=new _at.$1Et(_at.$4Z.$L);this.$2gX={};this.$1aV=null;this.$UV=null;this.$3l3=0}},$7Zo:function(){_js.Trace.logInfo(_at.$4Z.$L,"CancelCurrentDownload, canceling the current download");this.$l.get_$1rd().$AD4();this.$1aV=this.$UV;this.$UV=null},$5a5:function(){_js.Trace.logInfo(_at.$4Z.$L,"Inside StartDownloadInternal");if(this.$1aV)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the canceled download to get canceled.");else if(this.$UV)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$4Z.$L,"StartDownloadInternal, pending items in queue {0}",this.$1Jb.get_$A());this.$UV=this.$1Jb.$AVe();this.$3l3=0;if(this.$UV){_js.Trace.logInfo(_at.$4Z.$L,"Starting download {0}",this.$UV);this.$2VH(this.$UV,3);var n=this;this.$4VI.$EjU(this.$9j,this.$l,this.$$d_$9By,function(t){_js.Trace.logWarning(_at.$4Z.$L,"Scheduled cleanup failed due to error {0}",t);n.$9By()})}else _js.Trace.logInfo(_at.$4Z.$L,"Download queue is empty.")}},$9By:function(){_js.Trace.logInfo(_at.$4Z.$L,"Starting the download now for {0}",this.$UV);if(this.$1aV){this.$1aV=null;this.$5a5()}else this.$l.get_$1rd().$AYb(this.$UV.$Y0,1,this.$UV.$1Js,this.$UV.$2SP,this.$$d_$DdY,this.$$d_$DWT)},$DdY:function(n){if(this.$UV){this.$3l3+=n;var t=this;this.$4eX(this.$UV,function(n){n.$97T(t.$3l3)})}},$2VH:function(n,t){var i=this;this.$4eX(n,function(n){n.$2sE(t)})},$6wW:function(n,t){var i=this;this.$4eX(n,function(i){_js.Trace.logWarning(_at.$4Z.$L,"Raising OnError event with error {0} for attachment {1}",t,n);i.$XN(t)})},$4eX:function(n,t){var i=this.$2gX[n.$D3];i&&t(i)},$DWT:function(n,t,i){_js.Trace.logInfo(_at.$4Z.$L,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$UV);if(this.$1aV)this.$1aV=null;else if(n||t!==200){var f=this.$Bxs(n);_js.$9.$o(f)||this.$6wW(this.$UV,f);this.$2VH(this.$UV,1)}else{var r=this.$UV;var u=new AttachmentInfoRecord(this.$UV.$D3,i,this.$UV.$4S7,_a.$8.get_utcNow().$8Z(),this.$UV.$5HO,0,_a.$8.$Att(_a.$8.get_utcNow()),!0);var e=this,s=this;this.$9j.$9Q5(u,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$4Z.$L,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.$2VH(r,4);var o=this;this.$4eX(r,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$962(u)})}this.$UV=null;this.$5a5()},$EbY:function(n){var t=null;if(_bc.$9F.$8Sy(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$5HO)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment is a quick message {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$2SP)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have content type set. {0}",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$9.$o(n.$1Js)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have a valid file name {0}.",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(this.$1Jb.get_$A()===10){_js.Trace.logInfo(_at.$4Z.$L,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return t},$AqN:function(n,t){if(this.$UV&&n===this.$UV.$D3){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.$2sE(3)}else if(this.$1Jb.$5l(n)){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.$2sE(2)}else{var r=this,i=this;this.$9j.$9PM(n,function(i){if(i){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.$2sE(4);t.$962(i)}else{_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.$2sE(1)}},function(i){_js.Trace.logWarning(_at.$4Z.$L,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.$2sE(1)})}}};_at.$PI=function(){};_at.$PI.$APa=function(n){_a.$4.$X(n,"viewModel");_a.$4.$X(n.$Y0,"DownloadUrl should not be empty");var t=null;n.$9h&&n.$9h.get_$F7()&&(t=n.$9h.get_$F7().Id);return _at.$PI.$7hh(n.$1w,n.$1w.get_$1x(),n.$1w.get_$KN(),n.$Y0,t,!1)};_at.$PI.$7hh=function(n,t,i,r,u,f){_a.$4.$X(n,"attachment");_a.$4.$X(n.get_$6J(),"attachmentId");_a.$4.$X(r,"downloadUrl");_a.$4.$X(r,"destinationFileName");var e=new _at.$PI;e.$D3=n.get_$6J().Id;e.$4S7=n.get_$8D();e.$1Cx=t;e.$1Js=_a.$69.$li(e.$1Cx);e.$2SP=i;e.$Y0=_a.Uri.$2uY(r);e.$5HO=u;e.$6Qo=f;_js.$9.$o(e.$2SP)&&!_a.UserAgent.getInstance().$YL&&(e.$2SP="fakeMimeType");return e};_at.$PI.prototype={$2SP:null,$1Cx:null,$1Js:null,$D3:null,$5HO:null,$Y0:null,$4S7:0,$6Qo:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1Cx,this.$4S7,this.$2SP,this.$D3)}};_at.$34=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_at.$34.initializeBase(this,[n,t,i,r,u,e,s,h,c,a,v,y,p,w,o]);_a.$4.$z(f,"palDownloadManager");_a.$4.$z(o,"nativeBridge");_a.$4.$z(l,"itemStoreGetter");this.$sd=f;this.$l=o;this.$1e3=l;this.$Mm=p;this.$1w&&this.$9oZ(null,this.$1w.get_$6J())};_at.$34.prototype={$l:null,$sd:null,$Mm:null,$1e3:null,$5mX:null,$2sc:0,$48y:null,set_$6sE:function(n){this.$2sc=n;this.$4("PALAttachmentDownloadStatus");return n},set_$Dog:function(n){this.$48y=n;this.$4("PALAttachmentCurrentDowloadedBytes");return n},get_$95X:function(){return _at.$1j.prototype.get_$95X.call(this)||_g.$54.isInstanceOfType(this.$1w)&&_a.$RV.isInstanceOfType(this.$1w.$LJ)},get_$33m:function(){var n=_at.$1j.prototype.get_$33m.call(this);if(n&&this.$l&&this.$l.$8G(this.$l.get_$IF())){var t=this.$l.$2t(_a.$117,2);_js.Trace.logInfo(_at.$34.$L,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$9Eo:function(){return this.$1E.get_$8a()&&this.$7u},get_$7DK:function(){return this.get_$33m()&&!this.get_$4Gq()?!1:this.$sd.get_$1QB()&&this.$7u},get_$pg:function(){return!this.$PG.$1R9||this.$sd.get_$1QB()||this.$PG.$3A7||this.$1w.get_$X8()?!0:!1},$7MH:function(){this.$Esk()},$2sE:function(n){_js.Trace.logInfo(_at.$34.$L,"Got attachment status {0}",n);this.set_$6sE(n)},$97T:function(n){this.set_$Dog(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,this.$7f3(n,1),this.$7f3(this.$1w.get_$8D(),0)))},$XN:function(n){_js.Trace.logWarning(_at.$34.$L,"Unable to download attachment with name {0} and error is {1}",this.$1w.get_$1x(),n);this.$44(n)},$962:function(n){_js.Trace.logInfo(_at.$34.$L,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$5mX=n},$9wq:function(n){_a.$RV.isInstanceOfType(n.$LJ)?n.get_$CA()?this.$7Gl():this.$9wt():_at.$1j.prototype.$9wq.call(this,n)},$7kQ:function(n){if(_a.$RV.isInstanceOfType(n.$LJ)){_js.Trace.logInfo(_at.$34.$L,"Deleting file attachment via PAL.");var t=n.$LJ;this.$l.get_$2g().$1ko(t.get_$1yr())}else _at.$1j.prototype.$7kQ.call(this,n)},$6qj:function(){if(this.$sd.get_$1QB()){_js.Trace.logInfo(_at.$34.$L,"Will use PAL to open attachment.");this.$DnA()}else _at.$1j.prototype.$6qj.call(this)},$961:function(n,t){this.$9oZ(n,t);_at.$1j.prototype.$961.call(this,n,t)},$DnA:function(){_js.Trace.logInfo(_at.$34.$L,"OpenAttachmentUsingPAL, download status={0}",this.$2sc);if(!this.$9h.$3yk(this.$99)){_js.Trace.logWarning(_at.$34.$L,"The context has changed from "+this.$99+" to "+this.$9h.get_$1ao()+", opening attachment using PAL has been skipped.");return}if(this.$9h.get_$6PT()||!this.$7u){_js.Trace.logInfo(_at.$34.$L,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.$9h.get_$6PT(),this.$7u);return}this.$EwS();var t=_at.$PI.$APa(this);_js.Trace.logInfo(_at.$34.$L,"PAL attachment download parameters: {0}",t.toString());switch(this.$2sc){case 0:case 1:this.$97T(0);_js.Trace.logInfo(_at.$34.$L,"Starting PAL attachment download.");this.$sd.$4bk(t);break;case 3:case 2:_js.Trace.logInfo(_at.$34.$L,"Canceling PAL attachment download.");this.$sd.$Gf(t);break;case 4:_js.Trace.logInfo(_at.$34.$L,"PAL attachment download complete.");var n=this;this.$1e3.$9(function(){var i=n.$1e3.get_$1Z().$9(_g.$O.get_$Q().get_$1j().get_$HM());_at.$Ae.$6qj(n.$l,i.get_$2E4(),n.$5mX,t.$2SP,t.$1Cx,function(){_js.Trace.logInfo(_at.$34.$L,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$34.$L,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$6sE(1);var i=_at.$Ae.$Bmv(t);n.$44(i)})});break;default:break}},$9oZ:function(n,t){if(this.$sd)if(_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"ItemAttachment for PAL status:Downloaded");this.set_$6sE(4)}else if(this.$sd.get_$1QB()){!$C(n)&&n.Id&&this.$sd.$2bM(n.Id);!$C(t)&&t.Id&&this.$sd.$1k(t.Id,this)}},$Esk:function(){if(this.$sd.get_$1QB()&&this.$1w&&this.$1w.get_$6J()&&!_g.$7d.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"Unsubscribing for attachment with name {0} and id {1}",this.$1w.get_$1x(),this.$1w.get_$6J());this.$sd.$2bM(this.$1w.get_$6J().Id)}},$7f3:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(n>=1048576){r/=1048576;i=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(n>=1024){r/=1024;i=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else i=_u.Strings.l_SizeWithByteAbbreviation_Text;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},$EwS:function(){if(this.$1E.get_$fP()&&(_js.$9.$1h(this.$1w.get_$KN())||_at.$34.$4gJ===this.$1w.get_$KN().toLowerCase())){var t=_a.$69.$li(this.$1w.get_$1x());var n;if(_js.$9.$1h(t))n=_at.$34.$4gJ;else{n=_at.$34.$7pb[t.toLowerCase()];_js.$9.$o(n)&&(n=_at.$34.$4gJ)}_js.Trace.logInfo(_at.$34.$L,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.$1w.get_$1x()||"<NULL>",t||"<NULL>",this.$1w.get_$KN()||"<NULL>",n);this.$1w.set_$KN(n)}}};_at.$1Pd=function(){};_at.$1Pd.prototype={get_$1QB:function(){return!1},$1k:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},$2bM:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$4bk:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$Gf:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$jC=function(){};_at.$jC.prototype={$4L:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$7ek:function(n,t){throw Error.notImplemented();}};_at.$1EG=function(){};_at.$1EG.prototype={};_at.$1EG.registerEnum("_at.$1EG",!1);_at.$1Aw=function(){};_at.$1Aw.prototype={$4L:function(n,t){var r=n;var i=_js.$1I.$1GQ(_a.$C4,t.toString());return r!==i},$7ek:function(n,t){throw Error.notImplemented();}};_at.$r7=function(){};_at.$r7.prototype={$4L:function(n,t){var i=n;return!i||!i.$1w?"":i.get_$HO()!==1&&i.get_$HO()!==2?"":_js.$9.$o(i.$1w.get_$5c3())?i.get_$vD():"data:"+i.$1w.get_$9qE()+";base64,"+i.$1w.get_$5c3()},$7ek:function(n,t){throw Error.notImplemented();}};_at.$vv=function(){};_at.$vv.prototype={$4L:function(n,t){var i=n;var r=!0;try{var u=_js.$1I.$1GQ(_at.$1EG,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$7ek:function(n,t){throw Error.notImplemented();}};_at.$1D8.registerClass("_at.$1D8",_h.$1A3.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1X7);_at.$4v.registerClass("_at.$4v",_b.$G5);_at.$64.registerClass("_at.$64");_at.$1B6.registerClass("_at.$1B6");_at.$sv.registerClass("_at.$sv",null,_at.$1VO);_at.$11n.registerClass("_at.$11n");_at.$1CI.registerClass("_at.$1CI",_h.$1A3.$$(Boolean),_a.$13Q);_at.$Cu.registerClass("_at.$Cu",_h.$TS.$$(_g.$Lz,_g.$ZH));_at.$1DA.registerClass("_at.$1DA",_at.$Cu);_at.$1Dg.registerClass("_at.$1Dg",_h.$TS.$$(_g.$Qp,_g.$an));_at.$V0.registerClass("_at.$V0",_h.$TS.$$(_g.$V1,_g.$ZH));_at.$1Fd.registerClass("_at.$1Fd",_h.$1A3.$$(String));_at.$AS.registerClass("_at.$AS");_at.$r4.registerClass("_at.$r4",_a.$AY);_at.$GS.registerClass("_at.$GS");_at.$1j.registerClass("_at.$1j",_a.$En,_y.$OU,_js.$13p);_at.$1BA.registerClass("_at.$1BA",null,IAttachmentViewModelFactory);_at.$TP.registerClass("_at.$TP");_at.$6b.registerClass("_at.$6b");_at.$Uj.registerClass("_at.$Uj",_at.$1j);_at.$yA.registerClass("_at.$yA",_at.$Uj);_at.$19o.registerClass("_at.$19o",null,IUriFileAttachmentViewModelFactory);_at.$1Et.registerClass("_at.$1Et");_at.$Ae.registerClass("_at.$Ae");_at.$4Z.registerClass("_at.$4Z",null,_at.$Vp);_at.$PI.registerClass("_at.$PI");_at.$34.registerClass("_at.$34",_at.$1j,_at.$1VM);_at.$1Pd.registerClass("_at.$1Pd",null,_at.$Vp);_at.$jC.registerClass("_at.$jC",null,_js.$1KJ);_at.$1Aw.registerClass("_at.$1Aw",null,_js.$1KJ);_at.$r7.registerClass("_at.$r7",null,_js.$1KJ);_at.$vv.registerClass("_at.$vv",null,_js.$1KJ);_at.$4v.$5mb=new _H("Attachment",_g.Attachment,_at.$4v);_at.$4v.$6sR=new _H("ParentItemId",_g.$1T,_at.$4v);_at.$4v.$2No=new _H("IsEnabled",Boolean,_at.$4v);_at.$4v.$632=new _H("FileSelectedCommand",_js.$Ct,_at.$4v);_at.$4v.$5fc=new _H("UploadAttachmentCommand",_js.$Ct,_at.$4v);_at.$4v.$7Nu=new _H("UploadCompletedCommand",_js.$Ct,_at.$4v);_at.$4v.$L=_a.$0.$1m;_at.$64.$1Q=null;_at.$Cu.$L=_a.$0.$1m;_at.$V0.$L=_a.$0.$1m;_at.$AS.$4qs=null;_at.$GS.$3hd=null;_at.$GS.$$cctor();_at.$1j.$L=_a.$0.$1m;_at.$6b.$630=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$Ae.$L=_a.$0.$1m;_at.$Ae.$4xD=!1;_at.$4Z.$L=_a.$0.$1m;_at.$34.$L=_a.$0.$1m;_at.$34.$4gJ="application/octet-stream";_at.$34.$1Ml="application/vnd.ms-excel";_at.$34.$6ll="application/msword";_at.$34.$2r4="application/vnd.ms-powerpoint";_at.$34.$7pb={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.$34.$1Ml,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.$34.$6ll,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.$34.$6ll,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.$34.$2r4,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.$34.$2r4,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.$34.$2r4,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.$34.$2r4,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.$34.$2r4,".pwz":_at.$34.$2r4,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.$34.$1Ml,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.$34.$1Ml,".xlc":_at.$34.$1Ml,".xld":_at.$34.$1Ml,".xlk":_at.$34.$1Ml,".xll":_at.$34.$1Ml,".xlm":_at.$34.$1Ml,".xls":_at.$34.$1Ml,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.$34.$1Ml,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.$34.$1Ml,".xlw":_at.$34.$1Ml,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
