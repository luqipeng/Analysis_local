try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime();
Type.registerNamespace("_ex");function ExtensibilityComponent(){}ExtensibilityComponent.prototype={$2FT:function(n,t,i){var e=this;n.$r(IExtensibilityStatistics).$2a(IExtensibilityStatistics).$1I().$t(function(){return new _ex.$11f});var o=this;n.$r(_ex.$Ue).$1I().$t(function(){return new _ex.$Ue(n.$2(_g.$Ke),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))});var s=this;n.$r(_ex.$Ui).$1I().$t(function(){return new _ex.$Ui});var r=this,u=this;n.$r(_ex.$Ug).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$Ug(t.get_$gg(),t.get_$4P().get_$Lk(),t.get_$4P().get_$Fv(),t.get_$1j().get_$HM(),n.$2(_y.$W),n.$3J(IItemReadingPaneContextFactory),n.$3J(IItemReadingPaneViewModelPopOutFactory),n.$3J(IMailComposeContextFactory),n.$3J(IMailComposeActionFactory),n.$2(_a.$t),n.$2(_a.$3G),n.$2(_a.$2Y),n.$2(_a.$AE))}).$c9(function(t){t.$xj=n.$3J(ICalendarItemDetailsViewModelFactory);t.$zX=n.$3J(IMailComposeViewModelFactory);t.$xz=n.$3J(IComposeCalendarItemViewModelFactory)});var f=this;n.$r(IExtensibilityViewModelFactory).$2a(IExtensibilityViewModelFactory).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$11h(n.$2(_a.$1x),n.$2(_ex.$Ui),t.get_$4P().get_$CE(),i.get_$9EA(),n.$2(_a.$3G),n.$2(_a.$t),n.$2(_y.$W),n.$2(_ff.$M),n.$2(_ex.$Ue),n.$2(_ex.$Ug),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))})},$Bl2:function(){return null}};_ex.$lK=function(n,t,i){_ex.$lK.initializeBase(this);this.$Ai=n;this.$PX=t;this.$N5=i};_ex.$lK.prototype={$Ai:null,$PX:null,$N5:null,$6OS:function(n){var i=new _g.$Ua(this.$Ai,this.$PX,this.$N5);var t=new _g.$11T(this.$2k);t.actionName="Ext_ExecuteEwsProxy";n.$4dZ(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){t()}};_ex.$le=function(n,t){_ex.$le.initializeBase(this);this.$1vm=new Array(n.length);for(var i=0;i<n.length;i++){this.$1vm[i]=new _g.$Nf(t);this.$1vm[i].Id=n[i]}};_ex.$le.prototype={$1vm:null,$6OS:function(n){var i=new _g.$O7(this.get_$7h());i.Body.TokenRequests=this.$1vm;var t=new _g.$lf(this.$2k);t.actionName="Ext_GetUserIdentityToken";n.$3EF(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$wU:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_ex.$5K.get_$Q().$7UE(n.Token)}};_ex.$lk=function(n){_ex.$lk.initializeBase(this);this.$b=n};_ex.$lk.prototype={$b:null,$6OS:function(n){var i=new _g.$JD(_h.$f.get_$r8());i.ItemIds=[new _g.$1T(this.$b.get_$y().Id)];var t=new _g.$OA(this.$2k);t.clientStoreItem=0;var r=new _g.$JC(this.get_$7h(),i);n.$64(r,t,this.$$d_$6qf,this.$$d_$1Mz)},$wU:function(n){var t=n.Items[0];this.$b.set_$r8(t.EntityExtractionResult)}};_ex.$4W=function(){_ex.$4W.initializeBase(this)};_ex.$4W.prototype={$zL:!1,$8k:null,$2Fc:0,$60:null,$11:function(n,t){if(OwaApplication.$1PZ){_ex.$4W.$en=new _g.$O2;_ex.$4W.$en.Extensions=new Array(0)}else if(!this.$zL){this.$60=new _g.$VE(n,t);this.$zL=!0;this.$8k=_a.$8.get_$38();OwaApplication.$2B.$1U(this)}},$6OS:function(n){var t=new _g.$128(this.$2k);t.actionName="Ext_LoadApps";n.$2LC(this.$60,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){this.$2Fc=_a.$8.get_$38().$6M(this.$8k);_ex.$4W.$en=n;t()}};_ex.$Ve=function(n,t){_ex.$Ve.initializeBase(this);if(_js.$9.$o(t))throw Error.argument("scope","scope can not be null or empty.");this.$1vl=new _g.$Nf("ScopedToken");this.$1vl.Id=n;this.$1vl.Scope=t};_ex.$Ve.prototype={$1vl:null,$PX:null,$6OS:function(n){var i=new _g.$O7(this.get_$7h());i.Body.TokenRequests=[this.$1vl];var t=new _g.$lf(this.$2k);t.actionName="Ext_GetAttachmentToken";n.$3EF(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$wU:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.$PX=n.Token)}};_ex.$WP=function(n,t){_ex.$WP.initializeBase(this);this.$N5=n;this.$5i=t};_ex.$WP.prototype={$N5:null,$5i:null,$6OS:function(n){var i=new _g.$WQ(this.$N5,this.$5i);var t=new _g.$14d(this.$2k);t.actionName="Ext_LoadExtensionCustomProperties";n.$50u(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){t()}};_ex.$17i=function(n){_ex.$17i.initializeBase(this);_a.$4.$1s(n,"input");this.$3H7=n};_ex.$17i.prototype={$3H7:null,$6OS:function(n){var t=new _g.$17j(this.$2k);n.$4CY(this.$3H7,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.$0.$4W,"SanitizeHtml Web Service request successful.");t()}};_ex.$pC=function(n,t,i){_ex.$pC.initializeBase(this);this.$N5=n;this.$5i=t;this.$3XL=i};_ex.$pC.prototype={$N5:null,$5i:null,$3XL:null,$6OS:function(n){var i=new _g.$Xb(this.$N5,this.$5i,this.$3XL);var t=new _g.$17k(this.$2k);t.actionName="Ext_SaveExtensionCustomProperties";n.$5OJ(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){t()}};_ex.$pD=function(n,t,i){_ex.$pD.initializeBase(this);this.$N5=n;this.$39D=t;this.$3XM=i};_ex.$pD.prototype={$N5:null,$39D:null,$3XM:null,$6OS:function(n){var i=new _g.$Xd(this.$N5,this.$39D,this.$3XM);var t=new _g.$17l(this.$2k);t.actionName="Ext_SaveExtensionSettings";n.$5OK(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$6vl:function(n,t,i){t()}};_ex.$5K=function(){this.$1Q1={};this.$1Py={}};_ex.$5K.get_$Q=function(){$C(_ex.$5K.$1Q)&&(_ex.$5K.$1Q=new _ex.$5K);return _ex.$5K.$1Q};_ex.$5K.prototype={$7UE:function(n){switch(n.TokenType){case"CallerIdentity":this.$1Q1[n.Id]=new _ex.$5K.$3iZ(n);break;case"ExtensionCallback":this.$1Py[n.Id]=new _ex.$5K.$3iZ(n);break;default:var t=String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.$1I.$Gx(_g.$Tw,n));_js.Trace.logError(_a.$0.$Uj,t);break}},$34s:function(n){return n in this.$1Q1&&!this.$1Q1[n].$1oN()},$34r:function(n){return n in this.$1Py&&!this.$1Py[n].$1oN()},$8Ja:function(n){return this.$34s(n)?this.$1Q1[n].$PX:null},$8Ew:function(n){return this.$34r(n)?this.$1Py[n].$PX:null},$8SM:function(){var t=this.$1Q1;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oN())return!0}return!1},$8SF:function(){var t=this.$1Py;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oN())return!0}return!1}};_ex.$5K.$3iZ=function(n){this.$1aO=new Date;this.$PX=n};_ex.$5K.$3iZ.prototype={$1aO:null,$PX:null,$1oN:function(){var t=new Date;var n=t.getTime()-this.$1aO.getTime();return n>=(this.$PX.TTL-15)*6e4}};_ex.$1UG=function(){};_ex.$1UG.registerInterface("_ex.$1UG");_ex.$Ue=function(n,t,i){this.$2I=n;this.$FH=t;this.$1D=i||null};_ex.$Ue.prototype={$2I:null,$FH:null,$1D:null,$4Xu:function(n,t){return new _ex.$6E(n,this.$2I,t,this.$FH)},$4XG:function(n){return new _ex.$11Z(this.$FH,n,this.$1D)}};_ex.$11Z=function(n,t,i){this.$FH=n;this.$o4=t;this.$1D=i||null};_ex.$11Z.prototype={$FH:null,$1D:null,$o4:0,$61Z:function(n,t){_a.$6.stPT(_a.$0.$4W,"AppActivationInComposeForm",5);for(var v=_a.$6.$1g(_a.$0.$4W,"AppActivationInComposeForm",!0),y=_a.$8.get_$38(),s=new(_ff.$18.$$(_ex.$7c)),r=0;r<n.length;r++){var l=n[r];var i;var f,h;if(h=_ex.$7c.$5de(l,new _ex.$lG(this.$FH,this.$o4),f={val:i}),i=f.val,h){var e=null;var p=_a.$8.get_$38();var c,o;var u=i.$xR?(o=i.$xR.$2Hh(null,i.$Vt,c={val:e}),e=c.val,o):!1;var a=_a.$8.get_$38();u&&s.$F(i);this.$FH.$5dB(l.Id,a.$6M(p),u)}}this.$FH.$5dG(_a.$8.get_$38().$6M(y));t(s);this.$AV();this.$FH.$4f4();_a.$6.$1G(v,"AppActivationInComposeForm");_a.$6.endPT("AppActivationInComposeForm")},$9k5:function(){return!0},$AV:function(){}};_ex.$6E=function(n,t,i,r){this.$b=n;this.$2Ne=i;this.$FH=r;this.$2I=t};_ex.$6E.get_$5Cf=function(){_ex.$6E.$2T4||(_ex.$6E.$2T4=["junkemail","drafts"]);return _ex.$6E.$2T4};_ex.$6E.prototype={$2Ne:!1,$b:null,$FH:null,$1Cu:null,$2I:null,$61Z:function(n,t){var e=!0;this.$1Cu=new(_ff.$18.$$(_ex.$7c));for(var r=0;r<n.length;r++){var s=n[r];var f=new _ex.$lG(this.$FH,1);f.$ru=this.$2Ne;var i;var u,o;if(o=_ex.$7c.$5de(s,f,u={val:i}),i=u.val,o){this.$1Cu.$F(i);i.$xR&&(i.$xR.$4wQ(this.$b,i.$Vt)||(e=!1))}}e?this.$4dI(t):this.$8aH(t)},$9k5:function(){if(this.$b.get_$9i()||this.$b.get_$Hz())return!1;if(this.$b.get_$CK()){var n=this.$b.get_$CK().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$b.get_$3G()&&!this.$9k6(this.$b.get_$3G().Id)?!1:!0},$AV:function(){this.$1Cu=null},$9k6:function(n){if(!_ex.$6E.$1rm){_ex.$6E.$1rm={};for(var t=0;t<_ex.$6E.get_$5Cf().length;t++){var r=_ex.$6E.get_$5Cf()[t];var i=this.$2I.nameToId(r);i&&(_ex.$6E.$1rm[i.Id]=!0)}}return!(n in _ex.$6E.$1rm)},$4dI:function(n){if(this.$1Cu){_a.$6.stPT(_a.$0.$4W,"AppActivationInReadingPane",5);var c=_a.$6.$1g(_a.$0.$4W,"AppActivationInReadingPane",!0);var e=new(_ff.$18.$$(_ex.$7c));this.$FH.$5dD(this.$b.get_$2tW(),this.$b.get_$r8());for(var h=_a.$8.get_$38(),o=null,i=0;i<this.$1Cu.get_$A();i++){var t=this.$1Cu.get_$E(i);var l=_a.$8.get_$38();var f,u;var r=(u=this.$9k7(t,f={val:o}),o=f.val,u);var s=_a.$8.get_$38();if(r){e.$F(t);t.$9hP(this.$b.get_$r8())}this.$FH.$5dB(t.$5P.Id,s.$6M(l),r)}this.$FH.$5dG(_a.$8.get_$38().$6M(h));n(e);this.$AV();this.$FH.$4f4();_a.$6.$1G(c,"AppActivationInReadingPane","");_a.$6.endPT("AppActivationInReadingPane")}},$9k7:function(n,t){if($C(n)||$C(n.$xR))return!1;var i=!1;n.$Vt.$1Wx={};i=!!(i|n.$xR.$2Hh(this.$b,n.$Vt,t));return i},$8aH:function(n){var t=new _ex.$lk(this.$b);var i=this;t.add_$2s(function(t){i.$4dI(n)});OwaApplication.$2B.$1U(t)}};_ex.$jB=function(n,t,i,r){this.$$d_$9wp=Function.createDelegate(this,this.$9wp);this.$$d_$7Wv=Function.createDelegate(this,this.$7Wv);_ex.$jB.initializeBase(this,[i,r]);this.$75=n;this.$id=t};_ex.$jB.$8Ev=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_ex.$jB.prototype={$75:null,$id:null,$tc:null,$7ol:function(){var n;if(!this.$9sX()){this.$gF();return}var r,i,t;if(t=this.$9s2(r={val:n},i={val:this.$tc}),n=r.val,this.$tc=i.val,t){this.$tc.add_$EE(this.$$d_$7Wv);this.$tc.add_$1GC(this.$$d_$9wp)}else{this.$Z3(n,null);return}},$9wp:function(n){this.$tc.remove_$1GC(this.$$d_$9wp);if(n.get_$3Sn()){var i=_ex.$jB.$8Ev(n.get_$32Q());this.$Z3(i,null);return}var t=this.$id.$F(this.$tc);this.$Tw(t,null)},$7Wv:function(n,t){if(t==="IsDeleted"&&this.$tc.get_$1dX()){this.$tc.remove_$EE(this.$$d_$7Wv);this.$Z3(9006,null)}}};_ex.$yW=function(n,t,i,r){_ex.$yW.initializeBase(this,[n,t,i,r])};_ex.$yW.prototype={get_$Tp:function(){return"AddFileAttachment"},get_$5II:function(){return 3},$9sX:function(){var t=this.$1e.uri;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4W,"AddFileAttachment got null or empty uri or name");return!1}else if(t.length>2048||n.length>255){_js.Trace.logError(_a.$0.$4W,"AddFileAttachment got too long uri or name");return!1}else return!0},$9s2:function(n,t){var r=this.$1e.uri;var i=this.$1e.name;t.val=this.$75.$4PL(r,i,n);return!!t.val}};_ex.$yX=function(n,t,i,r){_ex.$yX.initializeBase(this,[n,t,i,r])};_ex.$yX.prototype={get_$Tp:function(){return"AddItemAttachment"},get_$5II:function(){return 3},$9sX:function(){var t=this.$1e.itemId;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4W,"AddItemAttachment got null or empty itemId or name");return!1}else if(t.length>200||n.length>255){_js.Trace.logError(_a.$0.$4W,"AddItemAttachment got too long itemId or name");return!1}else return!0},$9s2:function(n,t){var r=this.$1e.itemId;var u=this.$1e.name;var i=new _g.$7R;i.set_$y(new _g.$1T(r));i.set_$1x(u);i.set_$CA(!1);i.set_$8D(0);t.val=this.$75.$4PQ(i,n);return!!t.val}};_ex.$jH=function(n,t,i,r){_ex.$jH.initializeBase(this,[t,i]);this.$75=n;this.$2F4=r};_ex.$jH.prototype={$2F4:!1,$75:null,get_$Tp:function(){return this.$2F4?"SetRecipients":"AddRecipients"},get_$5II:function(){return 3},$9s8:function(n,t){t.val=new(_ff.$18.$$(_g.$1K));if($C(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync null for both displayName and address");this.$gF();return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync got displayName lengths over the limit");this.$gF();return!1}if(_a.$2i.$YR(f)){var i=new _g.$1K;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$F(i)}}if(t.val.get_$A()>0)return!0;else{this.$Z3(9013,null);return!1}},$7ol:function(){var u=this.$1e.recipientField;var r=this.$1e.recipientArray;var n;if(r.length>100){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync got more recipients in the list than the limit.");this.$gF();return}var t,i;if(i=this.$9s8(r,t={val:n}),n=t.val,i){if(this.$2F4)this.$75.$9ib(u,n);else if(!this.$75.$9s0(u,n)){this.$Z3(9012,null);return}this.$Tw(null,null)}}};_ex.$1ZA=function(n,t){this.$1e=n;this.$1Gq=t};_ex.$1ZA.prototype={$1e:null,$1Gq:null,$Ej:null,$11:function(n){if(!this.$7pZ(n)){_js.Trace.logError(_a.$0.$4W,String.format("API call failing due to insufficient permission {0}",this.get_$Tp()));this.$gF();return}_a.$6.stPT(_a.$0.$4W,this.get_$Tp(),5);this.$Ej=_a.$6.$1g(_a.$0.$4W,this.get_$Tp(),!0);this.$7ol()},$Tw:function(n,t){this.$1Gq(_ex.$1R.$4Y7(n));_a.$6.$1G(this.$Ej,this.get_$Tp(),"",t);_a.$6.endPT(this.get_$Tp())},$Z3:function(n,t){this.$1Gq(_ex.$1R.$7gJ(n));_a.$6.$1G(this.$Ej,this.get_$Tp(),_ex.$F5.$8c7(n),t);_a.$6.endPT(this.get_$Tp())},$2WE:function(n,t){this.$1Gq(n);_a.$6.$1G(this.$Ej,this.get_$Tp(),"",t);_a.$6.endPT(this.get_$Tp())},$9PS:function(n,t,i){this.$1Gq(n);_a.$6.$1G(this.$Ej,this.get_$Tp(),t,i);_a.$6.endPT(this.get_$Tp())},$gF:function(){this.$1Gq(null);_a.$6.$1G(this.$Ej,this.get_$Tp(),"NonAPI",null);_a.$6.endPT(this.get_$Tp())},$7pZ:function(n){return n===2?!0:this.get_$5II()===2?!1:n>=this.get_$5II()}};_ex.$zL=function(n,t,i,r){_ex.$zL.initializeBase(this,[n,t,i,r])};_ex.$zL.prototype={get_$Tp:function(){return"BodyPrepend"},get_$5II:function(){return 3},$2NA:function(n){this.$75_1.$9Hq(n,this.$xw===3);this.$Tw(null,null)}};_ex.$zM=function(n,t,i,r){_ex.$zM.initializeBase(this,[n,t,i,r])};_ex.$zM.prototype={get_$Tp:function(){return"BodySetSelectedData"},get_$5II:function(){return 3},$2NA:function(n){this.$75_1.$8QI(n,this.$xw===3);this.$Tw(null,null)}};_ex.$1ZB=function(){};_ex.$1ZB.$Vj=function(){};_ex.$1ZB.$Vj.prototype={text:0,html:3};_ex.$1ZB.$Vj.registerEnum("_ex.$1ZB.$Vj",!1);_ex.$11X=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9hq=Function.createDelegate(this,this.$9hq);this.$$d_$8GH=Function.createDelegate(this,this.$8GH);this.$$d_$9jH=Function.createDelegate(this,this.$9jH);this.$$d_$8JM=Function.createDelegate(this,this.$8JM);_ex.$11X.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$N4=n};_ex.$11X.prototype={$N4:null,$1Il:function(n,t){n.itemType=5;var i=this;_ex.$1a9.prototype.$1Il.call(this,n,function(){t()})},$2Cs:function(n){n.$3y([_ex.$29.$9("GetTimeAsync",this.$$d_$8JM),_ex.$29.$9("SetTimeAsync",this.$$d_$9jH),_ex.$29.$9("GetLocationAsync",this.$$d_$8GH),_ex.$29.$9("SetLocationAsync",this.$$d_$9hq)]);_ex.$1a9.prototype.$2Cs.call(this,n)},$8JM:function(n,t){new _ex.$12R(this.$N4,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$9jH:function(n,t){new _ex.$18O(this.$N4,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$9hq:function(n,t){new _ex.$18G(this.$N4,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$8GH:function(n,t){new _ex.$12C(this.$N4,n,t).$11(this.$8d.$5P.RequestedCapabilities)}};_ex.$1Ep=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_ex.$1Ep.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p,w])};_ex.$1Ep.prototype={$1Il:function(n,t){var r=this.$b.get_$CK()?this.$b.get_$CK().toLowerCase():"";if(_ex.$F9.$6Or(r)){n.itemType=2;var i=this.$b;this.$A2G(i,n)}var u=this;_ex.$4e.prototype.$1Il.call(this,n,function(){t()})},$A2G:function(n,t){if(!this.get_$1LW()){_ex.$4e.$1wl(t,"to",n.get_$Bm(),n.get_$MD());_ex.$4e.$1wl(t,"cc",n.get_$DH(),null);_ex.$4e.$1wl(t,"resources",n.get_$EP(),null);n.get_$MD()&&_ex.$4e.$3gG(t,"organizer",n.get_$MD())}n.get_$6E()&&(t.location=n.get_$6E().get_$26());n.get_$1T()&&(t.start=n.get_$1T().$fF().getTime());n.get_$2y()&&(t.end=n.get_$2y().$fF().getTime())}};_ex.$1a9=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8DO=Function.createDelegate(this,this.$8DO);this.$$d_$4dh=Function.createDelegate(this,this.$4dh);this.$$d_$4db=Function.createDelegate(this,this.$4db);this.$$d_$9Hr=Function.createDelegate(this,this.$9Hr);this.$$d_$9is=Function.createDelegate(this,this.$9is);this.$$d_$9ir=Function.createDelegate(this,this.$9ir);this.$$d_$8IW=Function.createDelegate(this,this.$8IW);this.$$d_$9j5=Function.createDelegate(this,this.$9j5);this.$$d_$8J1=Function.createDelegate(this,this.$8J1);this.$$d_$9ic=Function.createDelegate(this,this.$9ic);this.$$d_$7Te=Function.createDelegate(this,this.$7Te);this.$$d_$8Hn=Function.createDelegate(this,this.$8Hn);this.$$d_$1X2=Function.createDelegate(this,this.$1X2);this.$$d_$4PL=Function.createDelegate(this,this.$4PL);this.$$d_$4PQ=Function.createDelegate(this,this.$4PQ);_ex.$1a9.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$75=n};_ex.$1a9.prototype={$75:null,$id:null,get_$2DZ:function(){return"ComposeAppSelection"},get_$4RT:function(){return"ComposeAppSelectionToProgressDone"},get_$32V:function(){this.$id||(this.$id=new(_ex.$Uh.$$(_y.$OU))(this.$8d.$5P.Id));return this.$id},$4PQ:function(n,t){new _ex.$yX(this.$75,this.get_$32V(),n,t).$11(this.$8d.$5P.RequestedCapabilities)},$4PL:function(n,t){new _ex.$yW(this.$75,this.get_$32V(),n,t).$11(this.$8d.$5P.RequestedCapabilities)},$1X2:function(n,t){new _ex.$17T(this.get_$32V(),n,t).$11(this.$8d.$5P.RequestedCapabilities)},$8Hn:function(n,t){new _ex.$VZ(this.$75,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$9ic:function(n,t){new _ex.$jH(this.$75,n,t,!0).$11(this.$8d.$5P.RequestedCapabilities)},$7Te:function(n,t){new _ex.$jH(this.$75,n,t,!1).$11(this.$8d.$5P.RequestedCapabilities)},$8J1:function(n,t){new _ex.$12O(this.$75,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$9j5:function(n,t){new _ex.$18N(this.$75,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$8IW:function(n,t){new _ex.$12M(this.$75,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$9ir:function(n,t){new _ex.$18M(this.$75,n,t,this.$n).$11(this.$8d.$5P.RequestedCapabilities)},$9is:function(n,t){new _ex.$zM(this.$75,n,t,this.$n).$11(this.$8d.$5P.RequestedCapabilities)},$9Hr:function(n,t){new _ex.$zL(this.$75,n,t,this.$n).$11(this.$8d.$5P.RequestedCapabilities)},$8DO:function(n,t){new _ex.$123(this.$75,n,t).$11(this.$8d.$5P.RequestedCapabilities)},$1Il:function(n,t){t()},$2Cs:function(n){_ex.$1R.prototype.$2Cs.call(this,n);n.$3y([_ex.$29.$9("AddItemAttachmentAsync",this.$$d_$4PQ),_ex.$29.$9("AddFileAttachmentAsync",this.$$d_$4PL),_ex.$29.$9("RemoveAttachmentAsync",this.$$d_$1X2),_ex.$29.$9("GetRecipientsAsync",this.$$d_$8Hn),_ex.$29.$9("AddRecipientsAsync",this.$$d_$7Te),_ex.$29.$9("SetRecipientsAsync",this.$$d_$9ic),_ex.$29.$9("GetSubjectAsync",this.$$d_$8J1),_ex.$29.$9("SetSubjectAsync",this.$$d_$9j5),_ex.$29.$9("GetSelectedDataAsync",this.$$d_$8IW),_ex.$29.$9("SetSelectedDataAsync",this.$$d_$9ir),_ex.$29.$9("BodySetSelectedDataAsync",this.$$d_$9is),_ex.$29.$9("BodyPrependAsync",this.$$d_$9Hr),_ex.$29.$9("LoadCustomProperties",this.$$d_$4db),_ex.$29.$9("SaveCustomProperties",this.$$d_$4dh),_ex.$29.$9("GetBodyTypeAsync",this.$$d_$8DO)])},$4dh:function(n,t){new _ex.$LD(this.$75,n,this.$8d.$5P.Id,t).$11(this.$8d.$5P.RequestedCapabilities)},$4db:function(n,t){new _ex.$14c(this.$75,n,this.$8d.$5P.Id,this.$n,t).$11(this.$8d.$5P.RequestedCapabilities)}};_ex.$1R=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8ZQ=Function.createDelegate(this,this.$8ZQ);this.$$d_$7os=Function.createDelegate(this,this.$7os);this.$$d_$7or=Function.createDelegate(this,this.$7or);this.$$d_$7ot=Function.createDelegate(this,this.$7ot);this.$$d_$7p1=Function.createDelegate(this,this.$7p1);this.$$d_$9rP=Function.createDelegate(this,this.$9rP);this.$$d_$9Kb=Function.createDelegate(this,this.$9Kb);this.$$d_$9KX=Function.createDelegate(this,this.$9KX);this.$$d_$7pC=Function.createDelegate(this,this.$7pC);this.$$d_$7oy=Function.createDelegate(this,this.$7oy);this.$$d_$8Fh=Function.createDelegate(this,this.$8Fh);this.$$d_$98j=Function.createDelegate(this,this.$98j);this.$$d_$9rH=Function.createDelegate(this,this.$9rH);_a.$4.$z(a,"nativeBridge");this.$I=n;this.$kl=t;this.$tO=i;this.$LG=r;this.$PY=u;this.$xz=f;this.$xj=e;this.$zX=o;this.$sB=s;this.$zO=h;this.$fX=c;this.$l=a;this.$n=v;this.$6K=_a.$6i.$9()};_ex.$1R.get_$11b=function(){_ex.$1R.$2Dt||(_ex.$1R.$2Dt=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3));return _ex.$1R.$2Dt};_ex.$1R.get_$2Dw=function(){_ex.$1R.$2Dv||(_ex.$1R.$2Dv={wasSuccessful:!1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Dv};_ex.$1R.get_$7Wb=function(){_ex.$1R.$2Du||(_ex.$1R.$2Du={wasProxySuccessful:!1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Du};_ex.$1R.get_$7Wc=function(){_ex.$1R.$2Dx||(_ex.$1R.$2Dx={error:1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Dx};_ex.$1R.$4Y7=function(n){return{error:0,data:n}};_ex.$1R.$7gJ=function(n){return{error:1,errorCode:n}};_ex.$1R.$6Ha=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_ex.$1R.prototype={$1RT:0,$tO:null,$LG:null,$PY:null,$I:null,$kl:null,$J8:null,$Vt:null,$8d:null,$2U7:0,$1tz:null,$sB:null,$n:null,$xz:null,$xj:null,$zX:null,$zO:null,$fX:null,$1tp:null,$1ts:null,$11j:0,$2DT:0,$2US:0,$1lR:!1,$2Cv:!1,$12K:null,$1Cq:null,$1Cr:null,$vY:null,$1nn:!1,$l:null,$6K:null,$1sG:null,$2LG:0,get_$1LW:function(){return!this.$8d.$5P.RequestedCapabilities},$3e:function(n,t,i){this.$8d=n;this.$J8=t;this.$Vt=i;this.$1sG={};window.msWriteProfilerMark=this.$$d_$9rH},$9st:function(){window.msWriteProfilerMark=null;this.$11j=0},$8Fh:function(n,t){var u=_a.$8.get_$38();var f=_a.$6.acsa(_a.$0.$4W,"GetInitialData",!0);var i={};i.permissionLevel=this.$8d.$5P.RequestedCapabilities;i.timeZoneOffsets=this.$8JN();i.hostVersion=this.$I.get_$2zv();i.owaView=_ex.$1R.$6Ha(this.$I.get_$U());i.overrideWindowOpen=this.$l.$8G(this.$l.get_$IF())&&this.$l.get_$IF().get_$2H7().get_$2PY();if(!this.get_$1LW()){i.userDisplayName=this.$LG;i.userEmailAddress=this.$PY;i.userTimeZone=this.$tO;i.ewsUrl=this.$J8.EwsUrl}var r=this;this.$1Il(i,function(){_a.$6.acea(f);r.$2LG=_a.$8.get_$38().$6M(u);t(i);r.$1lR=!0;r.$2gr()})},$9LH:function(){if(!this.$1nn){if(!this.$vY){this.$vY=new(_ff.$18.$$(_ex.$29));this.$2Cs(this.$vY)}for(var t=0;t<this.$vY.get_$A();t++){var n=this.$vY.get_$E(t);this.$1tz.registerMethod(n.$WE,n.$m6,0,n.$32w)}this.$l.$8G(this.$l.get_$IF())&&this.$l.get_$IF().get_$2H7().get_$2PY()&&this.$1tz.unregisterMethod("ContextActivationManager_openWindowInHost");this.$1nn=!0}},$9t9:function(){if(this.$1nn&&this.$vY){for(var n=0;n<this.$vY.get_$A();n++){var t=this.$vY.get_$E(n);this.$1tz.unregisterMethod(t.$WE)}this.$1nn=!1}},$7oy:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteEwsRequest",5);this.$12K=_a.$6.$1g(_a.$0.$4W,"ExecuteEwsRequest",!0);var i=this.$8d.$5P;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_ex.$1R.$1S0);this.$Gi(this.$12K,"ExecuteEwsRequest","Failed",null);return}var s=n;var e=s.body;var o=_ex.$5K.get_$Q();if($C(e)||this.$nZ(e.length,_y.$Uf.$41K,"ExecuteEwsRequest")){t(_ex.$1R.$1S0);this.$Gi(this.$12K,"ExecuteEwsRequest","Failed",null);return}var r,u;if(!(u=this.$1QG(r={val:t},_ex.$1R.get_$7Wb()),t=r.val,u)){this.$Gi(this.$12K,"ExecuteEwsRequest",_ex.$1R.get_$11b(),null);return}if(!o.$34r(i.Id)||o.$8SF()){var h=this,f=this;this.$4X5("ExtensionCallback",function(r){h.$5Em(i,n,t)},function(n){t({wasProxySuccessful:!1});f.$Gi(f.$12K,"ExecuteEwsRequest","Failed",n)})}else this.$5Em(i,n,t)},$7pC:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteSaveSettingsRequest",5);this.$1Cr=_a.$6.$1g(_a.$0.$4W,"ExecuteSaveSettingsRequest",!0);var u=this.$8d;var c=n;var o=c[0];var s=JsonParser.serialize(o);if(this.$nZ(s.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$Gi(this.$1Cr,"ExecuteSaveSettingsRequest","Failed",null);return}var h,f;if(!(f=this.$1QG(h={val:t},_ex.$1R.get_$7Wc()),t=h.val,f)){this.$Gi(this.$1Cr,"ExecuteSaveSettingsRequest",_ex.$1R.get_$11b(),null);return}var i=new _ex.$pD(u.$5P.Id,u.$5P.Version,s);var r=this;i.add_$2s(function(n){if(i.get_$4d().WasSuccessful){u.set_$5W9(o);t({error:0});r.$Gi(r.$1Cr,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$4d().ErrorMessage,error:1});r.$Gi(r.$1Cr,"ExecuteSaveSettingsRequest",i.get_$4d().ErrorMessage,n)}});var e=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,error:1});e.$Gi(e.$1Cr,"ExecuteSaveSettingsRequest",i.$2H.message,n)});this.$n.$1U(i)},$7p1:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteGetUserIdentityTokenRequest",5);this.$1Cq=_a.$6.$1g(_a.$0.$4W,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1LW()){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$8d.$5P.DisplayName);t(_ex.$1R.$1S0);this.$Gi(this.$1Cq,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_ex.$5K.get_$Q();var r=this.$8d.$5P.Id;if(!u.$34s(r)||u.$8SM()){var e,o;if(!(o=this.$1QG(e={val:t},_ex.$1R.get_$2Dw()),t=e.val,o)){this.$Gi(this.$1Cq,"ExecuteGetUserIdentityTokenRequest",_ex.$1R.get_$11b(),null);return}var i=this,f=this;this.$4X5("CallerIdentity",function(n){i.$5Ep(r,t);i.$Gi(i.$1Cq,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});f.$Gi(f.$1Cq,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{this.$5Ep(r,t);this.$Gi(this.$1Cq,"ExecuteGetUserIdentityTokenRequest","",null)}},$7ot:function(n,t){var u=n;var i=this.$7sa(u);if(!i){t(null);return}var r=this;this.$xz.$9(function(n){if(r.$I.get_$U()==="Mouse"){var f=n.$3AP(i);r.$I.$VL(IComposeCalendarItemViewModelFactory,null,null,_bc.$2I.get_$rB(),f,!1)}else{var u=n.$wc(i.$60,null,null);r.$5YU(u)}t(null)})},$7or:function(n,t){var f=n;var u=f.itemId;if(_js.$9.$o(u)){t(null);return}var i=new _y.$BD;i.$n5(new _g.$1T(u));var r=this;this.$xj.$9(function(n){if(r.$I.get_$U()==="Mouse")r.$I.$VL(ICalendarItemDetailsViewModelFactory,null,i.$60,_bc.$2I.get_$rB(),null,!1);else{var u=n.$wc(i.$60,null,null);r.$5YU(u)}t(null)})},$7os:function(n,t){var i=n;this.$8Ft(i.itemId,this.$$d_$98j);t(null)},$8ZQ:function(n,t){if(this.$l.$8G(this.$l.get_$IF())){var i=n.launchUrl;i&&this.$l.get_$IF().$2PX(i)}t(null)},$9KX:function(n,t){var r=n;if(this.$8d.$5P.Origin===3){var i=new _ex.$11i(this.$8d.$5P.DisplayName.replace(_ex.$1R.$1wN,""));i.$9H0(r);i.$1U()}t(null)},$9Kb:function(n,t){var i=n;if(this.$8d.$5P.Origin!==3){t(null);return}var f=_a.$0.$4W;var u="[{0}] {1}";var r=this.$8d.$5P.DisplayName.replace(_ex.$1R.$1wN,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(f,u,r,i.Message);break;case"Error":_js.Trace.logError(f,u,r,i.Message);break;default:break}t(null)},$9rP:function(n,t){var r=n;if(this.$8d.$5P.Origin!==3){t(null);return}var i=this.$8d.$5P.DisplayName.replace(_ex.$1R.$1wN,"")+"."+r.Name.replace(_ex.$1R.$1wN,"");var u=r.Event;switch(u){case"Start":_a.$6.$1g(_a.$0.$4W,i);break;case"End":_a.$6.$1G(null,i);break;default:break}t(null)},setServiceEndPoint:function(n){this.$1tz=n},$8JN:function(){return this.$kl.$3F9(this.$tO)},$7Ge:function(){this.$1lR=!1;this.$2Cv=!1;this.$2DT=0;this.$2LG=0;this.$1RT=0;this.$2US=0;_a.$6.stPT(_a.$0.$4W,this.get_$2DZ(),5);this.$1tp=_a.$6.$1g(_a.$0.$4W,this.get_$2DZ(),!0);this.$1ts=_a.$6.$1g(_a.$0.$4W,this.get_$4RT(),!0)},$2gr:function(){if(this.$1tp){this.$38i(!1);var n=this.$1lR?"":"Failed";_a.$6.$1G(this.$1tp,this.get_$2DZ(),n,null,this.$4oX());_a.$6.endPT(this.get_$2DZ());this.$1tp=null}},$38i:function(n){if(this.$1ts){_a.$6.$1G(this.$1ts,this.get_$4RT(),n?"":"Failed",null,this.$4oX());this.$1ts=null}},$Gi:function(n,t,i,r){i||(i="");var u=null;r&&(_ex.$lK.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$pD.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$WP.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$pC.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$le.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$Ve.isInstanceOfType(r)&&r.$68&&(u=r.$68.correlationId));n?_a.$6.$1G(n,t,i,u):_a.$6.$1G(null,t,i,u);_a.$6.endPT(t)},$2Cs:function(n){n.$3y([_ex.$29.$7fb("GetInitialData",this.$$d_$8Fh),_ex.$29.$9("EwsRequest",this.$$d_$7oy),_ex.$29.$9("saveSettingsAsync",this.$$d_$7pC),_ex.$29.$9("RecordDataPoint",this.$$d_$9KX),_ex.$29.$9("RecordTrace",this.$$d_$9Kb),_ex.$29.$9("TrackCtq",this.$$d_$9rP),_ex.$29.$9("GetUserIdentityToken",this.$$d_$7p1),_ex.$29.$9("DisplayNewAppointmentForm",this.$$d_$7ot),_ex.$29.$9("DisplayExistingAppointmentForm",this.$$d_$7or),_ex.$29.$9("DisplayExistingMessageForm",this.$$d_$7os),_ex.$29.$9("LaunchPalUrl",this.$$d_$8ZQ)])},$316:function(n){this.$2US|=n},$nZ:function(n,t,i){if(n>t){_js.Trace.logWarning(_a.$0.$4W,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",i,this.$8d.$5P.DisplayName,t,n);return!0}return!1},$1QG:function(n,t){if(this.$2U7<3){var r=n.val;var i=this;n.val=function(n){i.$7dJ();r(n)};this.$2U7++;return!0}n.val(t);return!1},$7dJ:function(){this.$2U7--},$9rH:function(n){if(!_js.$9.$o(n)){n===OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd?this.$38i(!0):n===OSF.OsfControlActivationPerfMarker.SelectionTimeout?this.$38i(!1):n===OSF.OsfControlActivationPerfMarker.ActivationStart&&this.$2DT++;if(n.endsWith("Start")){n=n.substr(0,n.length-5);var i=_a.$6.acsa(_a.$0.$4W,n,!0);this.$1sG[n]=i}else if(n.endsWith("End")){n=n.substr(0,n.length-3);var t=this.$1sG[n];if(t){_a.$6.acea(t);delete this.$1sG[n]}}}},$5Ep:function(n,t){var i="";_ex.$5K.get_$Q().$34s(n)&&(i=_ex.$5K.get_$Q().$8Ja(n).TokenValue);t({wasSuccessful:!0,token:i})},$4X5:function(n,t,i){for(var f=new(_ff.$18.$$(String)),r=0;r<this.$J8.Extensions.length;r++){var e=this.$J8.Extensions[r];(n==="CallerIdentity"&&e.RequestedCapabilities>=1||n==="ExtensionCallback"&&e.RequestedCapabilities===2)&&f.$F(this.$J8.Extensions[r].Id)}var u=new _ex.$le(f.$3Q(),n);u.add_$2s(t);u.add_$2b(i);this.$n.$1U(u)},$5Em:function(n,t,i){var s=t;var o=s.body;var f="";if(_ex.$5K.get_$Q().$34r(n.Id)){f=_ex.$5K.get_$Q().$8Ew(n.Id).TokenValue;var r=new _ex.$lK(o,f,n.Id);var u=this;r.add_$2s(function(n){i({wasProxySuccessful:r.get_$4d().WasProxySuccessful,errorMessage:r.get_$4d().ErrorMessage,statusCode:r.get_$4d().StatusCode,statusDescription:r.get_$4d().StatusDescription,body:r.get_$4d().Body});u.$Gi(u.$12K,"ExecuteEwsRequest","",r)});var e=this;r.add_$2b(function(n){i({wasProxySuccessful:!1,errorMessage:r.$2H.message,statusCode:500,statusDescription:r.$2H.message,body:null});e.$Gi(e.$12K,"ExecuteEwsRequest",r.$2H.message,r)});this.$n.$1U(r)}else i({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})},$4oX:function(){if(!this.$11j){var r=this.$6K.$64("ExtAppVistedUrls");var u=this.$8d.$1RV.toLowerCase();this.$11j=_js.$9.$o(r)?3:-1!==r.indexOf(u)?1:2}if(!this.$2Cv&&this.$1lR&&this.$11j!==1){var t=this.$6K.$64("ExtAppVistedUrls");var i=this.$8d.$1RV.toLowerCase();if(t){t.length>5e3&&(t=t.substr(i.length));t+=i}else t=i;this.$6K.$I7("ExtAppVistedUrls",t);this.$2Cv=!0}var n=new _a.$3z;n.$5H("G",this.$2LG);n.$5H("S",this.$11j);this.$1RT&&n.$5H("E",this.$1RT);n.$5H("R",this.$2DT);n.$5H("F",this.$2US);n.$CX("Id",this.$8d.$5P.Id);n.$CX("Name",this.$8d.$5P.DisplayName);return n.toString()},$98j:function(n){if(n.get_$Hz()){var i=this;this.$sB.$9(function(t){var r=t.$H5(!0,!1);r.$4sg(n);i.$zX.$9(function(n){i.$I.$VL(IMailComposeViewModelFactory,function(){return n},null,_bc.$2I.get_$rB(),r,!1)})})}else{var t=this;this.$zO.$9(function(i){var r=i.$9(!1);r.set_$E(n);t.$fX.$9(function(n){t.$I.$VL(IItemReadingPaneViewModelPopOutFactory,function(){return n},null,_bc.$2I.get_$rB(),r,!1)})})}},$7sa:function(n){var t=new _bc.$Nj;if("requiredAttendees"in n){t.set_$Bm(new _js.$X);var e=n.requiredAttendees;if(this.$nZ(e.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var f=0;f<e.length;f++)t.get_$Bm().$F(_g.$2o.$4fv(e[f]))}if("optionalAttendees"in n){t.set_$DH(new _js.$X);var o=n.optionalAttendees;if(this.$nZ(o.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var i=0;i<o.length;i++)t.get_$DH().$F(_g.$2o.$4fv(o[i]))}if("start"in n&&!$C(n.start)){var v=n.start;var w=new Date(v);t.set_$1T(_a.$8.$4ft(w))}else{var a=_a.$1y.$35O(_a.$8.get_$38());t.set_$1T(a)}if("end"in n){var p=n.end;var y=new Date(p);t.set_$LO(_a.$8.$4ft(y).$6M(t.get_$1T()))}else t.set_$LO(18e5);if("subject"in n){var s=n.subject;if(this.$nZ(s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;t.set_$3o(s)}if("body"in n){var u=n.body;if(this.$nZ(u.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var r;r=this.$I.get_$U()==="Mouse"?new _g.$5d("HTML",_a.$1J.$4Wo(u)):new _g.$5d("Text",u);var l=new _g.$5E(r);t.set_$4n(l)}var h=_g.$3Q.$1CR();if("location"in n){var c=n.location;if(this.$nZ(c.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;h.set_$26(c)}t.set_$6E(h);return t},$8Ft:function(n,t){var f=_h.$o.get_$Q();var i=f.$64(n);if($C(i)||$C(i.get_$4n()))if(!$C(i)&&i.get_$Hz())this.$4nU(n,i.get_$106(),t);else{var u=this;var r=function(i){i.get_$Hz()?u.$4nU(n,i.get_$106(),t):t(i)};this.$3c4(n,_h.$f.get_$3zi(),"ItemNormalizedBody",r)}else t(i)},$4nU:function(n,t,i){var r;r=this.$I.get_$U()==="Mouse"&&t!==1?_h.$f.get_$24Y():_h.$f.get_$3Lk();this.$3c4(n,r,"MailCompose",i)},$3c4:function(n,t,i,r){var f=new _g.$1T(n);var u=new _h.$ll(100,[f],t,i,0,!1);var e=this;u.add_$2s(function(t){var i=_h.$o.get_$Q().$64(n);r(i)});this.$n.$1U(u)},$5YU:function(n){this.$I.$Ay(n)}};_ex.$Ug=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$kl=n;this.$LG=t;this.$PY=i;this.$tO=r;this.$I=u;this.$zO=f;this.$fX=e;this.$sB=o;this.$1M7=s;this.$1E=h;this.$l=c;this.$n=l;this.$1D=a};_ex.$Ug.prototype={$kl:null,$LG:null,$PY:null,$tO:null,$I:null,$sB:null,$1M7:null,$zO:null,$fX:null,$1D:null,$xj:null,$zX:null,$xz:null,$1E:null,$l:null,$n:null,$4Xf:function(n,t){return new _ex.$11e(this.$I,this.$kl,this.$tO,this.$LG,this.$PY,t,this.$xz,this.$xj,this.$zX,this.$sB,this.$1M7,this.$zO,this.$fX,n,this.$1E,this.$l,this.$n,this.$1D)},$7fl:function(n){return new _ex.$1Ep(this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$xz,this.$xj,this.$zX,this.$sB,this.$1M7,this.$zO,this.$fX,n,this.$1E,this.$l,this.$n,this.$1D)},$5uk:function(n){return new _ex.$11d(n,this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$xz,this.$xj,this.$zX,this.$sB,this.$zO,this.$fX,this.$1E,this.$l,this.$n)},$5tx:function(n){return new _ex.$11X(n,this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$xz,this.$xj,this.$zX,this.$sB,this.$zO,this.$fX,this.$1E,this.$l,this.$n)}};_ex.$11d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_ex.$11d.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$39C=n};_ex.$11d.prototype={$39C:null,$1Il:function(n,t){n.itemType=4;n.conversationId=this.$39C.$4nG();var i=this;_ex.$1a9.prototype.$1Il.call(this,n,function(){t()})}};_ex.$11e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_ex.$11e.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};_ex.$11e.prototype={$1Il:function(n,t){var i=this.$b.get_$CK()?this.$b.get_$CK().toLowerCase():"";if(_ex.$F9.$4wn(i)){if(_g.$9y.isInstanceOfType(this.$b)){n.itemType=3;this.$7Sx(n)}else n.itemType=1;this.$8aJ(n,t)}else _ex.$4e.prototype.$1Il.call(this,n,t)},$8aJ:function(n,t){var r=this.$b;n.conversationId=r.get_$5O()?r.get_$5O().Id:null;n.internetMessageId=r.get_$HS();if(this.get_$1LW())_ex.$4e.prototype.$1Il.call(this,n,t);else if(r.$22J){this.$316(16);var i=new _h.$lc(this.$b.get_$y());var f=this;i.add_$2b(function(){_js.Trace.logWarning(_a.$0.$4W,"GetAllRecipients to fetch extra recipients failed "+i.$2H);f.$316(256)});var u=this;i.add_$4Q(function(){u.$4Q0(n,t)});OwaApplication.$2B.$1U(i)}else this.$4Q0(n,t)},$4Q0:function(n,t){var i=this.$b;_ex.$4e.$3gG(n,"from",i.get_$5Q());_ex.$4e.$3gG(n,"sender",i.get_$Em());_ex.$4e.$4PP(n,"to",i.get_$79());_ex.$4e.$4PP(n,"cc",i.get_$7x());n.itemType===3&&this.$7UN(n);_ex.$4e.prototype.$1Il.call(this,n,t)},$7UN:function(n){var t=this.$b;_ex.$4e.$1wl(n,"to",t.get_$Q4().get_$Bm(),t.get_$Q4().get_$MD());_ex.$4e.$1wl(n,"cc",t.get_$Q4().get_$DH(),null);_ex.$4e.$1wl(n,"resources",t.get_$Q4().get_$EP(),null)},$7Sx:function(n){var t=this.$b;t.get_$Q4().get_$6E()&&(n.location=t.get_$Q4().get_$6E().get_$26());t.get_$Q4().get_$1T()&&(n.start=t.get_$Q4().get_$1T().$fF().getTime());t.get_$Q4().get_$2y()&&(n.end=t.get_$Q4().get_$2y().$fF().getTime())}};_ex.$Uh=function(n){this.$1rv={};this.$32l=n};_ex.$Uh.$$=function(n){var t="$Uh"+"$"+n.getName().replace(/\./g,"_");if(!_ex[t]){var r=_ex[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_ex.$Uh.apply(this,t)};r.registerClass("_ex."+t);var e={"_ex.$Uh":{T:n}};r.prototype.$$gta=e;var f=_ex.$Uh.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _ex[t]};_ex.$Uh.prototype={$32l:null,$18W:0,$F:function(n){var t=this.$32l+(+new Date).toString()+this.$18W.toString();this.$1rv[t]=n;this.$18W++;return t},$7UT:function(n,t){this.$1rv[n]=t;return n},$9PG:function(n,t){var i=this.$1rv[n];t&&delete this.$1rv[n];return i}};_ex.$4e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$$d_$7ou=Function.createDelegate(this,this.$7ou);this.$$d_$7ov=Function.createDelegate(this,this.$7ov);this.$$d_$4dh=Function.createDelegate(this,this.$4dh);this.$$d_$4db=Function.createDelegate(this,this.$4db);this.$$d_$7p0=Function.createDelegate(this,this.$7p0);_ex.$4e.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,y,p,w]);this.$jb=f;this.$b=v;this.$1D=b;this.$1M7=c};_ex.$4e.$3gG=function(n,t,i){$C(i)||(n[t]=_ex.$4e.$4Xw(i.Mailbox))};_ex.$4e.$4PP=function(n,t,i){if(!$C(i)&&i.get_$A()>0){for(var f=[],r=0;r<i.get_$A()&&r<100;r++){var u=i.get_$E(r);$C(u)||(f[r]=_ex.$4e.$4Xw(u))}n[t]=f}};_ex.$4e.$1wl=function(n,t,i,r){var f=null;var o=0;var s=!1;if(r&&r.Mailbox){s=!0;f=new Array(0);f[o++]=_ex.$4e.$4XA(r.Mailbox,"Organizer")}if(!$C(i)&&i.get_$A()>0){f||(f=new Array(0));for(var e=0;e<i.get_$A()&&o<100;e++){var u=i.get_$E(e);if(u&&u.get_$AB()){if(s&&r.Mailbox.EmailAddress&&u.get_$AB().EmailAddress&&u.get_$AB().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;f[o++]=_ex.$4e.$4XA(u.get_$AB(),u.get_$iA())}}}n[t]=f};_ex.$4e.$4Xw=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_ex.$4e.$3Lv(n.MailboxType);return t};_ex.$4e.$3Lv=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_ex.$4e.$7Sp=function(n,t){if(!$C(t)&&t.get_$A()>0){for(var f=[],u=0;u<t.get_$A();u++){var i=t.get_$E(u);var r={};if(i){r.id=i.get_$6J().Id;r.name=i.get_$1x();r.contentType=i.get_$KN();r.size=i.get_$8D();r.attachmentType=_g.$54.isInstanceOfType(i)?0:1;r.isInline=i.get_$CA();f[u]=r}}n.attachments=f}};_ex.$4e.$4XA=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_ex.$4e.$3Lv(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};_ex.$4e.prototype={$jb:!1,$1D:null,$1M7:null,$b:null,get_$2DZ:function(){return"ReadAppSelection"},get_$4RT:function(){return"ReadAppSelectionToProgressDone"},$7p0:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteGetCallbackTokenRequest",5);var i=_a.$6.$1g(_a.$0.$4W,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1LW()){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$8d.$5P.DisplayName);t(_ex.$1R.$1S0);this.$Gi(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var f,e;if(!(e=this.$1QG(f={val:t},_ex.$1R.get_$2Dw()),t=f.val,e)){this.$Gi(i,"ExecuteGetCallbackTokenRequest",_ex.$1R.get_$11b(),null);return}var r=new _ex.$Ve(this.$8d.$5P.Id,String.format("ParentItemId:{0}",this.$b.get_$y().Id));var u=this;r.add_$2s(function(n){u.$98v(t,n);u.$Gi(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$2b(function(n){t({wasSuccessful:!1});o.$Gi(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$2B.$1U(r)},$4db:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteLoadCustomPropRequest",5);var r=_a.$6.$1g(_a.$0.$4W,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _ex.$WP(this.$8d.$5P.Id,this.$b.get_$y().Id);var f,u;if(!(u=this.$1QG(f={val:t},_ex.$1R.get_$2Dw()),t=f.val,u)){this.$Gi(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful,customProperties:i.get_$4d().CustomProperties});e.$Gi(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1,customProperties:null});o.$Gi(r,"ExecuteLoadCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1U(i)},$4dh:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteSaveCustomPropRequest",5);var r=_a.$6.$1g(_a.$0.$4W,"ExecuteSaveCustomPropRequest",!0);var c=n;var h=c.customProperties;var e=JsonParser.serialize(h);if(this.$nZ(e.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_ex.$1R.$1S0);this.$Gi(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var u,f;if(!(f=this.$1QG(u={val:t},_ex.$1R.get_$2Dw()),t=u.val,f)){this.$Gi(r,"ExecuteSaveCustomPropRequest",_ex.$1R.get_$11b(),null);return}var i=new _ex.$pC(this.$8d.$5P.Id,this.$b.get_$y().Id,e);var o=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful});o.$Gi(r,"ExecuteSaveCustomPropRequest","",n)});var s=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1});s.$Gi(r,"ExecuteSaveCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1U(i)},$7ov:function(n,t){if(!this.$8Wh()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nZ(r.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}this.$5YF(1,r);t(null)},$7ou:function(n,t){if(!this.$8Wg()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nZ(r.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}this.$5YF(2,r);t(null)},$1Il:function(n,t){if(this.$8Us())this.$8aI(n,t);else{this.$30o(n);t()}},$2Cs:function(n){_ex.$1R.prototype.$2Cs.call(this,n);n.$3y([_ex.$29.$9("GetCallbackToken",this.$$d_$7p0),_ex.$29.$9("LoadCustomProperties",this.$$d_$4db),_ex.$29.$9("SaveCustomProperties",this.$$d_$4dh),_ex.$29.$9("DisplayReplyForm",this.$$d_$7ov),_ex.$29.$9("DisplayReplyAllForm",this.$$d_$7ou)])},$30o:function(n){n.id=this.$b.get_$y().Id;n.itemClass=this.$b.get_$CK();this.$b.get_$1Ce()&&(n.dateTimeCreated=this.$b.get_$1Ce().$fF().getTime());this.$b.get_$Jq()&&(n.dateTimeModified=this.$b.get_$Jq().$fF().getTime());this.$b.get_$172()&&(n.dateTimeSent=this.$b.get_$172().$fF().getTime());$C(this.$b.get_$r8())||(n.entities=this.$8Ey(this.$b.get_$r8()));var i=this.$Vt.$er.$8EX();i&&(n.filteredEntities=i);if(!this.get_$1LW()){n.subject=this.$b.get_$3o();n.normalizedSubject=this.$b.get_$14H();var t=this.$Vt.$1Wx;$C(t)||(n.regExMatches=t);_ex.$4e.$7Sp(n,this.$b.get_$EW())}},$8Us:function(){if(this.$b.get_$r8())return!1;var n=this.$b.get_$2tW();return n?n.ExtractedAddresses||n.ExtractedContacts||n.ExtractedEmails||n.ExtractedMeetings||n.ExtractedPhones||n.ExtractedTasks||n.ExtractedUrls:!1},$8aI:function(n,t){var i=new _ex.$lk(this.$b);var u=_a.$8.get_$38();var f=this;i.add_$2s(function(i){f.$1RT=_a.$8.get_$38().$6M(u);f.$30o(n);t()});var r=this;i.add_$2b(function(f){_js.Trace.logWarning(_a.$0.$4W,"GetItem to fetch entities failed "+i.$2H);r.$316(1);r.$1RT=_a.$8.get_$38().$6M(u);r.$30o(n);t()});OwaApplication.$2B.$1U(i)},$8Ey:function(n){var t={};t.Addresses=_ex.$3l.$12w(n.Addresses,3,this.$jb);t.Urls=_ex.$3l.$12w(n.Urls,4,this.$jb);t.PhoneNumbers=_ex.$3l.$12w(n.PhoneNumbers,5,this.$jb);if(!this.get_$1LW()){t.Contacts=_ex.$3l.$12w(n.Contacts,7,this.$jb);t.EmailAddresses=_ex.$3l.$12w(n.EmailAddresses,6,this.$jb);t.MeetingSuggestions=_ex.$3l.$12w(n.MeetingSuggestions,1,this.$jb);t.TaskSuggestions=_ex.$3l.$12w(n.TaskSuggestions,2,this.$jb)}return t},$5YF:function(n,t){var i=this;this.$sB.$9(function(r){var u=r.$H5(!0,!1);u.set_$6X(n);u.$1Th(i.$b);var e=u.$1kK(!0);var f;if(n===1)f=new _g.$gg;else if(n===2)f=new _g.$gf;else return;f.$3eO(e.get_$Ad());f.set_$2Ss(new _g.$5E(new _g.$5d("HTML",t)));f.set_$2u0(i.$b.get_$y());u.$6ND(f);i.$1M7.$9(function(n){var t=n.$4Xz(u,f,i.$1D);t.$M9=0;t.add_$2s(function(n){_js.Trace.logInfo(_a.$0.$4W,"Create response action succeeded");var t=n;if(t.$99===u.get_$D1()){u.$AV();u.set_$5j(0);u.set_$6X(4);u.set_$Fd(t.$5i);var i=new _y.$Cc;i.$WM(u)}});OwaApplication.$2B.$1U(t)})})},$8Wg:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$11n():!0:!1},$8Wh:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$xr():!0:!1},$98v:function(n,t){var i="";t&&_ex.$Ve.isInstanceOfType(t)&&t.$PX&&(i=t.$PX.TokenValue);n({wasSuccessful:!0,token:i})}};_ex.$123=function(n,t,i){_ex.$123.initializeBase(this,[t,i]);this.$75=n};_ex.$123.prototype={$75:null,get_$Tp:function(){return"GetBodyType"},get_$5II:function(){return 1},$7ol:function(){var t=this.$75.$2L1();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");this.$Tw(n,null)}};_ex.$12C=function(n,t,i){_ex.$12C.initializeBase(this,[t,i]);this.$N4=n};_ex.$12C.prototype={$N4:null,get_$Tp:function(){return"GetLocation"},get_$5II:function(){return 1},$7ol:function(){var n=this.$N4.$3Ej();this.$Tw(n,null)}};_ex.$VZ=function(n,t,i){_ex.$VZ.initializeBase(this,[t,i]);this.$75=n};_ex.$VZ.$7rz=function(n){var u=[];if(!n)return u;for(var f=n.get_$A()>100?100:n.get_$A(),t=0;t<f;t++){var r=n.get_$E(t).get_$2VQ();var i={};i.recipientType=_ex.$4e.$3Lv(r.get_$2Z().MailboxType);i.address=r.get_$2Z().EmailAddress||null;i.name=r.get_$26();u[t]=i}return u};_ex.$VZ.prototype={$75:null,get_$Tp:function(){return"GetRecipients"},get_$5II:function(){return 1},$7ol:function(){var i=this.$1e.recipientField;var t=this.$75.$8Hm(i);var n=_ex.$VZ.$7rz(t);this.$Tw(n,null)}};_ex.$12O=function(n,t,i){_ex.$12O.initializeBase(this,[t,i]);this.$75=n};_ex.$12O.prototype={$75:null,get_$Tp:function(){return"GetSubject"},get_$5II:function(){return 1},$7ol:function(){var n=this.$75.$v7();this.$Tw(n||"",null)}};_ex.$12M=function(n,t,i){_ex.$12M.initializeBase(this,[t,i]);this.$75=n};_ex.$12M.prototype={$75:null,get_$Tp:function(){return"GetSelectedData"},get_$5II:function(){return 1},$7ol:function(){var e=this.$1e;var n=0;var t;var s=e.coercionType;var f,r,u;var o=(u=this.$75.$8IV(s===_ex.$1ZB.$Vj.toString(3)?_ex.$1ZB.$Vj.toString(3):_ex.$1ZB.$Vj.toString(0),f={val:t},r={val:n}),t=f.val,n=r.val,u);if(n)this.$Z3(n,null);else{var i={};i.data=o;i.sourceProperty=t;this.$Tw(i,null)}}};_ex.$12R=function(n,t,i){_ex.$12R.initializeBase(this,[t,i]);this.$N4=n};_ex.$12R.prototype={$N4:null,get_$Tp:function(){return"GetTime"},get_$5II:function(){return 1},$7ol:function(){var n=null;var t=this.$1e.TimeProperty;t===1?n=this.$N4.$3tA():t===2&&(n=this.$N4.$3sb());this.$Tw(n.$fF().getTime(),null)}};_ex.$14c=function(n,t,i,r,u){this.$$d_$2nq=Function.createDelegate(this,this.$2nq);this.$$d_$2nt=Function.createDelegate(this,this.$2nt);_ex.$14c.initializeBase(this,[t,u]);this.$N5=i;this.$75=n;this.$n=r};_ex.$14c.prototype={$N5:null,$75:null,$n:null,get_$Tp:function(){return"ExecuteLoadCustomPropRequestForCompose"},get_$5II:function(){return 0},$7ol:function(){var t=this.$75.$3ES();if(t)for(var n=t.get_$A()-1;n>=0;n--)if(_h.$6B.$4ur(t.get_$E(n),this.$N5)){this.$2WE({wasSuccessful:!0,customProperties:t.get_$E(n).get_$1Z()},null);return}var r=this.$75.$2LI();if(!r){this.$2WE({wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$1e;var i=new _ex.$WP(this.$N5,this.$75.$2LI());i.add_$2s(this.$$d_$2nt);i.add_$2b(this.$$d_$2nq);this.$n.$1U(i)},$2nt:function(n){var t=n;var r={wasSuccessful:t.get_$4d().WasSuccessful,customProperties:t.get_$4d().CustomProperties};if(!_js.$9.$o(t.get_$4d().CustomPropertyNames)){var i=this.$75.$3ES();_h.$6B.$4PZ(i,t.get_$4d().CustomPropertyNames)}this.$2WE(r,n.$99)},$2nq:function(n){_js.Trace.logError(_a.$0.$4W,"custom properties load failed with "+n.$2H);var t={errorMessage:n.$2H.message,wasSuccessful:!1,customProperties:null};this.$9PS(t,n.$2H.message,n.$99)}};_ex.$17T=function(n,t,i){this.$$d_$5xg=Function.createDelegate(this,this.$5xg);_ex.$17T.initializeBase(this,[t,i]);this.$id=n};_ex.$17T.prototype={$id:null,$11d:null,$1Pi:null,get_$Tp:function(){return"RemoveAttachment"},get_$5II:function(){return 3},$7ol:function(){this.$1Pi=this.$1e.attachmentIndex;if(this.$1Pi.length>200){_js.Trace.logError(_a.$0.$4W,"RemoveFileAttachment got too long attachmentId");this.$gF();return}if(!this.$1Pi){_js.Trace.logError(_a.$0.$4W,"RemoveAttachment got null or empty attachmentIndex");this.$gF();return}this.$11d=this.$id.$9PG(this.$1Pi,!0);if(!this.$11d){this.$Z3(9008,null);return}if(this.$11d.get_$1dX()){this.$Tw(null,null);return}this.$11d.add_$1s4(this.$$d_$5xg);this.$11d.get_$1Cg().$11()},$5xg:function(n){this.$11d.remove_$1s4(this.$$d_$5xg);if(n.get_$3Sn()){this.$id.$7UT(this.$1Pi,this.$11d);this.$Z3(9009,null);return}this.$Tw(null,null)}};_ex.$LD=function(n,t,i,r){_ex.$LD.initializeBase(this,[t,r]);this.$N5=i;this.$75=n};_ex.$LD.prototype={$N5:null,$75:null,get_$Tp:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$5II:function(){return 0},$7ol:function(){var f=this.$1e;var e=f.customProperties;var u=JsonParser.serialize(e);if(u.length>2500){this.$gF();return}for(var r=_h.$6B.$7gN(this.$N5,u),n=this.$75.$3ES(),i=!1,t=0;t<n.get_$A();t++)if(_h.$6B.$4ur(n.get_$E(t),this.$N5)){n.set_$E(t,r);i=!0;break}i||this.$7TW(n,r);this.$75.$8cC();this.$2WE(_ex.$LD.$4Z8,null)},$7TW:function(n,t){n.$F(t);_h.$6B.$4PZ(n,t.get_$M0().get_$Ms())}};_ex.$1a6=function(n,t,i,r){this.$$d_$9Q1=Function.createDelegate(this,this.$9Q1);this.$$d_$9Q2=Function.createDelegate(this,this.$9Q2);_ex.$1a6.initializeBase(this,[t,i]);this.$75_1=n;this.$n=r};_ex.$1a6.prototype={$75_1:null,$n:null,$xw:0,$7ol:function(){var i=this.$1e;var n=i.data;if(n.length>1e6){this.$gF();return}var u,r;if(r=this.$9xZ(i.coercionType,u={val:this.$xw}),this.$xw=u.val,r)if(this.$xw===3)if(_js.$9.$o(n))this.$2NA("");else{var t=new _ex.$17i(n);t.add_$2s(this.$$d_$9Q2);t.add_$2b(this.$$d_$9Q1);this.$75_1.$9o9();this.$n.$1U(t)}else this.$75_1.$2L1()==="HTML"?this.$2NA(_ff.$2c.$Jh(n)):this.$2NA(n)},$9Q1:function(n){_js.Trace.logError(_a.$0.$4W,"Sanitize html failed with "+n.$2H);this.$Z3(9011,null)},$9Q2:function(n){_js.Trace.logInfo(_a.$0.$4W,"Sanitize html succeeded.");if(this.$75_1.$2L1()==="HTML"){var u=n;var t=u.get_$4d();var r;this.$9NN(r={val:t}),t=r.val;var i=this;this.$75_1.$7b4(function(n){n?i.$Z3(9014,null):i.$2NA(t)})}else this.$Z3(2006,null)},$9NN:function(n){n.val=n.val.trim();n.val.substr(0,5).toLowerCase()==="<div>"&&n.val.substr(n.val.length-6,6).toLowerCase()==="</div>"&&(n.val=n.val.substring(5,n.val.length-6))},$9xZ:function(n,t){var i=this.$75_1.$2L1();t.val=n;if(!$C(n)){if(i==="Text"&&t.val===3){this.$Z3(2006,null);return!1}return!0}this.$gF();return!1}};_ex.$18G=function(n,t,i){_ex.$18G.initializeBase(this,[t,i]);this.$N4=n};_ex.$18G.prototype={$N4:null,get_$Tp:function(){return"SetLocation"},get_$5II:function(){return 3},$7ol:function(){var n=this.$1e.location;if(n.length>255)this.$gF();else{this.$N4.$9ho(n);this.$Tw(null,null)}}};_ex.$18N=function(n,t,i){_ex.$18N.initializeBase(this,[t,i]);this.$75=n};_ex.$18N.prototype={$75:null,get_$Tp:function(){return"SetSubject"},get_$5II:function(){return 3},$7ol:function(){var n=this.$1e.subject;if(n.length>255){this.$gF();return}this.$75.$9j4(n);this.$Tw(null,null)}};_ex.$18M=function(n,t,i,r){_ex.$18M.initializeBase(this,[n,t,i,r]);this.$75=n};_ex.$18M.prototype={$75:null,get_$Tp:function(){return"SetSelectedData"},get_$5II:function(){return 3},$2NA:function(n){var t;var i;this.$75.$9iq(n,this.$xw===3,i={val:t}),t=i.val;t?this.$Z3(t,null):this.$Tw(null,null)}};_ex.$18O=function(n,t,i){_ex.$18O.initializeBase(this,[t,i]);this.$N4=n};_ex.$18O.prototype={$N4:null,get_$Tp:function(){return"SetTime"},get_$5II:function(){return 3},$7ol:function(){var i=this.$1e.TimeProperty;var r=this.$1e.time;var n=_a.$8.$rH(new Date(r));var t=!0;i===1?this.$N4.$9j0(n):i===2&&(t=this.$N4.$9sT(n));t?this.$Tw(null,null):this.$Z3(9010,null)}};_ex.$29=function(n,t,i){this.$WE=n;this.$m6=t;this.$32w=i};_ex.$29.$9=function(n,t){return new _ex.$29(n,t,!1)};_ex.$29.$7fb=function(n,t){return new _ex.$29(n,t,!0)};_ex.$29.prototype={$WE:null,$32w:!1,$m6:null};_ex.$19n=function(n,t){this.$1ZP=n;this.$3D=t};_ex.$19n.prototype={$1ZP:null,$3D:null,get_$EzB:function(){return this.$1ZP},get_$1x:function(){return this.$3D},get_$8D:function(){return 0},get_$6k:function(){return""}};_ex.$kU=function(n,t){this.$$d_$2IB=Function.createDelegate(this,this.$2IB);this.$$d_$3td=Function.createDelegate(this,this.$3td);_ex.$kU.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$kU.initializeBase(this);this.$65=n;this.$QC=t;if(this.$QC==="TouchNarrow"){this.set_$A1(_y.$1i.$FE(this));var r=this;var i=new _C(function(){r.$5N()},_a.$0.$4W);this.$5w.set_$Tx([_y.$1P.$SG(_nbs.NonBootStrings.l_Close_LowerCase_Text,i)])}};_ex.$kU.prototype={$QC:0,$7c:null,$65:null,$vJ:!1,$11z:null,$pU:null,get_$2tB:function(){return 2},get_$3tc:function(){return this.$$d_$3td},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7lv:function(){return!0},get_$SA:function(){return this.$QC==="TouchNarrow"?1:0},$3td:function(n,t){if(this.$vJ)return!1;if(this.$pU){this.$11z=n;this.$pU(this.$$d_$2IB);return!0}this.$2IB();return!1},$5N:function(){if(!this.$vJ&&this.$7c){this.$7c();this.$65.$32i(!1)}},$2IB:function(){this.$vJ=!0;this.$11z&&this.$11z()}};_ex.$KN=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$98I=Function.createDelegate(this,this.$98I);this.$$d_$5FO=Function.createDelegate(this,this.$5FO);this.$$d_$4ed=Function.createDelegate(this,this.$4ed);this.$$d_$6pk=Function.createDelegate(this,this.$6pk);this.$$d_$96C=Function.createDelegate(this,this.$96C);this.$$d_$998=Function.createDelegate(this,this.$998);this.$$d_$7E3=Function.createDelegate(this,this.$7E3);_ex.$KN.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p,w]);_a.$6.stPT(_a.$0.$4W,"EnableAppsButton",5);this.$1uu=_a.$6.$1g(_a.$0.$4W,"EnableAppsButton",!0);this.$FF=t;this.set_$31m(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3GE(!1);this.set_$1Pb(!0);this.$2DX=i;this.$15W=new _C(this.$$d_$7E3,n);this.$15W.set_$87(!1);this.$3GC=new _C(this.$$d_$998,n);this.$32j=new _C(this.$$d_$96C,n)};_ex.$KN.prototype={$13e:null,$2DY:null,$2MQ:!1,$2DX:null,$1YU:!1,$2IT:!1,$1Pa:!1,$2DW:0,$15W:null,$3GC:null,$32j:null,$2De:!1,$FF:null,$So:null,$1uu:null,add_$2TO:function(n){this.$32("OnAppsPaneOpened",n)},remove_$2TO:function(n){this.$5d("OnAppsPaneOpened",n)},add_$5Dr:function(n){this.$32("OnAppsPaneClosed",n)},remove_$5Dr:function(n){this.$5d("OnAppsPaneClosed",n)},add_$2Ta:function(n){this.$32("OnExtensionOpened",n)},remove_$2Ta:function(n){this.$5d("OnExtensionOpened",n)},add_$3Ru:function(n){this.$32("BackToList",n)},remove_$3Ru:function(n){this.$5d("BackToList",n)},get_$2xe:function(){return this.$15W},set_$7rk:function(n){if(this.$2IT!==n){this.$2IT=n;this.$4("ForceHideAppsButton")}return n},get_$5XY:function(){return this.$1YU},set_$5XY:function(n){if(this.$1YU!==n){this.$1YU=n;this.$4("ShowAppsButton")}return n},get_$3hN:function(){return this.$2DW},set_$3hN:function(n){if(this.$2DW!==n){this.$2DW=n;this.$4("AppPaneSize")}return n},get_$1Pb:function(){return this.$1Pa},set_$1Pb:function(n){if(this.$1Pa!==n){this.$1Pa=n;this.$4("AppPaneIsHidden")}return n},get_$13S:function(){return this.$FF.$aU===1},get_$6UE:function(){return this.$VJ.get_$U()==="TouchNarrow"},set_$50n:function(n){this.$13e=n;if(n.$d1===3){var t=this.$13e.$38w.get_$2g().extensionViewModel;this.$1My(t)}return n},set_$31m:function(n){if(this.$2DY!==n){this.$2DY=n;this.$4("AppPaneTitle")}return n},set_$3GE:function(n){if(this.$2MQ!==n){this.$2MQ=n;this.$4("HideExtensionsList")}return n},get_$2Oz:function(){return this.$VJ.get_$U()!=="Mouse"},$73:function(){this.$5Ld();this.set_$1Pb(!0);this.$8NQ();this.$FF&&this.$FF.$p("Orientation",this.$$d_$6pk);_ex.$2H.prototype.$73.call(this)},$AJ:function(){this.$9sr();this.$FF&&this.$FF.$1B("Orientation",this.$$d_$6pk);_ex.$2H.prototype.$AJ.call(this)},$1My:function(n){if(n){this.set_$3GE(!0);this.set_$22P(!1);this.set_$31m(n.get_$1lQ().DisplayName);if(this.$l.$8G(this.$l.get_$IF())){var t=this;this.$l.get_$IF().$4cy(n.get_$4d5(),n.get_$1lQ().DisplayName,function(){t.$5Nm(n)},this.$$d_$4ed)}else this.$5Nm(n)}else this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4dr():this.$4ed()},$7E3:function(){_a.$6.stPT(_a.$0.$4W,"ShowAppPane",3);var n=_a.$6.$1g(_a.$0.$4W,"ShowAppPane",!0);if(this.$VJ.get_$U()==="Mouse"){if(this.$1Pa){this.set_$3hN(342);this.set_$1Pb(!1);this.$5Dp(1)}}else if(this.$VJ.get_$U()!=="TouchNarrow"&&this.$FF.$aU)this.set_$1Pb(!1);else{this.$So=this.$2Ht.$7fx(this,this.$VJ.get_$U());this.$So.$pU=this.$$d_$5FO;this.$VJ.$Ay(this.$So)}this.$6T("OnAppsPaneOpened");_a.$6.$1G(n,"ShowAppPane","");_a.$6.endPT("ShowAppPane")},$22N:function(n){if(!this.$1Pa){var t=null;if(n){_a.$6.stPT(_a.$0.$4W,"HideAppPane",3);t=_a.$6.$1g(_a.$0.$4W,"HideAppPane",!0)}this.$32i(!1);this.set_$3hN(0);this.set_$1Pb(!0);this.$6T("OnAppsPaneClosed");this.$5Dp(2);if(n){_a.$6.$1G(t,"HideAppPane","");_a.$6.endPT("HideAppPane")}}},$32i:function(n){var t=null;if(n){_a.$6.stPT(_a.$0.$4W,"CloseComposeApp",3);t=_a.$6.$1g(_a.$0.$4W,"CloseComposeApp",!0)}this.$1My(null);if(n){_a.$6.$1G(t,"CloseComposeApp","");_a.$6.endPT("CloseComposeApp")}},$4aU:function(n){return!n},$96C:function(){this.$32i(!0)},$6pk:function(n,t){this.get_$13S()?this.$So&&this.$So.$5N():this.$22N(!1);this.$6T("OnAppsPaneClosed")},$998:function(){this.$VJ.get_$U()!=="TouchWide"||this.get_$13S()?this.$22N(!0):this.$So&&this.$So.$5N()},$5Nm:function(n){this.$6T("OnExtensionOpened");_ex.$2H.prototype.$1My.call(this,n);this.$1WM(!0)},$4ed:function(){this.$1tO(!0);this.set_$31m(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3GE(!1);this.$6T("BackToList");_ex.$2H.prototype.$1My.call(this,null)},$8NQ:function(){this.$p(_ex.$2H.$46r,this.$$d_$98I);this.$p(_ex.$2H.$41G,this.$$d_$98I);this.$p("ForceHideAppsButton",this.$$d_$98I);this.$2De=!0},$9sr:function(){if(this.$2De){this.$1B(_ex.$2H.$46r,this.$$d_$98I);this.$1B(_ex.$2H.$41G,this.$$d_$98I);this.$1B("ForceHideAppsButton",this.$$d_$98I);this.$2De=!1}},$98I:function(n,t){(t===_ex.$2H.$46r||t===_ex.$2H.$41G||t==="ForceHideAppsButton")&&this.$5Ld()},$5Dp:function(n){this.$2DX&&this.$2DX(n)},$5FO:function(n){this.$1My(null);n()},$5Ld:function(){this.set_$5XY(!this.$2IT&&(!this.$46q||!!this.$1Up));this.$15W.set_$87(this.$1YU);if(this.$1uu&&this.$1YU){_a.$6.$1G(this.$1uu,"EnableAppsButton");_a.$6.endPT("EnableAppsButton");this.$1uu=null}}};_ex.$11a=function(){_ex.$11a.initializeBase(this,[1,"VM.Extensibility.Stats"])};_ex.$11a.prototype={set_$7eP:function(n){this.$P("ContextRetrievalTime",n);return n},set_$7eM:function(n){this.$P("ContextExtensionsCount",n);return n},set_$8cj:function(n){this.$P("MaxCountOfActiveExtensions",n);return n},set_$7Qo:function(n){this.$P("ActivationTime",n);return n},set_$9qx:function(n){this.$P("TotalActivationStatistics",n);return n},set_$9L4:function(n){this.$P("RegExStatistics",n);return n},set_$9Fe:function(n){this.$P("PerExtensionStatistics",n);return n},set_$vI:function(n){this.$P("Interval",n);return n},set_$7sE:function(n){this.$P("FromHtmlStatistics",n);return n},set_$8Q9:function(n){this.$P("InnerTextStatistics",n);return n},set_$8Na:function(n){this.$P("HtmlBodyLengthStatistics",n);return n},set_$7ep:function(n){this.$P("ConvertedBodyLengthStatistics",n);return n},set_$7oQ:function(n){this.$P("EntityStatistics",n);return n}};_ex.$F5=function(){};_ex.$F5.$8c7=function(n){var i=n.toString();var t=_ex.$F5.$L2[i];if(!t){t=_js.$1I.$Gx(_y.$11b,n);_ex.$F5.$L2[i]=t}return t};_ex.$BH=function(n,t){this.$$d_$9RM=Function.createDelegate(this,this.$9RM);this.$$d_$9HE=Function.createDelegate(this,this.$9HE);_ex.$BH.initializeBase(this);this.$Ij=n;this.$iF=t;this.$10L=new _C(this.$$d_$9HE,_a.$0.$4W);this.$1Jp=new _fm.$1u(new Array(0));this.$rA=new _js.$X};_ex.$BH.prototype={$p7:0,$Ij:null,$rA:null,$1Jp:null,$iF:null,$2MP:!0,$1I1:null,$13e:null,$10L:null,set_$4r5:function(n){if(this.$2MP!==n){this.$2MP=n;this.$4(_ex.$BH.$4r6)}return n},set_$2aG:function(n){if(this.$1I1!==n){this.$1I1=n;$C(n)||this.$4(_ex.$BH.$3cZ)}return n},set_$50n:function(n){this.$13e=n;if(n.$d1===3){var t=this.$13e.$38w.get_$2g().extensionViewModel;if($C(t)||this.$1I1===t){this.$iF.$8d=null;this.$iF.$11();this.$Vi()}else{this.$iF.$8d=t;this.$iF.$11();this.set_$2aG(t)}}return n},$Vi:function(){this.$1I1=null;this.$4(_ex.$BH.$3cZ)},$9HE:function(){if(!(this.$p7<1)){var n=0;var i=this.$Ij.get_$A();var e=!1;var t=this.$1I1;var r=this.$p7;this.$rA.$1u();while(n<r&&n<i){var o=this.$Ij.get_$E(n);var u=n+1===r||n+1===i;($C(t)||o.$5P.Id===t.$5P.Id)&&(e=!0);var f=u&&!e?t:this.$Ij.get_$E(n);this.$rA.$F(f);f.set_$4wW(u&&i<=r);n++}this.set_$2aG(t);this.$4AA()}},$9RM:function(n){n.set_$4wW(!1);this.$rA.$5W(this.$rA.get_$A()-1);this.$rA.$F(n);this.$iF.$8d=n;this.$iF.$11();this.set_$2aG(n);this.$4AA()},$4AA:function(){var i=this.$Ij.get_$A();if(i>this.$p7){var t=0;this.$1Jp.$1a.$1u();while(t<i){var n=this.$Ij.get_$E(t);if(this.$rA.$7r(n)<0){var r=new _fm.$d(n.$5P.DisplayName,null,new _ex.$bX(this.$$d_$9RM,n),!0);this.$1Jp.$1a.$F(r)}t++}this.set_$4r5(!1)}else{this.$1Jp.$1a.$1u();this.set_$4r5(!0)}}};_ex.$lM=function(n,t,i){this.$$d_$4ef=Function.createDelegate(this,this.$4ef);this.$$d_$2IB=Function.createDelegate(this,this.$2IB);this.$$d_$3td=Function.createDelegate(this,this.$3td);_ex.$lM.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$lM.initializeBase(this);this.$65=n;this.$QC=i;if(i!=="Mouse"){this.set_$A1(_y.$1i.$FE(this));var e=this;var o=new _C(function(){e.$5N()},_a.$0.$4W);this.$5w.set_$Tx([_y.$1P.$SG(_nbs.NonBootStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$2P6())if(_g.$2g.isInstanceOfType(this.$65.$b))this.set_$3KL(this.$65.$b.get_$4n().get_$1Z());else if(this.$65.$b.get_$Mq()&&this.$65.$b.get_$Mq().get_$1Z())this.set_$3KL(this.$65.$b.get_$Mq().get_$1Z());else{var r=_ff.$1q.$4s(_h.$f.get_$3zi());r.MaximumBodySize=0;r.MaximumRecipientsToReturn=0;var u=new _h.$Fz(100,[this.$65.$b.get_$y()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2s(function(n){f.set_$3KL(f.$65.$b.get_$Mq().get_$1Z())});OwaApplication.$2B.$1U(u)}};_ex.$lM.prototype={$QC:0,$7c:null,$65:null,$pU:null,$3KK:null,$vJ:!1,$11z:null,set_$3KL:function(n){this.$3KK=n;this.$4("ItemBodyValue");return n},get_$2tB:function(){return 4},get_$3tc:function(){return this.$$d_$3td},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7lv:function(){return!0},get_$SA:function(){return this.$QC!=="Mouse"?1:0},$3td:function(n,t){if(this.$vJ)return!1;if(this.$pU){this.$11z=n;this.$pU(this.$$d_$2IB);return!0}this.$2IB();return!1},$5N:function(){this.$vJ||(this.$QC==="TouchNarrow"?this.$pU?this.$pU(this.$$d_$4ef):this.$4ef():this.$7c&&this.$7c())},$4ef:function(){this.$vJ=!0;this.$7c&&this.$7c()},$2IB:function(){this.$vJ=!0;this.$11z&&this.$11z()}};_ex.$Ui=function(){};_ex.$Ui.prototype={$7gO:function(n,t,i){return new _ex.$lM(n,t,i)},$7fx:function(n,t){return new _ex.$kU(n,t)}};_ex.$11f=function(){this.$$d_$4nO=Function.createDelegate(this,this.$4nO);this.$3Kn=_a.$8.$mH;this.$11M=[];this.$1Cs={};this.$1Ct={}};_ex.$11f.prototype={$52A:100,$36T:6e5,$nX:null,$bD:null,$TM:null,$1Cp:null,$5dE:function(n,t){if(!this.$1ut()){this.$TM||(this.$TM=new _ex.$11f.$4e5);if(!this.$TM.$1t5){this.$TM.$1t5=[];this.$TM.$1Wy=[]}Array.add(this.$TM.$1t5,n);Array.add(this.$TM.$1Wy,t)}},$9rT:function(n){this.$1Ct[n]=$C(this.$1Ct[n])?1:this.$1Ct[n]+1},$5dB:function(n,t,i){i&&(this.$1Cs[n]=$C(this.$1Cs[n])?1:this.$1Cs[n]+1);if(!this.$1ut()){this.$TM||(this.$TM=new _ex.$11f.$4e5);this.$TM.$3bd=t;this.$TM.$30c=i;this.$TM.$2O=n;this.$nX||(this.$nX=new _ex.$11f.$4Oc);Array.add(this.$nX.$2Mx,this.$TM);this.$TM=null}},$5dD:function(n,t){if(!this.$1ut()){this.$1Cp||(this.$1Cp=new _ex.$11f.$7ph);this.$1Cp.$5dD(n,t)}},$5dG:function(n){if(!this.$1ut()){this.$nX||(this.$nX=new _ex.$11f.$4Oc);this.$nX.$3dN=n;Array.add(this.$11M,this.$nX);this.$nX=null}},$9rO:function(n,t,i,r){if(!this.$1ut()){this.$bD||(this.$bD=new _ex.$11f.$7Xy);this.$bD.$3GS.$2W(n,null);this.$bD.$3H6.$2W(r,null);this.$bD.$3AK.$2W(i,null);this.$bD.$35C.$2W(t,null)}},$4f4:function(){var n=_a.$8.get_$38();if(n.$6M(this.$3Kn)>=this.$36T){_a.$i.$Ii.$7Ro(this.$$d_$4nO);this.$9OD();this.$3Kn=n}},$9OD:function(){this.$11M=[];this.$1Cs={};this.$1Ct={};this.$nX=null;this.$TM=null;this.$bD=null;this.$1Cp=null},$uY:function(n){var t=new Sys.StringBuilder;if($C(_ex.$4W.$en))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$4nO().$Gx(n));n&&t.append("</TABLE>")}return new _a.$F4("Pending Extensibility Statistics",t.toString())},$4nO:function(){var l=_ex.$4W.$en.Extensions.length;var n=new _ex.$11a;n.set_$7eP(_ex.$4W.$2PQ);n.set_$7eM(l);if(this.$11M.length>0){for(var e=0,h=new _ex.$Gz,i={},c=new _ex.$Gz,r=0;r<this.$11M.length;r++){var u=this.$11M[r];h.$2W(u.$3dN,null);for(var f=0,s=0;s<u.$2Mx.length;s++){var t=u.$2Mx[s];var o=t.$2O;t.$30c&&f++;$C(i[o])&&(i[o]=new _ex.$Gz);i[o].$2W(t.$3bd,null);t.$9w3(c)}f>e&&(e=f)}n.set_$8cj(e);n.set_$7Qo(this.$11M.length);n.set_$9qx(h.$wm());n.set_$9Fe(this.$9SR(i));n.set_$9L4(c.$wm());n.set_$vI(this.$36T/1e3);if(this.$bD){n.set_$7sE(this.$bD.$3AK.$wm());n.set_$8Q9(this.$bD.$3H6.$wm());n.set_$8Na(this.$bD.$3GS.$wm());n.set_$7ep(this.$bD.$35C.$wm())}this.$1Cp&&n.set_$7oQ(this.$1Cp.$wm())}return n},$9SR:function(n){for(var t=new Sys.StringBuilder,r=0;r<_ex.$4W.$en.Extensions.length;r++){var i=_ex.$4W.$en.Extensions[r];var f=$C(this.$1Cs[i.Id])?0:this.$1Cs[i.Id];var u=$C(this.$1Ct[i.Id])?0:this.$1Ct[i.Id];t.append("[");t.append(i.Id);t.append(",");t.append(i.DisplayName);t.append(";");t.append(n[i.Id]?n[i.Id].$wm():"");t.append(";");t.append(f.toString());t.append(",");t.append(u.toString());t.append("]")}return t.toString()},$1ut:function(){return this.$11M.length>=this.$52A||!_js.Trace.$43}};_ex.$11f.$4Oc=function(){this.$2Mx=[]};_ex.$11f.$4Oc.prototype={$3dN:0};_ex.$11f.$7Xy=function(){this.$3AK=new _ex.$Gz;this.$3H6=new _ex.$Gz;this.$3GS=new _ex.$Gz;this.$35C=new _ex.$Gz};_ex.$11f.$4e5=function(){};_ex.$11f.$4e5.prototype={$2O:null,$1t5:null,$1Wy:null,$3bd:0,$30c:!1,$9w3:function(n){if(this.$1Wy)for(var t=0;t<this.$1Wy.length;t++)n.$2W(this.$1Wy[t],this.$1t5[t])}};_ex.$11f.$7ph=function(){};_ex.$11f.$7ph.prototype={$3QU:0,$3QV:0,$3QW:0,$3QX:0,$3QY:0,$3QZ:0,$3Qa:0,$14C:null,$5dD:function(n,t){this.$14C=null;var i=!t;if(n){var r=new(_ff.$18.$$(_g.$BN));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1Ba(3);this.$3QU++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1Ba(7);this.$3QV++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1Ba(6);this.$3QW++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1Ba(1);this.$3QX++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1Ba(5);this.$3QY++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1Ba(2);this.$3QZ++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1Ba(4);this.$3Qa++}}},$wm:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$3QU,this.$3QV,this.$3QW,this.$3QX,this.$3QY,this.$3QZ,this.$3Qa));if(this.$14C){n.append("MissingOnLastMessage:");for(var t=0;t<this.$14C.get_$A();t++){n.append(_g.$BN.toString(this.$14C.get_$E(t)));n.append(",")}}return n.toString()},$1Ba:function(n){this.$14C||(this.$14C=new(_ff.$18.$$(_g.$BN)));this.$14C.$F(n)}};_ex.$11g=function(n){this.$2k=n};_ex.$11g.prototype={$2k:null,$Us:null,$2V:function(n,t,i){this.$Us=_js.$D.get_$Q().$2V(i,this.$2k,n,t)},$33h:function(){this.$Us&&(this.$Us=_js.$D.get_$Q().$6Q(this.$Us))}};_ex.$sr=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$5FO=Function.createDelegate(this,this.$5FO);this.$$d_$4ee=Function.createDelegate(this,this.$4ee);this.$$d_$5Hg=Function.createDelegate(this,this.$5Hg);_ex.$sr.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v])};_ex.$sr.prototype={$So:null,$2IA:null,$1My:function(n){_ex.$2H.prototype.$1My.call(this,n);this.$9l9()},$AJ:function(){_ex.$2H.prototype.$AJ.call(this);this.$So&&this.$So.$5N()},$4aU:function(n){return"Mouse"!==this.$VJ.get_$U()||!n},$5Hg:function(){this.$1WM(!0);this.$7hp()},$9l9:function(){"Mouse"!==this.$VJ.get_$U()&&this.$CN&&(this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4cy(this.$CN.get_$4d5(),this.$CN.get_$1lQ().DisplayName,this.$$d_$5Hg,this.$$d_$4ee):this.$5Hg())},$7hp:function(){this.$So=this.$2Ht.$7gO(this,this.$b2,this.$VJ.get_$U());this.$So.$pU=this.$$d_$5FO;this.$VJ.$Ay(this.$So)},$5FO:function(n){this.$dk&&this.$dk.$Vi();this.$2IA=n;this.$1tO(!0);this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4dr():this.$4ee()},$4ee:function(){this.$2IA&&this.$2IA()}};_ex.$2H=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$7bG=Function.createDelegate(this,this.$7bG);this.$$d_$98h=Function.createDelegate(this,this.$98h);this.$$d_$98H=Function.createDelegate(this,this.$98H);this.$$d_$2LC=Function.createDelegate(this,this.$2LC);this.$$d_$8Kl=Function.createDelegate(this,this.$8Kl);this.$$d_$9Dm=Function.createDelegate(this,this.$9Dm);this.$$d_$1My=Function.createDelegate(this,this.$1My);_ex.$2H.initializeBase(this);this.$Hn=n;this.$2Ht=u;this.$l=t;this.$b2=i;this.$VJ=r;this.$Ij=new _js.$X;this.$Qa=new _y.$NJ;this.$jT=[];this.$3Sw=_ex.$2H.$8HB(o);this.$iF=new _ex.$bX(this.$$d_$1My,null);this.$3Sj=new _C(this.$$d_$9Dm,_a.$0.$4W);this.$2WD=f;this.$vM=e;this.$2Hi=s;this.$FH=h;this.$b=c;this.$xQ=l;this.$fK=a;this.$1D=v};_ex.$2H.add_$2Td=function(n){_ex.$2H.$12v||(_ex.$2H.$12v=new Sys.EventHandlerList);_ex.$2H.$12v.addHandler(_ex.$2H.$5El,n)};_ex.$2H.remove_$2Td=function(n){_ex.$2H.$12v&&_ex.$2H.$12v.removeHandler(_ex.$2H.$5El,n)};_ex.$2H.$8HB=function(n){return n?n.replace("osfruntime_strings.js",""):""};_ex.$2H.$2DR=function(n,t){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",t);n.appendChild(i)};_ex.$2H.prototype={$VJ:null,$b2:null,$2Ht:null,$FH:null,$Hn:null,$3Sj:null,$Qa:null,$l:null,$3Sw:null,$xQ:null,$fK:null,$iF:null,$1QI:null,$14s:null,$J8:null,$1ur:!1,$dk:null,$1an:null,$Ij:null,$CN:null,$b:null,$1TU:!0,$46q:!0,$1Up:null,$2WD:!1,$vM:!1,$2Hi:null,$1E5:null,$1D:null,$DR:!1,$jT:null,get_$7cO:function(){switch(this.$VJ.get_$U()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$C2n:function(){return"extensionHighlight"},get_$Ap3:function(){return this.$J8},get_$DlY:function(){return null},get_$8Uj:function(){return this.$J8?this.$J8.IsInOrgMarketplaceRole:!1},set_$5Gy:function(n){this.$dk!==n&&(this.$dk=n);this.$4("OverflowMenuViewModel");return n},set_$48o:function(n){if(this.$1an!==n){this.$1an=n;this.$4("OsfContextActivationManager")}return n},get_$1tj:function(){return this.$CN},set_$1tj:function(n){if(this.$CN!==n){$C(n)||this.$FH.$9rT(n.get_$1lQ().Id);this.$CN=n;this.$4("SelectedExtension")}return n},set_$22P:function(n){if(this.$1TU!==n){this.$1TU=n;this.$4(_ex.$2H.$8Ml)}return n},get_$2rO:function(){return this.$46q},set_$2rO:function(n){if(this.$46q!==n){this.$46q=n;this.$4(_ex.$2H.$46r)}return n},get_$22R:function(){return this.$jT},set_$22R:function(n){if(this.$jT!==n){this.$jT=n;this.$4(_ex.$2H.$8NI)}return n},get_$C9a:function(){return!1},set_$6YD:function(n){this.$1Up=n;this.$4(_ex.$2H.$41G);return n},$1My:function(n){n&&this.$CN===n||this.$fK.$2gr();if(n){this.$fK.$7Ge();if(!this.$1an){var t=_a.$6.acsa(_a.$0.$4W,"ContextActivationManager",!0);this.$1WM(!1);this.set_$48o(this.$5u7("15.01"));this.$1tO(!1);_a.$6.acea(t)}this.$61K(n);this.set_$22R(n.get_$22R())}else{this.$3nL();this.set_$22R([])}this.set_$22P(this.$4aU(n));this.set_$1tj(n)},$AJ:function(){_ex.$2H.remove_$2Td(this.$$d_$8Kl);this.$DR=!1;this.$fK.$2gr();this.$3nL();this.set_$1tj(null);this.$dk&&this.$dk.$Vi();this.$dk=null;this.set_$22P(!0);this.$Ij.$1u();this.set_$2rO(!0);this.$xQ.$AV();this.$7Zn()},$73:function(){if(this.$b2.get_$95R()){this.$Ij.$1u();if(this.$xQ.$9k5()){this.$DR=!0;if(_a.$8J.$4xo()){_a.$8J.$5NL();_ex.$2H.$2Nw=!1;_ex.$2H.add_$2Td(this.$$d_$8Kl);this.$3ET()}else if($C(this.$J8)&&$C(_ex.$4W.$en)){_ex.$2H.add_$2Td(this.$$d_$8Kl);this.$3ET()}else{$C(this.$J8)&&!$C(_ex.$4W.$en)&&(this.$J8=_ex.$4W.$en);this.$4Ob()}}}},$98H:function(n){if(this.$2WD&&this.$14s){this.$14s.$2y();this.$14s=null}this.$9Jx(n);if(this.$1E5){var t=null;_ex.$4W.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);_a.$6.$1G(this.$1E5,"GetListOfApps","",t);_a.$6.endPT("GetListOfApps");this.$1E5=null}},$4Ob:function(){if(this.$xQ){this.$VJ.get_$U()==="Mouse"&&this.$J8.MarketplaceUrl&&this.set_$6YD(this.$J8.MarketplaceUrl);if(!$C(this.$J8.Extensions)&&this.$J8.Extensions.length){var n=this;this.$xQ.$61Z(this.$J8.Extensions,function(t){if(n.$xQ){if(t.get_$A()>0){n.$Ij.$3y(t.$3Q());n.$Aqe();n.set_$5Gy(new _ex.$BH(n.$Ij,n.$iF));n.$dk.$Vi();n.set_$2rO(!1);n.$4(_ex.$2H.$7pY)}else n.set_$2rO(!0);n.$4(_ex.$2H.$7Qr)}})}}},$61K:function(n){this.$fK.$3e(n,this.$J8,n.$Vt);this.$fK.$9LH()},$1WM:function(n){this.$5Hr(n)&&this.$2Hi.$1p(_a.$Ef,new _a.$Ef(!0,"Extensibility"))},$1tO:function(n){this.$5Hr(n)&&this.$2Hi.$1p(_a.$Ef,new _a.$Ef(!1,"Extensibility"))},$5u7:function(n){var i=new OSF.ContextActivationManager({appName:64,appVersion:n,clientMode:1,appUILocale:this.$Hn,dataLocale:"",hostControl:this.$fK,localizedScriptsUrl:this.$3Sw,docUrl:""});var t={frameBorder:"0"};this.$b2.get_$JM()&&this.$b2.get_$8a()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(t);return i},$5Hr:function(n){return!this.$b2.get_$3Ie()&&!this.$b2.get_$3xZ()?!1:!n||this.$CN&&!this.$CN.get_$1lQ().Type?!0:!1},$9Dm:function(){if(this.$1Up){_a.$6.stPT(_a.$0.$4W,"GetMoreApps",3);var n=_a.$6.$1g(_a.$0.$4W,"GetMoreApps",!0);this.$Qa.$aT(this.$1Up);this.$9nP();_a.$6.$1G(n,"GetMoreApps","");_a.$6.endPT("GetMoreApps")}},$Dsl:function(){var n=document.getElementsByTagName("head")[0];_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/o15apptofilemappingtable.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hn.toLowerCase()+"/office_strings.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hn.toLowerCase()+"/outlook_strings.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/office_strings.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/outlook_strings.js");_ex.$2H.$2DR(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/outlookwebapp-15.01.js")},$Aqe:function(){this.$4("ActiveExtensions")},$3nL:function(){this.$fK.$9st();this.$fK.$9t9()},$3ET:function(){if((!_ex.$2H.$2Nw||this.$1ur)&&!this.$vM){_a.$6.stPT(_a.$0.$4W,"GetListOfApps",5);this.$1E5=_a.$6.$1g(_a.$0.$4W,"GetListOfApps",!0);_ex.$2H.$2Nw=!0;this.$2LC();if(this.$2WD){this.$14s=new _ex.$17c(3,3e4,this.$$d_$2LC,_a.$0.$4W,"GetExtensibilityContext");this.$14s.$1T()}}},$2LC:function(){var n=new _ex.$4W;n.add_$2s(this.$$d_$98H);n.add_$2b(this.$$d_$98h);n.$11(this.get_$7cO(),this.$Hn)},$98h:function(n){if(this.$14s&&this.$14s.$2M5&&this.$1E5){var t=null;_ex.$4W.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);_a.$6.$1G(this.$1E5,"GetListOfApps","Failed",t);_a.$6.endPT("GetListOfApps")}},$7Zn:function(){this.$1QI&&this.$1QI.$33h()},$9nP:function(){if(!this.$1QI){this.$1QI=new _ex.$11g("CheckNewApp");this.$5Kr()}},$5Kr:function(){this.$1QI.$2V(this.$$d_$7bG,5e3,_a.$0.$4W)},$7bG:function(){if(_a.$8J.$4xo()){_a.$8J.$5NL();this.$1ur=!0;this.$3ET()}this.$5Kr()},$9Jx:function(n){if(_ex.$2H.$12v){var t=_ex.$2H.$12v.getHandler(_ex.$2H.$5El);$C(t)||t(n)}},$8Kl:function(n){_ex.$2H.remove_$2Td(this.$$d_$8Kl);if(this.$J8){if(this.$1ur){this.$1ur=!1;_ex.$4W.$2PQ=n.$2Fc}}else{_ex.$4W.$2PQ=n.$2Fc;this.$J8=_ex.$4W.$en;this.$1D&&this.$1D.$2r("AgavePerformance")&&this.$Dsl();this.$4Ob()}}};_ex.$11h=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$FF=n;this.$1lP=t;this.$Hn=i;this.$1N6=r;this.$l=u;this.$1E=f;this.$I=e;this.$N=o;this.$1bc=s;this.$1bd=h;this.$FH=c;this.$1D=l};_ex.$11h.prototype={$Hn:null,$1N6:null,$l:null,$1E:null,$I:null,$1lP:null,$N:null,$1bc:null,$1bd:null,$FH:null,$FF:null,$1D:null,$7g7:function(n){var t=!this.$1D.$2r("ContextualApps");return null},$4Xf:function(n,t){return this.$7k(n,this.$1bc.$4Xu(n,t),this.$1bd.$4Xf(n,t))},$7fl:function(n){return this.$7k(n,this.$1bc.$4Xu(n,!1),this.$1bd.$7fl(n))},$5uk:function(n,t){return new _ex.$KN(_a.$0.$16,this.$FF,t,this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zE(),this.$1N6,this.$N,this.$FH,null,this.$1bc.$4XG(2),this.$1bd.$5uk(n),this.$1D)},$5tx:function(n,t){return new _ex.$KN(_a.$0.$25,this.$FF,t,this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zE(),this.$1N6,this.$N,this.$FH,null,this.$1bc.$4XG(3),this.$1bd.$5tx(n),this.$1D)},$7iW:function(n,t){return new _ex.$19n(n,t)},$7k:function(n,t,i){return new _ex.$sr(this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zE(),this.$1N6,this.$N,this.$FH,n,t,i,this.$1D)}};_ex.$11i=function(n){_ex.$11i.initializeBase(this,[1,"VM.Extensibility."+n])};_ex.$11i.prototype={$1U:function(){_a.$i.$Ii.$JY(this)},$9H0:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};this.$P(t.key,t.value)}}};_ex.$bX=function(n,t){this.$$d_$7pG=Function.createDelegate(this,this.$7pG);_ex.$bX.initializeBase(this);this.set_$87(!0);this.set_$17K(this.$$d_$7pG);this.$3HG=n;this.$8d=t;this.$2D=_a.$0.$4W};_ex.$bX.prototype={$3HG:null,$8d:null,$7pG:function(){this.$3HG(this.$8d)}};_ex.$7c=function(n,t){this.$$d_$4Pt=Function.createDelegate(this,this.$4Pt);this.$jT=[];_ex.$7c.initializeBase(this);this.$5P=n;this.$Vt=t;this.$xR=_ex.$B7.$9(n.Rule,this.$Vt)};_ex.$7c.$5de=function(n,t,i){i.val=null;var f=new _ex.$7c(n,t);var u=null;var r=0;var s,o,e;if(e=_ex.$7c.$9sA(n,t.$o4,s={val:u},o={val:r}),u=s.val,r=o.val,e){f.$1RV=u;f.$2g0=r;i.val=f;return!0}return!1};_ex.$7c.$9sA=function(n,t,i,r){i.val=null;r.val=0;var e;if(t===1)e=0;else if(t===2||t===3)e=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,u=0;u<s;++u){var f=o[u];if(f.SettingsType===e){i.val=f.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=f.RequestedHeight;return!0}}return!1};_ex.$7c.prototype={$1RV:null,$2g0:0,$5P:null,$xR:null,$Vt:null,$3In:!1,$1Tb:null,get_$1lQ:function(){return this.$5P},get_$Wm:function(){return this.$5P.AppStatus},get_$4cn:function(){return this.$5P.EndNodeUrl},get_$26:function(){return this.$5P.DisplayName},get_$8Zn:function(){return this.$5P.LicenseType},get_$9JQ:function(){return this.$5P.ProviderName},get_$5W9:function(){return _js.$9.$1h(this.$5P.Settings)?{}:JsonParser.deserialize(this.$5P.Settings)},set_$5W9:function(n){this.$5P.Settings=n?JsonParser.serialize(n):"";return n},get_$8Nh:function(){if(!_js.$9.$1h(this.$1Tb))return this.$1Tb;this.$1Tb=_ex.$7c.$4sI?_js.$9.$1h(this.$5P.HighResolutionIconUrl)?this.$5P.IconUrl:this.$5P.HighResolutionIconUrl:_js.$9.$1h(this.$5P.IconUrl)?this.$5P.HighResolutionIconUrl:this.$5P.IconUrl;return this.$1Tb},get_$4d5:function(){return this.$1RV},set_$4wW:function(n){if(n!==this.$3In){this.$3In=n;this.$4("IsLastExtension")}return n},get_$22R:function(){return this.$jT},$9hP:function(n){var e=this.$Vt.$3MD;var c=this.$Vt.$1Wx;Array.clear(this.$jT);if(!this.$5P.DisableEntityHighlighting){var t={};var o=c;for(var f in o)for(var h={key:f,value:o[f]},u=h.value,i=0;i<u.length;i++)this.$4Pt(u[i],null,t);for(var r=0;r<e.length;r++){var s=e[r];switch(s){case 3:_ex.$3l.$uX(n.Addresses,"Address",t,this.$$d_$4Pt);break;case 6:_ex.$3l.$uX(n.EmailAddresses,"EmailAddress",t,this.$$d_$4Pt);break;case 4:_ex.$3l.$uX(n.Urls,"Url",t,this.$$d_$4Pt);break;case 1:_ex.$3l.$uX(n.MeetingSuggestions,"MeetingString",t,this.$$d_$4Pt);break;case 2:_ex.$3l.$uX(n.TaskSuggestions,"TaskString",t,this.$$d_$4Pt);break;case 5:_ex.$3l.$uX(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$4Pt);break;case 7:_ex.$3l.$uX(n.Contacts,"ContactString",t,this.$$d_$4Pt);break}}this.$Vt.$er.$7rh(t,this.$$d_$4Pt)}},$4Pt:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$jT,n);r[n]=!0}}};_ex.$17c=function(n,t,i,r,u){this.$$d_$8Qo=Function.createDelegate(this,this.$8Qo);_ex.$17c.initializeBase(this,[u]);this.$1pW=n;this.$1iD=t;this.$8E=i;this.$2D=r};_ex.$17c.prototype={$1pW:0,$1iD:0,$Rw:1,$8E:null,$2M5:!1,$2D:null,$1T:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Start");this.$2M5=!1;this.$2V(this.$$d_$8Qo,this.$1iD,this.$2D)},$2y:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.End");this.$2M5=!0;this.$Rw=this.$1pW;this.$33h()},$8Qo:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Callback: count {0}",this.$Rw);this.$8E();if(this.$Rw<this.$1pW){this.$Rw++;this.$2V(this.$$d_$8Qo,this.$1iD,this.$2D)}else{_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$Rw,this.$1pW);this.$2y()}}};_ex.$B7=function(){};_ex.$B7.$9=function(n,t){var i=_ex.$B7.$4Xj(n,t);if(!$C(i)){t.$36M>7&&i.$1YJ("Number of custom pattern rules exceeds the limit of "+7+".");t.$3WN>15&&i.$1YJ("Number of rules exceeds the limit of "+15+".");if(i.$KA)return i}return null};_ex.$B7.$3JQ=function(n){return n.$o4===1};_ex.$B7.$4Xj=function(n,t){return $C(n)?null:++t.$3WN>15?null:n.Type==="Collection"?new _ex.$108(n,t):n.Type==="ItemIs"?new _ex.$F9(n):n.Type==="ItemHasKnownEntity"?new _ex.$3l(n):n.Type==="ItemHasRegularExpressionMatch"?new _ex.$Dr(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _ex.$14G:null};_ex.$B7.prototype={$KA:!0,$4wQ:function(n,t){return!0},$1YJ:function(n){_js.Trace.logError(_a.$0.$4W,n);this.$KA=!1}};_ex.$108=function(n,t){_ex.$108.initializeBase(this);if($C(n.Mode)){this.$1YJ("Collection rule with no required 'mode' attribute found.");return}if($C(n.Rules)||!n.Rules.length){this.$1YJ("Collection rule with no required 'rule' attribute found.");return}this.$2NQ="And"===n.Mode;this.$11t=new _js.$X;for(var i=0;i<n.Rules.length;i++){var r=_ex.$B7.$4Xj(n.Rules[i],t);$C(r)||this.$11t.$F(r)}};_ex.$108.prototype={$2NQ:!1,$11t:null,$2Hh:function(n,t,i){for(var r=this.$2NQ,u=0;u<this.$11t.get_$A();u++){var f=this.$11t.get_$E(u);r=this.$2NQ?!!(r&f.$2Hh(n,t,i)):!!(r|f.$2Hh(n,t,i))}return r},$4wQ:function(n,t){for(var i=0;i<this.$11t.get_$A();i++){var r=this.$11t.get_$E(i);if(!r.$4wQ(n,t))return!1}return!0}};_ex.$lG=function(n,t){this.$3MD=[];this.$er=new _ex.$3k;this.$FH=n;this.$o4=t};_ex.$lG.prototype={$36M:0,$3WN:0,$1Wx:null,$ru:!1,$FH:null,$o4:0};_ex.$3k=function(){};_ex.$3k.$1D1=function(n,t,i,r){if(n){var f=n;for(var u in f){var e={key:u,value:f[u]};_ex.$3l.$uX(e.value,t,i,r)}}};_ex.$3k.$1Be=function(n,t,i){i&&(n[t]=i)};_ex.$3k.$1Bd=function(n,t,i){n.val||(n.val={});n.val[t]=i};_ex.$3k.prototype={$Gb:null,$y4:null,$TL:null,$1FE:null,$wQ:null,$1I4:null,$xL:null,$8EX:function(){var n={};_ex.$3k.$1Be(n,"Addresses",this.$Gb);_ex.$3k.$1Be(n,"Contacts",this.$y4);_ex.$3k.$1Be(n,"EmailAddresses",this.$TL);_ex.$3k.$1Be(n,"MeetingSuggestions",this.$1FE);_ex.$3k.$1Be(n,"PhoneNumbers",this.$wQ);_ex.$3k.$1Be(n,"TaskSuggestions",this.$1I4);_ex.$3k.$1Be(n,"Urls",this.$xL);return n},$4PI:function(n,t,i){switch(n){case 3:var o;_ex.$3k.$1Bd(o={val:this.$Gb},t,i),this.$Gb=o.val;break;case 7:var s;_ex.$3k.$1Bd(s={val:this.$y4},t,i),this.$y4=s.val;break;case 6:var h;_ex.$3k.$1Bd(h={val:this.$TL},t,i),this.$TL=h.val;break;case 1:var e;_ex.$3k.$1Bd(e={val:this.$1FE},t,i),this.$1FE=e.val;break;case 5:var r;_ex.$3k.$1Bd(r={val:this.$wQ},t,i),this.$wQ=r.val;break;case 2:var u;_ex.$3k.$1Bd(u={val:this.$1I4},t,i),this.$1I4=u.val;break;case 4:var f;_ex.$3k.$1Bd(f={val:this.$xL},t,i),this.$xL=f.val;break;default:break}},$7rh:function(n,t){_ex.$3k.$1D1(this.$Gb,"Address",n,t);_ex.$3k.$1D1(this.$y4,"ContactString",n,t);_ex.$3k.$1D1(this.$TL,"EmailAddress",n,t);_ex.$3k.$1D1(this.$1FE,"MeetingString",n,t);_ex.$3k.$1D1(this.$wQ,"OriginalPhoneString",n,t);_ex.$3k.$1D1(this.$1I4,"TaskString",n,t);_ex.$3k.$1D1(this.$xL,"Url",n,t)}};_ex.$14G=function(){_ex.$14G.initializeBase(this)};_ex.$14G.prototype={$2Hh:function(n,t,i){return _ex.$B7.$3JQ(t)?n.get_$P3()!==undefined&&n.get_$P3():!1}};_ex.$3l=function(n){this.$$d_$7od=Function.createDelegate(this,this.$7od);_ex.$3l.initializeBase(this);$C(n.EntityType)?this.$1YJ("ItemHasKnownEntity rule contains null entity type."):this.$Bb=n};_ex.$3l.$uX=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_ex.$3l.$12w=function(n,t,i){if($C(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_ex.$3l.$8Tq(i,e,t)){f[r]=_ex.$3l.$8Ez(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$4W,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$4W,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_ex.$3l.$8Tq=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_ex.$3l.$4xX(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_ex.$3l.$4xX=function(n){return n===7||n===1||n===2};_ex.$3l.$8Ez=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$8.$5s(i.StartTime,!0).$8Z());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$8.$5s(i.EndTime,!0).$8Z());return i;default:return n}};_ex.$3l.prototype={$Bb:null,$1Gg:null,$er:null,$4wQ:function(n,t){return n.get_$r8()?!0:this.$8Tp(n.get_$2tW())?this.$1Gg?!1:t.$ru?!1:!_ex.$3l.$4xX(this.$Bb.EntityType):!0},$2Hh:function(n,t,i){if(!_ex.$B7.$3JQ(t))return!1;this.$er=null;var u=n.get_$r8();if($C(u))return!1;if(this.$Bb.RegExFilter){var f,e;if(!(e=_ex.$Dr.$5dg(this.$Bb.RegExFilter,this.$Bb.IgnoreCase,f={val:this.$1Gg}),this.$1Gg=f.val,e))return!1}var r=!1;switch(this.$Bb.EntityType){case 3:r=this.$1Co(t,u.Addresses,null);break;case 7:r=this.$1Co(t,u.Contacts,"ContactString");break;case 6:r=this.$1Co(t,u.EmailAddresses,null);break;case 1:r=this.$1Co(t,u.MeetingSuggestions,"MeetingString");break;case 5:r=this.$1Co(t,u.PhoneNumbers,"OriginalPhoneString");break;case 2:r=this.$1Co(t,u.TaskSuggestions,"TaskString");break;case 4:r=this.$1Co(t,u.Urls,null);break}return r},$1Co:function(n,t,i){var r=null;!$C(t)&&t.length>0&&(r=_ex.$3l.$12w(t,this.$Bb.EntityType,n.$ru));if(r){if(!this.$1Gg){Array.add(n.$3MD,this.$Bb.EntityType);return!0}var u=_a.$8.get_$38();_ex.$3l.$uX(r,i,null,this.$$d_$7od);n.$FH.$5dE(this.$Bb.FilterName,_a.$8.get_$38().$6M(u));if(this.$er){n.$er.$4PI(this.$Bb.EntityType,this.$Bb.FilterName,this.$er);return!0}}this.$1Gg&&n.$er.$4PI(this.$Bb.EntityType,this.$Bb.FilterName,null);return!1},$7od:function(n,t,i){var r=n.match(this.$1Gg);if(r&&r.length>0){this.$er||(this.$er=[]);Array.add(this.$er,t)}},$8Tp:function(n){return n?this.$Bb.EntityType===3&&n.ExtractedAddresses||this.$Bb.EntityType===7&&n.ExtractedContacts||this.$Bb.EntityType===6&&n.ExtractedEmails||this.$Bb.EntityType===1&&n.ExtractedMeetings||this.$Bb.EntityType===5&&n.ExtractedPhones||this.$Bb.EntityType===2&&n.ExtractedTasks||this.$Bb.EntityType===4&&n.ExtractedUrls:!1}};_ex.$Dr=function(n,t,i){_ex.$Dr.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$Bb=n;t.$36M++}else this.$1YJ("Invalid ItemHasRegularExpressionMatchRule rule.");this.$1E=i};_ex.$Dr.$5dg=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$4W,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_ex.$Dr.$9Mc=function(n){for(var t=n.length-1;t>=0;t--){var r=!1;if(t>=50||n[t].length>3072)r=!0;else for(var i=t-1;i>=0;i--)if(n[t]===n[i]){r=!0;break}r&&Array.removeAt(n,t)}return n};_ex.$Dr.$8FY=function(n,t){if(t){if(n.get_$S7())return n.get_$S7().get_$1Z()}else if(n.get_$Mq())return n.get_$Mq().get_$1Z();else if(n.get_$4n())return n.get_$4n().get_$1Z();_js.Trace.logWarning(_a.$0.$4W,"Skipping regex eval: no body for item with Id: {0}.",n.get_$y()?n.get_$y().Id:"'null id'");return null};_ex.$Dr.prototype={$Bb:null,$1E:null,$4tr:16e3,$3HT:64e3,$4g6:5e5,$2Hh:function(n,t,i){if(!_ex.$B7.$3JQ(t))return!1;var r=null;var o=this.$8Fw(n,t,i);if(o){var u;var e,f;if(!(f=_ex.$Dr.$5dg(this.$Bb.RegExValue,this.$Bb.IgnoreCase,e={val:u}),u=e.val,f))return!1;var s=_a.$8.get_$38();r=o.match(u);t.$FH.$5dE(this.$Bb.RegExName,_a.$8.get_$38().$6M(s));if(r&&r.length>0){r=_ex.$Dr.$9Mc(r);if(r.length>0){t.$1Wx[this.$Bb.RegExName]=r;return!0}}}t.$1Wx[this.$Bb.RegExName]=new Array(0);return!1},$8Fw:function(n,t,i){if(this.$Bb.PropertyName===1)return n.get_$3o();else if(this.$Bb.PropertyName===4){var r=null;if(_g.$5w.isInstanceOfType(n))n.get_$Em()&&(r=n.get_$Em().Mailbox);else if(_g.$2g.isInstanceOfType(n)){var o=n.get_$MD();o&&(r=o.Mailbox)}if(r&&r.EmailAddress)return r.EmailAddress}else if(this.$Bb.PropertyName===3){var s=null;n.get_$106()===3&&(s=this.$4no(n,t.$ru));return s}else if(this.$Bb.PropertyName===2){if(i.val)return i.val;var u=this.$4no(n,t.$ru);var c=_a.$8.get_$38();var f=$(u);var e=_a.$8.get_$38();f[0]&&(i.val=f[0].innerText);$C(i.val)&&(i.val=f.text());var h=_a.$8.get_$38();t.$FH.$9rO(u?u.length:0,i.val?i.val.length:0,e.$6M(c),h.$6M(e));return i.val}return null},$4no:function(n,t){var i=_ex.$Dr.$8FY(n,t);if(i){if(i.length>this.$4g6){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds general activation size limit");i=null}if(this.$1E.get_$3Ie()||this.$1E.get_$3xZ())if(this.$Bb.PropertyName===2){if(i.length>this.$4tr){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds IPhone/IPad activation size limit");i=null}}else if(this.$Bb.PropertyName===3&&i.length>this.$3HT){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");i=i.substr(0,this.$3HT)}}return i}};_ex.$F9=function(n){_ex.$F9.initializeBase(this);this.$3Gi=n.IncludeSubClasses;this.$hi=n.ItemType;this.$1US=n.FormType;$C(n.ItemClass)||(this.$s4=n.ItemClass.toLowerCase())};_ex.$F9.$4wn=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_ex.$F9.$6Or=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_ex.$F9.prototype={$s4:null,$3Gi:!1,$hi:0,$1US:0,$2Hh:function(n,t,i){if(t.$o4===1&&(this.$1US===2||this.$1US===3)){if(!$C(n.get_$CK())){var r=n.get_$CK().toLowerCase();if(this.$hi===1&&_g.$5w.isInstanceOfType(n)&&_ex.$F9.$4wn(r)||this.$hi===2&&_g.$2g.isInstanceOfType(n)&&_ex.$F9.$6Or(r)){if(!this.$s4)return!0;if(this.$3Gi){if(r.startsWith(this.$s4))return!0}else if(r===this.$s4)return!0}}}else if(t.$o4===2&&this.$hi===1||t.$o4===3&&this.$hi===2)return this.$1US===1||this.$1US===3;return!1}};_ex.$Gz=function(){this.$1rG=-1};_ex.$Gz.prototype={$2QL:0,$2QN:null,$3cH:0,$A:0,get_$7XG:function(){return this.$A?Math.round(this.$3cH/this.$A):-1},$2W:function(n,t){this.$A++;this.$3cH+=n;if(n>=this.$2QL){this.$2QL=n;this.$2QN=t}(this.$1rG===-1||n<this.$1rG)&&(this.$1rG=n)},$wm:function(){if(!this.$A)return"";var t=$C(this.$2QN)?"":this.$2QN;var n=[this.$1rG,this.get_$7XG(),this.$2QL,t];return n.join(",")}};_ex.$10E=function(n){_ex.$10E.initializeBase(this,[n])};_ex.$kT=function(n,t){this.$$d_$Dc1=Function.createDelegate(this,this.$Dc1);_ex.$kT.initializeBase(this,[n,t]);this.$Ch=!1;this.$9Y=!0;this.set_$2Gv(!0)};_ex.$kT.prototype={$1E9:null,$jM:!1,$2WC:!1,$93U:function(){if(this.get_$20().get_$A()>0){this.$4f9();this.$3Vy();this.$jM=!1}else{this.$1E9.$3S();this.$jM=!0}},$3T:function(){_fce.$m.prototype.$3T.call(this);this.get_$S().bind("keydown",this.$$d_$Dc1)},$5I:function(){this.get_$S().unbind("keydown",this.$$d_$Dc1);_js.$7.prototype.$5I.call(this)},$4T:function(){_fce.$m.prototype.$4T.call(this);this.$1E9=this.$u.$1N("GetMoreAppsButton")},$35c:function(){var n=_fce.$m.prototype.$35c.call(this);if(this.$3N.get_$U()==="Mouse"){n.get_$4y().set_$e2(-1);n.get_$4y().set_$Rx(3);var t=this;n.get_$S().keydown(function(i){if(i.which===13||i.which===32){t.$vV(n,new _a.$7D(i));i.preventDefault()}})}return n},$vV:function(n,t){if(this.get_$34()){var i=n.get_$k();t.get_$2g().extensionViewModel=i;this.set_$Cb(new _ff.$Cy(t,3))}},$6od:function(n){if(!this.$2WC&&this.$jM){this.$jM=!1;this.$1E9.set_$g(-1)}else this.$2WC=!1},$Dc1:function(n){if(this.$jM||this.get_$ZL()){var t=new _a.$7D(n);var r=this.$Hx(this.get_$ZL());var i=this.get_$20().get_$E(r);if(this.$jM&&(t.get_$9k()===32||t.get_$9k()===13))this.$2WC=!0;else if(t.get_$9k()===40){if(!this.$jM){this.$64B();if(this.get_$ZL()===i){this.$1AN(null);this.set_$ZL(null);this.$1E9.set_$g(0);this.$1E9.$3S();this.$jM=!0}}}else if(t.get_$9k()===38)if(this.$jM){this.$4fB();this.$1E9.set_$g(-1);this.$jM=!1}else this.$64D();else t.get_$9k()===9&&_js.$D.get_$Q().$2V(_a.$0.$4W,"ComposeExtensibilityMenuListView",this.$$d_$9Oe,100)}}};_ex.$kV=function(n){this.$$d_$5Eg=Function.createDelegate(this,this.$5Eg);this.$$d_$95w=Function.createDelegate(this,this.$95w);this.$$d_$5EL=Function.createDelegate(this,this.$5EL);this.$$d_$986=Function.createDelegate(this,this.$986);_ex.$kV.initializeBase(this,[n]);this.$5q={}};_ex.$kV.prototype={$5q:null,$2bx:!1,$4T:function(){_js.$7.prototype.$4T.call(this);this.$5q.CloseButton=this.$u.$1N("CloseButton");this.$5q.ComposeExtMenuListView=this.$u.$1N("ComposeExtMenuListView");this.$5q.AppsBackButton=this.$u.$1N("AppsBackButton")},$3T:function(){_js.$7.prototype.$3T.call(this);this.get_$S().bind("keydown",this.$$d_$986);var n=this.get_$k();this.$p("DataContext",this.$$d_$5EL);n&&this.$5EL(null,null)},$5I:function(){var n=this.get_$k();this.get_$S().unbind("keydown",this.$$d_$986);this.$1B("DataContext",this.$$d_$5EL);if(n&&this.$2bx){n.remove_$2TO(this.$$d_$95w);n.remove_$3Ru(this.$$d_$95w);n.remove_$2Ta(this.$$d_$5Eg);this.$2bx=!1}_js.$7.prototype.$5I.call(this)},$5EL:function(n,t){var i=this.get_$k();i.add_$2TO(this.$$d_$95w);i.add_$3Ru(this.$$d_$95w);i.add_$2Ta(this.$$d_$5Eg);this.$2bx=!0},$95w:function(){this.$5q.ComposeExtMenuListView.$93U()},$5Eg:function(){this.$5q.AppsBackButton.$3S()},$986:function(n){var t=new _a.$7D(n);if(t.get_$9k()===27){var i=this.get_$k();i.$22N(!1);t.$OB()}}};_ex.$11c=function(n){_ex.$11c.initializeBase(this,[n])};_ex.$11c.prototype={$8Nw:function(n){this.get_$S().hide();this.get_$S().prev().show()}};_ex.$3r=function(n,t){this.$$d_$98Z=Function.createDelegate(this,this.$98Z);this.$$d_$278=Function.createDelegate(this,this.$278);this.$$d_$8PC=Function.createDelegate(this,this.$8PC);_ex.$3r.initializeBase(this,[n,t]);this.$I=t;this.$Ch=!1;this.set_$2Gv(!0)};_ex.$3r.prototype={$p7:0,$Ij:null,$10L:null,$3IT:!1,$A9:!1,$I:null,$2OY:!1,set_$2QR:function(n){if(this.$p7!==n){this.$p7=n;this.$4("MaxTabCount");n>0&&this.$5dr()}return n},set_$6uZ:function(n){this.$10L=n;this.$2OY&&this.$10L&&this.$5dr();return n},$278:function(){this.set_$2QR(this.$4TY(this.$3tG(!0)))},$35c:function(){var n=_fce.$m.prototype.$35c.call(this);if(this.$3N.get_$U()==="Mouse"){n.get_$4y().set_$e2(0);n.get_$4y().set_$Rx(3);var t=this;n.get_$S().keydown(function(i){(i.which===13||i.which===32)&&t.$vV(n,new _a.$7D(i))})}return n},$3T:function(){_fce.$m.prototype.$3T.call(this);_js.$D.get_$Q().$2V(this.get_$m(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.$$d_$8PC,0)},$5I:function(){_js.$7.prototype.$5I.call(this);if(this.$A9&&"Mouse"===this.$3N.get_$U()){this.$I.remove_$PJ(this.$$d_$278);_g.$O.get_$Q().get_$6r().remove_$1zu(this.$$d_$98Z);_g.$O.get_$Q().get_$6r().remove_$3FF(this.$$d_$98Z)}},$vV:function(n,t){if(this.get_$34()){var i=n.get_$k();t.get_$2g().extensionViewModel=i;this.set_$Cb(new _ff.$Cy(t,3))}},$4TY:function(n){if(!this.$Ij)return 0;for(var r=this.$Ij.get_$A(),e=-1,u=0,o=0,f=new Array(r),i=0;i<r;i++){f[i]=this.$52P(this.$Ij.get_$E(i).$5P.DisplayName);this.$Ij.get_$E(i)===this.get_$1F()&&(e=i)}if(e>-1){o+=f[e];u++}for(var t=0;t<r;){if(t!==e)if(o+f[t]<n){o+=f[t];u++}else break;t++}t<r&&o+46>=n&&u--;return u},$52P:function(n){if(!(n in _ex.$3r.$2EU)){if(!_ex.$3r.$we||$("#extensionRuler").length<=0){_ex.$3r.$we=document.createElement("span");_ex.$3r.$we.id="extensionRuler";_ex.$3r.$we.className="extensionRuler";document.body.appendChild(_ex.$3r.$we)}var t=document.createElement("span");t.className="extensionRulerItem";t.appendChild(document.createTextNode(n));_ex.$3r.$we.appendChild(t);_ex.$3r.$2EU[n]=_ex.$3r.$we.offsetWidth;_ex.$3r.$we.removeChild(t)}return _ex.$3r.$2EU[n]},$3tG:function(n){var r=this.$8FM();var i=this.get_$S().width();if(i>0)_ex.$3r.$1By=i;else if(!_ex.$3r.$1By||n){var t=this;_ex.$3r.$1By=i;while(!$C(t)&&!$C(t.get_$Bd())&&!$C(t.get_$S())&&_ex.$3r.$1By<=0){t=t.get_$Bd();_ex.$3r.$1By=t.get_$S().width()}}return _ex.$3r.$1By-r},$8FM:function(){return this.$3IT?0:this.$52P(_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text)+22},$98Z:function(n,t){this.$278()},$8PC:function(){if(this.get_$34()){this.set_$2QR(0);if("Mouse"===this.$3N.get_$U()){this.$I.add_$PJ(this.$$d_$278);_g.$O.get_$Q().get_$6r().add_$1zu(this.$$d_$98Z);_g.$O.get_$Q().get_$6r().add_$3FF(this.$$d_$98Z)}this.set_$2QR(this.$4TY(this.$3tG(!1)));this.$A9=!0}},$5dr:function(){if(this.$10L){this.$10L.$11();this.$2OY=!1}else this.$2OY=!0}};_ex.$1=function(){};_ex.$1.get_$7oW=function(){return _fm.$G.$9("error-fallback-app-icon","error-fallback-app-icon","owa","ms-bg-color-neutralTertiary ms-font-color-white")};_ex.$1.get_$7WS=function(){return _fm.$G.$9("arrow-left-grey-circle-hover-ext","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_ex.$1.get_$1Bc=function(){return _fm.$G.$9("add-small-ext","add-small-ext","owa","ms-font-color-neutralSecondary")};_ex.$1.get_$11T=function(){return _fm.$G.$9("add-small-hover-ext","add-small-hover-ext","owa","ms-font-color-neutralDark")};_ex.$1.get_$5kj=function(){return _fm.$G.$9("affordance-grey-ext","x16","owa","ms-font-color-neutralSecondary")};_ex.$CG=function(n,t){_ex.$CG.initializeBase(this,[n]);this.$I=t};_ex.$CG.prototype={$I:null,$3Ht:!1,$3K6:!1,$1GH:null,$CN:null,$Hn:null,$l:null,$122:null,set_$48o:function(n){if(!$C(n)){this.$1GH=n;this.$3dc()}return n},set_$CE:function(n){if(this.$Hn!==n){this.$Hn=n;this.$3dc()}return n},set_$1tj:function(n){if(this.$CN===n)return n;$C(n)&&this.$5Kf();this.$CN=n;this.$3dc();return n},$4bL:function(n,t,i,r,u,f,e,o,s){this.$1GH.displayNotification({infoType:n,id:t,title:i,description:r,buttonTxt:u,buttonCallback:f,detailView:e,displayDeactive:o,reDisplay:s})},$5Kf:function(){if(_ex.$CG.$2U1>0&&!$C(this.$1GH)&&this.$122){this.$1GH.purgeOsfControl(this.$122,!1);this.$122=null}},$3dc:function(){if(!$C(this.$CN)&&!$C(this.$1GH)&&!$C(this.$Hn)&&!this.get_$17()){this.$5Kf();_ex.$CG.$2U1++;this.$122="ocii"+_ex.$CG.$2U1;var a="DefaultSettings";var e=new OSF.Manifest.ExtensionSettings;e._sourceLocations[this.$Hn]=this.$CN.$1RV;if(OSF.OsfManifestManager.hasManifest(this.$CN.$5P.Id,this.$CN.$5P.Version)){var w=OSF.OsfManifestManager.getCachedManifest(this.$CN.$5P.Id,this.$CN.$5P.Version);w._extensionSettings[a]=e}else{var v=this;var b=new OSF.Manifest.Manifest(function(n){n._id=v.$CN.$5P.Id;n._version=v.$CN.$5P.Version;n._extensionSettings={};n._extensionSettings[a]=e});OSF.OsfManifestManager.cacheManifest(this.$CN.$5P.Id,this.$CN.$5P.Version,b)}var n;if(this.$I.get_$U()==="TouchNarrow"){n=window.innerHeight-50;n<0&&(n=0)}else{n=this.$CN.$2g0;n<32?n=32:n>450&&(n=450)}this.$3Ht||this.get_$S().css("height",n.toString()+"px");this.$1GH.insertOsfControl({div:this.get_$S()[0],id:this.$122,marketplaceID:this.$CN.$5P.Id,marketplaceVersion:this.$CN.$5P.Version,settings:this.$CN.get_$5W9(),store:"",storeType:OSF.StoreType.Exchange});if(_y.$z.$1Q.get_$U()==="Mouse"){var p=this;_js.$D.get_$Q().$6C(_a.$0.$4W,"OsfHostContainerView.TryInsertOsfControl",function(){p.get_$S().children()[0]&&p.get_$S().children()[0].focus()})}if(this.$CN.$5P.Origin===1||this.$CN.$5P.Origin===2&&this.$3K6){var t=this;var y=function(){t.$l&&t.$l.$8G(t.$l.get_$IF())&&t.$l.get_$IF().get_$2H7().get_$2PY()?t.$l.get_$IF().$2PX(t.$CN.get_$4cn()):window.open(t.$CN.get_$4cn())};if(_js.$9.$1h(this.$CN.get_$Wm()))this.$CN.get_$8Zn()===1&&this.$4bL(2,this.$122,_nbs.NonBootStrings.l_AppInfoTitle_Text,_nbs.NonBootStrings.l_AppTrialMessage_Text,_nbs.NonBootStrings.l_AppBuyButton_Text,y,!1,!1,!0);else{var i;var u;var f;var r;var h,c,l,o,s;(s=this.$9sB(this.$CN.get_$Wm(),h={val:i},c={val:u},l={val:f},o={val:r}),i=h.val,u=c.val,f=l.val,r=o.val,s)&&this.$4bL(1,this.$122,_nbs.NonBootStrings.l_AppErrorTitle_Text,i,u,y,f,r,!0)}}}},$9sB:function(n,t,i,r,u){t.val="";i.val="";r.val=!1;u.val=!1;switch(n){case"1.0":t.val=_nbs.NonBootStrings.l_AppErrorCode1_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.1":t.val=_nbs.NonBootStrings.l_AppErrorCode1_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.2":t.val=_nbs.NonBootStrings.l_AppErrorCode1_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"2.0":t.val=_nbs.NonBootStrings.l_AppErrorCode2_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"2.1":t.val=_nbs.NonBootStrings.l_AppErrorCode2_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"3.0":t.val=_nbs.NonBootStrings.l_AppErrorCode3_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.1":t.val=_nbs.NonBootStrings.l_AppErrorCode3_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.2":t.val=_nbs.NonBootStrings.l_AppErrorCode3_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.3":t.val=_nbs.NonBootStrings.l_AppErrorCode3_3_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;default:_js.Trace.logWarning(this.get_$m(),String.format("The app status {0} does not have corresponding description.",n));return!1}return!0}};_ex._TI=function(){};_ex._TI.$$cctor=function(){var s="ComposeAppsPane";new _A(s,function(){_ex._TI.$1[s]===undefined&&(_ex._TI.$1[s]=[null]);var t=_ex._TI._hf.childNodes[0].cloneNode(!0);var n=new _ex.$kV(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$KN,_ex.$10E,!1,!1,!1,0,_ex._TI.$1);var o="ComposeExtensibilityPopupView";new _A(o,function(){_ex._TI.$1[o]===undefined&&(_ex._TI.$1[o]=[[[-1,0,["ExtensibilityViewModel"],[_ex._TI.$D03],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[1].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$kU,_js.$7,!1,!1,!1,0,_ex._TI.$1);var e="ComposeExtensibilityView._tid1";new _A(e,function(){_ex._TI.$1[e]===undefined&&(_ex._TI.$1[e]=[null,[[-1,4,null,null,null,"AriaLabel",null,_ex._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_AT_Button_Text],[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,7],[-1,4,null,null,null,"Text",null,_ex._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_Text],[-1,0,["IsTouch"],[_ex._TI.$D07],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8u8],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[2].cloneNode(!0);var n=new _fc.$H(_B.$3(t,[1,0]));n.set_$g(-1);var i=new _fce.$v(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_ex.$KN,_ex.$kT,!1,!0,!1,0,_ex._TI.$1);var l="ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3";new _A(l,function(){_ex._TI.$1[l]===undefined&&(_ex._TI.$1[l]=[null,[[-1,0,["DisplayName"],[_ex._TI.$6hP],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,0,["ProviderName"],[_ex._TI.$D0L],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[3].cloneNode(!0);var i=new _b.$KT(n.children[2]);var r=new _b.$KT(n.children[1]);var t=new _js.$7(n.children[0]);t.set_$6("ComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_ex.$7c,_js.$7,!1,!0,!1,0,_ex._TI.$1);var c="ComposeExtensibilityView.ComposeExtensionListItemTemplate";new _A(c,function(){_ex._TI.$1[c]===undefined&&(_ex._TI.$1[c]=[[[-1,0,["DisplayName"],[_ex._TI.$6hP],null,"AriaLabel",null,_ex._TI.$1l,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[4].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3");return new _B(t,[n])},_ex.$7c,_fce.$22,!1,!1,!1,0,_ex._TI.$1);var h="ComposeExtensibilityView.ExtensionIconImage";new _A(h,function(){_ex._TI.$1[h]===undefined&&(_ex._TI.$1[h]=[[[-1,4,null,null,null,"Id",null,_ex._TI.$14,0,null,null,null,_ex.$1.get_$7oW()]],[[-1,0,["IconUrl"],[_ex._TI.$D0K],null,"Source",null,_ex._TI.$LY,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[5].cloneNode(!0);var i=new _ex.$11c(n.children[1]);var t=new _fc.$Y(n.children[0],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));return new _B(n,[t,i])},_ex.$7c,_js.$7,!1,!1,!1,0,_ex._TI.$1);var i="ComposeExtensibilityView";new _A(i,function(){_ex._TI.$1[i]===undefined&&(_ex._TI.$1[i]=[[[-1,5,["SelectedExtension"],[_ex._TI.$44O],null,"_ex_s",null,null,0,_ex._TI.get_$24(),null,null],[-1,5,["IsLandscape"],[_ex._TI.$58f],null,"_ex_p",null,null,0,null,null,null],[-1,5,["IsTouchNarrow"],[_ex._TI.$8u2],null,"tnarrow",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$5N()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_n.$1.get_$Gh()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5o,0,null,null,null,_n.$1.get_$5rt()],[-1,4,null,null,null,"Title",null,_ex._TI.$1b,0,null,null,null,_nbs.NonBootStrings.l_CloseAppPaneButton_Text],[-1,0,["IsTouchNarrow"],[_ex._TI.$8u2],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_ex._TI.$D05],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,5,["IsLandscape"],[_ex._TI.$58f],null,"_ex_q",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"Title",null,_ex._TI.$1b,0,null,null,null,_nbs.NonBootStrings.l_AppBackButton_Title_Button_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$7WR()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_ex.$1.get_$7WS()],[-1,0,["BackToListCommand"],[_ex._TI.$8u1],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$24(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_b.$1.get_$4Ri()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5o,0,null,null,null,_b.$1.get_$7WQ()],[-1,0,["BackToListCommand"],[_ex._TI.$8u1],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$24(),null,!0]],[[-1,0,["AppPaneTitle"],[_ex._TI.$D04],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,5,["IsLandscape"],[_ex._TI.$58f],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["HideExtensionsList"],[_ex._TI.$D06],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["ActiveExtensions"],[_ex._TI.$8u4],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["ListViewEventInfo"],[_ex._TI.$D08],_ex._TI.$D09,"EventInfo",_ex._TI.$w2,_ex._TI.$w3,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6hN],null,"OsfContextActivationManager",null,_ex._TI.$6hQ,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8u5],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6hO],null,"UserCulture",null,_ex._TI.$6hS,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"SelectedExtension",null,_ex._TI.$6hR,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8u6],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8uA,1,null,null,!1],[-1,5,["IsLandscape"],[_ex._TI.$58f],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8u9],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[6].cloneNode(!0);var s=new _b.$Fi(_B.$3(n,[0,3]));var f=new _ex.$CG(_B.$3(n,[0,2]),_js.$2.Instance.$2(_y.$W));f.$3Ht=!0;var t=new _ex.$kT(_B.$3(n,[0,1,0]),_js.$2.Instance.$2(_y.$W));t.set_$3Z("ComposeExtensibilityView.ComposeExtensionListItemTemplate");t.set_$BC("_ex_o");t.set_$6("ComposeExtensibilityView._tid1");var h=new _js.$F(_B.$3(n,[0,1]));var c=new _b.$KT(_B.$3(n,[0,0,3]));var o=new _fc.$H(_B.$3(n,[0,0,2]));var u=new _fc.$H(_B.$3(n,[0,0,1]));var r=new _fc.$H(_B.$3(n,[0,0,0]));r.set_$g(0);var e=new _js.$F(_B.$3(n,[0,0]));return new _B(n,[e,r,u,o,c,h,t,f,s]).R({CloseButton:r,AppsBackButton:u,ComposeExtMenuListView:t})},_ex.$KN,_ex.$kV,!1,!1,!1,0,_ex._TI.$1);var t="ExtensibilityPopupView";new _A(t,function(){_ex._TI.$1[t]===undefined&&(_ex._TI.$1[t]=[[[-1,0,["ExtensibilityViewModel","UserCulture"],[_ex._TI.$58g,_ex._TI.$6hO],null,"UserCulture",null,_ex._TI.$6hS,1,null,null,null],[-1,0,["ExtensibilityViewModel","OsfContextActivationManager"],[_ex._TI.$58g,_ex._TI.$6hN],null,"OsfContextActivationManager",null,_ex._TI.$6hQ,1,null,null,null],[-1,0,["ExtensibilityViewModel","OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$58g,_ex._TI.$1qi,_ex._TI.$6hM],null,"SelectedExtension",null,_ex._TI.$6hR,1,null,null,null]],[[-1,0,["ItemBodyValue"],[_ex._TI.$D0I],null,"Html",null,_ex._TI.$vq,1,null,null,null],[-1,2,["ExtensibilityViewModel","SelectedExtension","HighlightedTerms"],[_ex._TI.$58g,_ex._TI.$44O,_ex._TI.$1MU],null,_b.$2P.$xB,null,null,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[7].cloneNode(!0);var i=new _b.$2n(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_a.$C9.$$(ILinkPreviewBuilderFactory)));i.$P(_b.$2P.$lp,"extensionHighlight");var r=new _ex.$CG(n.children[0],_js.$2.Instance.$2(_y.$W));return new _B(n,[r,i])},_ex.$lM,_js.$7,!1,!1,!1,0,_ex._TI.$1);var n="ExtensibilityView._tid4";new _A(n,function(){_ex._TI.$1[n]===undefined&&(_ex._TI.$1[n]=[[[-1,4,null,null,null,"Text",null,_ex._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$1Bc()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_ex.$1.get_$11T()],[-1,0,["MarketplaceUrl"],[_ex._TI.$8u7],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2e(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8u8],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$5kj()],[-1,0,["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qi,_ex._TI.$8u3],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0]]]);var t=_ex._TI._hf.childNodes[8].cloneNode(!0);var u=new _fc.$H(t.children[2]);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));i.$M(_E.$D(["OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_ex._TI.$1qi,_ex._TI.$D0A],null,"MenuDataContext",null,_ex._TI.$3q,1)).$M(_E.$D(["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qi,_ex._TI.$8u3],null,"IsShown",null,_ex._TI.$3m,1,_ex._TI.get_$K(),null,!1));i.$58=3;u.set_$12([i]);var r=new _fce.$v(t.children[1]);var f=new _fc.$H(t.children[0]);return new _B(t,[f,r,u]).R({ListPanel:r})},_ex.$sr,_ex.$3r,!1,!0,!1,0,_ex._TI.$1);var f="ExtensibilityView.ExtensionListItemTemplate._tid7";new _A(f,function(){_ex._TI.$1[f]===undefined&&(_ex._TI.$1[f]=[[[-1,0,["DisplayName"],[_ex._TI.$6hP],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},_ex.$7c,_js.$7,!1,!0,!1,0,_ex._TI.$1);var u="ExtensibilityView.ExtensionListItemTemplate";new _A(u,function(){_ex._TI.$1[u]===undefined&&(_ex._TI.$1[u]=[[[-1,5,["IsSelected"],[_ex._TI.$O0],null,"ms-font-color-white ms-bg-color-themeSecondary",null,null,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ExtensibilityView.ExtensionListItemTemplate._tid7");return new _B(t,[n])},_ex.$7c,_fce.$22,!1,!1,!1,0,_ex._TI.$1);var r="ExtensibilityView";new _A(r,function(){_ex._TI.$1[r]===undefined&&(_ex._TI.$1[r]=[[[-1,0,["OverflowMenuViewModel","ExtensionsTabList"],[_ex._TI.$1qi,_ex._TI.$D0B],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qi,_ex._TI.$6hM],_ex._TI.$D0H,"SelectedItem",_ex._TI.$6L,_ex._TI.$6I,2,null,null,null],[-1,0,["OverflowMenuViewModel","MaxTabCount"],[_ex._TI.$1qi,_ex._TI.$D0D],_ex._TI.$D0G,"MaxTabCount",_ex._TI.$D0M,_ex._TI.$D0P,2,null,null,0],[-1,0,["ActiveExtensions"],[_ex._TI.$8u4],null,"ActiveExtensions",null,_ex._TI.$D0N,1,null,null,null],[-1,0,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_ex._TI.$1qi,_ex._TI.$D0E],null,"PopulateMenuItemsCommand",null,_ex._TI.$D0Q,1,null,null,null],[-1,0,["OverflowMenuViewModel","ListViewEventInfo"],[_ex._TI.$1qi,_ex._TI.$D0C],_ex._TI.$D0F,"EventInfo",_ex._TI.$w2,_ex._TI.$w3,2,null,null,null],[-1,0,["MarketplaceUrl"],[_ex._TI.$8u7],null,"IsGetMoreAppHidden",null,_ex._TI.$D0O,1,_ex._TI.get_$2e(),null,!1]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6hN],null,"OsfContextActivationManager",null,_ex._TI.$6hQ,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8u5],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6hO],null,"UserCulture",null,_ex._TI.$6hS,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qi,_ex._TI.$6hM],null,"SelectedExtension",null,_ex._TI.$6hR,1,null,null,null],[-1,0,["NativeBridge"],[_ex._TI.$D0J],null,"NativeBridge",null,_ex._TI.$D0R,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8u6],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8uA,1,null,null,!1]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8u9],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[11].cloneNode(!0);var i=new _b.$Fi(_B.$3(t,[0,2]));var u=new _ex.$CG(_B.$3(t,[0,1]),_js.$2.Instance.$2(_y.$W));var n=new _ex.$3r(_B.$3(t,[0,0,0]),_js.$2.Instance.$2(_y.$W));n.set_$3Z("ExtensibilityView.ExtensionListItemTemplate");n.set_$BC("_ex_x");n.set_$6("ExtensibilityView._tid4");return new _B(t,[n,u,i])},_ex.$sr,_js.$7,!1,!1,!1,0,_ex._TI.$1)};_ex._TI.$9S=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_ex_0\" class='_ex_2 _ex_3'></div> </div><div> <div autoid=\"_ex_1\" class='_ex_4'></div> </div><div> <div></div> <div class='_ex_l'> <button autoid=\"_ex_7\" type='button' class='_ex_m ms-font-weight-regular'></button> </div> </div><div> <div class='_ex_8'></div> <div autoid=\"_ex_9\" class='_ex_j _ex_5'></div> <div autoid=\"_ex_a\" class='_ex_k ms-font-weight-regular _ex_5'></div> <div style=\"clear:both;\"></div> </div><div> <div autoid=\"_ex_8\" class='_ex_i'></div> </div><div> <span class='_ex_9'></span> <img autoid=\"_ex_b\" class='_ex_a'/> </div><div> <div class='_ex_e'> <div class='_ex_g'> <button autoid=\"_ex_2\" type='button' class='_ex_f'></button>  <button autoid=\"_ex_3\" type='button' class='_ex_6'></button>  <button autoid=\"_ex_4\" type='button' class='_ex_7'></button> <div autoid=\"_ex_5\" class='_ex_h _ex_5'></div> <div style=\"clear:both;\"></div> </div> <div class='_ex_b'> <div autoid=\"_ex_6\" class='_ex_n'></div> </div> <div class='_ex_c'></div> <div class='hidden'> </div> </div>   </div><div> <div class='_ex_t ms-border-color-themeSecondary'></div> <div class='_ex_u ms-bg-color-white'></div> </div><div> <button autoid=\"_ex_d\" type='button' class='_ex_B'></button> <div class='_ex_x'></div> <button type='button' class='_ex_A ms-font-s ms-font-color-themePrimary'></button> </div><div> <span autoid=\"_ex_f\"></span> </div><div> <div autoid=\"_ex_e\" class='_ex_w ms-font-s ms-font-color-themePrimary'></div> </div><div> <div class='_ex_v'> <div class='_ex_y ms-bg-color-neutralLight'> <div autoid=\"_ex_c\"></div> </div> <div class='_ex_z ms-border-color-themeSecondary'></div> <div class='hidden'> </div> </div>  </div>";_js.$F.get_$9G().appendChild(n);return n};_ex._TI.$D03=function(n){return n.$65};_ex._TI.$D07=function(n){return n.get_$2Oz()};_ex._TI.$8u8=function(n){return n.$3Sj};_ex._TI.$6hP=function(n){return n.get_$26()};_ex._TI.$D0L=function(n){return n.get_$9JQ()};_ex._TI.$D0K=function(n){return n.get_$8Nh()};_ex._TI.$44O=function(n){return n.$CN};_ex._TI.$58f=function(n){return n.get_$13S()};_ex._TI.$8u2=function(n){return n.get_$6UE()};_ex._TI.$D05=function(n){return n.$3GC};_ex._TI.$8u1=function(n){return n.$32j};_ex._TI.$D04=function(n){return n.$2DY};_ex._TI.$D06=function(n){return n.$2MQ};_ex._TI.$8u4=function(n){return n.$Ij};_ex._TI.$D08=function(n){return n.$13e};_ex._TI.$w2=function(n){return n.get_$Cb()};_ex._TI.$6hN=function(n){return n.$1an};_ex._TI.$8u5=function(n){return n.$1TU};_ex._TI.$6hO=function(n){return n.$Hn};_ex._TI.$8u6=function(n){return n.get_$8Uj()};_ex._TI.$8u9=function(n){return n.$Qa};_ex._TI.$58g=function(n){return n.$65};_ex._TI.$1qi=function(n){return n.$dk};_ex._TI.$6hM=function(n){return n.$1I1};_ex._TI.$D0I=function(n){return n.$3KK};_ex._TI.$1MU=function(n){return n.get_$22R()};_ex._TI.$8u7=function(n){return n.$1Up};_ex._TI.$8u3=function(n){return n.$2MP};_ex._TI.$D0A=function(n){return n.$1Jp};_ex._TI.$O0=function(n){return n.get_$2f()};_ex._TI.$D0B=function(n){return n.$rA};_ex._TI.$6L=function(n){return n.get_$1F()};_ex._TI.$D0D=function(n){return n.$p7};_ex._TI.$D0M=function(n){return n.$p7};_ex._TI.$D0E=function(n){return n.$10L};_ex._TI.$D0C=function(n){return n.$13e};_ex._TI.$D0J=function(n){return n.$l};_ex._TI.$Z=function(n,t){n.set_$k(t)};_ex._TI.$8=function(n,t){n.set_$17(t)};_ex._TI.$a=function(n,t){n.set_$4k(t)};_ex._TI.$2n=function(n,t){n.set_$4E(t)};_ex._TI.$6d=function(n,t){n.set_$18(t)};_ex._TI.$1W=function(n,t){n.set_$1K(t)};_ex._TI.$H=function(n,t){n.set_$1K(t)};_ex._TI.$1l=function(n,t){n.set_$4E(t)};_ex._TI.$14=function(n,t){n.set_$2O(t)};_ex._TI.$LY=function(n,t){n.set_$Br(t)};_ex._TI.$x=function(n,t){n.set_$BI(t)};_ex._TI.$1o=function(n,t){n.set_$Es(t)};_ex._TI.$5o=function(n,t){n.set_$aa(t)};_ex._TI.$1b=function(n,t){n.set_$3u(t)};_ex._TI.$2o=function(n,t){n.set_$20(t)};_ex._TI.$D09=function(n,t){n.set_$50n(t)};_ex._TI.$w3=function(n,t){n.set_$Cb(t)};_ex._TI.$6hQ=function(n,t){n.set_$48o(t)};_ex._TI.$6hS=function(n,t){n.set_$CE(t)};_ex._TI.$6hR=function(n,t){n.set_$1tj(t)};_ex._TI.$8uA=function(n,t){n.$3K6=t};_ex._TI.$vq=function(n,t){n.set_$Sa(t)};_ex._TI.$3q=function(n,t){n.set_$KX(t)};_ex._TI.$3m=function(n,t){n.set_$1C(t)};_ex._TI.$D0H=function(n,t){n.set_$2aG(t)};_ex._TI.$6I=function(n,t){n.set_$1F(t)};_ex._TI.$D0G=function(n,t){n.$p7=t};_ex._TI.$D0P=function(n,t){n.set_$2QR(t)};_ex._TI.$D0N=function(n,t){n.$Ij=t};_ex._TI.$D0Q=function(n,t){n.set_$6uZ(t)};_ex._TI.$D0F=function(n,t){n.set_$50n(t)};_ex._TI.$D0O=function(n,t){n.$3IT=t};_ex._TI.$D0R=function(n,t){n.$l=t};_ex._TI.get_$24=function(){_ex._TI.$47||(_ex._TI.$47=new _fc.$6Q);return _ex._TI.$47};_ex._TI.get_$K=function(){_ex._TI.$2L||(_ex._TI.$2L=new _fc.$42);return _ex._TI.$2L};_ex._TI.get_$2e=function(){_ex._TI.$4Y||(_ex._TI.$4Y=new _fc.$6o);return _ex._TI.$4Y};ExtensibilityComponent.registerClass("ExtensibilityComponent",null,_a.$1X7);_ex.$lK.registerClass("_ex.$lK",_h.$1A3.$$(_g.$Ub));_ex.$le.registerClass("_ex.$le",_h.$TS.$$(_g.$V7,_g.$lg));_ex.$lk.registerClass("_ex.$lk",_h.$TS.$$(_g.$OB,_g.$WF));_ex.$4W.registerClass("_ex.$4W",_h.$1A3.$$(_g.$O2));_ex.$Ve.registerClass("_ex.$Ve",_h.$TS.$$(_g.$V7,_g.$lg));_ex.$WP.registerClass("_ex.$WP",_h.$1A3.$$(_g.$WR));_ex.$17i.registerClass("_ex.$17i",_h.$1A3.$$(String));_ex.$pC.registerClass("_ex.$pC",_h.$1A3.$$(_g.$Xc));_ex.$pD.registerClass("_ex.$pD",_h.$1A3.$$(_g.$Xe));_ex.$5K.registerClass("_ex.$5K");_ex.$5K.$3iZ.registerClass("_ex.$5K.$3iZ");_ex.$Ue.registerClass("_ex.$Ue");_ex.$11Z.registerClass("_ex.$11Z",null,_ex.$1UG);_ex.$6E.registerClass("_ex.$6E",null,_ex.$1UG);_ex.$1ZA.registerClass("_ex.$1ZA");_ex.$jB.registerClass("_ex.$jB",_ex.$1ZA);_ex.$yW.registerClass("_ex.$yW",_ex.$jB);_ex.$yX.registerClass("_ex.$yX",_ex.$jB);_ex.$jH.registerClass("_ex.$jH",_ex.$1ZA);_ex.$1a6.registerClass("_ex.$1a6",_ex.$1ZA);_ex.$zL.registerClass("_ex.$zL",_ex.$1a6);_ex.$zM.registerClass("_ex.$zM",_ex.$1a6);_ex.$1ZB.registerClass("_ex.$1ZB");_ex.$1R.registerClass("_ex.$1R");_ex.$1a9.registerClass("_ex.$1a9",_ex.$1R);_ex.$11X.registerClass("_ex.$11X",_ex.$1a9);_ex.$4e.registerClass("_ex.$4e",_ex.$1R);_ex.$1Ep.registerClass("_ex.$1Ep",_ex.$4e);_ex.$Ug.registerClass("_ex.$Ug");_ex.$11d.registerClass("_ex.$11d",_ex.$1a9);_ex.$11e.registerClass("_ex.$11e",_ex.$4e);_ex.$123.registerClass("_ex.$123",_ex.$1ZA);_ex.$12C.registerClass("_ex.$12C",_ex.$1ZA);_ex.$VZ.registerClass("_ex.$VZ",_ex.$1ZA);_ex.$12O.registerClass("_ex.$12O",_ex.$1ZA);_ex.$12M.registerClass("_ex.$12M",_ex.$1ZA);_ex.$12R.registerClass("_ex.$12R",_ex.$1ZA);_ex.$14c.registerClass("_ex.$14c",_ex.$1ZA);_ex.$17T.registerClass("_ex.$17T",_ex.$1ZA);_ex.$LD.registerClass("_ex.$LD",_ex.$1ZA);_ex.$18G.registerClass("_ex.$18G",_ex.$1ZA);_ex.$18N.registerClass("_ex.$18N",_ex.$1ZA);_ex.$18M.registerClass("_ex.$18M",_ex.$1a6);_ex.$18O.registerClass("_ex.$18O",_ex.$1ZA);_ex.$29.registerClass("_ex.$29");_ex.$19n.registerClass("_ex.$19n",null,_y.$mk,_a.$1Iw);_ex.$kU.registerClass("_ex.$kU",_y.$1b6,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$tg);_ex.$2H.registerClass("_ex.$2H",_a.$En,_y.$1Iv);_ex.$KN.registerClass("_ex.$KN",_ex.$2H,_y.$1Vm,_y.$1Iv);_ex.$11a.registerClass("_ex.$11a",_a.$AY);_ex.$F5.registerClass("_ex.$F5");_ex.$BH.registerClass("_ex.$BH",_a.$En);_ex.$lM.registerClass("_ex.$lM",_y.$1b6,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$tg);_ex.$Ui.registerClass("_ex.$Ui");_ex.$11f.registerClass("_ex.$11f",null,IExtensibilityStatistics);_ex.$11f.$4Oc.registerClass("_ex.$11f.$4Oc");_ex.$11f.$7Xy.registerClass("_ex.$11f.$7Xy");_ex.$11f.$4e5.registerClass("_ex.$11f.$4e5");_ex.$11f.$7ph.registerClass("_ex.$11f.$7ph");_ex.$11g.registerClass("_ex.$11g",null,_y.$1YR);_ex.$sr.registerClass("_ex.$sr",_ex.$2H);_ex.$11h.registerClass("_ex.$11h",null,IExtensibilityViewModelFactory);_ex.$11i.registerClass("_ex.$11i",_a.$AY);_ex.$bX.registerClass("_ex.$bX",_js.$Ct);_ex.$7c.registerClass("_ex.$7c",_a.$En,_y.$1Vi);_ex.$17c.registerClass("_ex.$17c",_ex.$11g);_ex.$B7.registerClass("_ex.$B7");_ex.$108.registerClass("_ex.$108",_ex.$B7);_ex.$lG.registerClass("_ex.$lG");_ex.$3k.registerClass("_ex.$3k");_ex.$14G.registerClass("_ex.$14G",_ex.$B7);_ex.$3l.registerClass("_ex.$3l",_ex.$B7);_ex.$Dr.registerClass("_ex.$Dr",_ex.$B7);_ex.$F9.registerClass("_ex.$F9",_ex.$B7);_ex.$Gz.registerClass("_ex.$Gz");_ex.$10E.registerClass("_ex.$10E",_js.$F);_ex.$kT.registerClass("_ex.$kT",_fce.$m);_ex.$kV.registerClass("_ex.$kV",_js.$7);_ex.$11c.registerClass("_ex.$11c",_b.$J5);_ex.$3r.registerClass("_ex.$3r",_fce.$m);_ex.$1.registerClass("_ex.$1");_ex.$CG.registerClass("_ex.$CG",_js.$F);_ex._TI.registerClass("_ex._TI");_ex.$4W.$en=null;_ex.$4W.$2PQ=0;_ex.$5K.$1Q=null;_ex.$6E.$2T4=null;_ex.$6E.$1rm=null;_ex.$1R.$1S0={wasSuccessful:!1};_ex.$1R.$1wN=new RegExp(" ","g");_ex.$1R.$2Dt=null;_ex.$1R.$2Du=null;_ex.$1R.$2Dx=null;_ex.$1R.$2Dv=null;_ex.$LD.$4Z8={wasSuccessful:!0};_ex.$F5.$L2={};_ex.$BH.$4r6="HideExtensionContextMenu";_ex.$BH.$3cZ="TabSelectedExtension";_ex.$2H.$8NI="HighlightedTerms";_ex.$2H.$7pY="ExtensionBecomeActiveTestOnly";_ex.$2H.$46r="NoActiveExtensions";_ex.$2H.$41G="MarketplaceUrl";_ex.$2H.$5El="OnGetExtensibilityContextCompleted";_ex.$2H.$8Ml="HideExtensionContainer";_ex.$2H.$7Qr="ActiveExtensionsCount";_ex.$2H.$2Nw=!1;_ex.$2H.$12v=null;_ex.$7c.$4sI=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_ex.$3r.$1By=0;_ex.$3r.$2EU={};_ex.$3r.$we=null;_ex.$CG.$2U1=0;_ex._TI._hf=_ex._TI.$9S();_ex._TI.$47=null;_ex._TI.$2L=null;_ex._TI.$4Y=null;_ex._TI.$1={};_ex._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.extensibility.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
