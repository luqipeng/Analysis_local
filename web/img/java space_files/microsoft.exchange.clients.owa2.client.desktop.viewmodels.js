try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_i");_i.$1=function(){};_i.$1.get_$9ky=function(){return _fm.$B.$9("conversations_showdeleted.png")};_i.$1.get_$6LN=function(){return _fm.$B.$9("conversations_hidedeleted.png")};_i.$1.get_$6mG=function(){return _fm.$B.$9("conversations_newestontop.png")};_i.$1.get_$95a=function(){return _fm.$B.$9("conversations_oldestontop.png")};_i.$1.get_$5L8=function(){return _fm.$B.$9("readingpane_off.png")};_i.$1.get_$9KI=function(){return _fm.$B.$9("readingpane_onbottom.png")};_i.$1.get_$6wj=function(){return _fm.$B.$9("readingpane_onright.png")};_i.$1.get_$A5c=function(){return _fm.$G.$9("alert-triangle-yellow","x18","owa","owa-color-neutral-yellow")};_i.$IG=function(n,t,i,r,u){this.$$d_$Dic=Function.createDelegate(this,this.$Dic);this.$$d_$Did=Function.createDelegate(this,this.$Did);this.$$d_$Dia=Function.createDelegate(this,this.$Dia);this.$$d_$Dib=Function.createDelegate(this,this.$Dib);this.$$d_$DiV=Function.createDelegate(this,this.$DiV);this.$$d_$DiY=Function.createDelegate(this,this.$DiY);this.$$d_$DiZ=Function.createDelegate(this,this.$DiZ);_i.$IG.initializeBase(this,[n]);this.$d=t;this.set_$kI(this.$2lQ());this.$N=i;this.$2Y=r;this.$W7=!!u&&u.$2r("FolderBasedClutter")};_i.$IG.prototype={$W7:!1,$d:null,$3Fu:!1,$2kp:!1,$3Fv:!1,$Ld:null,$wi:1,$O3:0,$10R:0,$28E:null,$3hK:!1,$2uN:0,$6NS:0,$3LH:0,$ng:0,$3LE:0,$3LI:0,$1CO:0,$1yL:null,$2MN:0,$2Aa:null,$13E:null,$4sq:0,$6Mz:null,$N:null,$1oW:!1,$2Y:null,$1Lg:!1,$6N2:!1,$1fp:!1,get_$2tB:function(){return 3},get_$8Wi:function(){return this.$d.get_$9N().get_$2Vr()},set_$6zO:function(n){if(n!==this.$2uN){this.$2uN=n;this.$4("ReportJunkOption")}return n},set_$kI:function(n){if(this.$Ld!==n){this.$Ld=n;this.$4("PivotOptions")}return n},set_$Gp:function(n){if(this.$O3!==n){this.$O3=n;this.$5Fl();this.$4("PivotSelectedOptionIndex")}return n},set_$2vN:function(n){if(this.$wi!==n){this.$wi=n;this.$4("SelectedPivot")}return n},set_$8a7:function(n){if(n!==this.$3LH){this.$3LH=n;this.$4("ListViewMessageFormat")}return n},set_$32b:function(n){this.$ng=n;this.$4("AutoSelectFirstMessage");return n},set_$4Wi:function(n){if(n!==this.$1CO){this.$1CO=n;this.$4("ConversationOrder")}this.$EWN(n);return n},set_$3kJ:function(n){if(n!==this.$1yL){this.$1yL=n;this.$4("ConversationOrderImage")}return n},set_$8Mg:function(n){if(n!==this.$2MN){this.$2MN=n;this.$4("HideDeletedItemsOption")}this.$EZc(n);return n},set_$7Et:function(n){if(n!==this.$2Aa){this.$2Aa=n;this.$4("ShowOrHideDeletedItemsImage")}return n},set_$8a1:function(n){if(n!==this.$3LE){this.$3LE=n;this.$4("ListViewClutterOption")}return n},set_$8a9:function(n){if(n!==this.$3LI){this.$3LI=n;this.$4("ListViewPreviewOption")}return n},set_$5L9:function(n){if(n!==this.$10R){this.$10R=n;this.$4("ReadingPanePositionOption")}this.$9iZ(n);return n},set_$3Um:function(n){if(n!==this.$28E){this.$28E=n;this.$4("ReadingPanePositionImage")}return n},set_$7Vp:function(n){this.$3hK=n;this.$4("ApplyRPPositionToAllFolders");return n},set_$1Ek:function(n){if(n!==this.$1Lg){this.$1Lg=n;this.$4("IsOptimizedForAccessibility")}return n},get_$C1x:function(){return!this.$W7},get_$DcA:function(){var n=this;return function(t){n.$1oW||n.$Dc9()}},get_$DS8:function(){var n=this;return function(t){n.$1oW||n.$DS7()}},get_$DcD:function(){var n=this;return function(t){n.$1oW||n.$DcC()}},get_$Dh7:function(){var n=this;return function(t){n.$1oW||n.$Dh6()}},get_$DUl:function(){var n=this;return function(t){n.$1oW||n.$DUk()}},get_$Da6:function(){var n=this;return function(t){n.$1oW||n.$Da5()}},get_$DU4:function(){var n=this;return function(t){n.$1oW||n.$DU3()}},set_$DoW:function(n){if(this.$1fp!==n){this.$1fp=n;this.$4("OwaLightEnabled");this.$4("OwaLightOptionDescription")}return n},get_$9ES:function(){return this.$1fp?_nbs.NonBootStrings.l_SettingsOwaLightOptionDescription_Text:_nbs.NonBootStrings.l_SettingsOwaLightOptionDisabled_Text},$EZV:function(n){n&&this.set_$Gp(2)},$EA:function(){this.$1oW=!0;this.$A7D();this.$13E=this.$4nK();this.$4sq=this.$10R;this.$6Mz=this.$d.get_$6r().$1bk;this.$6N2=this.$1Lg;this.$6NS=this.$2uN;this.$2kp=!1;this.$3Fu=!1;this.$3Fv=!1;this.set_$GZ(1);this.$26k=!1;this.$1oW=!1},$B0:function(){var n=this.$AQq();var i=null;var r=null;this.set_$GZ(3);if(this.$3hK){this.$d.get_$1j().set_$1na(this.$10R);var f=this.$d.get_$6r().$1bk;for(var u in f){var t={key:u,value:f[u]};if(t.value.$MF!==3){t.value.set_$1AH(3);this.$d.get_$6r().$2Bk(t.value)}}i=_h.$21.$4Vw(this.$d.get_$6r().get_$b4(),OwaApplication.$2B,this.$$d_$DiZ,this.$$d_$DiV);_a.$i.$Ga(this.$8HL())}else if(this.$4sq!==this.$10R){i=_h.$21.$4Vw(this.$d.get_$6r().get_$b4(),OwaApplication.$2B,this.$$d_$DiZ,this.$$d_$DiY);this.$2kp=!0;_a.$i.$Ga(this.$8HL())}if(n){n.add_$2s(this.$$d_$Dib);n.add_$2b(this.$$d_$Dia);this.$n.$1U(n);this.$3Fu=!0}this.$1fp&&!n&&this.$1Lg!==this.$d.get_$1j().get_$1Ek()&&(r=this.$9QE());this.$6NS!==this.$2uN&&this.$EZG(this.$2uN);n||i||r||this.$5dd()},$Gf:function(){this.$9PW();this.$9PV();this.$9PX();SettingsPanelViewModelBase.prototype.$Gf.call(this)},$Dib:function(n){var t=this.$4nK();if(this.$13E.ConversationSortOrder!==t.ConversationSortOrder||this.$13E.HideDeletedItems!==t.HideDeletedItems){this.$d.get_$1j().set_$ea(this.$1CO);this.$d.get_$1j().set_$rl(this.$2MN===1);this.$N.$1p(_y.$x0,new _y.$x0);this.$N.$1p(_h.$Ps,new _h.$Ps(9))}this.$W7&&!this.$d.get_$9N().get_$2Up()&&t.ShowInferenceUiElements&&this.$d.get_$9N().set_$2Up(!0);this.$3Fu=!1;this.$1fp&&this.$1Lg!==this.$d.get_$1j().get_$1Ek()&&this.$9QE();this.$5dd()},$DiZ:function(n){this.$2kp=!1;this.$5dd()},$Did:function(n){this.$3Fv=!1;this.$5dd()},$Dia:function(n){this.$3Fu=!1;this.set_$GZ(5);this.$9PW()},$DiY:function(n){this.$2kp=!1;this.set_$GZ(5);this.$9PV()},$DiV:function(n){this.$2kp=!1;this.set_$GZ(5);this.$E5f()},$Dic:function(n){this.$3Fv=!1;this.set_$GZ(5);this.$9PX()},$5dd:function(){var n=!this.$3Fu&&!this.$2kp&&!this.$3Fv;if(n){this.set_$GZ(4);this.$26k=!0;this.get_$h1()&&this.get_$h1()()}},$2lQ:function(){var n=[];Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsMessageListPivot_Text,1));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsConversationsPivot_Text,2));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsReadingPanePivot_Text,0));this.get_$8Wi()&&Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_JunkEmailSetting_Text,5));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsOwaVersionPivot_Text,4));return n},$5Fl:function(){this.set_$2vN(this.$Ld[this.$O3].$1e)},$CFD:function(n){if(this.$13E.ShowInferenceUiElements!==n.ShowInferenceUiElements){if(this.$d.get_$1j().get_$15Y())this.$2Y.$9sZ();else{this.$2Y.$9sY(2);this.$E45()}return!0}return this.$13E.ShowSenderOnTopInListView!==n.ShowSenderOnTopInListView?!0:this.$13E.ShowPreviewTextInListView!==n.ShowPreviewTextInListView?!0:this.$13E.ConversationSortOrder!==n.ConversationSortOrder?!0:this.$13E.HideDeletedItems!==n.HideDeletedItems?!0:this.$13E.GlobalReadingPanePosition!==n.GlobalReadingPanePosition?!0:this.$13E.ShowFirstMessageOnSignIn!==n.ShowFirstMessageOnSignIn?!0:!1},$4nK:function(){var n=new _g.$Oq;n.ShowInferenceUiElements=!this.$3LE;n.ShowSenderOnTopInListView=!this.$3LH;n.ShowFirstMessageOnSignIn=!this.$ng;n.ShowPreviewTextInListView=!this.$3LI;n.ConversationSortOrder=this.$1CO;n.HideDeletedItems=this.$2MN===1;n.GlobalReadingPanePosition=this.$3hK?this.$10R:this.$d.get_$1j().get_$1na();return n},$A6z:function(n){this.$d.get_$1j().set_$15Y(n.ShowInferenceUiElements);this.$d.get_$1j().set_$1OW(n.ShowSenderOnTopInListView);this.$d.get_$1j().set_$1OT(n.ShowPreviewTextInListView);this.$d.get_$1j().set_$ea(n.ConversationSortOrder);this.$d.get_$1j().set_$rl(n.HideDeletedItems);this.$d.get_$1j().set_$1OV(n.ShowFirstMessageOnSignIn);this.$d.get_$1j().set_$1na(n.GlobalReadingPanePosition)},$A7D:function(){this.set_$8a1(this.$d.get_$1j().get_$15Y()?0:1);this.set_$8a7(this.$d.get_$1j().get_$1OW()?0:1);this.set_$32b(this.$d.get_$1j().get_$1OV()?0:1);this.set_$8a9(this.$d.get_$1j().get_$1OT()?0:1);this.set_$5L9(_y.$1O.$2k9(this.get_$124(),this.$d));this.set_$7Vp(!1);(this.$d.get_$1j().get_$ea()==="ChronologicalNewestOnTop"||this.$d.get_$1j().get_$ea()==="ChronologicalNewestOnBottom")&&this.set_$4Wi(this.$d.get_$1j().get_$ea());this.set_$8Mg(this.$d.get_$1j().get_$rl()?1:0);this.set_$1Ek(this.$d.get_$1j().get_$1Ek());this.set_$DoW(this.$d.get_$9N().get_$6rp());this.$d.get_$1j().get_$gy()?this.set_$6zO(this.$d.get_$1j().get_$mh()?1:2):this.set_$6zO(0)},$EZG:function(n){switch(n){case 0:this.$d.get_$1j().set_$gy(!1);break;case 1:this.$d.get_$1j().set_$mh(!0);this.$d.get_$1j().set_$gy(!0);break;case 2:this.$d.get_$1j().set_$mh(!1);this.$d.get_$1j().set_$gy(!0);break}_h.$21.$Kq(this.$d.get_$1j().$Hm,OwaApplication.$2B)},$9iZ:function(n){switch(n){case 2:this.set_$3Um(_i.$1.get_$9KI());break;case 0:this.set_$3Um(_i.$1.get_$5L8());break;case 1:this.set_$3Um(_i.$1.get_$6wj());break}},$EWN:function(n){switch(n){case"ChronologicalNewestOnBottom":this.set_$3kJ(_i.$1.get_$95a());break;case"ChronologicalNewestOnTop":this.set_$3kJ(_i.$1.get_$6mG());break}},$EZc:function(n){switch(n){case 1:this.set_$7Et(_i.$1.get_$6LN());break;case 0:this.set_$7Et(_i.$1.get_$9ky());break}},$Dc9:function(){this.$d.get_$1j().set_$1OW(!this.$3LH)},$DS7:function(){this.$d.get_$1j().set_$1OV(!this.$ng)},$DcC:function(){this.$d.get_$1j().set_$1OT(!this.$3LI)},$Dh6:function(){this.$7Vn(this.$10R)},$7Vn:function(n){var t=this.$d.get_$6r().$fD(this.get_$124());t.set_$1AH(n);this.$d.get_$6r().$2Bk(t)},$AQq:function(){var n=this.$4nK();return this.$CFD(n)?new _c.$pf(n):null},$DUk:function(){this.$N.$1p(_y.$Ic,new _y.$Ic(this.$1CO,this.$2MN===1))},$Da5:function(){this.$N.$1p(_y.$Ic,new _y.$Ic(this.$1CO,this.$2MN===1))},$DU3:function(){this.$d.get_$1j().set_$15Y(!this.$3LE)},$E45:function(){this.$d.get_$1j().set_$3u4(!1);this.$d.get_$1j().set_$3u7(!1);this.$d.get_$1j().set_$3u5(!1);this.$d.get_$1j().set_$3u8(!1);this.$d.get_$1j().set_$3u6(!1);this.$d.get_$1j().set_$3u9(!1);this.$d.get_$1j().set_$fb(this.$d.get_$1j().get_$fb()&-2);this.$d.get_$1j().set_$fb(this.$d.get_$1j().get_$fb()&-3);_h.$21.$Kq(this.$d.get_$1j().$Hm,OwaApplication.$2B)},$9PW:function(){this.$A6z(this.$13E);var n=this.$4nK();(this.$13E.ConversationSortOrder!==n.ConversationSortOrder||this.$13E.HideDeletedItems!==n.HideDeletedItems)&&this.$N.$1p(_y.$Ic,new _y.$Ic(this.$13E.ConversationSortOrder,this.$13E.HideDeletedItems))},$9PV:function(){this.$7Vn(this.$4sq)},$E5f:function(){var i=this.$6Mz;for(var r in i){var n={key:r,value:i[r]};var t=this.$d.get_$6r().$1bk[n.key];t.set_$1AH(n.value.$MF);this.$d.get_$6r().$2Bk(t)}},$9PX:function(){this.$d.get_$1j().set_$1Ek(this.$6N2)},$9QE:function(){this.$d.get_$1j().set_$1Ek(this.$1Lg);var n=_h.$21.$4Vw(this.$d.get_$1j().$Hm,OwaApplication.$2B,this.$$d_$Did,this.$$d_$Dic);this.$3Fv=!0;return n},$8HL:function(){var n=null;switch(this.$10R){case 0:n="VM.MailUsage.SetReadingPaneOff";break;case 1:n="VM.MailUsage.SetReadingPaneRight";break;case 2:n="VM.MailUsage.SetReadingPaneBottom";break}return n}};_i.$vc=function(n,t,i,r,u){this.$$d_$Hc=Function.createDelegate(this,this.$Hc);this.$$d_$5N=Function.createDelegate(this,this.$5N);this.$$d_$Gf=Function.createDelegate(this,this.$Gf);this.$$d_$6nP=Function.createDelegate(this,this.$6nP);_i.$vc.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$vc.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(i,"userAgent");_a.$4.$z(r,"bookmarker");this.$N=n;this.$I1=t;this.$1E=i;this.$qf=r;this.$xM=u;this.$XM=new _C(this.$$d_$6nP,_a.$0.$L3);this.$8W=new _C(this.$$d_$Gf,_a.$0.$L3);this.$5a=new _C(this.$$d_$5N,_a.$0.$L3);this.$3RT=new _C(this.$$d_$Hc,_a.$0.$L3);this.$H6=1;this.$34e=0;this.$3uc=!1;this.$4HF=!1;this.set_$8WL(!0)};_i.$vc.prototype={$1E:null,$qf:null,$N:null,$I1:null,$xM:null,$DE:null,$48:null,$5a:null,$8W:null,$3RT:null,$XM:null,$H6:0,$34e:0,$3uc:!1,$4HF:!1,$5KZ:!1,$4xe:!1,set_$8WL:function(n){if(this.$4xe!==n){this.$4xe=n;this.$4("IsProvisioning")}return n},get_$Df:function(){return this.$1E.get_$Df()},get_$A2O:function(){return this.$1E.get_$2OB()?_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_Mac_Text:_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_PC_Text},get_$CHX:function(){return this.$5KZ?_nbs.NonBootStrings.l_OfflineNotAvailable_Text:_nbs.NonBootStrings.l_OfflineSettingsDone_Text},set_$9kW:function(n){if(this.$4HF!==n){this.$4HF=n;this.$4("ShowAbortProvisionInfo")}return n},set_$6LZ:function(n){if(this.$3uc!==n){this.$3uc=n;this.$4("HideNextButton")}return n},set_$AIX:function(n){if(this.$34e!==n){this.$34e=n;this.$4("ComputerPrivacyMode");this.$34e===1?this.$9z9():this.$AJV()}return n},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7lv:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},get_$4Yk:function(){return this.$H6},set_$4Yk:function(n){if(this.$H6!==n){this.$H6=n;this.$H6===4&&this.set_$6LZ(!0);this.$4("CurrentStep");this.$4("StepInfo")}return n},get_$EkD:function(){return String.format(_nbs.NonBootStrings.l_StepInfo_Text,this.$H6,4)},$5N:function(){this.$DE();this.$N.$1p(_a.$PC,new _a.$PC);this.set_$8WL(!1)},$6nP:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is invoking OK");this.$5N()},$Gf:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is cancelling offline provision");this.$5N();if(this.$H6>1){this.$63O(!1);this.$I1.$6yo(_g.$1H.$1Q,window.location)}},$Hc:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is invoking next");switch(this.$H6){case 1:this.$C6q();break;case 3:this.$63O(!1);break;default:break}this.$5KZ?this.set_$4Yk(4):this.set_$4Yk(this.get_$4Yk()+1)},$9z9:function(){this.set_$6LZ(!0);this.set_$9kW(!0)},$AJV:function(){this.set_$6LZ(!1);this.set_$9kW(!1)},$C6q:function(){var t=this,n=this;this.$I1.$6uz(_g.$1H.$1Q,null,!0,_js.$D.get_$Q(),"Mouse",function(n){_g.$1H.set_$Q(n);t.$N.$1p(_a.$PB,new _a.$PB(!0))},function(t){_js.Trace.logError(_a.$0.$1c,"Failed to install offline components. {0}",t);if(n.$4xe){n.$5KZ=!0;n.$4("LastStepInfo")}else{var i=new _a.$2y([_nbs.NonBootStrings.l_OfflineNotAvailable_Text],1,null);n.$N.$1p(_a.$2y,i)}});this.$qf.$Dst(this.$xM)},$63O:function(n){this.$qf.$63O(n)}};_i.$nu=function(n,t,i,r,u,f,e,o){this.$$d_$6Wy=Function.createDelegate(this,this.$6Wy);this.$$d_$Gf=Function.createDelegate(this,this.$Gf);this.$$d_$6nP=Function.createDelegate(this,this.$6nP);_i.$nu.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$nu.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(r,"userAgent");_a.$4.$z(u,"bookmarker");_a.$4.$z(i,"owaShell");this.$N=n;this.$I1=t;this.$1E=r;this.$qf=u;this.$xM=f;this.$I=i;this.$1Yv=e;this.$35=o;this.$XM=new _C(this.$$d_$6nP,_a.$0.$L3);this.$8W=new _C(this.$$d_$Gf,_a.$0.$L3);this.$QD=new _C(this.$$d_$6Wy,_a.$0.$L3)};_i.$nu.prototype={$I:null,$N:null,$I1:null,$1E:null,$qf:null,$xM:null,$35:null,$1Yv:null,$DE:null,$48:null,$4sp:0,$2fm:0,$XM:null,$8W:null,$QD:null,$1s0:null,$Ld:null,$wi:0,$O3:0,get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7lv:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},set_$7j0:function(n){if(this.$2fm!==n){this.$2fm=n;this.$4("CurrentOfflinEnabledStatus");this.$4("ShowOptOutWarningInfo")}return n},get_$Ef9:function(){return!this.$2fm&&this.$I1.get_$6rd()>0},set_$DQL:function(n){if(n!==this.$1s0){this.$1s0=n;this.$4("OfflineFoldersViewModel")}return n},set_$kI:function(n){if(this.$Ld!==n){this.$Ld=n;this.$4("PivotOptions")}return n},set_$Gp:function(n){if(this.$O3!==n){this.$O3=n;this.$5Fl();this.$4("PivotSelectedOptionIndex")}return n},set_$2vN:function(n){if(this.$wi!==n){this.$wi=n;this.$4("SelectedPivot")}return n},$5N:function(){this.$DE()},$2lQ:function(){var n=[];Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_SetUp_Text,0));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_OfflineFolders_Text,1));return n},$5Fl:function(){this.set_$2vN(this.$Ld[this.$O3].$1e)},$6Wy:function(){this.$4sp=this.$I1.$BJ.get_$1iY()?1:0;this.set_$7j0(this.$4sp);if(this.$I1.$BJ.get_$YO()){this.$1s0||this.set_$DQL(new _d.$Ee(this.$I,_nbs.NonBootStrings.l_OfflineFolders_Text,this.$N,this.$1Yv,this.$48,this.$35));this.$1s0.$5WE();this.$Ld||this.set_$kI(this.$2lQ())}},$6nP:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettings Invoking OK");this.$5N();if(this.$2fm!==this.$4sp)if(this.$2fm===1){var n=new _i.$vc(this.$N,this.$I1,this.$1E,this.$qf,this.$xM);this.$I.$Ay(n)}else this.$I1.$6yo(_g.$1H.$1Q,window.location);else this.$9Jz();this.$1s0&&this.$1s0.$71I()},$Gf:function(){this.$5N();this.$1s0&&this.$1s0.$5WE();this.$9Jz()},$9Jz:function(){this.$N.$1p(_a.$PC,new _a.$PC)}};function SettingsPanelFactory(n,t,i,r,u,f,e,o,s){this.$n=n;this.$d=t;this.$N=i;this.$1E=r;this.$2Y=u;this.$3Y=o;this.$85=s;this.$1Yv=f;this.$35=e}SettingsPanelFactory.prototype={$n:null,$d:null,$N:null,$1E:null,$2Y:null,$1Yv:null,$35:null,$3Y:null,$85:null,$4Y9:function(){return new _i.$LO(this.$n,this.$d,this.$N)},$4XY:function(){return new _i.$IG(this.$n,this.$d,this.$N,this.$2Y,this.$3Y)},$4Xl:function(n,t,i,r){return new _i.$nu(this.$N,n,t,this.$1E,i,r,this.$1Yv,this.$35)},$4Y6:function(){return new _i.$xY(this.$d,this.$85)}};function SettingsPanelViewModelBase(n){this.$$d_$DiX=Function.createDelegate(this,this.$DiX);this.$$d_$Die=Function.createDelegate(this,this.$Die);this.$$d_$9Eq=Function.createDelegate(this,this.$9Eq);this.$$d_$EA=Function.createDelegate(this,this.$EA);this.$$d_$Gf=Function.createDelegate(this,this.$Gf);this.$$d_$B0=Function.createDelegate(this,this.$B0);this.$$d_$5N=Function.createDelegate(this,this.$5N);SettingsPanelViewModelBase.initializeBase(this);this.$n=n;this.$5a=new _C(this.$$d_$5N,_a.$0.$1c);this.$E0=new _C(this.$$d_$B0,_a.$0.$1c);this.$8W=new _C(this.$$d_$Gf,_a.$0.$1c);this.$QD=new _C(this.$$d_$EA,_a.$0.$1c)}SettingsPanelViewModelBase.prototype={$n:null,$48:null,$7c:null,$5a:null,$E0:null,$8W:null,$QD:null,$UW:null,$6OV:!1,$HL:0,$26k:!1,$3Sk:null,$3jd:null,$4Vk:null,$4Vl:null,get_$8aC:function(){return this.$QD},get_$124:function(){return this.$UW},set_$124:function(n){this.$UW=n;return n},get_$2NM:function(){return this.$6OV},set_$2NM:function(n){this.$6OV=n;this.$EZV(n);return n},set_$GZ:function(n){if(this.$HL!==n){this.$HL=n;this.$4("Status")}return n},get_$2tB:function(){return 2},get_$3tc:function(){return this.$$d_$9Eq},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7lv:function(){return!1},get_$3Sl:function(){return this.$3Sk},set_$3Sl:function(n){this.$3Sk=n;return n},$ma:function(){},$IX:function(){if(this.$3Sk){_a.$6.$1G(this.$3Sk);this.$3Sk=null}},$pf:function(){},$Tq:function(){if(this.$3jd){_a.$6.$1G(this.$3jd);this.$3jd=null}},$AQo:function(){return null},$9Bx:function(n){},$Gf:function(){this.$26k=!0;this.get_$h1()&&this.get_$h1()()},$5Ff:function(n){},$EZV:function(n){},$B0:function(){var n=this.$AQo();if(n){this.set_$GZ(3);n.add_$2s(this.$$d_$Die);n.add_$2b(this.$$d_$DiX);this.$n.$1U(n)}else{this.$26k=!0;this.get_$h1()()}},$Die:function(n){this.set_$GZ(4);this.$9Bx(n);this.$26k=!0;this.get_$h1()()},$DiX:function(n){this.set_$GZ(5);this.$5Ff(n)},$5N:function(){this.$4Vk&&this.$4Vl&&(this.$3jd=_a.$6.$1g(this.$4Vk,this.$4Vl,!0));this.$26k=!0;this.get_$h1()()},$9Eq:function(n,t){return!this.$26k}};_i.$LO=function(n,t,i){this.$$d_$9AF=Function.createDelegate(this,this.$9AF);this.$$d_$DcS=Function.createDelegate(this,this.$DcS);_i.$LO.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_i.$LO.initializeBase(this,[n]);var r=t.get_$RA().DefaultTheme;_js.$9.$1h(r)&&(r="base");this.$1AQ=t.get_$1j().get_$4Jh();_js.$9.$1h(this.$1AQ)&&(this.$1AQ=r);this.$N=i;this.$4Vk=_a.$0.$1c;this.$4Vl="ThemesPanelClose"};_i.$LO.prototype={$N:null,$1AQ:null,$10w:null,$2G0:null,$2aV:null,$1AW:null,$2Pn:null,$14y:null,get_$1I7:function(){return this.$10w},set_$1I7:function(n){if(this.$10w!==n){this.$10w=n;this.$4("ThemesList")}return n},get_$16x:function(){return this.$2G0},set_$16x:function(n){if(this.$2G0!==n){this.$2G0=n;this.$4("CssPaths")}return n},set_$9qA:function(n){if(this.$2aV!==n){this.$2aV=n;this.$4("ThemePath")}return n},set_$3X6:function(n){if(this.$1AW!==n){this.$1AW=n;this.$4("SelectedThemeId");this.$N.$1p(_a.$Ss,new _a.$Ss(this.$1AW))}return n},set_$71P:function(n){if(this.$1AQ!==n){this.$1AQ=n;this.$4("SavedThemeId")}return n},$EA:function(){this.$2Pn=_a.$6.$1g(_a.$0.$1c,"ThemesLoad",!0);this.set_$GZ(0);this.$26k=!1;var n=new _c.$1HV;n.add_$2s(this.$$d_$DcS);n.add_$2b(this.$$d_$9AF);this.$n.$1U(n)},$AQo:function(){this.$14y=_a.$6.$1g(_a.$0.$1c,"ThemesSave",!0);return new _c.$1QN(this.$1AW)},$9Bx:function(n){this.set_$71P(n.$46o);this.$N.$1p(_a.$YH,new _a.$YH(this.$1AQ));if(!$C(this.$14y)){var t=new _a.$3z;t.$CX("T",n.$46o);_a.$6.$1G(this.$14y,null,"",n.$FJ(),t.toString());this.$14y=null}},$Gf:function(){SettingsPanelViewModelBase.prototype.$Gf.call(this);this.$N.$1p(_a.$Ss,new _a.$Ss(this.$1AQ))},$5Ff:function(n){if(!$C(this.$14y)){_a.$6.$1G(this.$14y,null,n.$2H?n.$2H.toString():"unknown",n.$FJ());this.$14y=null}},$DcS:function(n){this.set_$GZ(1);var r=!1;if(!$C(n)){var t=n.$7JN;this.set_$16x(t.CssPaths);this.set_$9qA(t.ThemePath);this.set_$1I7(t.Themes);($C(this.$10w)||!this.$10w.length)&&this.$9AF(n);for(var i=0;i<this.$10w.length;i++)if(this.$10w[i].FolderName===this.$1AQ){r=!0;break}}r||this.set_$71P("base");this.set_$3X6(this.$1AQ);if(!$C(this.$2Pn)){_a.$6.$1G(this.$2Pn,null,"",n.$FJ());this.$2Pn=null}},$9AF:function(n){this.set_$GZ(2);if(!$C(this.$2Pn)){_a.$6.$1G(this.$2Pn,null,n.$2H?n.$2H.toString():"unknown",n.$FJ());this.$2Pn=null}}};_i.$xY=function(n,t){this.$$d_$7bV=Function.createDelegate(this,this.$7bV);this.$$d_$Bnz=Function.createDelegate(this,this.$Bnz);this.$$d_$Gf=Function.createDelegate(this,this.$Gf);this.$$d_$6nP=Function.createDelegate(this,this.$6nP);this.$$d_$6Wy=Function.createDelegate(this,this.$6Wy);_i.$xY.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$xY.initializeBase(this);this.$1Ow=new _i.$18d;this.$d=n;this.$85=t;this.$QD=new _C(this.$$d_$6Wy,_a.$0.$53);this.$XM=new _C(this.$$d_$6nP,_a.$0.$53);this.$8W=new _C(this.$$d_$Gf,_a.$0.$53);this.$1zI=new _C(_a.$c.$1Ja,_a.$0.$53);this.$187=new _C(this.$$d_$Bnz,_a.$0.$53);this.$34B=new _C(this.$$d_$7bV,_a.$0.$53)};_i.$xY.prototype={$d:null,$85:null,$QD:null,$XM:null,$8W:null,$1zI:null,$187:null,$34B:null,$1bp:!1,$1bq:!1,$1Io:!1,$1Ow:null,$6rS:null,$34C:null,$G7:!1,$DE:null,$48:null,get_$C6p:function(){return _a.$c.get_$2mc()?null:_i.$1.get_$A5c()},get_$8Qb:function(){return _a.$c.get_$2mc()?String.format(_nbs.NonBootStrings.l_Smime_MostRecentControlIsInstalled_Text,_a.$c.get_$5A()):String.format(_nbs.NonBootStrings.l_Smime_NewControlAvailable_Text,_a.$c.get_$5A())},get_$AYc:function(){return _a.$c.get_$2mc()?_u.Strings.l_Smime_ReinstallControlLabel_Text:_u.Strings.l_Smime_UpdateControlLabel_Text},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7lv:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},set_$AsQ:function(n){if(this.$1bp!==n){this.$1bp=n;this.$4("ForceEncryptMessage")}return n},set_$Asa:function(n){if(this.$1bq!==n){this.$1bq=n;this.$4("ForceSignMessage")}return n},set_$A5t:function(n){if(this.$1Io!==n){this.$1Io=n;this.$4("AllowUserChoiceOfSigningCertificate")}return n},set_$7d:function(n){if(this.$G7!==n){this.$G7=n;this.$4("IsBusy")}return n},$5N:function(){this.$DE()},$6Wy:function(){this.set_$7d(!0);if(this.$d.get_$VV()){this.set_$AsQ(this.$d.get_$VV().AlwaysEncrypt);this.set_$Asa(this.$d.get_$VV().AlwaysSign);this.set_$A5t(this.$d.get_$VV().AllowUserChoiceOfSigningCertificate)}this.$1Ow.$8aB(this.$1bp,this.$1bq,this.$1Io);this.$1Ow.set_$4cl(this.$d.get_$1j().get_$2ZN());this.$1Ow.set_$5ZB(this.$d.get_$1j().get_$2ZP());this.$1Ow.set_$7XA(!this.$d.get_$1j().get_$2oI());this.$1Ow.set_$3bM(this.$d.get_$1j().get_$2y0());this.$1Ow.set_$5Z9(this.$d.get_$1j().get_$2ZI());this.$6rS=this.$1Ow.$4s();this.set_$7d(!1)},$7Vt:function(n,t){if(n){(!this.$1bp||t)&&this.$d.get_$1j().set_$2ZN(n.get_$4cl());(!this.$1bq||t)&&this.$d.get_$1j().set_$2ZP(n.get_$5ZB());if(this.$1Io||t){this.$d.get_$1j().set_$2oI(!n.$2E8);if(!n.$2E8||t){this.$d.get_$1j().set_$2y0(n.get_$3bM());this.$d.get_$1j().set_$2ZI(n.$1i0)}}}t&&this.$d.get_$1j().$Hm.$AV()},$6nP:function(){if(!this.$G7){_js.Trace.logInfo(_a.$0.$53,"SmimeSettings Invoking OK");this.set_$7d(!0);this.$7Vt(this.$1Ow,!1);var t=this,n=this;var i=_h.$21.$4Vw(this.$d.get_$1j().$Hm,OwaApplication.$2B,function(){t.set_$7d(!1);t.$5N()},function(t){n.set_$7d(!1);n.$dt(_nbs.NonBootStrings.l_Smime_CannotSaveSettings_Text);_js.Trace.logException(_a.$0.$53,t.$2H,"Failed to save S/MIME settings.")});if(!i){this.set_$7d(!1);this.$5N();return}}},$Gf:function(){this.$7Vt(this.$6rS,!0);this.$5N()},$7bV:function(){if(!this.$G7){var n=this;_a.$c.$1A9.$6IH(null,function(t){var r=JsonParser.deserialize(t);if(r.ErrorCode){n.$dt(_u.Strings.l_Smime_CannotGetSubjectCertFromStore_Text);return}n.set_$7d(!0);n.$34C=r.Data;var i=new _h.$ld(200,n.$34C,!1);i.add_$2s(function(){if(i.get_$4d().IsValid){n.$1Ow.set_$3bM(_a.$c.$4p4(i.get_$4d().Subject));n.$1Ow.set_$5Z9(i.get_$4d().SubjectKeyIdentifier)}else{_js.Trace.logInfo(_a.$0.$53,"The chosen cert can't be used for signing.");n.$dt(_u.Strings.l_Smime_ChoosenCertificateIsInvalid_Text)}});i.add_$2b(function(t){_js.Trace.logException(_a.$0.$53,t.$2H,"Unabled to verify the chosen cert.");n.$dt(_u.Strings.l_Smime_CannotVerifyChoosenCertificate_Text)});i.add_$4Q(function(){n.set_$7d(!1)});OwaApplication.$2B.$1U(i)})}},$Bnz:function(){this.$85.$iT(9)},$dt:function(n){_a.$3m.$44(n,0)}};_i.$18d=function(){_i.$18d.initializeBase(this)};_i.$18d.prototype={$1bp:!1,$1bq:!1,$1Io:!1,$38g:!1,$3bK:!1,$1OZ:null,$1i0:null,$2E8:!1,get_$4cl:function(){return this.$38g||this.$1bp},set_$4cl:function(n){if(this.$38g!==n){this.$38g=n;this.$4("EncryptMessage")}return n},get_$5ZB:function(){return this.$3bK||this.$1bq},set_$5ZB:function(n){if(this.$3bK!==n){this.$3bK=n;this.$4("SignMessage")}return n},set_$7XA:function(n){if(this.$2E8!==n){this.$2E8=n;this.$4("AutoChooseCert")}return n},get_$3bM:function(){return _js.$9.$o(this.$1OZ)?_u.CommonStrings.l_None_Text:this.$1OZ},set_$3bM:function(n){if(this.$1OZ!==n){this.$1OZ=n;this.$4("SigningCertSubject")}return n},set_$5Z9:function(n){if(this.$1i0!==n){this.$1i0=n;this.$4("SigningCertSubjectKeyId")}return n},$8aB:function(n,t,i){this.$1bp=n;this.$1bq=t;this.$1Io=i},$4s:function(){var n=new _i.$18d;n.$1bp=this.$1bp;n.$1bq=this.$1bq;n.$1Io=this.$1Io;n.$38g=this.$38g;n.$3bK=this.$3bK;n.$2E8=this.$2E8;n.$1OZ=this.$1OZ;n.$1i0=this.$1i0;return n}};function DesktopViewModelsComponent(){}DesktopViewModelsComponent.prototype={$2FT:function(n,t,i){var u=this;n.$r(SettingsPanelFactory).$2a(ISettingsPanelFactory).$1I().$t(function(){return new SettingsPanelFactory(n.$2(_a.$2Y),n.$2(_g.$O),n.$2(_ff.$M),n.$2(_a.UserAgent),n.$2(IInferenceTracker),n.$36(ISyncFolderSettingProcessor),n.$2(_js.$3V),n.$2(_a.$1d),n.$2(IModuleHelpProvider))});var r=this;n.$r(_i.$LO).$2a(IThemesViewModel).$t(function(){return new _i.$LO(n.$2(_a.$2Y),_g.$O.get_$Q(),n.$2(_ff.$M))})},$Bl2:function(){return null}};_i.$1.registerClass("_i.$1");SettingsPanelViewModelBase.registerClass("SettingsPanelViewModelBase",ISettingsPanelViewModelBase,_y.$Ol);_i.$IG.registerClass("_i.$IG",SettingsPanelViewModelBase);_i.$vc.registerClass("_i.$vc",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);_i.$nu.registerClass("_i.$nu",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);SettingsPanelFactory.registerClass("SettingsPanelFactory",null,ISettingsPanelFactory);_i.$LO.registerClass("_i.$LO",SettingsPanelViewModelBase,IThemesViewModel,_js.$13p);_i.$xY.registerClass("_i.$xY",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);_i.$18d.registerClass("_i.$18d",_js.$Ec);DesktopViewModelsComponent.registerClass("DesktopViewModelsComponent",null,_a.$1X7);
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
