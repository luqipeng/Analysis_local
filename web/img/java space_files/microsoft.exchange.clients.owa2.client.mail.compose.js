try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$9oq=function(n,t,i){var o=n==="Mouse";var s=!(t.get_$Df()&&t.get_$gv().get_$5A()<9);var r=i.get_$4P().get_$CE();var e=!!r&&r.startsWith("en");var f=!!i.get_$b8()&&i.get_$b8().get_$5qf();var u=!!i.get_$1j()&&i.get_$1j().get_$1aZ();return o&&f&&u&&s&&e};MailComposeComponent.prototype={$2FT:function(n,t,i){var e=this;n.$r(_mcp.$mv).$2a(IMailComposeActionFactory).$1I().$t(function(){return new _mcp.$mv});var o=this;n.$r(_mcp.$14u).$2a(IMailResponseViewModelFactory).$1I().$t(function(){return new _mcp.$14u(n.$2(IInferenceTracker),n.$2(_g.$O),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mv),n.$3J(ISmimeCommandFactory))});var s=this;n.$r(IMailComposeContextFactory).$1I().$t(function(){return new _mcp.$1Ky(n.$2(_y.$my),n.$2(_a.$AE))});var r=this;n.$r(_mcp.$14q).$2a(IMailComposeViewModelFactory).$1I().$t(function(){var u=n.$2(_a.$t);var f=n.$2(_g.$2Z);var e=MailComposeComponent.$9oq(i.get_$AA(),u,f);var t=n.$2(_a.$1d);var r=i.get_$AA()==="Mouse"&&t.$2r("ComposeBread1");return new _mcp.$14q(n.$3J(IExtensibilityViewModelFactory),n.$2(_rw.$XO),e?n.$3J(IForgottenAttachmentDetectorFactory):null,n.$3J(IRichPeoplePickerViewModelFactory),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mv),n.$2(_pe.$Ch),n.$2(_y.$W),n.$3J(IOfflineHelpProvider),n.$2(_mcp.$uh),n.$2(_y.$Dp),n.$2(_ff.$M),n.$3J(IAttachmentWellViewModelFactory),t,n.$2(_a.$AE),n.$36(IAttachmentsFilePickerPanelViewModel),n.$2(IInferenceTracker),n.$2(_g.$Lo),n.$2(_a.$3G),n.$2(_g.$AM).get_$9xA(),n.$36(IMyLocationBuilder),n.$3J(IMailTipsHandlerFactory),n.$3J(IPolicyTipsHandlerFactory),i.get_$AA()==="Mouse"?n.$2(_cmc.$kS):null,r?n.$3J(ISendNotificationProviderViewModel):null,r?n.$3J(ISendFailureNotificationProviderViewModel):null,n.$3J(IFindRecipientMailComposeViewModelFactory),n.$36(IComponentOverrideFactory),n.$2(_g.$O).get_$2dq(),n.$3J(IIntroductionControllerFactory))});var u=this;n.$r(_mcp.$uh).$2a(IMailComposeDiscardManager).$1I().$t(function(){return new _mcp.$uh(n.$2(IMailComposeActionFactory))});var f=this;n.$r(_mcp.$mz).$t(function(){return new _mcp.$mz(window.document.createElement("div"),i.get_$AA(),n.$2(_a.$t),n.$2(_a.$AE),n.$2(_a.$1d),n.$2(_a.$3G))})},$Bl2:function(){return null}};_mcp.$sN=function(n){_mcp.$sN.initializeBase(this);this.$1kM=n};_mcp.$sN.prototype={$1kM:null,$6OS:function(n){var i=this.$u4();var t=new _g.$1DP(this.$2k);t.explicitLogonUser=this.$1kM.$Qc;$C(this.$1kM.$Hp)||t.actionName||(t.actionName=this.$1kM.$Hp);n.$7hx(i,t,this.$$d_$6qf,this.$$d_$1Mz)},$u4:function(){var t=this.$1kM.$AQd();var i=new _g.$ab(this.get_$7h());var n=new _g.$UI;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},$1Mz:function(n){_h.$1A3.prototype.$1Mz.call(this,n)},$wU:function(n){this.$1kM.$Dv4(n)}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.$Gn=function(n,t,i,r,u,f,e,o){this.$$d_$8QV=Function.createDelegate(this,this.$8QV);this.$$d_$Daj=Function.createDelegate(this,this.$Daj);this.$$d_$97i=Function.createDelegate(this,this.$97i);this.$$d_$DWC=Function.createDelegate(this,this.$DWC);this.$$d_$9tj=Function.createDelegate(this,this.$9tj);this.$$d_$1tX=Function.createDelegate(this,this.$1tX);this.$$d_$E6p=Function.createDelegate(this,this.$E6p);this.$$d_$DWs=Function.createDelegate(this,this.$DWs);this.$$d_$26l=Function.createDelegate(this,this.$26l);this.$$d_$1s1=Function.createDelegate(this,this.$1s1);this.$$d_$Bk0=Function.createDelegate(this,this.$Bk0);this.$$d_$8QO=Function.createDelegate(this,this.$8QO);this.$$d_$1Ph=Function.createDelegate(this,this.$1Ph);_mcp.$Gn.initializeBase(this,[5,n]);this.$3Y=i;this.$N6=u;this.$F1=t;this.$16L=new _C(this.$$d_$1Ph,this.get_$m());this.$1D=r;this.$5Bz=f;this.$tx=e;this.$CY=o};_mcp.$Gn.prototype={$3Y:null,$1D:null,$N6:null,$F1:null,$5Bz:null,$WK:null,$tx:null,$16L:null,$1dR:null,$4tD:null,$49u:null,$3vh:null,$4yw:!1,$rD:null,$1aE:null,$3zJ:!1,$9kF:!1,$CY:null,get_$Tg:function(){return this.$w(_mcp.$Gn.$24k)},set_$Tg:function(n){this.$P(_mcp.$Gn.$24k,n);return n},get_$8QQ:function(){this.$4tD||(this.$4tD=new _C(this.$$d_$8QO,this.get_$m()));return this.$4tD},add_$6nZ:function(n){this.$32("AttachmentWellInitialized",n)},remove_$6nZ:function(n){this.$5d("AttachmentWellInitialized",n)},get_$9Z:function(){return this.$w(_mcp.$Gn.$5mm)},set_$9Z:function(n){this.$P(_mcp.$Gn.$5mm,n);return n},get_$Q6:function(){return(this.get_$9Z()?this.get_$9Z().get_$Q6():!1)||(this.$WK?this.$WK.get_$E3X():!1)},get_$P3:function(){return this.get_$9Z()&&this.get_$9Z().get_$1m()?this.get_$9Z().get_$1m().get_$A()>0:!1},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1aE){_js.Trace.logInfo(_a.$0.$16,"Setting attachment component override");this.$1aE=this.$v.get_$4IH().$ALB();this.$1aE.$3e(this.$$d_$Bk0)}},$2F3:function(){if(this.$1aE){this.$1aE.$AV();this.$1aE=null}},$3e:function(){var t=this.$1n.$v.$c;this.$2xE();this.$8PO();var i=!t.get_$OV()||t.get_$3uZ();var r=t.get_$EW();var u=!((t.get_$6X()===4||t.get_$6X()===13)&&!this.$1D.get_$NE());if(this.get_$9Z()){this.get_$9Z().$5Lm(t.get_$Fd(),r,i,t.get_$D1(),t.get_$2E6());this.$7d7(t,i)}else{var n=this;this.$F1.$9(function(f){if(_y.$z.$1Q.get_$U()==="TouchNarrow")n.set_$9Z(f.$2Fu(t.get_$Fd(),r,i,u,t.get_$2E6(),!0,n.$1n.$v.$1d,t.get_$D1()));else{var e=f.$3kT(t.get_$Fd());e.set_$E(t.get_$j0());e.set_$CK(1);n.set_$9Z(f.$4Y2(e,r,i,_y.$z.$1Q.get_$U()==="Mouse"?3:0,u,t.get_$2E6(),!0,n.$1n.$v.$1d,t.get_$D1(),n.$1n.$v.$6R,n.$1n.$v.$mc))}n.get_$9Z().add_$1s1(n.$$d_$1s1);n.get_$9Z().add_$26l(n.$$d_$26l);n.get_$9Z().apcl("EditorCallContext",n.$$d_$DWs);var o=n.$1n.$5m(14);o&&n.get_$9Z().add_$7P2(o.$$d_$kN);n.$AQ("AttachmentWellInitialized",n);n.$7d7(t,i)})}},$Bk0:function(){return this.get_$9Z()},$DWs:function(n,t){if(t==="EditorCallContext"){var i=this.$1n.$5m(27);i.set_$Nf(this.get_$9Z().get_$Nf())}},$7Ew:function(n){this.$49u&&this.$49u.set_$17(!n)},$7El:function(n){this.$3vh&&this.$3vh.set_$17(!n)},$26l:function(n){if(_a.$5N.$43){var t=this;_js.$D.get_$Q().$6C(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5m(25);n.$2BU(8)})}},$1s1:function(){var i=this.$1n.$v;var n=i.$c;if(n.get_$Fd()){this.$4X8(n);this.get_$9Z()&&this.get_$9Z().$1NU(n.get_$Fd(),n.get_$EW(),n.get_$2E6())}else{var t=this.$1n.$5m(8);t.$2NE("Attach",this.$$d_$E6p,this.$$d_$1tX,!1)}},$iZ:function(){if(!this.$4yw&&this.get_$9Z()){var n=this.$1n.$v.$c;if(_y.$z.$1Q.get_$U()==="Mouse")this.get_$9Z().$1NU(n.get_$Fd(),n.get_$EW(),n.get_$2E6());else{_js.Trace.logInfo(_a.$0.$16,"Delaying attachment refresh because we're in not in mouse layout.");this.get_$9Z().$AU6(n.get_$Fd(),n.get_$EW(),n.get_$2E6(),this.$$d_$9tj)}this.$9tj();this.$1n.$v.$N.$1p(_y.$mw,new _y.$mw);this.$4yw=!0}},$9tj:function(){var n=this.$1n.$v.$c;if(n.$jW)if(n.get_$EW()){var t=new _js.$X;t.$3y(n.get_$EW().$3Q());n.$jW.set_$EW(t);n.get_$T9()&&n.get_$T9().set_$EW(t)}else{n.$jW.set_$EW(null);n.get_$T9()&&n.get_$T9().set_$EW(null)}},$AV:function(){var n=this.get_$9Z();if(n){n.remove_$1s1(this.$$d_$1s1);n.remove_$26l(this.$$d_$26l);n.rpcl("EditorCallContext",this.$$d_$DWs);_mcp.$3t.$Jx(this.$1n)}this.$4yw=!1;this.$2F3();_mcp.$14n.prototype.$AV.call(this)},$8Ui:function(){var n=_a.UserAgent.getInstance();return n.get_$8a()&&!!this.$3Y&&this.$1D.get_$NE()&&(this.$3Y.$2r("iOSSharePointRichTextEditor")&&n.get_$JM()||this.$3Y.$2r("AndroidCED")&&n.$YL)},$8Cw:function(){var n=[];var t=this.$1n.$5m(15);var i=this.$1n.$5m(22);if(t){t.$1aC.$3s&&Array.add(n,new _y.$2a(_u.CommonStrings.l_NewPhotoSubmenuItemText_Text,t.$1aC));t.$1aD.$3s&&Array.add(n,new _y.$2a(_u.CommonStrings.l_PhotoFromGallerySubmenuItemText_Text,t.$1aD));this.$2Nr()&&Array.add(n,new _y.$2a(this.$4n1(),this.$16L))}else if(i)Array.add(n,new _y.$2a(this.$4n1(),i.$5GH));else if(_a.UserAgent.getInstance().get_$32R()){Array.add(n,new _y.$2a(this.$4n1(),this.$16L));this.$1D.get_$ps()&&this.$1n.$v.$c.get_$6P()==="HTML"&&!_a.UserAgent.getInstance().get_$8a()&&Array.add(n,new _y.$2a(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,this.$1dR))}return n},$7Nv:function(){var n=this.$1n.$v.$c;if(!_js.$9.$o(n.get_$37U())&&!this.$3zJ&&n.get_$Fd()&&this.get_$9Z()){this.$3zJ=!0;var t=!1;try{this.get_$9Z().$A2n(n.get_$37U(),this.$$d_$DWC,this.$$d_$97i);t=!0}finally{t||(this.$3zJ=!1)}}},$Ez2:function(n){this.$tx&&this.get_$9Z()&&this.$tx.$9(this.get_$9Z(),this.get_$m()).$1Ph(n)},$1Ph:function(){var t=this.$1n.$v;var i=t.$c;_js.Trace.logInfo(_a.$0.$16,"Insert attachment start");if(this.$3Il()&&this.get_$9Z())if(this.$1aE)this.$1aE.$1GD(!1);else if(this.$2Nr()){var n=_a.$6.$1g(_a.$0.$1m,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$16,"Opening OWA's file picker");this.$5YP(n)}else{_js.Trace.logInfo(_a.$0.$16,"Opening OS's file picker");this.get_$9Z().$1GD(!1,null,null)}_js.Trace.logInfo(_a.$0.$16,"Insert attachment end")},$8QV:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$16,"Insert picture start");this.$3Il()&&this.get_$9Z()&&(this.$1aE?this.$1aE.$1GD(!0):this.get_$9Z().$1GD(!0,null,null));_js.Trace.logInfo(_a.$0.$16,"Insert picture end")},$8QO:function(){if(this.$WK)this.$8QP(this.$WK);else if(this.$5Bz){var n=this;this.$5Bz.$9(function(t){n.$WK=t;n.$8QP(n.$WK)})}},$8QP:function(n){_js.Trace.logInfo(_a.$0.$16,"Inserting location");var i=_a.$6.$1g(_a.$0.$sR,"BeamMeUpPlaceholderPopulated",!0);var t=this;n.$8QO(function(i){var r=t.$1n.$5m(27);r.set_$Nf(i);n.$A3G(t.get_$9Z(),i.get_$C6T())},this.$$d_$Daj,i)},$Daj:function(n){if(n){var t=this.$1n.$v;t.$2F.$44(0,n,null)}},$8PO:function(){if(!this.get_$Tg()){var n=[];var t=new _fm.$d(this.$4n1(),null,this.$16L,!1,null,_nbs.NonBootStrings.l_InsertAttachment_AT_MenuItem_Text);Array.add(n,t);if(this.$1D.get_$ps()){this.$1dR=new _C(this.$$d_$8QV,this.get_$m());this.$49u=new _fm.$d(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,null,this.$1dR,!1,null,_nbs.NonBootStrings.l_InsertPicture_AT_MenuItem_Text);Array.add(n,this.$49u);this.$7Ew(this.$1n.$v.$c.get_$6P()==="HTML");if(_a.UserAgent.getInstance().get_$8a()&&this.$3Y&&this.$3Y.$2r("iOSSharePointRichTextEditor")){this.$3vh=new _fm.$d(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,null,this.get_$8QQ(),!1,null,_nbs.NonBootStrings.l_InsertLocation_AT_MenuItem_Text);Array.add(n,this.$3vh)}this.$7El(this.$1n.$v.$c.get_$6P()==="HTML")}this.set_$Tg(new _fm.$1u(n))}},$7d7:function(n,t){this.get_$9Z().set_$6PT(!n.get_$OV());_js.Trace.logInfo(_a.$0.$16,"Attachment component initialized, ReadOnly={0}",t);n.get_$OV()&&this.$iZ();_mcp.$14n.prototype.$3e.call(this)},$4X8:function(n){n.get_$EW()||n.set_$EW(new _js.$X)},$3Il:function(){var t=this.$1n.$v;var n=t.$c;if($C(n)||!n.get_$OV()){_js.Trace.logInfo(_a.$0.$16,"Show not allowed to add attachment due to context="+(n?"non-null":"null")+"; Upgraded="+n.get_$OV());t.$2F.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0},$E6p:function(n){var i=this.$1n.$v;var t=i.$c;if(n.$99===t.get_$D1()){this.$4X8(t);this.get_$9Z()&&this.get_$9Z().$1NU(t.get_$Fd(),t.get_$EW(),t.get_$2E6());this.$7Nv()}},$1tX:function(n){var t=this.$1n.$v;var i=t.$c;if(this.get_$9Z()&&n.$99===i.get_$D1()){this.get_$9Z().$9MN();t.$2F.$44(0,_nbs.NonBootStrings.l_WarningFileCanNotBeAttachedDisconnected_Text,null);this.$7Nv()}},$5YP:function(n){if(this.$N6){var t=this;this.$N6.$9(function(i){t.$rD=i;if(t.$rD){var r=t.$v.$c.get_$6P()==="Text";t.$rD.$Li(t.get_$9Z(),n,r,t.$1n.$v.$sY,t.$1n.$v.$6R)}})}},$Dsr:function(){if(this.$2Nr()&&this.$N6){var n=this;this.$N6.$9(function(t){n.$rD=t;n.$rD&&n.$rD.$Dsp()})}},$2Nr:function(){return!!this.$1D&&!!this.$CY&&this.$1D.$4S6(this.$CY.AttachmentDataProviderAvailable)},$DWC:function(n){this.$1n.$v.$c.set_$37U(null);this.$97i(n)},$97i:function(n){n.remove_$1GC(this.$$d_$DWC);n.remove_$5GA(this.$$d_$97i);this.$3zJ=!1;this.$9kF&&this.$1n.$5m(7).$3XI()},$4n1:function(){return this.$2Nr()?_u.CommonStrings.l_AttachmentSubmenuItem_LowerCase_Text:_u.CommonStrings.l_AttachmentLegacySubmenuItem_LowerCase_Text}};_mcp.$1Ku=function(n,t,i){this.$$d_$A8y=Function.createDelegate(this,this.$A8y);this.$$d_$A8z=Function.createDelegate(this,this.$A8z);this.$$d_$DRb=Function.createDelegate(this,this.$DRb);this.$$d_$A8x=Function.createDelegate(this,this.$A8x);_mcp.$1Ku.initializeBase(this,[n,t,i]);this.$2BE=new _mcp.$1LB(this.$$d_$A8x,6e4)};_mcp.$1Ku.prototype={$2BE:null,$3e:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$16,"Enabling timer during initialization of auto save component");this.$2BE.$4yi=!0;if(!t.get_$4HB()){this.$1T();_js.Trace.logInfo(_a.$0.$16,"Auto save timer started")}_mcp.$Kn.prototype.$3e.call(this);n.$N.$1k(_a.$LY,this.$$d_$DRb)},$A8x:function(){var u=this.$1n;var r=u.$v;var n=r.$c;if(!n.get_$4HB()){if(!n.get_$6TI()){_js.Trace.logInfo(_a.$0.$16,"Auto Save not supported for the current operation {0}",n.get_$6X());return}var f=u.$5m(5);_js.Trace.logInfo(_a.$0.$16,"Checking dirty before auto save");var t=r.$IO();var i=f.get_$Q6();if(t&&!i){_js.Trace.logInfo(_a.$0.$16,"AutoSave:Context:"+n.toString());this.$2BE.$1u();this.$2NE("AutoSave",this.$$d_$A8z,this.$$d_$A8y,!1)}else{this.$2BE.$1T();_js.Trace.logInfo(_a.$0.$16,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},$1T:function(){var n=this.$1n.$v.$c;!n.get_$4HB()&&n.get_$6TI()&&this.$2BE.$1T()},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Disabling the timer on reset");this.$2BE.$37Z();var n=this.$1n.$v;n.$N.$4A(_a.$LY,this.$$d_$DRb);_mcp.$Kn.prototype.$AV.call(this)},$2A:function(){var n=this.$1n.$v;n.$N.$4A(_a.$LY,this.$$d_$DRb)},$DRb:function(n){_js.$D.get_$Q().$6C(_a.$0.$16,"Autosave triggered for PAL OnPause event",this.$$d_$A8x)},$A8z:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.get_$4HB()||this.$2BE.$1T()},$A8y:function(n){_js.Trace.logInfo(_a.$0.$16,"AutoSaveActionFailed: Error: {0}",n.$2H.message);this.$1n.$v.$c.get_$4HB()||this.$2BE.$1T()}};_mcp.$JQ=function(n){this.$$d_$EYW=Function.createDelegate(this,this.$EYW);this.$$d_$Eeh=Function.createDelegate(this,this.$Eeh);this.$$d_$DYh=Function.createDelegate(this,this.$DYh);this.$$d_$7N1=Function.createDelegate(this,this.$7N1);_mcp.$JQ.initializeBase(this,[3,n])};_mcp.$JQ.$7fW=function(n,t){return new _y.$2a(n,t)};_mcp.$JQ.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$JQ.prototype={$KO:null,$ta:null,$2O3:!1,$4HZ:null,$E6:null,$3HU:null,$2Ny:!1,set_$3xa:function(n){if(this.$2O3!==n){this.$2O3=n;this.$4("IsIrmProtected")}return n},set_$Eei:function(n){if(this.$4HZ!==n){this.$4HZ=n;this.$4("ShowIrmInformationCommand")}return n},set_$ny:function(n){if(this.$E6!==n){this.$E6=n;this.$4("DialogViewModel")}return n},$3e:function(){var n=this.$1n.$v;var u=n.$c;var o=n.$5w;var r=n.$l7;if(this.$5q6())if(_g.$1H.$Yv){_js.Trace.logInfo(_a.$0.$16,"Checking main window for compliance configuration");this.$ta=_mcp.$JQ.$6Wt;_g.$1H.$Yv.$BpT(this.$$d_$7N1)}else if(r.WasLoadedFromServer)this.$7N1(r);else{_js.Trace.logInfo(_a.$0.$16,"Adding the loading permissions menu item");this.$ta=_mcp.$JQ.$6Wt;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$16,"Submitting GetComplianceConfigurationAction");var e=n.$N;e.$1k(_a.$V9,this.$$d_$DYh);var s=new _h.$V8(r,n.$N);s.$11()}}else if(this.$ta&&this.$2Ny&&o.$1a){n.$5w.$5MW(this.$ta);this.$2Ny=!1}var t=u.get_$9i();this.set_$3xa(!!t&&!t.get_$RG());if(this.$2O3&&"Mouse"===_y.$z.$1Q.get_$U()){var i=n.$1aw();i.$4r.apply(i,[4499].concat([t.get_$2yu(),t.get_$2ys()]));i.$4r.apply(i,[4500].concat([t.get_$2Fa()]))}else if(u.get_$a7()){var f=n.$1aw();f.$4r.apply(f,[3800].concat([u.get_$h0(),u.get_$eW()]))}"Mouse"===_y.$z.$1Q.get_$U()||this.$4HZ||this.set_$Eei(new _C(this.$$d_$Eeh,this.get_$m()));_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.set_$3xa(!1);_mcp.$14n.prototype.$AV.call(this)},$5q6:function(){var i=_g.$O.get_$Q();if(!$C(i.get_$9N())&&!i.get_$9N().get_$3vy()){_js.Trace.logInfo(_a.$0.$16,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$1n.$v.$c.get_$9i();var t=!n||!!n.get_$RG()||n.get_$KU()||n.get_$4e0();_js.Trace.logInfo(_a.$0.$16,"CanSetCompliance="+t);return t},$3km:function(n,t){var i=this.$1n.$v.$l7;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$16,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var e=0;r[e++]=t(_nbs.NonBootStrings.l_NoRestriction_Text,new _C(this.$$d_$EYW,this.get_$m()));for(var f=0,u=0;f<o||u<s;)if(f===o){var l=i.MessageClassifications[u++];r[e++]=t(l.Name,new _C(this.$7fu(l.Id),this.get_$m()))}else if(u===s){var a=i.RmsTemplates[f++];r[e++]=t(a.Name,new _C(this.$7h5(a.Id),this.get_$m()))}else{var h=i.MessageClassifications[u];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[e++]=t(h.Name,new _C(this.$7fu(h.Id),this.get_$m()));u++}else{r[e++]=t(c.Name,new _C(this.$7h5(c.Id),this.get_$m()));f++}}return r},$2Fv:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var i=this.$3km(_fm.$d,_mcp.$JQ.$4Xd);i&&(this.$KO=new _fm.$1u(i))}else if(!this.$2Ny){if(!this.$ta){var r=this.$3km(_y.$2a,_mcp.$JQ.$7fW);r&&(this.$ta=new _y.$2a(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r))}if(this.$ta){var u=this.$1n.$v.$5w;var t=u.$1a;if(t)for(var n=0;n<t.length;n++)if(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text===t[n].$3V){u.$4PT(this.$ta,n+1);this.$2Ny=!0}}}},$DYh:function(n){var t=this.$1n.$v;this.$7N1(t.$l7);t.$N.$4A(_a.$V9,this.$$d_$DYh)},$7N1:function(n){var r=this.$1n.$v;r.$l7=n;_js.Trace.logInfo(_a.$0.$16,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$z.$1Q.get_$U()){this.$ta&&r.$5w.$5MW(this.$ta);this.$ta=null;this.$2Ny=!1}n.WasLoadedFromServer&&this.$2Fv();if("Mouse"===_y.$z.$1Q.get_$U()){var t=this.$1n.$5m(18);if(t.get_$Tg()){var i=t.$3Ec(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text);i>=0&&t.get_$Tg().$1a.$5W(i);n.WasLoadedFromServer&&t.$A4Y()}}},$EYW:function(){var i=this.$1n.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$16,"Set no restriction");n.set_$h4("0");var t=i.$1aw();if($C(n.get_$9i())){if(n.get_$a7()){t.$9U(3800);n.set_$a7(!1);n.set_$h0(null);n.set_$eW(null);n.set_$l4(null)}}else{if("Mouse"===_y.$z.$1Q.get_$U()){t.$9U(4499);t.$9U(4500)}n.set_$9i(null);this.set_$3xa(!1)}},$7h5:function(n){var t=this;return function(){_a.$6.stPT(_a.$0.$16,"MailComposeSetIRM",3);var h=_a.$6.$1g(_a.$0.$16,"MailComposeSetIRM",!0);var e=t.$1n.$v;var r=e.$c;r.set_$h4(n);if(r.get_$a7()){e.$1d.$9U(3800);_mcp.$3t.$Jx(t.$1n);r.set_$a7(!1);r.set_$h0(null);r.set_$eW(null);r.set_$l4(null)}for(var s=e.$l7.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var i=new _g.$gn;i.set_$70v(n);i.set_$2Fa(_g.$O.get_$Q().get_$4P().get_$Fv());i.set_$KU(!0);i.set_$RG(0);i.set_$2yu(u.Name);i.set_$2ys(u.Description);i.set_$6P(r.get_$6P());r.set_$9i(i);if("Mouse"===_y.$z.$1Q.get_$U()){var f=e.$1aw();f.$9U(4499);f.$9U(4500);f.$4r.apply(f,[4499].concat([u.Name,u.Description]));f.$4r.apply(f,[4500].concat([i.get_$2Fa()]))}t.set_$3xa(!0);_js.Trace.logInfo(_a.$0.$16,"Set IRM "+u.Name);break}}_a.$6.$1G(h);_a.$6.endPT("MailComposeSetIRM")}},$7fu:function(n){var t=this;return function(){var u=t.$1n.$v;var r=u.$c;r.set_$h4(n);if(!$C(r.get_$9i())&&"Mouse"===_y.$z.$1Q.get_$U()){var s=u.$1aw();s.$9U(4499);s.$9U(4500);r.set_$9i(null);t.set_$3xa(!1)}for(var o=u.$l7.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){r.set_$a7(!0);r.set_$h0(i.Name);r.set_$eW(i.Description);r.set_$l4(i.Id);var e=u.$1aw();e.$9U(3800);e.$4r.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.$0.$16,"Set class "+i.Name);break}}}},$Eeh:function(){var t=this.$1n.$v.$c;if(t.get_$9i()){var n=t.get_$9i();this.$Eej(n.get_$2yu(),n.get_$2ys(),n.get_$2Fa())}else _js.Trace.logError(_a.$0.$16,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},$Eej:function(n,t,i){if($C(this.$E6)){this.set_$ny(new _bc.$DH);this.$E6.$9B.$F(new _ff.$1l(this.$E6.$5a,_nbs.NonBootStrings.l_Close1_Text))}this.$E6.set_$3u(n);$C(this.$3HU)&&(this.$3HU=new _mcp.$147);this.$3HU.set_$iw(t);this.$3HU.set_$AJe(String.format(_nbs.NonBootStrings.l_IrmConversationOwner_Text,i));this.$E6.set_$FD(this.$3HU);this.$E6.set_$1C(!0)}};_mcp.$14n=function(n,t){_mcp.$14n.initializeBase(this);this.$7dY=n;this.$1n=t;if(t&&t.$v){this.$v=t.$v;this.$c_2=this.$v.$c;this.$vE=this.$v.$1d}};_mcp.$14n.prototype={$7dY:0,$1n:null,$v:null,$c_2:null,$vE:null,$A9:!1,get_$G8:function(){return this.$A9},set_$G8:function(n){this.$A9=n;return n},get_$m:function(){return _a.$0.$16},$3e:function(){this.$A9=!0},$AV:function(){this.$A9=!1},$5jV:function(n){var t=this.$6GJ(n);this.$vE.$4r(t,null);if(t===55||t===50){var i=this;this.$v.$2TK.$9(function(n){n.$7SJ(i.$vE);_mcp.$3t.$Jx(i.$1n)})}else _mcp.$3t.$Jx(this.$1n)},$3gR:function(n){this.$vE.$2D5(n);_mcp.$3t.$Jx(this.$1n)},$7Sj:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.$vE).$eI.apply(r,[t,n].concat(u));_mcp.$3t.$Jx(this.$1n)},$3VU:function(){this.$vE.$E2K();this.$vE.$ag(_mcp.$Kn.$wR);this.$vE.$ag(_mcp.$G6.$wR);this.$vE.$ag(_mcp.$MZ.$wR);var n=this;this.$v.$2TK.$9(function(t){t.$E0y(n.$vE);_mcp.$3t.$Jx(n.$1n)})},$7DG:function(){if(!this.$c_2.$jW)return!0;_js.Trace.logInfo(_a.$0.$16,"Comparing initial baseline to baseline. Context:"+this.$c_2.toString());if(!this.$c_2.$jW.$5b(this.$c_2.get_$T9()))return!0;_js.Trace.logInfo(_a.$0.$16,"Checking dirty before showing discard confirmation.");return this.$v.$IO()?!0:this.$c_2.get_$1TQ()?!0:!1},$6GJ:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.$1Kw=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$AG2=Function.createDelegate(this,this.$AG2);this.$$d_$EWF=Function.createDelegate(this,this.$EWF);this.$$d_$E47=Function.createDelegate(this,this.$E47);this.$$d_$C4O=Function.createDelegate(this,this.$C4O);this.$2FO=[];this.$5sX=new _mcp.$1Kv(this,t,i,r,u,f,e,o,s,h,c,l);this.$v=n};_mcp.$1Kw.prototype={$2FO:null,$v:null,$5sX:null,$5m:function(n){var t=n;$C(this.$2FO[t])&&(this.$2FO[t]=this.$5sX.$ALx(n,this.$v.$I.get_$U()));return this.$2FO[t]},$3e:function(){this.$4fg(this.$$d_$C4O)},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map Reset start.");this.$4fg(this.$$d_$E47,!0);_js.Trace.logInfo(_a.$0.$16,"Component Map Reset end.")},$2xE:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map set override start.");this.$4fg(this.$$d_$EWF);_js.Trace.logInfo(_a.$0.$16,"Component Map set override end.")},$2F3:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map clear override start.");this.$4fg(this.$$d_$AG2);_js.Trace.logInfo(_a.$0.$16,"Component Map clear override end.")},$4fg:function(n,t){if($C(t)||!t)for(var r=0;r<this.$2FO.length;r++)this.$9Fg(n,r);else for(var i=this.$2FO.length-1;i>=0;i--)this.$9Fg(n,i)},$9Fg:function(n,t){var i=this.$2FO[t];$C(i)||n(i,t)},$C4O:function(n,t){_mcp.$14o.isInstanceOfType(n)||n.get_$G8()||n.$3e()},$E47:function(n,t){var i=Object.getType(n).getName();if(n.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"Reset "+i+" at index "+t);n.$AV()}else _js.Trace.logInfo(_a.$0.$16,"Skip uninitialized "+i+" at index "+t)},$EWF:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2xE()},$AG2:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2F3()}};_mcp.$1Kx=function(n,t){this.$$d_$EpH=Function.createDelegate(this,this.$EpH);this.$$d_$EpC=Function.createDelegate(this,this.$EpC);this.$$d_$EpG=Function.createDelegate(this,this.$EpG);_mcp.$1Kx.initializeBase(this,[17,n]);this.$6R=t};_mcp.$1Kx.prototype={$5cd:null,$5cj:null,$7I7:null,$7I5:null,$6R:null,$1xJ:null,set_$7I8:function(n){this.$7I7=n;this.$4("SwitchToPlainTextContent");return n},set_$7I6:function(n){this.$7I5=n;this.$4("SwitchToHtmlContent");return n},$3e:function(){this.$5cj||(this.$5cj=new _C(this.$$d_$EpG,this.get_$m()));this.$5cd||(this.$5cd=new _C(this.$$d_$EpC,this.get_$m()));_mcp.$14n.prototype.$3e.call(this)},$EpG:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to plain text");if(this.$8TG(_nbs.NonBootStrings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$1n.$v.$c.get_$3sY().$11();var r=this.$1n.$v.$c.get_$MW();var n;var i,t;var f=(t=_a.$1J.$4Wn(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.get_$m(),"Using html due to failed conversion")}if(n.length>0){var u=this.$1n.$v.$2F;u.$RN(1,[_nbs.NonBootStrings.l_ConvertToPlainTextWarning_Text],this.$$d_$EpH,!1,null,null,null,this.$6R)}else this.$8Rc()}},$EpH:function(n,t){n&&this.$8Rc()},$8Rc:function(){var t=null;var i,r;if(r=_a.$1J.$1yO(_a.UserAgent.getInstance(),this.$1n.$v.$c.get_$MW(),i={val:t}),t=i.val,r){if(this.$1xJ&&this.$1xJ.$3s){this.$1xJ.$11();this.$1xJ=null}this.$1n.$v.$c.set_$do(t);this.set_$7I8(t);this.set_$7I8(null);this.$1n.$v.get_$1kA().get_$G8()&&this.$1n.$v.get_$1kA().$9mF();var n=this.$1n.$5m(5);n.$7Ew(!1);n.$7El(!1);n.get_$9Z()&&n.get_$9Z().$Eee();this.$1n.$v.$c.set_$6P("Text");_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")},$EpC:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to html");if(this.$8TG(_nbs.NonBootStrings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var u=this.$1n;var n=u.$v;var t=n.$c;t.get_$8JK().$11();var f=n.$c.get_$1vc();t.set_$6P("HTML");var i=_a.$1J.$1yP(f);t.set_$do(i);this.set_$7I6(i);this.set_$7I6(null);n.get_$1kA().$9mG();var r=u.$5m(5);r.$7Ew(!0);r.$7El(!0);_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},$8TG:function(n){_js.Trace.logInfo(this.get_$m(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.$1n.$v.$c.get_$OV()){this.$1n.$v.$2F.$44(0,n,null);_js.Trace.logInfo(this.get_$m(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}};_mcp.$Ow=function(n){_mcp.$Ow.initializeBase(this,[18,n]);this.$6q=_g.$O.get_$Q().get_$1j();this.$c=this.$1n.$v.$c};_mcp.$Ow.prototype={$4K8:null,$4K7:null,$6q:null,$c:null,get_$Tg:function(){return this.$w(_mcp.$Ow.$24k)},set_$Tg:function(n){this.$P(_mcp.$Ow.$24k,n);return n},$9mF:function(){this.$4K7.set_$17(!1);this.$4K8.set_$17(!0)},$9mG:function(){this.$4K7.set_$17(!0);this.$4K8.set_$17(!1)},$3e:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var t=[];var n;if(this.$c.get_$6X()!==8&&!this.$c.get_$1El()&&!_y.$z.$1Q.get_$lN()){var e=this.$1n.$5m(8);n=new _fm.$d(_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,null,e.$E0);Array.add(t,n)}var i=this.$1n.$5m(1);if(!this.$c.get_$1El()){n=new _fm.$d(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$4HI);_g.$O.get_$Q().get_$1j().get_$1Ip()&&n.set_$17(!0);Array.add(t,n);n=new _fm.$d(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,null,i.$4qx);_g.$O.get_$Q().get_$1j().get_$1Ip()||n.set_$17(!0);Array.add(t,n)}if(this.$c.get_$3Jg()||this.$c.get_$s0()){var l=this.$1n.$5m(1);n=new _fm.$d(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$3as);(_g.$O.get_$Q().get_$1j().get_$tY()||this.$c.get_$ow())&&n.set_$17(!0);Array.add(t,n);i.$3as.set_$87(!this.$c.get_$s0());n=new _fm.$d(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,null,i.$4r8);_g.$O.get_$Q().get_$1j().get_$tY()||this.$c.get_$ow()||n.set_$17(!0);Array.add(t,n)}if(!this.$c.get_$1El()&&!_y.$z.$1Q.get_$lN()){n=new _fm.$d(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$1Nc);Array.add(t,n)}var f=this.$1n.$5m(6);if(!$C(f.$KO)){n=new _fm.$CN(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,f.$KO);Array.add(t,n)}var r=this.$1n.$5m(3);if(r.$KO){n=new _fm.$CN(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r.$KO);Array.add(t,n)}else if(r.$5q6()&&this.$1n.$v.$l7.IsLoadingFromServer){n=new _fm.$d(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$z.$1Q.get_$lN()){var c=this.$1n.$5m(12);var h=this.$1n.$5m(5);n=new _fm.$d(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,null,c.$4Pj);n.set_$4E(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text);h.get_$Tg().$1a.$F(n)}var u=this.$1n.$5m(17);this.$4K8=new _fm.$d(_nbs.NonBootStrings.l_ConvertToPlainText_LowerCase_Text,null,u.$5cj);Array.add(t,this.$4K8);this.$4K7=new _fm.$d(_nbs.NonBootStrings.l_ConvertToHtml_Text,null,u.$5cd,!0);Array.add(t,this.$4K7);this.$c.get_$6P()==="HTML"?this.$9mG():this.$9mF();if(!this.$c.get_$1El()){var o=this.$1n.$5m(10);n=new _fm.$d(_nbs.NonBootStrings.l_ShowMessageOptions_Text,null,o.$3b1);Array.add(t,n)}var s=this.$1n.$5m(18);s.set_$Tg(new _fm.$1u(t))}_mcp.$14n.prototype.$3e.call(this)},$7NW:function(){var t=this.get_$Tg().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text));var n=this.get_$Tg().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$1LS());n.set_$17(!this.$c.get_$1LS())},$7NX:function(){var t=this.get_$Tg().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text));var n=this.get_$Tg().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$ow());n.set_$17(!this.$c.get_$ow())},$3Ec:function(n){var i=this.get_$Tg().$1a;if(i)for(var t=0;t<i.get_$A();t++)if(n===i.get_$E(t).$3V)return t;return-1},$A4Y:function(){var t=this.$1n.$5m(3);if(!$C(t.$KO)){var n=this.$3Ec(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text);if(n>=0){var i=new _fm.$CN(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,t.$KO);this.get_$Tg().$1a.$6i(n+1,i)}}}};_mcp.$1Kz=function(n){this.$$d_$4r3=Function.createDelegate(this,this.$4r3);this.$$d_$5yo=Function.createDelegate(this,this.$5yo);this.$$d_$Edw=Function.createDelegate(this,this.$Edw);_mcp.$1Kz.initializeBase(this,[21,n]);this.$Fp=new _C(this.$$d_$Edw,this.get_$m());this.$Lx=n.$v.$Lx};_mcp.$1Kz.prototype={$Fp:null,$Lx:null,$1kw:null,$233:!1,set_$5yq:function(n){if(n!==this.$1kw){this.$1kw=n;this.$4("DiscardConfirmDialogButtonData")}return n},set_$2lq:function(n){if(n!==this.$233){this.$233=n;this.$4("IsDiscardConfirmDialogShown")}return n},$5yo:function(){var i=this.$1n;var t=i.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$16,"Discard and close");t.set_$1Ei(!0);if(n.get_$6X()||!n.get_$6X()&&(n.get_$Fd()||t.get_$1XF().get_$G9())){_js.Trace.logInfo(_a.$0.$16,"Discard");this.$4b0(n.get_$D1(),n.get_$Fd())}n.set_$T9(null);var r=i.$5m(2);r.get_$5F().$2Si(t,!1);_js.Trace.logInfo(_a.$0.$16,"Navigated away from compose")},$5Nk:function(n,t){if(this.$Lx.$1EM(n)){_js.Trace.logInfo(_a.$0.$16,"Resuming discard of "+_h.$D1.$1d1(t));this.$4b0(n,t)}else _js.Trace.logInfo(_a.$0.$16,"User had already discarded.")},$4b0:function(n,t){this.$4r3();var i=this.$1n.$v;var r=i.$c.get_$23K()||i.$c.get_$1TQ();this.$Lx.$5yr(n,t,i.$n,r)},$Edw:function(){var t=this.$1n.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$16,"User chose to discard");if(this.$7DG()){this.$9jZ();_js.Trace.logInfo(_a.$0.$16,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$2lq(!0)}else{_js.Trace.logInfo(_a.$0.$16,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$5yo()}},$4r3:function(){_js.Trace.logInfo(_a.$0.$16,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$1n.$v.$c.toString());this.set_$2lq(!1)},$9jZ:function(){if($C(this.$1kw)){_js.Trace.logInfo(_a.$0.$16,"Creating discard confirm dialog.");var n=new _js.$X;n.$F(new _ff.$1l(new _C(this.$$d_$5yo,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$4r3,this.get_$m()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5yq(n)}}};_mcp.$1L0=function(n){this.$$d_$6IU=Function.createDelegate(this,this.$6IU);this.$$d_$BoV=Function.createDelegate(this,this.$BoV);this.$$d_$2k4=Function.createDelegate(this,this.$2k4);_mcp.$1L0.initializeBase(this,[27,n]);this.$1T3=new _C(this.$$d_$2k4,_a.$0.$16);this.$6Gq=new _C(this.$$d_$BoV,_a.$0.$16);this.$3tD=new _C(this.$$d_$6IU,_a.$0.$16);var t=n.$v.$c;t.set_$BsP(this.$1T3);t.set_$3sY(this.$6Gq);t.set_$8JK(this.$3tD)};_mcp.$1L0.prototype={$1T3:null,$6Gq:null,$3tD:null,$r4:null,set_$Nf:function(n){this.$r4=n;this.$4("EditorCallContext");return n},$2k4:function(){var n=new _cmc.$s7(!1,!1);this.set_$Nf(n)},$BoV:function(){var n=new _cmc.$s7(!0,!1);this.set_$Nf(n)},$6IU:function(){var n=new _cmc.$s7(!1,!0);this.set_$Nf(n)}};_mcp.$eU=function(n){this.$$d_$EYK=Function.createDelegate(this,this.$EYK);this.$$d_$EYX=Function.createDelegate(this,this.$EYX);this.$$d_$EXf=Function.createDelegate(this,this.$EXf);_mcp.$eU.initializeBase(this,[6,n])};_mcp.$eU.$7fW=function(n,t){return new _y.$2a(n,t)};_mcp.$eU.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$eU.prototype={$KO:null,$ta:null,$6Qm:!1,$4x7:!1,$6Ra:!1,set_$CBE:function(n){if(n!==this.$6Qm){this.$6Qm=n;this.$4("IsHighImportance")}return n},set_$CD3:function(n){if(n!==this.$4x7){this.$4x7=n;this.$4("IsNormalImportance")}return n},set_$CCO:function(n){if(n!==this.$6Ra){this.$6Ra=n;this.$4("IsLowImportance")}return n},$3e:function(){var i=this.$1n.$v.$c.get_$Bv();this.$5Vd(i);_js.Trace.logInfo(_a.$0.$16,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.$z.$1Q.get_$U()){if(!this.$KO){var t=this.$3km(_fm.$d,_mcp.$eU.$4Xd);t&&(this.$KO=new _fm.$1u(t))}}else if(!this.$ta){var n=this.$3km(_y.$2a,_mcp.$eU.$7fW);n&&(this.$ta=new _y.$2a(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,n))}_mcp.$14n.prototype.$3e.call(this)},$EXf:function(){var n=_a.$6.$1g(_a.$0.$16,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$16,"User sets high importance");this.$5Vd("High");_a.$6.$1G(n)},$EYX:function(){_js.Trace.logInfo(_a.$0.$16,"User sets normal importance");this.$5Vd("Normal")},$EYK:function(){var n=_a.$6.$1g(_a.$0.$16,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$16,"User sets low importance");this.$5Vd("Low");_a.$6.$1G(n)},$5Vd:function(n){this.$1n.$v.$c.set_$Bv(n);this.set_$CBE("High"===n);this.set_$CD3("Normal"===n);this.set_$CCO("Low"===n)},$3km:function(n,t){return[t(_nbs.NonBootStrings.l_HighImportanceButtonText_Text,new _C(this.$$d_$EXf,this.get_$m())),t(_nbs.NonBootStrings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$EYX,this.get_$m())),t(_nbs.NonBootStrings.l_LowImportanceButtonText_Text,new _C(this.$$d_$EYK,this.get_$m()))]}};_mcp.$1L3=function(n,t){this.$$d_$4aw=Function.createDelegate(this,this.$4aw);this.$$d_$7CC=Function.createDelegate(this,this.$7CC);this.$$d_$7Ep=Function.createDelegate(this,this.$7Ep);this.$$d_$7Fd=Function.createDelegate(this,this.$7Fd);_mcp.$1L3.initializeBase(this,[26,n]);this.$Sc=_h.$3s.$6Gt(t)};_mcp.$1L3.prototype={$rc:null,$24J:null,$Sc:!1,$1YY:!1,$1YW:!1,$1Zi:null,$1W3:null,$ck:null,$c7:null,$Va:null,set_$2O9:function(n){if(n!==this.$Sc){this.$Sc=n;this.$4("IsLinkPreviewEnabled")}return n},set_$4o7:function(n){if(n!==this.$rc){this.$rc=n;this.$7HH()}return n},set_$1ZX:function(n){if(n!==this.$Va){this.$Va=n;this.$4("VideoPlayerHtmlLookup")}return n},set_$3LC:function(n){this.$24J=n;this.$4("LinkPreviewResponse");return n},set_$1wT:function(n){if(n!==this.$ck){this.$ck=n;this.$ck&&_h.$3s.$3Fl(this.$ck,null,this.$$d_$7Fd,null)}return n},set_$1rz:function(n){if(n!==this.$c7){this.$c7=n;this.$c7&&_h.$3s.$3Fl(this.$c7,null,this.$$d_$7Ep,null)}return n},set_$3bI:function(n){if(this.$1YY!==n){this.$1YY=n;this.$4("ShowYouTubePlayer")}return n},set_$3b5:function(n){if(this.$1YW!==n){this.$1YW=n;this.$4("ShowOEmbedVideoPlayer")}return n},set_$7Q4:function(n){this.$1Zi=n;this.$4("YouTubePlayerUrl");return n},set_$3Rn:function(n){this.$1W3=n;this.$4("OEmbedVideoPlayerHtml");return n},$7HH:function(){if(_h.$3s.$3vz){_js.Trace.logInfo(_a.$0.$6c,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.$rc.Url);this.$4aw();return}if(this.$rc){var i=1;var r=_a.$6.$1g(_a.$0.$6c,"GetComposeLinkPreview",!0);var n=[];Array.add(n,this.$rc);_js.Trace.logInfo(_a.$0.$6c,"Preparing GetLinkPreview action for {0}",this.$rc.Url);this.$rc.Autoplay=!0;var u=new _h.$3s(this.$rc);_js.Trace.logInfo(_a.$0.$6c,"Submitting GetLinkPreview action for {0}",this.$rc.Url);var t=this,f=this;this.$1n.$v.$n.$tE(u,function(u){_h.$3s.$9hj(u,t.$$d_$7CC,t.$$d_$4aw,i,r,"GetComposeLinkPreview",n)},function(t){_h.$3s.$7ox(t,i,r,"GetComposeLinkPreview",n)},null)}},$7CC:function(n){this.set_$3LC(n)},$4aw:function(){this.set_$2O9(!1)},$7Fd:function(n){this.set_$7Q4(n);this.set_$3bI(!!this.$1Zi)},$7Ep:function(n){var t=this.$6Ip(n);t?this.set_$3Rn(t):this.set_$3Rn(n);this.set_$3b5(!!this.$1W3)},$6Ip:function(n){return n in this.$Va?this.$Va[n]:null}};_mcp.$eT=function(n){_mcp.$eT.initializeBase(this,[16,n])};_mcp.$eT.prototype={$1d:null,$3jw:0,$1Q3:null,$3e:function(){_mcp.$14n.prototype.$3e.call(this);this.$1Q3=this.$BoC();var n=this.$1n.$v;this.$1d=n.$1aw();this.$3jw=n.$c.get_$6X();_mcp.$7y.$8XW(n.$c)&&!n.$c.get_$6TH()&&this.$1IV()},$1IV:function(){this.$1d.$ag(_mcp.$eT.$3Tw);this.$7sj()},$BoC:function(){var n=this.$1n.$v.$c;var t=n.get_$IV()||n.get_$j0();return t&&n.get_$oy()?t:null},$Boj:function(){if(_g.$2g.isInstanceOfType(this.$1Q3))return this.$1Q3.get_$Vh();else if(_g.$Mf.isInstanceOfType(this.$1Q3)){var n=this.$1Q3;return n.get_$Q4().get_$Vh()==="RecurringMaster"?n.get_$Q9()?"RecurringMaster":"Occurrence":n.get_$Q4().get_$Vh()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.$1Q3).getName());},$7sj:function(){if(this.$1Q3){this.$Aty();if(!_g.$Mg.isInstanceOfType(this.$1Q3)){this.$1d.$4r(6800);switch(this.$Boj()){case"Occurrence":case"Exception":this.$Au3();break;case"RecurringMaster":this.$Atw();break}}}},$BoR:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:t=3210;break;case 6:t=3215;break;case 7:t=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},$BoS:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:t=3110;break;case 6:t=3115;break;case 7:t=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},$Atw:function(){var n=this.$BoS(this.$3jw);this.$1d.$4r(n)},$Au3:function(){var i=new _cc.$To;var t=i.$4L(this.$1Q3,null);var n=this.$BoR(this.$3jw);this.$1d.$4r(n,t)},$Aty:function(){if(_g.$9y.isInstanceOfType(this.$1Q3)){var t=this.$1Q3;var i=t.get_$4ux()&&!!t.get_$2VP();if(i){var n=-1;switch(this.$3jw){case 5:n=3250;break;case 7:n=3260;break;case 6:n=3255;break}n!==-1&&this.$1d.$4r(n,t.get_$2VP().Mailbox.Name)}}}};_mcp.$14o=function(n,t,i){this.$$d_$BtG=Function.createDelegate(this,this.$BtG);this.$$d_$DYl=Function.createDelegate(this,this.$DYl);this.$$d_$Aoe=Function.createDelegate(this,this.$Aoe);this.$$d_$lF=Function.createDelegate(this,this.$lF);this.$$d_$6N9=Function.createDelegate(this,this.$6N9);this.$$d_$Aqb=Function.createDelegate(this,this.$Aqb);this.$$d_$DZ8=Function.createDelegate(this,this.$DZ8);this.$$d_$95c=Function.createDelegate(this,this.$95c);this.$$d_$DZ7=Function.createDelegate(this,this.$DZ7);this.$$d_$3Rq=Function.createDelegate(this,this.$3Rq);this.$$d_$DYk=Function.createDelegate(this,this.$DYk);this.$$d_$DUq=Function.createDelegate(this,this.$DUq);this.$$d_$DWu=Function.createDelegate(this,this.$DWu);_mcp.$14o.initializeBase(this,[0,n]);this.$Lx=n.$v.$Lx;this.$1D=t;this.set_$5q1(!0);this.$6R4=i};_mcp.$14o.prototype={$Lx:null,$4yC:!1,$4UR:!1,$5fa:!1,$63e:null,$72K:null,$40T:null,$1D:null,$6R4:!1,$2N2:null,get_$G8:function(){return _mcp.$14n.prototype.get_$G8.call(this)},set_$G8:function(n){if(n!==_mcp.$14n.prototype.get_$G8.call(this)){_mcp.$14n.prototype.set_$G8.call(this,n);this.$4("IsInitialized")}this.$1n.$v.$c.set_$CGI(n);return n},set_$8X2:function(n){if(n!==this.$4yC){this.$4yC=n;this.$4("IsSecondInitializationComplete")}return n},set_$5q1:function(n){if(this.$4UR!==n){this.$4UR=n;this.$4("CanLoadPopoutSuccessfully")}return n},$2F3:function(){if(this.$2N2){this.$2N2.$AV();this.$2N2=null}},$3e:function(){this.$63e=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.FirstInit",!0);var i=this.$1n.$v;var n=i.$c;n.$p("IsEditorReady",this.$$d_$DWu);if(!n.$jW&&!n.get_$Fd()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$jW=_mcp.$1W.$33t(n);n.get_$23e()||n.set_$1Oz(!0)}if(n.get_$rt()){_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for complete context");this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade for complete context");this.$5nh()}else{var e=i.$n;var r=n.get_$Fd();var t=n.get_$14V();var o=n.get_$9oB();if(!r&&o){var u;var f=_g.$O.get_$Q().get_$4P();u=_js.$9.$o(f.get_$1up())?f.get_$Fv()||"":f.get_$sA()||"";var l=new _g.$QF("StoreId",o,u);var c=new _c.$10b([l],"EwsId");e.$tE(c,this.$$d_$DUq,this.$$d_$DYk,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Calling server to convert id, storeId="+o)}else if(r)if(n.get_$3ey()&&n.get_$23e()){_js.Trace.logInfo(_a.$0.$16,"The message was saving prior to popout, check for save result from main window");this.$9Ig()}else{_js.Trace.logInfo(_a.$0.$16,"Load draft "+_h.$D1.$1d1(r));this.$6Wn(r)}else if((4===n.get_$6X()||13===n.get_$6X())&&n.get_$23e()){_js.Trace.logInfo(_a.$0.$16,"Loading draft without id for the popout from inline case, check id from main window");this.$9Ig()}else if(t){i.$1d.$9U(3400);i.$1d.$4r(3400,null);if(n.get_$1oe()){var a=_cc.$Dj.$H5(t,n.get_$1Lf());var s=new _cc.$Dj(200,a);s.$99=n.get_$D1();e.$tE(s,this.$$d_$DZ7,this.$$d_$95c,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=i.$Xj.$5uS(t);h.$99=n.get_$D1();e.$tE(h,this.$$d_$DZ8,this.$$d_$95c,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$6X()||11===n.get_$6X()){n.set_$OV(!0);n.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for new mail");this.$3o1()}else{this.$lF("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$1I.$Gx(_y.$1m,n.get_$6X())));}}_js.$9.$o(_g.$O.get_$Q().get_$4P().get_$1up())||i.$1d.$4r(95,null)},$AV:function(){this.set_$G8(!1);this.set_$8X2(!1);this.set_$5q1(!0);this.$5fa=!1;this.$2F3()},$7Xe:function(){this.$AmV();this.$72K=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.SecondInit",!0);var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$16,"Queue 2nd init task, context:"+i.toString());_js.$D.get_$Q().$6C(_a.$0.$16,"Delayed MailCompose Secondary Init",this.$$d_$Aqb);if(n.get_$3w3()&&!n.$5w.$1a){var f=t.$5m(11);_js.Trace.logInfo(_a.$0.$16,"Queue appbar setup task");_js.$D.get_$Q().$6C(_a.$0.$16,"SetupApplicationBarMenu",f.$$d_$Ea5)}if(i.get_$37U()){var u=this.$1n.$5m(8);_js.Trace.logInfo(_a.$0.$16,"Queue diagnostics save to trigger uploading of the diagnostics attachment");_js.$D.get_$Q().$6C(_a.$0.$16,"Diagnostics save:",u.$$d_$E6R)}var r=t.$5m(19);_js.Trace.logInfo(_a.$0.$16,"Queue GetMailTips if needed task");_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerMailTipsIfNeeded",r.$$d_$EqO)},$DYl:function(n){var f=_a.$6.acss(_a.$0.$16,"VM.MailCompose.ProcessDraft");var o=this.$1n.$v.$c;var e=this.$v.get_$5yp();var i=n;var t=n.$99;_js.Trace.logInfo(_a.$0.$16,"Got draft, checking pending discards for "+t);if(this.$Lx.$1EM(t))e.$5Nk(t,i.get_$y());else if(t===this.$c_2.get_$D1()){var r=i.$Ov;if(_g.$Sj.isInstanceOfType(r)){this.$c_2.$6ND(r);this.$5kC(!0);this.$97p(i)}else _a.$c.$43&&r.get_$Mk()?this.$C4k(r,i):this.$6N9(r,i);if(_a.$5N.$43){var u=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){var n=u.$1n.$5m(25);n.$2BU(32)})}}else _js.Trace.logInfo(_a.$0.$16,"Skipping get draft processing since action context "+t+" doesn't match current context "+this.$c_2.toString());_a.$6.aces(f);_a.$6.acea(this.$40T)},$C4k:function(n,t){var i=this;this.$v.$5vR(function(){i.$7h1();i.$2N2.$6N9(n,t)})},$7h1:function(){if(!this.$2N2){_js.Trace.logInfo(_a.$0.$16,"Setting initializer component override");this.$2N2=this.$v.get_$4IH().$7h1();var n=this.$1n.$5m(29);this.$2N2.$3e(this.$$d_$6N9,n.$$d_$7Sk,this.$$d_$lF,this.$v.$n)}},$6N9:function(n,t){this.$c_2.$4sg(n);this.$5kC(!1);this.$97p(t)},$97p:function(n){if(this.$c_2.get_$23e()&&this.$c_2.get_$1Oz()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline for a loaded draft.");this.$c_2.$jW=_mcp.$1W.$33t(this.$c_2)}_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for a loaded draft.");this.$3o1();var t=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5m(25);n.$2BU(32)})},$DZ7:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lx.$1EM(i)){var r=n;t.$1Th(r.$1X);t.set_$1Lf(!1);_js.Trace.logInfo(_a.$0.$16,"Got original cal item, finish 1st init with context:"+t.toString());this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade on original cal item");this.$5nh()}},$DZ8:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lx.$1EM(i)){var r=n;t.$1Th(r.$Ov);_js.Trace.logInfo(_a.$0.$16,"Got original message, finish 1st init with context: "+t.toString());this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade on original message item");this.$5nh()}},$DYk:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lx.$1EM(t)||u.$n.$t6(n,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessageDisconnected_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_bms.BootModelsStrings.l_ErrorRequestTimeout_Text,this.$$d_$Aoe);var i="GetDraftFailure_UnknownError";var r="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LB(n.$2H)||"GetDraftFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$40T);this.$lF(i,n.$FJ(),r)},$95c:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lx.$1EM(t)||u.$n.$9kY(n,this.$$d_$Aoe);var i="GetItemFailure_UnknownError";var r="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LB(n.$2H)||"GetItemFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$40T);this.$lF(i,n.$FJ(),r)},$Aoe:function(n,t){var i=this.$1n.$5m(2);i.get_$5F().$2Si(this.$1n.$v,!1);_js.Trace.logInfo(_a.$0.$16,"Navigate away on action failure")},$3Rq:function(n){var t=this.$1n.$v;var i=t.$c;if(n.$99===i.get_$D1()){t.$1d.$9U(3400);_mcp.$3t.$Jx(this.$1n)}},$3o1:function(){var f=_a.$6.acss(_a.$0.$16,"VM.MailCompose.ComponentInit");var n=this.$1n;var r=n.$v;var t=r.$c;var i=t.get_$6X();n.$5m(7).$3e();n.$5m(8).$3e();n.$5m(1).$3e();t.get_$oy()&&n.$5m(16).$3e();var u=_y.$z.$1Q.get_$U();i&&i!==11||!this.$1D.get_$NE()||t.get_$do()||t.set_$do("");t.get_$Xa()&&n.$5m(12).$3e();u!=="Mouse"?n.$5m(11).$3e():n.$5m(24).$3e();_a.$6.aces(f);_a.$6.acea(this.$63e);if(r.$hd){_js.Trace.logInfo(_a.$0.$16,"Begin 2nd init in finish 1st because we are already in view.");this.$7Xe()}this.set_$G8(!0)},$Aqb:function(){var t=this.$1n;var i=t.$v;var n=i.$c;n.get_$6X()||n.get_$do()||n.set_$do("");t.$5m(2);t.$3e();n.get_$T9()||n.$7ob();this.set_$8X2(!0);_js.Trace.logInfo(_a.$0.$16,"Finish 2nd init, context:"+n.toString());_a.$6.acea(this.$72K)},$6Wn:function(n){this.$40T=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.LoadDraft",!0);var i=this.$1n.$v;var t=i.$c;var f=i.$n;if(t.get_$23e()){if(t.get_$1Oz()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline since message was a clean new message before popout, context: "+t.toString());t.$jW=_mcp.$1W.$33t(t)}t.get_$1Lk()&&!t.get_$OV()&&this.$5kC(!0)}else t.set_$23K(!0);i.$1d.$9U(3400);i.$1d.$4r(3400,null);t.get_$3xz()&&i.$1d.$4r(3480);var r=this.$1D.get_$NE()&&t.get_$6P()==="HTML"?_h.$f.get_$24Y():_h.$f.get_$3Lk();var e="MailCompose";var u=i.$Xj.$5uS(n,r,e);u.$99=t.get_$D1();f.$tE(u,this.$$d_$DYl,this.$$d_$DYk,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading draft with ID="+_h.$D1.$1d1(n)+"; Shape="+r.BodyType+"; Layout="+_y.$z.$1Q.get_$U()+"; ContextBodyType="+t.get_$6P())},$5kC:function(n){if(n!==this.$5fa){var t=this.$1n.$v.$1d;t.$9U(3440);n&&t.$4r(3440,null);_mcp.$3t.$Jx(this.$1n);this.$5fa=n}},$DUq:function(n){var i=n;var t=new _g.$1T(i.get_$7eq().Id);this.$1n.$v.$c.set_$Fd(t);this.$6Wn(t)},$5nh:function(){var i=this.$1n;var t=i.$v.$c;var n=t.get_$6X();var u=1===n||2===n||3===n||12===n;if(u&&!t.get_$Fd()&&!t.get_$OV()){var r=i.$5m(13);r.$A9O()}},$9Ig:function(){var n=this.$1n.$v.$c.get_$D1();if(this.$6R4){_js.Trace.logInfo(_a.$0.$16,"Processing save result on main window for popout projection compose window "+n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.$3A.$1Zf,this.$$d_$BtG)}else{_js.Trace.logInfo(_a.$0.$16,"Calling main window to process save result "+n);_g.$1H.$Yv.$BtF(n,_a.$3A.$1Zf,this.$$d_$BtG)}},$BtG:function(n){var t=this.$1n.$v.$c;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$16,"Resume loading draft after main window successfully saved item: "+i.Id);t.get_$1Lk()&&!t.get_$OV()&&t.set_$OV(!0);this.$6Wn(i)}else{_js.Trace.logInfo(_a.$0.$16,"Save failed on the main window for this popout, show failure message.");this.set_$5q1(!1);this.$lF("ErrorSaveFailedOnMainWindow",null,null)}},$DWu:function(n,t){var r=this.$1n.$v;var i=r.$c;if(i.$3wt){if(i.get_$T9()&&!i.$7DT){i.$W2.$11();i.get_$T9().set_$MW(i.get_$MW());i.$jW&&i.$jW.set_$MW(i.get_$MW())}this.$Ame()}},$Ame:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$1NF()){_y.$2F.$1G(n.get_$1NF(),null,"",null,t.get_$7jB());n.set_$1NF(null)}this.$4cr()},$lF:function(n,t,i){var u=this.$1n.$v;var r=u.$c;if(r.get_$dm()){_y.$2F.$1G(r.get_$dm(),null,n,t,i);r.set_$dm(null)}if(r.get_$1NF()){_y.$2F.$1G(r.get_$1NF(),null,n,t,i);r.set_$1NF(null)}this.$4cr()},$AmV:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$dm()){_y.$2F.$1G(n.get_$dm(),null,"",null,t.get_$7jB());n.set_$dm(null)}},$4cr:function(){var i=this.$1n.$v;var t=i.$c;if(t.get_$2By()){var n=null;switch(t.get_$6X()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.$6.endPT(n);t.set_$2By(!1)}}}};_mcp.$MZ=function(n,t){this.$$d_$7pq=Function.createDelegate(this,this.$7pq);this.$$d_$E6o=Function.createDelegate(this,this.$E6o);this.$$d_$6uP=Function.createDelegate(this,this.$6uP);this.$$d_$1tX=Function.createDelegate(this,this.$1tX);this.$$d_$2WV=Function.createDelegate(this,this.$2WV);this.$$d_$DOQ=Function.createDelegate(this,this.$DOQ);this.$$d_$DnE=Function.createDelegate(this,this.$DnE);_mcp.$MZ.initializeBase(this,[9,n]);this.$6ql=new _C(this.$$d_$DnE,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=t};_mcp.$MZ.prototype={$Lx:null,$1D:null,$6ql:null,$3yM:!1,$3ym:!1,$2mk:!1,$3ex:!1,$4qX:!1,$2N9:null,get_$DnF:function(){return this.$6ql},set_$3yN:function(n){this.$3yM!==n&&(this.$3yM=n);return n},get_$3yn:function(){return this.$3ym},set_$3yn:function(n){if(this.$3ym!==n){this.$3ym=n;this.$7Xv(n)}return n},get_$4y1:function(){return this.$2mk},set_$4y1:function(n){if(this.$2mk!==n){this.$2mk=n;this.$7Xv(n)}return n},$4UP:function(){var n=!0;var u=this.$1n;var i=u.$v;var t=i.$c;var r=i.get_$iH();var o=i.get_$1XF();var e=t.get_$D1();var s=t.get_$6X();if(this.$Lx.$1EM(e))_js.Trace.logInfo(_a.$0.$16,"User had chose to discard, simply navigate away.");else if(t.get_$1Lk()&&this.$Lx.$7lq(u,!1))_js.Trace.logInfo(_a.$0.$16,"User had navigated away on an unused response, the unused response was discarded.");else if(this.$7av())n=!1;else if(r.$bo){_js.Trace.logInfo(_a.$0.$16,"We're sending the message, can't exit yet.");n=!1}else if(r.$3ye){_js.Trace.logInfo(_a.$0.$16,"We're resolving the recipients, can't exit yet.");r.$7pN();n=!1}else if(t.get_$1El()){var f=u.$5m(21);f.$Fp.$11();n=!1}else{_js.Trace.logInfo(_a.$0.$16,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$IO()){this.$4qX=!1;_js.$D.get_$Q().$2V(_a.$0.$16,"NavigatingAwaySaveTimeout",this.$$d_$DOQ,1e4);this.$3VU();if(o.$2NE("InlineExit",this.$$d_$2WV,this.$$d_$1tX,!1)){this.set_$4y1(!0);_js.Trace.logInfo(_a.$0.$16,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$APE:function(){return new _y.$Cc},$7Xv:function(n){var t=this.$1n.$v;t.set_$9qs(_u.CommonStrings.l_Saving_Text);t.set_$9kQ(n);t.set_$EbS(n)},$DnE:function(){var i=this.$1n;var t=i.$v;var n=t.$c;var u=n.get_$D1();var l=i.$5m(7);_js.$D.get_$Q().$1Yl(_a.$0.$16,"MailComposePopOut");if(this.$3yM){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because another pop out is in progress.");return}if(l.$bo){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because send is in progress.");return}if(this.$7av()||this.$Lx.$1EM(u)){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because attachment is currently uploading or user had discarded");return}n.set_$dm(this.$2N9=_y.$2F.$1g(_a.$0.$16,"MailComposeInlinePopOut",!0));this.set_$3yN(!0);var s=!1;try{var a=this.$1n.$v.$1d;a.$ag(_mcp.$MZ.$wR);_mcp.$3t.$Jx(i);var r=i.$5m(8);_js.Trace.logInfo(_a.$0.$16,"Checking dirty before popping out from inline. Context:"+n.toString());var e=t.$IO();var f=t.$c.get_$6Pt();var c=i.$5m(12);if(!n.get_$Fd()||e||c.$7DD||f){this.set_$3yn(!0);(n.get_$Fd()&&!f||e||r.$1Ts)&&n.set_$1Oz(!1);_js.Trace.logInfo(_a.$0.$16,"Set WasCleanNewMessageBeforePopout = "+n.get_$1Oz());this.$3ex=!1;_js.$D.get_$Q().$2V(_a.$0.$16,"PopoutSaveTimeout",this.$$d_$6uP,1e4);n.set_$3ey(!0);this.$3VU();t.$Le.get_saveForPopoutMap()[u]=new _y.$1N9;this.$6r1();r.$2NE("Popout",this.$$d_$E6o,this.$$d_$7pq,!1)}else{if(n.get_$23K())n.set_$1Oz(!1);else if(n.get_$1TQ())n.set_$1Oz(!1);else if(r.$1Ts)n.set_$1Oz(!1);else if(n.$jW){_js.Trace.logInfo(_a.$0.$16,"Comparing initial baseline with baseline. Context:"+n.toString());n.$jW.$5b(n.get_$T9())||n.set_$1Oz(!1)}else n.set_$1Oz(!1);n.set_$3ey(!1);_a.$4.$z(t.$Le,"PopoutManager");_a.$4.$z(t.$Le.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.$Le.get_saveForPopoutMap()[u];this.$6r1()}var h=t.get_$2rD();if(h){var o=h.get_$5F();if(o){_js.Trace.logInfo(_a.$0.$16,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");o.set_$3tw(!0)}}s=!0}catch(v){_y.$2F.$1G(this.$2N9,null,v.toString(),null,v.message);n.set_$dm(this.$2N9=null);throw v;}finally{if(!s){this.set_$3yN(!1);this.set_$3yn(!1)}}},$7av:function(){var n=this.$1n.$v;var t=this.$1n.$5m(5);if(t.get_$Q6()){if(!n.$2F.$3W){_js.Trace.logInfo(_a.$0.$16,"Show attachment in progress error dialog");n.$2F.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1},$6r1:function(){var i=this.$1n.$v;var t=i.$c;var n=new _mcp.$V;if(this.$1D){n.set_$ps(this.$1D.get_$ps());n.set_$NE(this.$1D.get_$NE())}n.set_$5j(0);n.set_$Xa(!1);if(t.get_$6X()===11||t.get_$6X()===12){n.set_$6X(13);n.set_$19x(t.get_$19x());n.set_$2se(t.get_$2se())}else n.set_$6X(4);n.set_$Fd(t.get_$Fd());n.set_$6P(t.get_$6P());var r=this.$APE();n.set_$23e(!0);n.set_$OV(t.get_$OV());n.set_$1ZM(t.get_$1ZM());n.set_$1Lk(t.get_$1Lk());n.set_$23K(t.get_$23K());n.set_$1TQ(t.get_$1TQ());n.set_$1Oz(t.get_$1Oz());n.set_$3ey(t.get_$3ey());n.set_$D1(t.get_$D1());n.set_$3o(t.get_$3o());n.set_$dm(t.get_$dm());t.get_$OV()||t.get_$6X()!==3||t.$6T1()||!t.get_$IV().get_$1m()||n.set_$EW(t.get_$IV().get_$1m().get_$7V());r.$WM(n);if(!t.get_$3ey()){i.set_$1Ei(!0);this.$2Si();this.set_$3yN(!1)}},$E6o:function(n){this.set_$3yn(!1);if(this.$3ex){_js.Trace.logInfo(_a.$0.$16,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$2F.$1G(this.$2N9,null,_mcp.$MZ.$QU.toString(3));this.$2N9=null}else{var i=n.$99;var t=this.$1n.$v;if(i in t.$Le.get_saveForPopoutMap()){var u=_mcp.$Kn.$7pk(n);var r=t.$Le.get_saveForPopoutMap()[i];if(r.$349.length){var f=JsonParser.serialize(u);t.$Le.pushSaveResultToPopout(f,r.$349);delete t.$Le.get_saveForPopoutMap()[i]}else r.$y=u}if(t.$c.get_$D1()===i){_js.Trace.logInfo(_a.$0.$16,"Save succeeded for popout, navigating away from the main window.");t.set_$1Ei(!0);this.$2Si();this.set_$3yN(!1)}else _js.Trace.logInfo(_a.$0.$16,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$c.get_$D1())}},$2WV:function(n){this.$2mk&&this.set_$4y1(!1);if(this.$4qX){_js.Trace.logInfo(_a.$0.$16,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$1n.$v.set_$1Ei(!0);this.$2Si()},$1tX:function(n){if(this.$2mk){_js.Trace.logInfo(_a.$0.$16,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$4y1(!1)}},$2Si:function(){var n=this.$1n;var t=n.$5m(2);t.get_$5F().$2Si(n.$v,!1);_js.Trace.logInfo(_a.$0.$16,"Navigated away from inline compose")},$7pq:function(n){if(this.$3yM){this.set_$3yN(!1);this.set_$3yn(!1);var f=this.$1n;var i=f.$v;var t;t=n?n.$99:i.$c.get_$D1();if(t in i.$Le.get_saveForPopoutMap()){var r=i.$Le.get_saveForPopoutMap()[t];r.$349.length>0&&i.$Le.pushSaveResultToPopout(null,r.$349);delete i.$Le.get_saveForPopoutMap()[t]}}var u=this.$3ex?2:1;_y.$2F.$1G(this.$2N9,null,_mcp.$MZ.$QU.toString(u));this.$2N9=null},$6uP:function(){_js.Trace.logInfo(_a.$0.$16,"Attempt to popout expired since save did not come back in time");if(this.$3ym){this.$3ex=!0;this.$7pq(null);var n=this.$1n;var t=n.$v.$1d;this.$3VU();t.$4r(84);_mcp.$3t.$Jx(n)}},$DOQ:function(){_js.Trace.logInfo(_a.$0.$16,"Attempt to navigate away expired since save did not come back in time");if(this.$2mk){this.$4qX=!0;this.$1tX(null);var n=this.$1n;var t=n.$v.$1d;this.$3VU();t.$4r(86);_mcp.$3t.$Jx(n)}}};_mcp.$MZ.$QU=function(){};_mcp.$MZ.$QU.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3};_mcp.$MZ.$QU.registerEnum("_mcp.$MZ.$QU",!1);_mcp.$7y=function(n){_mcp.$7y.initializeBase(this,[4,n])};_mcp.$7y.$8XW=function(n){switch(n.get_$6X()){case 4:return n.get_$6TH();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_mcp.$7y.prototype={get_$4fr:function(){return this.$w(_mcp.$7y.$655)},set_$4fr:function(n){this.$P(_mcp.$7y.$655,n);return n},get_$2va:function(){return this.$w(_mcp.$7y.$73h)},set_$2va:function(n){this.$P(_mcp.$7y.$73h,n);return n},get_$51H:function(){return this.$w(_mcp.$7y.$6XB)},set_$51H:function(n){this.$P(_mcp.$7y.$6XB,n);return n},get_$6Rg:function(){return this.$w(_mcp.$7y.$6Rh)},set_$6Rg:function(n){this.$P(_mcp.$7y.$6Rh,n);return n},$3e:function(){var n=this.$1n.$v.$c;var i=this.$1n.$v.$4x;n.get_$3Fs()?this.set_$51H(new _cc.$Cb(n.get_$6E(),null,this.$1n.$v.$4x,this.$1n.$v.$I)):this.set_$51H(null);if(n.get_$oy()&&n.get_$23N()){var t=1;var f=_pc.$q.$7gg(n.get_$5Q());var e=i.$Na(f,_bc.$6a.$11g,!0,t);this.set_$4fr(e);this.set_$6Rg(!!n.get_$Em()&&!!n.get_$Em().Mailbox&&!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_g.$1Z.$5b(n.get_$5Q().Mailbox,n.get_$Em().Mailbox));if(this.get_$6Rg()){var r=_pc.$q.$7gg(n.get_$Em());var u=i.$Na(r,_bc.$6a.$11g,!0,t);this.set_$2va(u)}else this.get_$2va()&&this.set_$2va(null)}else{this.get_$4fr()&&this.set_$4fr(null);this.get_$2va()&&this.set_$2va(null)}_js.Trace.logInfo(_a.$0.$16,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$oy(),n.get_$23N());_mcp.$14n.prototype.$3e.call(this)}};_mcp.$1L5=function(n,t,i){this.$$d_$2qx=Function.createDelegate(this,this.$2qx);this.$$d_$2qw=Function.createDelegate(this,this.$2qw);this.$$d_$7dP=Function.createDelegate(this,this.$7dP);this.$$d_$9ze=Function.createDelegate(this,this.$9ze);this.$$d_$nq=Function.createDelegate(this,this.$nq);this.$$d_$2Ul=Function.createDelegate(this,this.$2Ul);this.$$d_$Eer=Function.createDelegate(this,this.$Eer);_mcp.$1L5.initializeBase(this,[10,n]);this.$6R=t;this.$3Y=i};_mcp.$1L5.prototype={$6R:null,$3Y:null,$3b1:null,$E6:null,$hp:null,$9B:null,set_$Ees:function(n){if(this.$3b1!==n){this.$3b1=n;this.$4("ShowMessageOptionsCommand")}return n},set_$ny:function(n){if(this.$E6!==n){this.$E6=n;this.$4("DialogViewModel")}return n},$3e:function(){this.$3b1||this.set_$Ees(new _C(this.$$d_$Eer,this.get_$m()));this.$7Tv();_mcp.$14n.prototype.$3e.call(this)},$Eer:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to show message options");$C(this.$hp)&&(this.$hp=new _mcp.$nO);this.$hp.$1Tg(this.$c_2);if($C(this.$E6)){var t=new _bc.$DH;t.set_$cC(this.$6R);this.set_$ny(t);this.$E6.set_$3u(_nbs.NonBootStrings.l_MessageOptions_Text);this.$9B=[new _ff.$1l(new _C(this.$$d_$2Ul,this.get_$m()),_u.CommonStrings.l_Ok_LowerCase_Text,null),new _ff.$1l(new _C(this.$$d_$nq,this.get_$m()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$E6.$9B.$3y(this.$9B)}this.$E6.set_$FD(this.$hp);if("TouchNarrow"===_y.$z.$1Q.get_$U()){var n=this.$1n.$v.get_$5F();this.$hp.set_$5F(n);n.get_$6m().add_$22(this.$$d_$9ze)}this.$E6.set_$1C(!0)},$2Ul:function(){if(this.$E6.$G7){_js.Trace.logInfo(_a.$0.$16,"User tried to click OK button more than once.");return}var n=this.$v.$c;if(n.get_$ET()!==this.$hp.$3XJ){"Normal"!==n.get_$ET()&&this.$E2F();n.set_$ET(this.$hp.$3XJ);"Normal"!==n.get_$ET()&&this.$7Tv()}n.set_$Qu(this.$hp.$3wi);n.set_$Q8(this.$hp.$3yU);this.$hp.$1Yf&&!n.get_$PT()||this.$hp.$1Yg&&!n.get_$T0()?this.$v.$5vR(this.$$d_$7dP):this.$7dP()},$7dP:function(){var t=this.$v.$c;var o=this.$1n.$v;var n=this.$v.get_$eM();var i=n.get_$9Z();if(t.get_$PT()!==this.$hp.$1Yf){t.set_$PT(this.$hp.$1Yf);this.$4("SmimeEncryptMessage");_js.Trace.logInfo(_a.$0.$53,"SmimeEncryptMessage option is changed to {0} by user.",this.$hp.$1Yf)}if(t.get_$T0()!==this.$hp.$1Yg){t.set_$T0(this.$hp.$1Yg);this.$4("SmimeSignMessage");_js.Trace.logInfo(_a.$0.$53,"SmimeSignMessage option is changed to {0} by user.",this.$hp.$1Yg)}var r=this.$hp.$1Yf||this.$hp.$1Yg;r&&o.$7FS();i&&i.set_$s0(t.get_$s0());if(this.$hp.$5gk&&!r&&n.get_$P3())if(n.get_$Q6()){_js.Trace.logInfo(_a.$0.$53,"Waiting to move attachments because the attachment well is currently in progress.");this.$E6.set_$7d(!0);i.add_$EE(this.$$d_$2qw)}else this.$2qw(null,null);else if(!this.$hp.$5gk&&r){var u=this.$c_2.get_$6X();var e=u===1||u===2||u===3;var f=e&&this.$3Y.$2r("ComposeBread1");f&&this.$v.get_$7Np().get_$7dK().$11();if(n.get_$P3())if(n.get_$Q6()){_js.Trace.logInfo(_a.$0.$53,"Waiting to move attachments because the attachment well is currently in progress.");this.$E6.set_$7d(!0);i.add_$EE(this.$$d_$2qx)}else this.$2qx(null,null);else this.$5Da()}else this.$5Da()},$2qw:function(n,t){if(this.$8WU(n,t)){_js.Trace.logInfo(_a.$0.$53,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.remove_$EE(this.$$d_$2qw);this.$E6.set_$7d(!1)}var i=this.$v.get_$eM().get_$9Z();if(this.$v.$c.get_$Fd())i.$2qw();else{var r=this.$v.get_$1XF();var u=this;r.$2NE("Attach",function(){i.$2qw()},null,!1)}this.$5Da()}},$2qx:function(n,t){if(this.$8WU(n,t)){_js.Trace.logInfo(_a.$0.$53,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.remove_$EE(this.$$d_$2qx);this.$E6.set_$7d(!1)}this.$v.get_$eM().get_$9Z().$2qx();this.$5Da()}},$8WU:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.get_$Q6()},$5Da:function(){_js.Trace.logInfo(_a.$0.$16,"User hit OK on message options dialog, setting Sensitivity="+this.$c_2.get_$ET()+"; DeliveryReceipt="+this.$c_2.get_$Qu()+"; ReadReceipt="+this.$c_2.get_$Q8()+"; SmimeEncryptMessage="+this.$c_2.get_$PT()+"; SmimeSignMessage="+this.$c_2.get_$T0());this.$nq()},$nq:function(){if(this.$E6.$G7){_js.Trace.logInfo(_a.$0.$16,"User tried to close dialog when busy.");return}var t=this.$1n.$v.$c;var i=this.$v.$1aw();if(t.get_$s0()&&t.get_$ow()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i.$4r(750)}else i.$9U(750);this.$v.get_$ad().$3as.set_$87(!t.get_$s0());var n=this.$v.get_$eM();if(n.get_$9Z()){n.get_$9Z().remove_$EE(this.$$d_$2qw);n.get_$9Z().remove_$EE(this.$$d_$2qx)}"TouchNarrow"===_y.$z.$1Q.get_$U()&&this.$hp.$48.get_$6m().remove_$22(this.$$d_$9ze);_js.Trace.logInfo(_a.$0.$16,"Close message options dialog");this.$E6.$5a.$11()},$9ze:function(n,t){_mcp.$8n.isInstanceOfType(this.$1n.$v.get_$5F().get_$8q())?this.$E6.set_$1C(!0):this.$E6.set_$1C(!1)},$E2F:function(){var t=this.$1n.$v;var n=t.$1aw();switch(t.$c.get_$ET()){case"Personal":n.$9U(8900);break;case"Confidential":n.$9U(8901);break;case"Private":n.$9U(8902);break}_mcp.$3t.$Jx(this.$1n)},$7Tv:function(){var t=this.$1n.$v;var n=t.$1aw();switch(t.$c.get_$ET()){case"Personal":n.$4r(8900,null);break;case"Confidential":n.$4r(8901,null);break;case"Private":n.$4r(8902,null);break}_mcp.$3t.$Jx(this.$1n)}};_mcp.$1L6=function(n){this.$$d_$9Ob=Function.createDelegate(this,this.$9Ob);this.$$d_$48M=Function.createDelegate(this,this.$48M);_mcp.$1L6.initializeBase(this,[2,n]);this.$Lx=n.$v.$Lx};_mcp.$1L6.prototype={$Lx:null,$48:null,$1OP:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cc);return this.$48},set_$5F:function(n){this.$48=n;return n},$3e:function(){var n=_y.$z.$1Q;"Mouse"!==n.get_$U()||n.get_$Cp()||n.add_$1w2(this.$$d_$48M);_mcp.$14n.prototype.$3e.call(this)},$4WJ:function(n){this.$1n.$v.$1di&&(this.$1OP=!0);if(!this.$1OP){_js.Trace.logInfo(_a.$0.$16,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$1n.$v.$c.toString());this.$1n.$v.$IO()&&n.$1a4(_nbs.NonBootStrings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$1OP=!0;_js.$D.get_$Q().$2V(_a.$0.$16,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$9Ob,100)},$9Ob:function(){this.$1OP=!1},$48M:function(){_y.$z.$1Q.remove_$1w2(this.$$d_$48M);this.$Lx.$7lq(this.$1n,!0)}};_mcp.$1L7=function(n,t){this.$$d_$1GD=Function.createDelegate(this,this.$1GD);_mcp.$1L7.initializeBase(this,[15,n]);this.$5GH=new _C(this.$$d_$1GD,this.get_$m());this.$5GH.set_$87(t.get_$JQ().get_$14F().get_$5C3())};_mcp.$1L7.prototype={$5GH:null,$1GD:function(){_js.Trace.logInfo(_a.$0.$16,"OpenFilePicker on PAL.");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$9Z().$Dnb();_js.Trace.logInfo(_a.$0.$16,"OpenFilePicker on PAL end.")}};_mcp.$Ma=function(n,t){this.$$d_$7Wf=Function.createDelegate(this,this.$7Wf);this.$$d_$7We=Function.createDelegate(this,this.$7We);_mcp.$Ma.initializeBase(this,[15,n]);var i;i=t.$8G(t.get_$JQ())?t.get_$JQ().get_$14F():this;var u=this;this.$1aC=new _C(this.$$d_$7We,this.get_$m(),i,"CameraAvailable",function(){return t.$8G(t.get_$JQ())&&t.get_$JQ().get_$14F().get_$4U6()});var r=this;this.$1aD=new _C(this.$$d_$7Wf,this.get_$m(),i,"GalleryAvailable",function(){return t.$8G(t.get_$JQ())&&t.get_$JQ().get_$14F().get_$4g5()})};_mcp.$Ma.$3Il=function(n){var t=n.$c;if($C(t)||!t.get_$OV()){_js.Trace.logInfo(_a.$0.$16,"Show attachment not allowed dialog, Upgraded="+t.get_$OV());n.$2F.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_mcp.$Ma.prototype={$1aC:null,$1aD:null,$7We:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to attach from camera");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open camera, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open camera, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$9Z().$9Db(n.$8Ui());_js.Trace.logInfo(_a.$0.$16,"Attach from camera end")},$7Wf:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to attach from gallery");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$9Z().$48T(n.$8Ui());_js.Trace.logInfo(_a.$0.$16,"Attach from gallery end")}};_mcp.$HY=function(n){this.$$d_$BjK=Function.createDelegate(this,this.$BjK);this.$$d_$Bur=Function.createDelegate(this,this.$Bur);this.$$d_$Bus=Function.createDelegate(this,this.$Bus);this.$$d_$Buu=Function.createDelegate(this,this.$Buu);this.$$d_$AZh=Function.createDelegate(this,this.$AZh);this.$$d_$DhN=Function.createDelegate(this,this.$DhN);this.$$d_$4fe=Function.createDelegate(this,this.$4fe);this.$$d_$7rp=Function.createDelegate(this,this.$7rp);this.$$d_$3SQ=Function.createDelegate(this,this.$3SQ);this.$$d_$1s9=Function.createDelegate(this,this.$1s9);this.$$d_$7rq=Function.createDelegate(this,this.$7rq);this.$$d_$DfE=Function.createDelegate(this,this.$DfE);this.$$d_$6qG=Function.createDelegate(this,this.$6qG);this.$$d_$A4A=Function.createDelegate(this,this.$A4A);this.$$d_$9Bs=Function.createDelegate(this,this.$9Bs);this.$$d_$E8i=Function.createDelegate(this,this.$E8i);this.$$d_$AUt=Function.createDelegate(this,this.$AUt);this.$$d_$C2A=Function.createDelegate(this,this.$C2A);this.$$d_$9lE=Function.createDelegate(this,this.$9lE);this.$$d_$C1s=Function.createDelegate(this,this.$C1s);this.$$d_$Ed9=Function.createDelegate(this,this.$Ed9);_mcp.$HY.initializeBase(this,[1,n]);this.$GI=this.$5vA();this.$GM=this.$5vA();this.$Gd=this.$5vA();this.$4HI=new _C(this.$$d_$Ed9,this.get_$m());this.$4qx=new _C(this.$$d_$C1s,this.get_$m());this.$3as=new _C(this.$$d_$9lE,this.get_$m());this.$4r8=new _C(this.$$d_$C2A,this.get_$m());this.$5xo=new _C(this.$$d_$AUt,this.get_$m());this.$5rL=new _C(this.$$d_$E8i,this.get_$m());this.$1Nc=new _C(this.$$d_$9Bs,this.get_$m());this.$1gP=new(_ff.$18.$$(_y.$mW));this.$A4F()};_mcp.$HY.$DsH=function(n,t){n.set_$79(t)};_mcp.$HY.$Drl=function(n,t){n.set_$7x(t)};_mcp.$HY.$Dri=function(n,t){n.set_$AN(t)};_mcp.$HY.$DsG=function(n,t){n.set_$10y(t)};_mcp.$HY.$Drk=function(n,t){n.set_$xs(t)};_mcp.$HY.$Drh=function(n,t){n.set_$qd(t)};_mcp.$HY.prototype={$GI:null,$GM:null,$Gd:null,$4HI:null,$4qx:null,$3as:null,$4r8:null,$5xo:null,$5rL:null,$1Nc:null,$5cT:null,$4Uo:null,$4Sj:null,$5Y6:null,$4r9:null,$5Xa:null,$4qw:null,$o5:null,$1K1:null,$5Wq:!1,$NH:!1,$4vj:!1,$5lv:!1,$cS:null,$361:null,$4rV:null,$2Oo:!1,$6SR:!1,$7Dk:!1,$5X3:!1,$5X1:!1,$1gP:null,add_$9Br:function(n){this.$32("ResolveOperationSucceeded",n)},remove_$9Br:function(n){this.$5d("ResolveOperationSucceeded",n)},add_$9Bq:function(n){this.$32("ResolveOperationCanceled",n)},remove_$9Bq:function(n){this.$5d("ResolveOperationCanceled",n)},set_$4fu:function(n){if(this.$o5!==n){this.$o5=n;this.$4("FromPersonaViewModel")}return n},get_$Asy:function(){return this.$o5&&this.$o5.get_$3F()?this.$o5.get_$3F().get_$2Z():null},get_$1Ru:function(){if(!this.$1K1){var n=this;this.$v.$39Y.$9(function(t){var i=t.$7gU();i.set_$bq(!0);i.set_$17(!1);i.set_$2BW(100);i.set_$26F(0);i.set_$2ua("PersonaDetailedView");i.$1jT();i.set_$15P(!0);i.set_$7JH(new _C(n.$$d_$A4A,_a.$0.$16));_y.$z.$1Q.get_$U()!=="Mouse"&&i.set_$Qn(new _C(n.$$d_$A4A,_a.$0.$16));i.add_$1AU(n.$$d_$6qG);n.$1K1=i;if(n.$5X3){n.$9lE();n.$5X3=!1}else if(n.$5X1){n.$6NA();n.$5X1=!1}})}return this.$1K1},set_$9kB:function(n){if(this.$5Wq!==n){this.$5Wq=n;this.$4("ShouldHighlightFromAsInvalid")}return n},get_$18Z:function(){var n=this.$1n.$v.$c.get_$ow()&&(!!this.$o5&&this.$o5.get_$18Z()||!!this.$1K1&&this.$1K1.get_$18Z());return n||this.$GI.get_$18Z()||this.$GM.get_$18Z()||this.$Gd.get_$18Z()},set_$3JT:function(n){this.$NH=n;this.$4("IsReadWrite");return n},set_$6SS:function(n){this.$6SR=n;this.$4("IsPeoplePickerShown");return n},get_$4vk:function(){var n=this.$1n.$v.$c;return!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_a.$2i.$YR(n.get_$5Q().Mailbox.EmailAddress)},get_$3at:function(){this.$5Y6||(this.$5Y6=new _y.$2a(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,this.$3as));return this.$5Y6},get_$4rA:function(){this.$4r9||(this.$4r9=new _y.$2a(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,this.$4r8));return this.$4r9},get_$7E8:function(){this.$5Xa||(this.$5Xa=new _y.$2a(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,this.$4HI));return this.$5Xa},get_$6LF:function(){this.$4qw||(this.$4qw=new _y.$2a(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,this.$4qx));return this.$4qw},get_$C9F:function(){return!this.$1n.$v.$c.get_$1El()},get_$CFn:function(){return!this.$1n.$v.$c.get_$1El()},get_$CDv:function(){return this.$1n.$v.$c.get_$1El()},get_$C0u:function(){return this.$5qk(this.$NH?this.$GI.$5X.$Gb:this.$GI.$RC.get_$xV())||this.$5qk(this.$NH?this.$GM.$5X.$Gb:this.$GM.$RC.get_$xV())||this.$5qk(this.$NH?this.$Gd.$5X.$Gb:this.$Gd.$RC.get_$xV())},$3e9:function(){this.$GI.$3e9();this.$GM.$3e9();this.$Gd.$3e9()},$EXh:function(n){this.$4rV=n},$AAA:function(n,t,i){if(this.$cS){this.$cS.remove_$2WR(this.$361);this.$cS.add_$2WR(i);this.$361=i;this.$cS.set_$6wy(t);this.$cS.$9w0(n);this.set_$6SS(!0);this.$1n.$v.$sY(this.$cS)}else{var r=this;this.$v.$3WB.$9(function(u){r.$cS=u.$5vK(n,t);r.$cS.add_$2WR(i);r.$cS.add_$6ta(r.$$d_$DfE);r.$361=i;r.set_$6SS(!0);r.$1n.$v.$sY(r.$cS)})}},$A4E:function(){if(this.$GI.$5X){this.$GI.$5X.remove_$1Mt(this.$$d_$7rq);this.$GI.$5X.remove_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$GI.$5X.add_$1Mt(this.$$d_$7rq);this.$GI.$5X.add_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.add_$22(this.$$d_$3SQ)}if(this.$GM.$5X){this.$GM.$5X.remove_$1Mt(this.$$d_$7rp);this.$GM.$5X.remove_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$GM.$5X.add_$1Mt(this.$$d_$7rp);this.$GM.$5X.add_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.add_$22(this.$$d_$3SQ)}},get_$wW:function(){return this.$1gP},$3e:function(){var n=this.$1n.$v.$c;var t=n.get_$9i();this.set_$3JT(!t||!!t.get_$RG()||t.get_$6lB()||t.get_$KU());if(n.get_$4IU()&&n.get_$4IU().get_$A()>0){this.$GI.$C5q(n.get_$4IU(),this.$NH,_u.Strings.l_ToRecipientsLabel_Text);n.set_$4IU(null)}else this.$GI.$3e(n.get_$79(),n.get_$10y(),this.$NH,_u.Strings.l_ToRecipientsLabel_Text);this.$GM.$3e(n.get_$7x(),n.get_$xs(),this.$NH,_u.Strings.l_CcRecipientsLabel_Text);_y.$z.$1Q.get_$lN()&&this.$9ql(!0);this.$A4E();var i=_g.$O.get_$Q().get_$4P();if(!_js.$9.$o(i.get_$1up())&&!_js.$9.$o(i.get_$sA())){var r=new _g.$8w;r.Mailbox=this.$Jf(i.get_$sA());n.set_$5Q(r)}("Mouse"===_y.$z.$1Q.get_$U()||n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tY()||!$C(n.get_$AN())&&n.get_$AN().get_$A()>0||_g.$O.get_$Q().get_$1j().get_$1Ip())&&this.$1lJ();this.$9wJ(n);_mcp.$14n.prototype.$3e.call(this)},$AV:function(){if(this.$o5){this.$o5.$1v();this.$o5=null}if(this.$cS){this.$cS.remove_$2WR(this.$361);this.$cS.remove_$6ta(this.$$d_$DfE);this.$cS.dispose();this.$cS=null;this.$361=null}this.$9NB();if(this.$1K1){this.$1K1.remove_$1AU(this.$$d_$6qG);this.$1K1.$1v();this.$1K1=null}this.$9NB();this.$E1z();this.$1gP.$1u();this.$GI.$1v();this.$GM.$1v();this.$Gd.$1v();_mcp.$14n.prototype.$AV.call(this)},$2zW:function(){this.$1lJ();var n=this.$1n.$v.$c;this.$5eg();this.$2Ul(n,this.$GI,_mcp.$HY.$DsH,_mcp.$HY.$DsG);this.$2Ul(n,this.$GM,_mcp.$HY.$Drl,_mcp.$HY.$Drk);this.$2Ul(n,this.$Gd,_mcp.$HY.$Dri,_mcp.$HY.$Drh)},$4GQ:function(n,t){var u=_a.$2i.$YR(n);if(u){this.get_$1Ru().set_$By("");var f=this.$Jf(n);var e=_pc.$q.$Jf(f);var o=this.$1n.$v.$9M.$1b7;var i=o.$nr(e,4,!0,1);i.set_$4k(this.$5rL);i.set_$OA(!0);i.$2vP=!0;this.set_$4fu(i);this.$ANU()}else{this.get_$1Ru().set_$By(n);this.set_$4fu(null)}if(t){var r=this.$1n.$v.get_$6Xr();r.get_$G8()||r.$3e();r.$2yR()}this.set_$9kB(!u);this.$2zW()},$226:function(){this.$1lJ();return this.$GI.$226()+this.$GM.$226()+this.$Gd.$226()},$Buu:function(){this.$1lJ();return this.$GI.$226()},$Bus:function(){this.$1lJ();return this.$GM.$226()},$Bur:function(){this.$1lJ();return this.$Gd.$226()},$3W3:function(n){this.$1lJ();this.$5eg();this.$AD8();this.$7Dk=n;this.$AsW()},$BjJ:function(){var n=new(_ff.$18.$$(String));this.$GI.$5X?n.$3y(this.$GI.$5X.$2Kz()):this.$GI.$RC&&n.$3y(this.$GI.$RC.$2Kz());this.$GM.$5X?n.$3y(this.$GM.$5X.$2Kz()):this.$GM.$RC&&n.$3y(this.$GM.$RC.$2Kz());this.$Gd.$5X?n.$3y(this.$Gd.$5X.$2Kz()):this.$Gd.$RC&&n.$3y(this.$Gd.$RC.$2Kz());return n.$3Q()},$AsW:function(){this.$GI.$NH?this.$GI.$3A9():this.$7rq(!0)},$7rq:function(n){n?this.$GM.$NH?this.$GM.$3A9():this.$7rp(!0):this.$4fe(!1)},$7rp:function(n){n?this.$Gd.$NH?this.$Gd.$3A9():this.$4fe(!0):this.$4fe(!1)},$4fe:function(n){if(this.$7Dk)if(n){_js.Trace.logInfo(_a.$0.$16,"Force resolve completed");this.$6T("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$16,"Force resolve cancelled");this.$6T("ResolveOperationCanceled")}},$1zx:function(){this.$1lJ();this.$5eg();this.$GI.$1zx();this.$GM.$1zx();this.$Gd.$1zx()},$1lJ:function(){if(!this.$5lv){this.$5lv=!0;var n=this.$1n.$v.$c;this.$Gd.$3e(n.get_$AN(),n.get_$qd(),this.$NH,_u.Strings.l_BccRecipientsLabel_Text);if(!$C(n.get_$AN())&&0<n.get_$AN().get_$A()||!_js.$9.$o(n.get_$qd())||_g.$O.get_$Q().get_$1j().get_$1Ip()){n.set_$1LS(!0);_js.Trace.logInfo(_a.$0.$16,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$C(n.get_$AN())?0:n.get_$AN().get_$A(),!_js.$9.$o(n.get_$qd()),_g.$O.get_$Q().get_$1j().get_$1Ip())}if(this.$Gd.$5X){this.$Gd.$5X.remove_$1Mt(this.$$d_$4fe);this.$Gd.$5X.remove_$1s9(this.$$d_$1s9);this.$Gd.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$Gd.$5X.add_$1Mt(this.$$d_$4fe);this.$Gd.$5X.add_$1s9(this.$$d_$1s9);this.$Gd.$5X.$3X.add_$22(this.$$d_$3SQ)}_js.Trace.logInfo(_a.$0.$16,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,$C(n.get_$79())?0:n.get_$79().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(n.get_$AN())?0:n.get_$AN().get_$A());this.$9wJ(n);if(n.get_$3Jg()&&(n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tY()))if(this.get_$1Ru()){this.$6NA();_js.Trace.logInfo(_a.$0.$16,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,_g.$O.get_$Q().get_$1j().get_$tY())}else this.$5X1=!0;else if(_g.$O.get_$Q().get_$1j().get_$tY()&&!$C(n.get_$9i())&&!n.get_$9i().get_$KU()){var t=this.$1n.$v.$1d;t.$9U(4525);t.$4r(4525);_mcp.$3t.$Jx(this.$1n)}}},$51L:function(){this.$GI.$51L();this.$GM.$51L();this.$Gd.$51L()},$BjK:function(){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.$1n.$v.$c;var t=new(_ff.$18.$$(_g.$1K));var u=this.$NH?this.$GI.$5X.$Gb:this.$GI.$RC.get_$xV();var f=this.$NH?this.$GM.$5X.$Gb:this.$GM.$RC.get_$xV();var r=this.$NH?this.$Gd.$5X.$Gb:this.$Gd.$RC.get_$xV();if(u){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.$3y(u.$3Q())}if(f){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.$3y(f.$3Q())}if(r){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.$3y(r.$3Q())}_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.$3sl();if(!n){var i=_g.$O.get_$Q().get_$4P();n=new _g.$1K;n.Name=i.get_$Lk();n.EmailAddress=i.get_$Fv()||i.get_$sA();n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.$F(n);return t},$E8i:function(){if(this.$o5){_js.Trace.logInfo(_a.$0.$16,"User selected from persona");this.$o5.set_$2f(!0);this.$4rV&&this.$4rV()}else _js.Trace.logInfo(_a.$0.$16,"User tries to select from persona, but it is null")},$9Bs:function(){this.$3W3(!1)},$AUt:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to delete from persona");this.set_$4fu(null);this.get_$1Ru().set_$Qw(!0)},$A4A:function(){this.$4GQ(this.get_$1Ru().get_$By(),!0)},$6qG:function(n,t){this.$7Tb()},$5vA:function(){return new _mcp.$JR(this.$1n.$v.$9M,this)},$DhN:function(n,t){this.$1gP.$1u();this.$7NJ(this.$GI);this.$7NJ(this.$GM);this.$7NJ(this.$Gd)},$7NJ:function(n){n.$5X?this.$1gP.$F(n.$5X):n.$RC&&this.$1gP.$F(n.$RC)},$A4F:function(){this.$GI.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$GM.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$Gd.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$GI.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhN);this.$GM.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhN);this.$Gd.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhN)},$E1z:function(){this.$GI.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$GM.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$Gd.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhN);this.$GI.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhN);this.$GM.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhN);this.$Gd.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhN)},$3SQ:function(n,t){this.$GI.get_$1L8()||this.$GM.get_$1L8()||this.$Gd.get_$1L8()||this.$1n.$v.$1d.$9U(65);this.$GI.get_$Iu()&&this.$GM.get_$Iu()&&this.$Gd.get_$Iu()||this.$1n.$v.$1d.$9U(70);_y.$z.$1Q.get_$lN()&&this.$9ql(!1);if(t&&t.$3R===2){var r=this.$1n.$v.get_$6Xr();r.get_$G8()||r.$3e();r.$9Mx();if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$6C(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){if(i.$1n&&i.$1n.$v){var n=i.$1n.$v.get_$9Go();n.$2BU(1)}})}}},$AD8:function(){this.$GI.$5X&&this.$GI.$5X.$33e();this.$GM.$5X&&this.$GM.$5X.$33e();this.$Gd.$5X&&this.$Gd.$5X.$33e()},$DfE:function(){this.set_$6SS(!1)},$9NB:function(){if(this.$GI.$5X){this.$GI.$5X.remove_$1Mt(this.$$d_$7rq);this.$GI.$5X.remove_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.remove_$22(this.$$d_$3SQ)}if(this.$GM.$5X){this.$GM.$5X.remove_$1Mt(this.$$d_$7rp);this.$GM.$5X.remove_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.remove_$22(this.$$d_$3SQ)}if(this.$Gd.$5X){this.$Gd.$5X.remove_$1Mt(this.$$d_$4fe);this.$Gd.$5X.remove_$1s9(this.$$d_$1s9);this.$Gd.$5X.$3X.remove_$22(this.$$d_$3SQ)}},$1s9:function(){_mcp.$3t.$Jx(this.$1n)},$Ed9:function(){_a.$6.stPT(_a.$0.$16,"MailComposeShowBcc",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$16,"User chose to show bcc");this.$1lJ();var n=this.$1n.$v.$c;if(!n.get_$1LS()){n.set_$1LS(!0);_mcp.$3t.$Jx(this.$1n);this.$7NW()}_a.$6.$1G(t);_a.$6.endPT("MailComposeShowBcc")},$C1s:function(){_a.$6.stPT(_a.$0.$16,"MailComposeHideBcc",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$16,"User chose to hide bcc");this.$1lJ();var n=this.$1n.$v.$c;if(n.get_$1LS()){n.set_$1LS(!1);_mcp.$3t.$Jx(this.$1n);this.$7NW()}_a.$6.$1G(t);_a.$6.endPT("MailComposeHideBcc")},$7NW:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5m(18);r.$7NW()}else{var n=this.$1n.$v.$c;var u=n.get_$1LS()?this.get_$6LF():this.get_$7E8();var t=n.get_$1LS()?this.get_$7E8():this.get_$6LF();var i=this.$1n.$v.$5w;i.$6zB(t,u)}},$9wJ:function(n){if("Mouse"!==_y.$z.$1Q.get_$U()){var f=this.$1n;var u=f.$v;var r=u.$5w;if(r){var i=r.$1a;if(i)if(n.get_$3Jg()){if(!this.$2Oo)for(var t=0;t<i.length;t++)if(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text===i[t].$3V){r.$4PT(this.get_$3at(),t+1);this.$2Oo=!0}}else if(this.$2Oo){u.$5w.$5MW(this.get_$3at());this.$2Oo=!1}}}},$5eg:function(){var i=this.$1n.$v.$c;var n=null;if(i.get_$ow()){var t=null;this.$o5?t=this.$o5.get_$3F().get_$2Z():this.$1K1&&!_js.$9.$o(this.$1K1.get_$By())&&(t=this.$Jf(this.$1K1.get_$By()));n=new _g.$8w;n.Mailbox=t;i.set_$5Q(n);this.get_$4vk()||this.$1n.$v.$1d.$9U(66)}return n},$Jf:function(n){var t=new _g.$1K;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},$ANU:function(){var t=_mcp.$JR.$2to;var n=[];(t&4)==4&&Array.add(n,new _fm.$d(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(this.$$d_$AZh,_a.$0.$16)));(t&2)==2&&Array.add(n,new _fm.$d(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(this.$$d_$AUt,_a.$0.$16)));$C(this.$o5.$1kB)||(t&1)!=1||Array.addRange(n,this.$o5.$1kB);this.$o5.set_$1JE(n)},$6NA:function(){var n=this.$1n.$v.$c;var i=null;var t=_g.$O.get_$Q().get_$4P();i=_js.$9.$o(t.get_$1up())||_js.$9.$o(t.get_$sA())?null!==n.get_$5Q()&&n.get_$5Q().Mailbox?n.get_$5Q().Mailbox.EmailAddress:_h.$2k.$4nQ(null)||t.get_$Fv():t.get_$sA();this.$4GQ(i,!1);n.set_$ow(!0);var u=this.$5eg();n.get_$T9()&&n.get_$T9().set_$5Q(u);var r=this.$1n.$5m(20);$C(r.get_$Tg())&&r.$3e()},$AZh:function(){var n=this.$o5.get_$3F().get_$2Z().EmailAddress;this.set_$4fu(null);this.get_$1Ru().set_$By(n);this.get_$1Ru().set_$Qw(!0)},$7Tb:function(){var n=this.get_$1Ru().get_$kU();if($C(n)||$C(n.get_$A2())||$C(n.get_$A2().get_$2Z()))_js.Trace.logWarning(_a.$0.$16,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.get_$A2().get_$2Z().EmailAddress;_js.Trace.logInfo(_a.$0.$16,"User selected from="+t);this.$4GQ(t,!0)}},$9lE:function(){if(!this.get_$1Ru()){this.$5X3=!0;return}_a.$6.stPT(_a.$0.$16,"MailComposeShowFrom",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeShowFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ow())_js.Trace.logInfo(_a.$0.$16,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$16,"User chose to show from");this.$4vj=!0;this.$6NA();_mcp.$3t.$Jx(this.$1n);this.$7NX()}_a.$6.$1G(t);_a.$6.endPT("MailComposeShowFrom")},$C2A:function(){_a.$6.stPT(_a.$0.$16,"MailComposeHideFrom",3);var r=_a.$6.$1g(_a.$0.$16,"MailComposeHideFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ow()){n.set_$ow(!1);this.$4vj=!1;_mcp.$3t.$Jx(this.$1n);if(_y.$z.$1Q.get_$U()==="Mouse"){var i=this.$1n.$5m(18);i.$7NX()}else{var t=this.$1n.$v.$5w;t.$6zB(this.get_$4rA(),this.get_$3at())}}else _js.Trace.logInfo(_a.$0.$16,"Skip hide from since it is already hidden");this.$1n.$v.$1d.$9U(750);_a.$6.$1G(r);_a.$6.endPT("MailComposeHideFrom")},$7NX:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5m(18);r.$7NX()}else{var n=this.$1n.$v.$c;var u=n.get_$ow()?this.get_$4rA():this.get_$3at();var t=n.get_$ow()?this.get_$3at():this.get_$4rA();var i=this.$1n.$v.$5w;i.$6zB(t,u)}},$2Ul:function(n,t,i,r){var u=this.$NH?t.$5X:t.$RC;if(!$C(u)){i(n,u.get_$xV());if(_rw.$83.isInstanceOfType(u)){var f=u;f.get_$9Q()&&r(n,f.get_$9Q().get_$By())}}},$9ql:function(n){var e=this.$1n.$v.$c;var i=!1;var u=e.$3sl();if(u){var t=this.$GM.$5X.$Gb;if(t)for(var r=0;r<t.get_$A();r++){var f=t.get_$E(r);if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.$1n.$v.$1d.$9U(4450);this.$1n.$v.$1d.$4r(4450)}else n||i||this.$1n.$v.$1d.$9U(4450)},$5qk:function(n){if(!n||!n.get_$A())return!1;for(var t=0;t<n.get_$A();t++){var i=n.get_$E(t);if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},$Za:function(n){var t=this.$GI.$638()||this.$GM.$638()||this.$Gd.$638();t&&n.$5X.$3X.$F(t)},get_$Eog:function(){if(!this.$5cT){var n=this;this.$5cT=new _C(function(){n.$Za(n.$GI)},_a.$0.$16)}return this.$5cT},get_$AEF:function(){if(!this.$4Uo){var n=this;this.$4Uo=new _C(function(){n.$Za(n.$GM)},_a.$0.$16)}return this.$4Uo},get_$A9J:function(){if(!this.$4Sj){var n=this;this.$4Sj=new _C(function(){n.$Za(n.$Gd)},_a.$0.$16)}return this.$4Sj}};_mcp.$JR=function(n,t){this.$$d_$5FI=Function.createDelegate(this,this.$5FI);this.$$d_$6oY=Function.createDelegate(this,this.$6oY);this.$$d_$8ZS=Function.createDelegate(this,this.$8ZS);_mcp.$JR.initializeBase(this);this.$9M=n;this.$6Xe=t};_mcp.$JR.prototype={$9M:null,$5Ns:null,$5X:null,$RC:null,$NH:!1,$6Xe:null,$1t2:null,$3bg:null,$5M:null,set_$i8:function(n){if(this.$5X!==n){this.$5X=n;this.$4("ReadWriteRecipientWellViewModel")}return n},get_$E5m:function(){this.$5Ns||(this.$5Ns=new _C(this.$$d_$8ZS,_a.$0.$g7));return this.$5Ns},set_$3Uo:function(n){if(n!==this.$RC){this.$RC=n;this.$4("ReadOnlyRecipientWellViewModel")}return n},get_$Iu:function(){var o=this.$NH&&_rw.$4c.$Iu(this.$5X);if(this.$NH){var f;var n;var s="";var t="";var i="";var r="";if(this.$5X){for(var u=0;u<this.$5X.$3X.get_$A();u++){f=this.$5X.$3X.get_$E(u);if(f){s=f.$8m.get_$mk();i=i+" "+s}}for(var e=0;e<this.$5X.$Gb.get_$A();e++){n=this.$5X.$Gb.get_$E(e);if(n){t="";_js.$9.$1h(n.EmailAddress)?_js.$9.$1h(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.$0.$mg,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$1t2,o,i,r)}return o},get_$1L8:function(){return this.$NH&&!$C(this.$5X)&&this.$5X.$2NR},$2BV:function(){this.$NH&&this.$5X&&this.$5X.$ErP()},$C5q:function(n,t,i){this.$3bg=n;this.$NH=t;this.$5X?this.$5X.$5Lm(null):this.set_$i8(this.$7hs(null));var r=this.$5X.get_$9Q();if(r){r.set_$By("");r.$8LI(this.$3bg)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6oY);this.$1t2=i},$3e:function(n,t,i,r){this.$NH=i;this.$5M=t;if(i){this.$5X?this.$5X.$5Lm(n):this.set_$i8(this.$7hs(n));var u=this.$5X.get_$9Q();if(u){!_js.$9.$o(u.get_$By())&&_js.$9.$o(t)&&u.set_$By(t);_js.$9.$o(t)||u.set_$By(t)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6oY);this.$1t2=r}else this.$RC?this.$RC.$5Lm(n):this.set_$3Uo(this.$AQM(n))},$3A9:function(){$C(this.$5X)||this.$5X.$3A9()},$1zx:function(){this.$5X&&this.$5X.$1zx()},$3e9:function(){if(!$C(this.$5X)){this.$5X.set_$3e9(!0);this.$5X.set_$3e9(!1)}},$226:function(){var n;n=this.$NH?$C(this.$5X)?0:!this.$5X.get_$9Q()||_js.$9.$o(this.$5X.get_$9Q().get_$By())?this.$5X.$Gb.get_$A():this.$5X.$Gb.get_$A()+1:$C(this.$RC)?0:this.$RC.get_$xV().get_$A();return n},$51L:function(){if(this.$5X){for(var f="",u="",r="",i,n,t=0,o=this.$5X.$3X.get_$A();t<o;t++){i=this.$5X.$3X.get_$E(t);if(i&&!i.$KA){n=this.$5X.$Gb.get_$E(t);if(n){u=_js.$9.$1h(n.Name)?"":n.Name;f=_js.$9.$1h(n.EmailAddress)?"":n.EmailAddress;var e=String.format("( {0} , {1} ),",u,f);r+=e}}}r!==""&&_js.Trace.logInfo(_a.$0.$16,"{0} Well Invalid Recipients are: {1} \n",this.$1t2,r)}},$2A:function(){if(!$C(this.$5X)){this.$5X.set_$7Dl(!1);this.$5X.$1v();this.$5X=null}},$7hs:function(n){return this.$9M.$4Xv(_mcp.$JR.$2to,_pe.$1k.$1xH,n,!0)},$AQM:function(n){return this.$9M.$1CT(_mcp.$JR.$5LB,_bc.$6a.$11g,n,1)},$6oY:function(n,t){var r=n;var i=r.get_$9Q();if(this.$3bg&&this.$3bg.get_$A()>0){i.set_$By("");i.$8LI(this.$3bg)}_js.$9.$1h(this.$5M)||i.set_$By(this.$5M);r.$1B("FindRecipientViewModel",this.$$d_$6oY)},$8ZS:function(){if(this.$NH&&!OwaApplication.$Oy){_js.Trace.logInfo(_a.$0.$16,"User chose to launch rich people picker");this.$5X.$1zx();_a.$i.$Ii.$F("VM.PeoplePicker.Launched",_a.$8.get_$38());_a.$6.stPT(_a.$0.$g7,"PeoplePicker",3);_a.$6.$1g(_a.$0.$g7,"PeoplePicker");this.$6Xe.$AAA(this.$5X.$3X,this.$1t2,this.$$d_$5FI)}},$5FI:function(n){_y.$z.$1Q.get_$U()!=="TouchNarrow"&&this.$5X.$3X.$1u();var t=this;n.$Cj(function(n){var i=n;i.$KA?t.$5X.$317(i.$I3):t.$5X.$3gF(i.$I3)})},$638:function(){for(var t=this.$5X.$3X,r=null,n=0;n<t.get_$A();n++){var i=t.get_$E(n);if(i.$4uL){r=i;t.$5W(n);break}}return r}};_mcp.$3t=function(n,t){this.$$d_$6oj=Function.createDelegate(this,this.$6oj);this.$$d_$kN=Function.createDelegate(this,this.$kN);_mcp.$3t.initializeBase(this,[14,n]);this.$6R=t};_mcp.$3t.$Jx=function(n){var i=n.$5m(14);i&&i.$kN();var t=n.$5m(1);t&&t.$3e9()};_mcp.$3t.prototype={$6R:null,$5gf:!1,get_$3W0:function(){return this.$w(_mcp.$3t.$707)},set_$3W0:function(n){this.$P(_mcp.$3t.$707,n);return n},$3e:function(){if(!this.$5gf){this.$ElS();this.$5gf=!0;_g.$O.get_$Q().get_$6r().add_$1zu(this.$$d_$6oj);_g.$O.get_$Q().get_$6r().add_$3FF(this.$$d_$6oj)}this.$kN();_js.Trace.logInfo(_a.$0.$16,"Resize editor component initialized and resize editor called");_mcp.$14n.prototype.$3e.call(this)},$kN:function(){this.$C7Z()},$AV:function(){this.$Esw();this.$5gf=!1;_g.$O.get_$Q().get_$6r().remove_$1zu(this.$$d_$6oj);_g.$O.get_$Q().get_$6r().remove_$3FF(this.$$d_$6oj);_js.Trace.logInfo(_a.$0.$16,"Editor resize component reset");_mcp.$14n.prototype.$AV.call(this)},$C7Z:function(){!$C(this.get_$3W0())&&this.get_$3W0().$3s?this.get_$3W0().$11():this.$1n.$5m(27).set_$Nf(new _cmc.$1Cm)},$6oj:function(n,t){this.$kN()},$ElS:function(){if(this.$6R){var t=_js.$2q.$3AJ(this.$6R);var n=this;t.$8l("resize",function(t){n.$kN()},"EditorResizeComponent")}else _y.$z.$1Q.add_$1Go(this.$$d_$kN)},$Esw:function(){if(this.$6R){var n=_js.$2q.$3AJ(this.$6R);n.$Be("resize","EditorResizeComponent")}else _y.$z.$1Q.remove_$1Go(this.$$d_$kN)}};_mcp.$Kn=function(n,t,i){this.$$d_$AX6=Function.createDelegate(this,this.$AX6);this.$$d_$AX7=Function.createDelegate(this,this.$AX7);this.$$d_$8RQ=Function.createDelegate(this,this.$8RQ);this.$$d_$7HL=Function.createDelegate(this,this.$7HL);this.$$d_$B0=Function.createDelegate(this,this.$B0);this.$$d_$E6R=Function.createDelegate(this,this.$E6R);this.$WV={};_mcp.$Kn.initializeBase(this,[8,n]);this.$2Y=t;this.$E0=new _C(this.$$d_$B0,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=i};_mcp.$Kn.$7pk=function(n){var t=null;_h.$4A.isInstanceOfType(n)?t=n.$5i:_h.$49.isInstanceOfType(n)&&(t=n.$5i);return t};_mcp.$Kn.prototype={$Lx:null,$E0:null,$1D:null,$GQ:!1,$1Ts:!1,$3tx:!1,$4IN:null,$2Yw:!1,$14y:null,$4Cb:null,$2Y:null,$1gn:null,get_$1AP:function(){return this.$E0},get_$G9:function(){return this.$GQ},set_$G9:function(n){if(n!==this.$GQ){this.$GQ=n;this.$4("IsSaving")}return n},get_$C9h:function(){return this.$1Ts},$B0:function(){this.$7OK(null)},$7OK:function(n){var i=this.$1n;var r=i.$5m(5);var u=i.$v.$2F;var t=i.$v.$c;_js.Trace.logInfo(_a.$0.$16,"SaveStart:Context:"+t.toString());this.$3VU();if(!t.get_$6TI()){_js.Trace.logInfo(_a.$0.$16,"Save not supported for the current operation {0}",t.get_$6X());return}if(r.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Skip save and show attachment in progress dialog");u.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$1Ts=!0;this.$2NE("Save",n,null,!1)},$3e:function(){this.$2xE();_mcp.$14n.prototype.$3e.call(this)},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1gn){_js.Trace.logInfo(_a.$0.$16,"Setting save component override");this.$1gn=this.$v.get_$4IH().$AQp();var n=this.$1n.$5m(29);this.$1gn.$3e(this.$$d_$7HL,this.$$d_$8RQ,n.$$d_$AAs,n.$$d_$7Sk)}},$2F3:function(){if(this.$1gn){this.$1gn.$AV();this.$1gn=null}},$2NE:function(n,t,i,r){if(this.$1gn&&!this.$1gn.$8WT()){_js.Trace.logInfo(_a.$0.$16,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var f=this.$1n;var s=f.$v;var u=s.$c;var h=s.$1d;var e=u.get_$D1();var a=this.$1n.$v.get_$eM();var c=f.$5m(7);if(c.$bo&&!r){_js.Trace.logInfo(_a.$0.$16,"Send is in progress, this "+n+" save is ignored. ContextId="+e);return!0}if(this.$Lx.$1EM(e)){_js.Trace.logInfo(_a.$0.$16,"User already discarded, clearing all save processors to ignore save effects. ContextId="+e);this.$WV={};return!1}var o=f.$5m(1);o.$1zx();if(_g.$O.get_$Q().get_$6Yb()<o.$226()){h.$4r(800,null);_mcp.$3t.$Jx(f);return!0}o.$2zW();u.get_$3sY().$11();this.$WV[n]=new _mcp.$1NA(t,i);if(!this.$GQ||r){this.$4IN=_mcp.$1W.$33t(u);this.set_$G9(!0)}else{this.$3tx=!this.$4IN.$7oS(u);return!0}if(!u.get_$OV()&&!u.get_$Fd()&&!u.get_$1ZM()){_js.Trace.logInfo(_a.$0.$16,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+e);return!0}_a.$6.stPT(_a.$0.$16,"MailComposeSave",5);this.$14y=_y.$2F.$1g(_a.$0.$16,"MailComposeSave",!0);this.$4Cb=n;_js.$D.get_$Q().$1Yl(_a.$0.$16,"MailComposeSave");_js.Trace.logInfo(_a.$0.$16,"Started new task runner context before starting save.");try{this.$1gn?this.$1gn.$7HL(n):this.$7HL(n);return!0}catch(l){this.$8RQ(l);throw l;}},$AV:function(){this.$GQ=!1;this.$3tx=!1;this.$1Ts=!1;this.$2Yw=!1;this.$WV={};this.$4IN=null;this.$2F3();_mcp.$14n.prototype.$AV.call(this)},$5Nn:function(){this.$GQ=!1;this.$3tx=!1;_js.Trace.logInfo(_a.$0.$16,"ResumeSave:Context:"+this.$1n.$v.$c.toString());var i=this.$WV;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.$2NE(n.key,t.$2yW,t.$3nm,!0);break}},$E6R:function(){this.$2NE("Diagnostics",null,null,!1)},$6GJ:function(n){return _y.$5y.$4TX(n.$2H,40,50,60,700,88,89,43,57)},$5jV:function(n){if("InlineExit"in this.$WV||"Popout"in this.$WV){var u=this.$1n.$v;var t=u.$1d;var r=this.$6GJ(n);var e=new _y.$ty;var i=e.$4L(r,null);t.$ag(_mcp.$MZ.$wR);"InlineExit"in this.$WV?t.$4r(87,i):t.$4r(85,i);if(r===50){var f=this;u.$2TK.$9(function(n){n.$7SJ(t);_mcp.$3t.$Jx(f.$1n)})}else _mcp.$3t.$Jx(this.$1n)}else"Save"in this.$WV&&_mcp.$14n.prototype.$5jV.call(this,n)},$7HL:function(n){_js.Trace.logInfo(_a.$0.$dS,"Setup save action, context:"+this.$c_2.toString()+"; OriParentFolderId="+(this.$c_2.get_$IV()&&this.$c_2.get_$IV().get_$3G()&&_g.$b.$2I?_g.$b.$2I.idToName(this.$c_2.get_$IV().get_$3G()):"null"));var t=this.$v.$Xj.$5u1(this.$v,0,this.$1D);if((_h.$2k.isInstanceOfType(t)||_h.$49.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.$c_2.get_$1El()){var i=t;i.$14x=new _g.$8c(new _g.$7G("internalsubmission"))}this.$v.$n.$tE(t,this.$$d_$AX7,this.$$d_$AX6,null);_js.Trace.logInfo(_a.$0.$16,"Save action submitted")},$8RQ:function(n){this.set_$G9(!1);this.$1Ts=!1;var t=n.toString();_y.$2F.$1G(this.$14y,null,t,null,this.$6G3(this.$4Cb,n.message));this.$14y=null;_a.$6.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$16,"Save failed due to an error before action was submitted: "+t)},$9Iu:function(n){var f=this.$1n;var o=f.$v;var u=o.$c;var t=n.$99;var r=!1;if(this.$Lx.$1EM(t)){u.get_$D1()===t&&(this.$WV={});this.$3lq(n);var e=_mcp.$Kn.$7pk(n);if(e){_js.Trace.logInfo(_a.$0.$16,"Resume discard for context "+t);f.$5m(21).$5Nk(t,e)}r=!0}else if(t===u.get_$D1()){if(this.$2Yw){this.$2Yw=!1;_js.Trace.logInfo(_a.$0.$16,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+t);this.$WV={};this.$3lq(n);var i=null;_h.$4A.isInstanceOfType(n)?i=n.$5i:_h.$49.isInstanceOfType(n)&&(i=n.$5i);i&&u.set_$Fd(i);var s=f.$5m(7);s.$3XI();r=!0}else if(this.$3tx){_js.Trace.logInfo(_a.$0.$16,"Saving new content per user's request. ContextId="+t);this.$5Nn();r=!0}}else _js.Trace.logInfo(_a.$0.$16,"Skipping default save processing due to ContextId="+t+"; viewModelId="+o.$c.get_$D1());return r},$AX7:function(n){var r=this.$1n;var o=r.$v;var f=o.$c;var s=r.$5m(21);var u=n.$99;_js.Trace.logInfo(_a.$0.$16,"Save action returned success, ContextId="+u+"; Context:"+f.toString());if(!this.$9Iu(n)&&u===f.get_$D1()){this.$AU2(n);this.$8b9();var i=!1;var t=null;if("Attach"in this.$WV){if("AutoSave"in this.$WV){t=this.$WV.AutoSave;t&&t.$2yW(n)}t=this.$WV.Attach}else if("Popout"in this.$WV){t=this.$WV.Popout;var e=r.$5m(9);if(e&&e.$3ex&&"InlineExit"in this.$WV){t&&t.$2yW(n);t=this.$WV.InlineExit}}else if("InlineExit"in this.$WV)t=this.$WV.InlineExit;else if("AutoSave"in this.$WV){t=this.$WV.AutoSave;i=!0}else if("Save"in this.$WV){t=this.$WV.Save;i=!0}else"Diagnostics"in this.$WV&&(i=!0);t&&t.$2yW&&t.$2yW(n);i&&r.$5m(5).$7Nv();this.$WV={}}_y.$2F.$1G(this.$14y,null,"",this.$FJ(n),this.$6G3(this.$4Cb,""));this.$14y=null},$8b9:function(){var i="";var t=this.$WV;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.$0.$16,"ProcessorKeys:"+i)},$AX6:function(n){var o=this.$1n.$v.$c;var e=n.$99;_js.Trace.logInfo(_a.$0.$16,"Save action returned a failure, ContextId="+e+"; Context:"+o.toString());if(!this.$9Iu(n)&&e===o.get_$D1()){this.$8b9();var t=!1;var h=this.$WV;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.$3nm){u.$3nm(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){this.$7k6(n);t=!0}}else if(!t){this.$7k6(n);t=!0}}t||this.$3lq(n);this.$WV={}}var r="SaveFailure_UnknownError";var f="";if(_g.$4k.$1dc(n.$2H)){r=_g.$4k.$2LB(n.$2H)||"SaveFailure_UnknownError";f=n.$2H.FaultMessage}_y.$2F.$1G(this.$14y,null,r,this.$FJ(n),this.$6G3(this.$4Cb,f));this.$14y=null},$AU2:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;var f=n.$99;var o=this.$1Ts;if(f===t.get_$D1()){this.$EuA(n);t.set_$6Pt(!1);i.$9wk()}this.$6T("MailSaveSucceeded");if(f===t.get_$D1()&&o){var s=_a.$8.get_$38();var u=i.$1d;u.$ag(_mcp.$Kn.$wR);u.$4r(1001,s.$4I(0));_mcp.$3t.$Jx(r)}if(_a.$5N.$43){var e=r.$5m(25);e.$2BU(this.$1Ts?4:2)}this.$3lq(n)},$7k6:function(n){_js.Trace.logInfo(_a.$0.$16,"SaveActionFailed: Error: {0}",n.$2H.message);n.$99===this.$1n.$v.$c.get_$D1()&&this.$5jV(n);var t=this.$1n.$v;t.$1di&&t.set_$1Ei(!1);this.$3lq(n)},$3lq:function(n){var i=this.$1n;var t=i.$v.$c;if(n.$99===t.get_$D1()){this.set_$G9(!1);this.$1Ts=!1}_a.$6.endPT("MailComposeSave")},$FJ:function(n){var t=null;_h.$4A.isInstanceOfType(n)&&n.$68?t=n.$68.correlationId:_h.$49.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);return t},$6G3:function(n,t){var i=new _a.$3z;i.$CX("Ctx",n||"");i.$CX("Err",t||"");return i.toString()},$EuA:function(n){var t=this.$1n.$v.$c;t.set_$T9(this.$4IN);if(this.$1Ts){t.set_$1TQ(!0);this.$1Ts=!1;_js.Trace.logInfo(_a.$0.$16,"Explicit save recorded. ContextId="+t.get_$D1())}if(_h.$2k.isInstanceOfType(n)){var u=n;var r=u.$5i;u.$b.set_$y(r);t.set_$Fd(r);t.set_$j0(u.$b);_js.Trace.logInfo(_a.$0.$16,"Updated context from create action. Context:"+t.toString());this.$2Y.$AYf(r)}else if(_h.$49.isInstanceOfType(n)){var i=n;var s=i.$5i;i.$Fs.set_$y(s);t.set_$Fd(s);t.set_$j0(i.$Fs);_js.Trace.logInfo(_a.$0.$16,"Updated context from update action. Context:"+t.toString())}else if(_h.$Bk.isInstanceOfType(n)){var y=n;var v=y.$5i;t.set_$Fd(v);_js.Trace.logInfo(_a.$0.$16,"Updated context from create response action. Context:"+t.toString())}else if(_mcp.$sN.isInstanceOfType(n)){var p=n;var b=p.$1kM.$5i;t.set_$Fd(b);_js.Trace.logInfo(_a.$0.$16,"Updated context from create response from modern group action. Context:"+t.toString())}else if(_cc.$10h.isInstanceOfType(n)){var e=n;var w=e.meetingResponseMessageId;t.set_$Fd(w);t.set_$j0(e.$Ov);_js.Trace.logInfo(_a.$0.$16,"Updated context from create meeting response message. Context:"+t.toString())}else if(_c.$sM.isInstanceOfType(n)){var a=n;var c=a.$5i;t.set_$Fd(c);_js.Trace.logInfo(_a.$0.$16,"Updated context from create approval response action. Context:"+t.toString())}if(_h.$4A.isInstanceOfType(n)&&t.get_$j0()){var l=n;var f=l.$3hg;var o=t.get_$j0().get_$EW();if(f&&o){var h=0;var k=this;o.$Cj(function(n){var t=n;t.set_$6J(f[h]);h++});_js.Trace.logInfo(_a.$0.$16,"Attachment IDs have been updated.")}}}};_mcp.$II=function(n){this.$$d_$AV7=Function.createDelegate(this,this.$AV7);_mcp.$II.initializeBase(this,[20,n])};_mcp.$II.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$II.prototype={get_$Tg:function(){return this.$w(_mcp.$II.$24k)},set_$Tg:function(n){this.$P(_mcp.$II.$24k,n);return n},$3e:function(){if($C(this.get_$Tg())){var n=this.$3km(_fm.$d,_mcp.$II.$4Xd);if(n){this.set_$Tg(new _fm.$1u(n));this.get_$Tg().set_$AJO(new _C(this.$$d_$AV7,this.get_$m()))}}_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.get_$Tg()&&this.set_$Tg(null);_mcp.$14n.prototype.$AV.call(this)},$4PT:function(n,t){if(this.get_$Tg()){for(var u=_mcp.$II.$4Xd(n,new _C(this.$4Y4(n),this.get_$m())),i=this.get_$Tg().$1a,r=i.get_$A()-1;r>0;r--)if(_fm.$6V.isInstanceOfType(i.get_$E(r))){i.$6i(r+1,u);var f=i.get_$A()-r-1;f>t&&i.$5W(i.get_$A()-1);return}i.$F(new _fm.$6V);i.$F(u)}},$AV7:function(){if(this.get_$Tg()&&this.get_$Tg().$1Y){var f=this.get_$Tg().$1Y;var r=_g.$O.get_$Q().get_$1j().get_$4DQ();var e=r.$3M(f.$3V);if(e){for(var n=this.get_$Tg().$1a,t=n.get_$A()-1;t>0;t--)if(n.get_$E(t).$3V===f.$3V){n.$5W(t);var u=n.get_$A();_fm.$6V.isInstanceOfType(n.get_$E(u-1))&&n.$5W(u-1);break}var i=new(_a.$u.$$(String));r.get_$A()>0?i.$1yQ(r):i.$F("");_g.$O.get_$Q().get_$1j().set_$4DQ(i);_h.$21.$Kq(_g.$O.get_$Q().get_$1j().$Hm,OwaApplication.$2B)}}},$3km:function(n,t){var o=_g.$O.get_$Q().get_$4P().get_$2fO();var c=$C(o)?0:o.get_$A();var f=_g.$O.get_$Q().get_$1j().get_$4DQ();var r=$C(f)?0:f.get_$A();if(r===1&&f.get_$E(0)===""){f.$5W(0);r=0}var l=r>0?1:0;var u=new Array(1+c+r+l);var e=0;var i=_g.$O.get_$Q().get_$4P().get_$Fv();u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()));for(var s=0;s<c;s++){i=o.get_$E(s).EmailAddress;u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()))}if(r>0){u[e++]=new _fm.$6V;for(var h=0;h<r;h++){i=f.get_$E(h);u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()))}}return u},$4Y4:function(n){var t=this;return function(){_js.Trace.logInfo(_a.$0.$16,"User chose from="+n);t.$1n.$v.get_$ad().$4GQ(n,!0)}}};_mcp.$G6=function(n,t,i,r){this.$$d_$By9=Function.createDelegate(this,this.$By9);this.$$d_$9SF=Function.createDelegate(this,this.$9SF);this.$$d_$9SM=Function.createDelegate(this,this.$9SM);this.$$d_$E9N=Function.createDelegate(this,this.$E9N);this.$$d_$E9I=Function.createDelegate(this,this.$E9I);this.$$d_$DhL=Function.createDelegate(this,this.$DhL);this.$$d_$8Ic=Function.createDelegate(this,this.$8Ic);this.$$d_$8Id=Function.createDelegate(this,this.$8Id);this.$$d_$EZZ=Function.createDelegate(this,this.$EZZ);this.$$d_$EZa=Function.createDelegate(this,this.$EZa);this.$$d_$7Zy=Function.createDelegate(this,this.$7Zy);this.$$d_$3XI=Function.createDelegate(this,this.$3XI);this.$$d_$E9j=Function.createDelegate(this,this.$E9j);this.$$d_$E9s=Function.createDelegate(this,this.$E9s);_mcp.$G6.initializeBase(this,[7,n]);this.$LB=new _C(this.$$d_$E9s,this.get_$m());this.$1a3=new _C(this.$$d_$E9j,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=t;this.$3Y=i;this.$N=r};_mcp.$G6.prototype={$Lx:null,$1a3:null,$1D:null,$3Y:null,$N:null,$740:null,$73l:null,$LB:null,$bo:!1,$3ye:!1,$1le:null,$2XD:null,$3XF:null,$5gm:!1,$6m6:!1,$1Ns:null,get_$7G1:function(){return this.$1Ns?this.$1Ns.get_$7G1():null},get_$2XB:function(){return this.$LB},set_$2XB:function(n){this.$LB=n;return n},get_$m1:function(){return this.$bo},set_$m1:function(n){if(n!==this.$bo){this.$bo=n;this.$4("IsSending");var t=this.$1n.$v;t.set_$9qs(_u.CommonStrings.l_Sending_Text);t.set_$9kQ(n)}return n},get_$DOa:function(){return this.get_$6TT()&&this.$6m6},get_$6TT:function(){return this.$3Y.$2r("ComposeBread1")&&this.$v.$I.get_$U()==="Mouse"&&!this.$v.get_$3yL()&&!this.$c_2.get_$s0()&&!!this.$v.$1tw&&!!this.$v.$sv},get_$73e:function(){return this.$3XF},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1Ns){_js.Trace.logInfo(_a.$0.$16,"Setting send component override");this.$1Ns=this.$v.get_$4IH().$AR0();var t=this.$1n.$5m(29);var n=this.$1n.$5m(1);this.$1Ns.$3e(this.$v.get_$D1(),this.$$d_$3XI,this.$$d_$7Zy,this.$$d_$EZa,this.$$d_$EZZ,this.$$d_$8Id,this.$$d_$8Ic,this.$v.$n,this.$1n.$v.$9M,n.$$d_$Buu,n.$$d_$Bus,n.$$d_$Bur,n.$$d_$BjK,t.$$d_$AAs,t.$$d_$A3K,t.$$d_$7Sk)}},$2F3:function(){if(this.$1Ns){this.$1Ns.$AV();this.$1Ns=null}},$3e:function(){this.$2xE();var n=this.$1n.$5m(1);if(n){n.remove_$9Br(this.$$d_$DhL);n.remove_$9Bq(this.$$d_$7Zy);n.add_$9Br(this.$$d_$DhL);n.add_$9Bq(this.$$d_$7Zy)}_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.set_$m1(!1);this.$2F3();_mcp.$14n.prototype.$AV.call(this)},$3XI:function(){var u=this.$1n;var i=u.$v;var n=i.$c;var r=u.$5m(8);u.$5m(25).$EYQ();if(r.$GQ){r.$2Yw=!0;_js.Trace.logInfo(_a.$0.$16,"Send deferred due to in progress save.")}if(n.get_$OV()||n.get_$Fd()||n.get_$1ZM()){if(!r.$2Yw){var o=this.$1n.$5m(1);o.$2zW();_js.Trace.logInfo(_a.$0.$16,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IV()&&n.get_$IV().get_$3G()&&_g.$b.$2I?_g.$b.$2I.idToName(n.get_$IV().get_$3G()):"null"));var t=i.$Xj.$5u1(i,1,this.$1D);_js.Trace.logInfo(_a.$0.$16,"Submitting send action");var f=_g.$1H.$1Q;_bc.$Og.isInstanceOfType(f)&&(_h.$49.isInstanceOfType(t)?t.add_$28h(this.$$d_$E9I):_h.$2k.isInstanceOfType(t)&&t.add_$28h(this.$$d_$E9I));i.$n.$tE(t,this.$8Id(),this.$8Ic(),this.$$d_$E9N);_js.Trace.logInfo(_a.$0.$16,"Send action submitted")}}else{var e=n.get_$D1();_js.Trace.logInfo(_a.$0.$16,"Send was attempted during upgrade for context "+e+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$7Zy:function(){var i=this.$1n.$v.$1d;var t=this.$1n.$v.get_$ad();var n=null;this.set_$m1(!1);if(t.$GI.get_$1L8()||t.$GM.get_$1L8()||t.$Gd.get_$1L8()){i.$4r(65,null);n=_js.$1I.$Gx(_bc.InfoBarMessageId,65);this.$N.$1p(_a.$CH,new _a.$CH(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}if(t.get_$4vk()){i.$4r(66,null);n=_js.$1I.$Gx(_bc.InfoBarMessageId,66)}_mcp.$3t.$Jx(this.$1n);this.$7pN();n=n||"CancelSend_UnknownError";this.$lF(n,null,null)},$7pN:function(){var n=this;_js.$D.get_$Q().$2V(_a.$0.$16,"ExitResolvingRecipientsMode",function(){n.$3ye=!1},2e3)},$7Tt:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.$O.get_$Q().get_$4P().get_$Fv()&&!_h.$2k.$4nD(n)){var i=_g.$O.get_$Q().get_$1j().get_$4DQ();if(!$C(i)){if(i.$5l(r))return;i.get_$A()===1&&i.get_$E(0)===""&&i.$5W(0)}var t=new(_a.$u.$$(String));t.$F(r);t.$1yQ(i);t.get_$A()>_mcp.$G6.$6Yc&&t.$5W(t.get_$A()-1);_g.$O.get_$Q().get_$1j().set_$4DQ(t);_h.$21.$Kq(_g.$O.get_$Q().get_$1j().$Hm,OwaApplication.$2B);var u=this.$1n.$5m(20);u.$4PT(r,_mcp.$G6.$6Yc)}}},$6GJ:function(n){var t;var i=_a.$4.$4or(n.$2H);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.$Er4(n.$2H,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:_y.$5y.$4TX(n.$2H,45,55,62,700,88,89,46,58))}return t},$8Id:function(){return this.$740||this.$$d_$9SM},$8Ic:function(){return this.$73l||this.$$d_$9SF},$EZa:function(n){this.$740=n},$EZZ:function(n){this.$73l=n},$Er4:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.$3D.$rd(i)==="Value"&&_a.$3D.$8DE(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$3D.$YG(i))){t.val=48;return!0}}t.val=-1;return!1},$E9s:function(){if(this.$1Ns&&!this.$1Ns.$8WT()){_js.Trace.logInfo(_a.$0.$16,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.$6.stPT(_a.$0.$16,"MailComposeSend",5);this.$5gm=!0;this.$2XD=_y.$2F.$1g(_a.$0.$16,"MailComposeSend",!0);this.get_$6TT()&&(this.$3XF=_y.$2F.$1g(_a.$0.$16,"MailComposeSendClose",!0));_js.Trace.logInfo(_a.$0.$16,"SendStart:Context:"+this.$c_2.toString());this.$3VU();this.$c_2.get_$T0()?this.$Dt3():this.$9Or()},$Dt3:function(){var n=this;var t=function(t){n.$lF(_js.$1I.$Gx(_bc.InfoBarMessageId,t),null,null);n.$c_2.set_$4IJ(null);n.$7Zy();t!==-1&&n.$7Sj(_u.Strings.l_Smime_CannotSend_Text,t)};if(this.$c_2.get_$4IJ())this.$9xm(t);else{var i=this;this.$v.get_$Eiy().$AFU(13,function(n){if(i.$c_2.set_$4IJ(n))i.$9xm(t);else{t(-1);_js.Trace.logWarning(_a.$0.$53,"The send is canceled due to unavailable cert.")}})}},$9xm:function(n){var t=new _h.$ld(200,this.$c_2.get_$4IJ(),!0);var i=this,r=this;this.$1n.$v.$n.$tE(t,function(){_js.Trace.logInfo(_a.$0.$53,"Retrieving certs info completed.");if(t.get_$4d().IsValid)i.$9Or();else{_js.Trace.logWarning(_a.$0.$53,"Retrieving certs info determined the certificate is INVALID.");switch(t.get_$4d().ChainValidityStatus){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.$0.$53,"Retrieving certs info failed. "+t.$2H.message);n(743)},null)},$9Or:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to send, start force resolve recipients");this.$3ye=!0;var n=this.$1n.$5m(1);n.$3W3(!0)},$DhL:function(){if(this.$bo){_js.Trace.logInfo(_a.$0.$16,"Skip send since another send is in progress");return}this.set_$m1(!0);this.$3ye=!0;_js.$D.get_$Q().$1Yl(_a.$0.$16,"MailComposeSend");_js.Trace.logInfo(_a.$0.$16,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.$CGE(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.$0.$16,"waiting for a pending validation decision, once decided, send will resume"):this.$7Go():this.set_$m1(!1);r=!1}finally{if(r){this.set_$m1(!1);_js.Trace.logWarning(_a.$0.$16,"Send failed due to an unhandled exception thrown before the action was submitted");this.$lF("SendFailure_UnhandledException",null,null)}}},$7Go:function(){this.$c_2.set_$3Fz(!1);if(this.$1Ns)this.$1Ns.$AAe();else{this.$3XI();var n=!1;if(this.get_$6TT()&&!this.$c_2.get_$3yg()){if(this.$v.$sv.get_$bs()){var i=this;this.$v.$sv.$9(function(t){t.get_$3od()>0&&(n=!0)})}if(!n&&this.$v.$1tw.get_$bs()){var r=this;this.$v.$1tw.$9(function(t){t.get_$E9a()>0&&(n=!0)})}if(!n){_js.Trace.logInfo(_a.$0.$16,"Navigating away after submitting action for send via notification");this.$c_2.set_$3Fz(!0);this.$6m6=!0;this.$943();var t=this;this.$v.$1tw.$9(function(){t.$N.$1p(ISendEvent,new _mcp.$1PW(t.$v))})}}}},$CGE:function(n){n.val=!1;var f=this.$1n;var r=f.$v;var t=f.$5m(1);var o=f.$5m(5);var u=r.$1d;var h=f.$5m(25);if(this.$Lx.$1EM(r.$c.get_$D1())){_js.Trace.logInfo(_a.$0.$16,"User had already discarded, skipping send.");this.$lF("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.get_$4vk()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since sender's address is invalid");u.$4r(66,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!r.$c.get_$1El()&&t.$GI.get_$Iu()&&t.$GM.get_$Iu()&&t.$Gd.get_$Iu()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since no recipients were specified");u.$4r(70,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.$GI.get_$1L8()||t.$GM.get_$1L8()||t.$Gd.get_$1L8()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$4vk(),t.$GI.get_$1L8(),t.$GM.get_$1L8(),t.$Gd.get_$1L8());t.$51L();u.$4r(65,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since attachment is in progress");var c=r.$2F;c.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null,!1,null,null,null,c.$6R);this.$lF("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.$O.get_$Q().get_$6Yb()<t.$226()){u.$4r(800,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.$5N.$43&&h.$CF6()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since policy violation detected");var l=r.$2F;l.$44(0,h.$Btd(),null,!1,null,null,null,l.$6R);this.$lF("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.$9.$o(this.$v.$c.get_$3o())){n.val=!0;var s=r.$2F;s.$RN(2,[_nbs.NonBootStrings.l_MailComposeForgottenSubjectMessage_Text],this.$$d_$By9,!1,_nbs.NonBootStrings.l_MailComposeForgottenSubjectSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectTitle_Text,s.$6R);return!1}else if(o&&o.get_$9Z()&&this.$v.$1D3)if(this.$1le)return this.$7b6();else{n.val=!0;var i=this;this.$v.$1D3.$9(function(n){i.$1le=n.$7gZ(i.$v.$2F,i.$LB);i.$7b6()?i.$7Go():i.set_$m1(!1)})}else if(this.$c_2.get_$s0())if(this.$c_2.get_$ow()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.get_$C0u()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithModernGroups_Text,0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.$c_2.get_$EW()){var e=new(_ff.$18.$$(String));var a=this;this.$c_2.get_$EW().$Cj(function(n){_g.$54.isInstanceOfType(n)||_g.$7d.isInstanceOfType(n)||_g.$7R.isInstanceOfType(n)||e.$F(n.get_$1x())});if(e.get_$A()>0){_a.$3m.$44(String.format(_u.Strings.l_Smime_NotSupportedWithCloudAttachments_Text,e.get_$1y().join(", ")),0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},$7b6:function(){var n=this.$v.get_$eM();try{if(this.$1le.$4qJ(this.$v.$c,n.get_$9Z().get_$1m())){this.$lF("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.$0.$16,t,"An exception has been caught for FAD check; keep sending",this.$1le,this.$v.$c,n.get_$9Z().get_$1m())}return!0},$9SM:function(n){var o=this.$1n;var i=o.$v;var t=i.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$16,"Send action succeeded, ContextId="+f+"; Context:"+t.toString());this.$7BV();var e=!1;var h=_g.$1H.$1Q;_bc.$Og.isInstanceOfType(h)&&(e=!0);t.get_$3Jg()&&!e&&this.$7Tt(t.get_$5Q());if(t.$32m&&t.$32m.length>0){var s=this.$1n.$v.$1d;s.$4r(742,t.$32m);_js.Trace.logInfo(_a.$0.$16,"Showing infobar message for Bcc forking failed");this.set_$m1(!1);i.$n.$6wV(n);this.$lF(_js.$1I.$Gx(_bc.InfoBarMessageId,742),null,null)}else{if(f===t.get_$D1()){t.set_$T9(null);if(this.$c_2.get_$3Fz()){_js.Trace.logInfo(_a.$0.$16,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var c=this;this.$v.$1tw.$9(function(){c.$N.$1p(ISendSucceededEvent,new _mcp.$1Pc(i))})}else{_js.Trace.logInfo(_a.$0.$16,"Context match, navigating away from compose at the end of send success. ContextId="+f);this.$943()}}else _js.Trace.logInfo(_a.$0.$16,"Context does not match, skipping navigating away from compose.");this.$6T("MailSendSucceeded");var u=!i.get_$eM()||!i.get_$eM().get_$9Z()?null:i.get_$eM().get_$9Z().$Bjv();var r=this.$Bl4(t);r?u&&(r=r+"|"+u):r=u;this.$AmY(r)}this.$N.$1p(_a.$CH,new _a.$CH(_nbs.NonBootStrings.l_MailComposeSendComponent_AT_LiveRegion_Text))},$943:function(){var t=this.$1n;var n=t.$v;var i=t.$5m(2);n.set_$1Ei(!0);i.get_$5F().$2Si(n,!0)},$9SF:function(n){var r=this.$1n.$v;var t=r.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$16,"Send action failed, ContextId="+f+"; Context:"+t.toString());var i="SendFailure_UnknownError";var u="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LB(n.$2H);u=n.$2H.FaultMessage}if(f===t.get_$D1()){if(t.get_$1xI()&&t.get_$1xI().length>0){var o=this.$1n.$v.$1d;o.$4r(65,t.get_$1xI())}this.set_$m1(!1);_js.Trace.logInfo(_a.$0.$16,"Context match. Showing infobar message for ResponseCode="+i);this.$5jV(n);if(this.$c_2.get_$3Fz()){_js.Trace.logInfo(_a.$0.$16,"Raise send failed event for send via notification");t.set_$9SG(this.$6GJ(n));var e=this;this.$v.$sv.$9(function(){e.$N.$1p(ISendFailedEvent,new _mcp.$1PX(r))})}}else _js.Trace.logInfo(_a.$0.$16,"Context does not match. Skip showing infobar message for ResponseCode="+i);this.$lF(i,this.$FJ(n),u);r.$n.$6wV(n)},$E9N:function(n){this.$4cr();this.$8Nq()&&this.$N.$1p(_y.$tz,new _y.$tz(6))},$8Nq:function(){return this.$3Y.$2r(_mcp.$G6.$8bl)||_a.$2D.$4pN(window.location.href,"survey")==="1"?!0:!1},$FJ:function(n){var t=null;_h.$4A.isInstanceOfType(n)&&n.$68?t=n.$68.correlationId:_h.$49.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);return t},$E9j:function(){this.$1n.$v.get_$5zV()&&this.$LB.$3s&&this.$LB.$11()},$7BV:function(){var t=this.$v.get_$ad();var n=this.$v.get_$eM();_js.Trace.logInfo(_a.$0.$16,"Check to see if we have attachments to set permissions for");n.get_$9Z()&&n.get_$9Z().get_$4qU()&&n.get_$9Z().$9gA(t.$BjJ())},$Bl4:function(n){if(!n)return null;var r=n.get_$6P()==="HTML"?"html":"text";var i;i=n.get_$6X()===1||n.get_$6X()===2||n.get_$6X()===3?n.get_$OV()?"yes":"no":"na";var u=n.$52e;var t=new _a.$3z;t.$CX("BT",r);t.$CX("U",i);t.$5H("S",u);t.$5H("O",n.get_$6X());return t.toString()},$lF:function(n,t,i){if(this.$2XD){_y.$2F.$1G(this.$2XD,null,n,t,i);this.$2XD=null}if(this.$3XF){_y.$2F.$1G(this.$3XF,null,n,t,i);this.$3XF=null}this.$4cr()},$AmY:function(n){if(this.$2XD){_y.$2F.$1G(this.$2XD,null,null,null,n);this.$2XD=null}},$4cr:function(){if(this.$5gm){_a.$6.endPT("MailComposeSend");this.$5gm=!1}},$By9:function(n,t){n&&this.$7Go()},$E9I:function(n){var i=this.$1n;var r=i.$v;var t=r.$c;_h.$2k.isInstanceOfType(n)&&n.remove_$28h(this.$$d_$E9I);_h.$49.isInstanceOfType(n)&&n.remove_$28h(this.$$d_$E9I);t.get_$3Jg()&&this.$7Tt(t.get_$5Q())}};_mcp.$1LA=function(n){this.$$d_$A3K=Function.createDelegate(this,this.$A3K);this.$$d_$AAs=Function.createDelegate(this,this.$AAs);this.$$d_$7Sk=Function.createDelegate(this,this.$7Sk);_mcp.$1LA.initializeBase(this,[29,n])};_mcp.$1LA.prototype={$A3K:function(n,t){this.$7Sj(n,t)},$7Sk:function(n){this.$3gR(n)},$AFU:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.$0.$53,i.message);if(_a.$2f.$1UI(i)){_a.$2f.$1Ha(i,n);e.$3gR(i);t(null)}else{_js.Trace.logException(_a.$0.$53,i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.$c.$4AK(!0,!0,!1,!1,!1);if(i)if(_a.$2f.$3zQ(i))this.$3gR(i);else throw i;_js.Trace.logInfo(_a.$0.$53,"S/MIME choosing a cert...");var r;var u=_g.$O.get_$Q();r=u.get_$VV().AllowUserChoiceOfSigningCertificate&&u.get_$1j().get_$2oI()?u.get_$1j().get_$2ZI():null;_js.Trace.logInfo(_a.$0.$53,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.$c.$1A9.$6IH(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.$2f.$9("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},$AAs:function(n,t,i,r){var c=_g.$O.get_$Q().get_$VV();var l=_g.$O.get_$Q().get_$1j();var e=this.$BrQ(t,this.$c_2.get_$T0(),this.$c_2.get_$PT());e=e||"SMIMEComposeUndefinedCtq";var d=_a.$6.$1g(_a.$0.$53,e,!0);var nt=this.$c_2.get_$6X();var it=this.$c_2.get_$5j();var y=c.AlwaysSign;var p=c.AlwaysEncrypt;var w=l.get_$2ZP();var v=l.get_$2ZN();var h=c.ClearSign;var s=c.TripleWrapSignedEncryptedMail;var ht=this;var st=function(n){_a.$6.$1G(d,e,"",null,ht.$7YG(nt,it,y,p,w,v,h,s));$C(i)||i(n)};var ot=this;var tt=function(n){_a.$6.$1G(d,e,n.message,null,ot.$7YG(nt,it,y,p,w,v,h,s));$C(r)||r(n)};try{_js.Trace.logInfo(_a.$0.$53,"Building S/MIME data package...");_js.Trace.logInfo(_a.$0.$53,"Admin.AlwaysEncrypt="+p);_js.Trace.logInfo(_a.$0.$53,"Admin.AlwaysSign="+y);_js.Trace.logInfo(_a.$0.$53,"Admin.IsClearSign="+h);_js.Trace.logInfo(_a.$0.$53,"Admin.TripleWrap="+s);_js.Trace.logInfo(_a.$0.$53,"User.AlwaysEncrypt="+v);_js.Trace.logInfo(_a.$0.$53,"User.AlwaysSign="+w);_js.Trace.logInfo(_a.$0.$53,"User.SigningCert="+l.get_$2y0());_js.Trace.logInfo(_a.$0.$53,"User.SigningCertId="+l.get_$2ZI());_js.Trace.logInfo(_a.$0.$53,"Context.Encrypt="+this.$c_2.get_$PT());_js.Trace.logInfo(_a.$0.$53,"Context.Sign="+this.$c_2.get_$T0());var f;if(t===2&&this.$c_2.get_$PT()){var u=this.$v.get_$ad();var k=u.$NH?u.$GI.$5X.$Gb:u.$GI.$RC.get_$xV();var b=u.$NH?u.$GM.$5X.$Gb:u.$GM.$RC.get_$xV();var g=u.$NH?u.$Gd.$5X.$Gb:u.$Gd.$RC.get_$xV();var at=k?k.get_$A():0;var lt=b?b.get_$A():0;var ct=g?g.get_$A():0;var a=at+lt;f=this.$c_2.$1i1?this.$c_2.$1i1===1?this.$c_2.$4p8(0,a):this.$c_2.$1i1===2?this.$c_2.$4p8(a+this.$c_2.$3kv,1):this.$c_2.$1i1===3?this.$c_2.$4p8(a,ct):null:this.$c_2.get_$9mj()}else f=null;var rt=this.$1kK();var et=JsonParser.serialize(rt.get_$Ad());var ft=f?JsonParser.serialize(f):null;var o;if(!this.$c_2.get_$T0()&&this.$c_2.get_$PT())o=6;else if(this.$c_2.get_$T0()&&!this.$c_2.get_$PT())o=h?11:10;else if(this.$c_2.get_$T0()&&this.$c_2.get_$PT())o=s?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");var ut=this;_a.$c.$1A9.$ARE(o,et,ft,this.$c_2.get_$4IJ(),function(t){ut.$AmK(t,n,st,tt)})}catch(vt){this.$7pr(vt,tt)}},$1kK:function(){var n=new _g.$5w;n.set_$4n(this.$c_2.$7fd());n.get_$4n().get_$6P()==="HTML"&&n.get_$4n().set_$1Z(_a.$37.$6yz(n.get_$4n().get_$1Z(),!0));this.$DuN(n,this.$v.get_$eM().get_$9Z().get_$1m());n.set_$5Q(new _g.$8w);n.get_$5Q().Mailbox=this.$c_2.$3sl();if(!n.get_$5Q().Mailbox){var t=_g.$O.get_$Q().get_$4P();n.get_$5Q().Mailbox=new _g.$1K;n.get_$5Q().Mailbox.Name=t.get_$Lk();n.get_$5Q().Mailbox.EmailAddress=t.get_$Fv()||t.get_$sA();n.get_$5Q().Mailbox.MailboxType="Mailbox";n.get_$5Q().Mailbox.RoutingType="SMTP"}n.set_$79(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$79()&&n.get_$79().$3y(this.$c_2.get_$79().$3Q());n.set_$7x(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$7x()&&n.get_$7x().$3y(this.$c_2.get_$7x().$3Q());n.set_$3o(this.$c_2.get_$3o());n.set_$Bv(this.$c_2.get_$Bv());n.set_$ET(this.$c_2.get_$ET());n.set_$172(_a.$8.get_$38());n.set_$Q8(this.$c_2.get_$Q8());n.set_$Qu(this.$c_2.get_$Qu());if(n.set_$a7(this.$c_2.get_$a7())){n.set_$1xt(this.$c_2.get_$1xt());n.set_$l4(this.$c_2.get_$l4());n.set_$h0(this.$c_2.get_$h0());n.set_$eW(this.$c_2.get_$eW())}return n},$DuN:function(n,t){if(t&&t.get_$A()){var i=new(_a.$2T.$$(_g.Attachment,_g.$Bg));var f=new(_ff.$18.$$(_y.$OU));var s=this;t.$Cj(function(t){var o=t;var r=o.get_$9P();if(r.get_$2mt()){_js.Trace.logInfo(_a.$0.$53,"Skipping SmimeDataPackage.");return}if(!(_g.$54.isInstanceOfType(r)||_g.$7d.isInstanceOfType(r)||_g.$7R.isInstanceOfType(r))){_js.Trace.logWarning(_a.$0.$53,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.get_$1x());return}if(n.get_$4n().get_$6P()==="HTML"&&r.get_$CA()&&n.get_$4n().get_$1Z().indexOf(r.get_$SF())<0){_js.Trace.logInfo(_a.$0.$53,"Removing unreferenced inline attachment: {0}",r.get_$SF());f.$F(o);return}if(_g.$7R.isInstanceOfType(r)){var e=r;var u=new _g.$7d;u.set_$1x(e.get_$1x());u.set_$KN(e.get_$KN()||"message/rfc822");u.set_$8D(e.get_$8D());u.set_$c4(e.get_$c4());i.$F(u)}else i.$F(r)});for(var u=f.get_$1y(),e=u.length,r=0;r<e;++r){var o=u[r];this.$v.get_$eM().get_$9Z().$1X2(o,!1)}n.set_$1m(i.get_$A()>0?i:null)}},$AmK:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.$2f.$1Ha(_a.$2f.$9("Cannot encode the message.",u.ErrorCode),15);this.$7pr(f,r)}else{_js.Trace.logInfo(_a.$0.$53,"S/MIME data package built successfully.");this.$c_2.set_$9mi(u.Data);i(t)}},$7pr:function(n,t){_js.Trace.logWarning(_a.$0.$53,n.message);if(_a.$2f.$1UI(n))this.$3gR(n);else{_js.Trace.logException(_a.$0.$53,n,"Unknown error occurred when building data package.");n=_a.$2f.$1Ha(_a.$2f.$9(n.message,11),15);this.$3gR(n)}t(n)},$7YG:function(n,t,i,r,u,f,e,o){var s=new _a.$3z;s.$CX("O",_y.$1m.toString(n));s.$CX("M",_y.$Ox.toString(t));s.$Ik("AS",i);s.$Ik("AE",r);s.$Ik("UAS",u);s.$Ik("UAE",f);s.$Ik("CS",e);s.$Ik("TW",o);return s.toString()},$BrQ:function(n,t,i){var r=null;t&&!i?n===2?r="SMIMESendSign":n===3&&(r="SMIMESaveSign"):!t&&i?n===2?r="SMIMESendEncrypt":n===3&&(r="SMIMESaveEncrypt"):t&&i&&(n===2?r="SMIMESendSignAndEncrypt":n===3&&(r="SMIMESaveSignAndEncrypt"));return r}};_mcp.$1L9=function(n,t){_mcp.$1L9.initializeBase(this,[23,n]);this.$l=t};_mcp.$1L9.prototype={$l:null,$3e:function(){if(!this.get_$G8()&&this.$l.get_$5e().get_$Fb().get_$5a8()===2&&this.$l.get_$15T().get_$Eb4().get_$C1D()){var n=this.$1n.$5m(5);_mcp.$Ma.$3Il(this.$1n.$v)&&!$C(n)&&($C(n.get_$9Z())||n.get_$9Z().$A4Z())}_mcp.$14n.prototype.$3e.call(this)}};_mcp.$G7=function(n,t){this.$$d_$7Ty=Function.createDelegate(this,this.$7Ty);_mcp.$G7.initializeBase(this,[12,n]);this.$4Pj=new _C(this.$$d_$7Ty,this.get_$m());this.$1D=t;this.$1E=_a.UserAgent.getInstance();this.$6K=_a.$6i.$9()};_mcp.$G7.$6IG=function(n,t){return t?n.get_$1Hm():n.get_$1Ya()};_mcp.$G7.prototype={$4Pj:null,$1D:null,$4I0:null,$7DD:!1,$1E:null,$6K:null,set_$7Fh:function(n){if(this.$4I0!==n){this.$4I0=n;this.$4("Signature")}return n},set_$Xa:function(n){this.$7DD=n;this.$4("ShouldAutoAddSignature");return n},$3e:function(){if(this.$1n.$v.$c.get_$Xa()&&this.$ACH()){_a.$6.stPT(_a.$0.$16,"MailComposeAutoSig",5);var n=_a.$6.$1g(_a.$0.$16,"MailComposeAutoSig",!0);this.set_$Xa(!0);this.$7Ty(!0);_a.$6.$1G(n);_a.$6.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$16,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_mcp.$14n.prototype.$3e.call(this)},$Bk9:function(){var n=this.$1E.get_$Df()?"<P></P>":"<P><BR></P>";return n+n},$ACH:function(){var n=_g.$O.get_$Q().get_$1j();return"Mouse"===_y.$z.$1Q.get_$U()?n.get_$qc():this.$1E.get_$8a()?this.$6K.$64("MOWA.IsSignatureChanged")==="true"?this.$6K.$64("MOWA.AutoAddSignature")==="true":!0:n.get_$1Pm()},$7ZH:function(n,t){if("Mouse"===_y.$z.$1Q.get_$U())return _mcp.$G7.$6IG(n,t);if(this.$1E.get_$8a()){if(this.$6K.$64("MOWA.IsSignatureChanged")==="true")if(this.$6K.$64("MOWA.UseDesktopSignature")==="true")return _mcp.$G7.$6IG(n,t);else{var r=this.$6K.$64("MOWA.SignatureText")||"";return t?_a.$1J.$1yP(r):r}return t?_a.$1J.$1yP(_c.$MI.$4oH(this.$1E)):_c.$MI.$4oH(this.$1E)}if(n.get_$1IW())return _mcp.$G7.$6IG(n,t);else{var i=n.get_$1Yb()||"";return t?_a.$1J.$1yP(i):i}},$7Ty:function(n){var o=null;var a=this.$1n.$5m(27);var c=this.$1n.$v.$c;var h=_g.$O.get_$Q().get_$1j();if(n)c.set_$6Pt(!0);else{_a.$6.stPT(_a.$0.$16,"MailComposeInsertSig",3);o=_a.$6.$1g(_a.$0.$16,"MailComposeInsertSig",!0)}var t=c.get_$6P()==="HTML"&&this.$1D.get_$NE();if(t){var r=this.$7ZH(h,t);if(_js.$9.$o(r))_js.Trace.logInfo(_a.$0.$16,"Skipping inserting blank signature in HTML format.");else{var l='<DIV id = "Signature">';var v="</DIV>";var y=n?this.$Bk9():_mcp.$G7.$9mR;var e=y+l+r.replace(_mcp.$G7.$9L3," ")+v;_js.Trace.logInfo(_a.$0.$16,"Insert signature for mouse html OriSig="+r+"; FormattedSig="+e);this.set_$7Fh(e)}}else{var u=this.$7ZH(h,t);if(_js.$9.$o(u))_js.Trace.logInfo(_a.$0.$16,"Skipping inserting blank signature in text format.");else{var f="\n\n"+u;_js.Trace.logInfo(_a.$0.$16,"Insert signature for touch text OriSig="+u+"; FormattedSig="+f);this.set_$7Fh(f)}}var s=!_js.$9.$o(this.$4I0);if(s){var i=new _cmc.$MV(0,this.$4I0,t);i.$28Y=!0;i.$2zX=!1;a.set_$Nf(i)}else _js.Trace.logInfo(_a.$0.$16,"Skip insert signature due to HasSignature="+s+";");if(!n){_a.$6.$1G(o);_a.$6.endPT("MailComposeInsertSig")}}};_mcp.$ui=function(n,t,i){this.$$d_$3tc=Function.createDelegate(this,this.$3tc);this.$$d_$2WV=Function.createDelegate(this,this.$2WV);this.$$d_$6LK=Function.createDelegate(this,this.$6LK);this.$$d_$5xY=Function.createDelegate(this,this.$5xY);this.$$d_$4CZ=Function.createDelegate(this,this.$4CZ);this.$$d_$9kl=Function.createDelegate(this,this.$9kl);this.$$d_$Ea5=Function.createDelegate(this,this.$Ea5);_mcp.$ui.initializeBase(this,[11,n]);this.$5a=new _C(this.$$d_$9kl,this.get_$m());this.$3Y=t;this.$1D=i};_mcp.$ui.$AL5=function(n){if(OwaApplication.$Oy)return null;var t=n.$5m(24);return new _y.$1P(_y.$U.get_$2df(),_y.$U.get_$7W6(),_u.CommonStrings.l_AppsTouch_Text,t.$15W)};_mcp.$ui.prototype={$5a:null,$1ah:null,$1oH:!1,$3Y:null,$1D:null,$6Oo:!1,get_$5rh:function(){return this.$1ah},set_$5rh:function(n){if(n!==this.$1ah){this.$1ah=n;this.$4("CloseConfirmDialogButtonData")}return n},get_$2Na:function(){return this.$1oH},set_$2Na:function(n){if(n!==this.$1oH){this.$1oH=n;this.$4("IsCloseConfirmDialogShown")}return n},set_$C8Z:function(n){if(n!==this.$6Oo){this.$6Oo=n;this.$4("IsAppBarSetup")}return n},$Ea5:function(){var i=this.$1n;var u=i.$v.$c;_js.Trace.logInfo(_a.$0.$16,"Setup appbar menu. Context: "+u.toString());var n=new(_ff.$18.$$(_y.$2a));var t=i.$5m(1);_g.$O.get_$Q().get_$1j().get_$1Ip()?n.$F(t.get_$6LF()):n.$F(t.get_$7E8());if(u.get_$3Jg())if(_g.$O.get_$Q().get_$1j().get_$tY()){n.$F(t.get_$4rA());t.$2Oo=!1}else{n.$F(t.get_$3at());t.$2Oo=!0}else t.$2Oo=!1;OwaApplication.$Oy||n.$F(new _y.$2a(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,t.$1Nc));var e=i.$5m(6);n.$F(e.$ta);var r=i.$5m(3);if(r.$ta&&r.$5q6()){n.$F(r.$ta);r.$2Ny=!0}else r.$2Ny=!1;var f=i.$5m(10);n.$F(new _y.$2a(_nbs.NonBootStrings.l_ShowMessageOptions_Text,f.$3b1));i.$v.$5w.set_$vh(n.get_$1y());this.set_$C8Z(!0)},$3e:function(){var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$16,"InitTouchComponent:Context:"+i.toString());n.$5w||this.$2Fi();t.$5m(23);_mcp.$14n.prototype.$3e.call(this)},$3tc:function(n,t){if(this.$1n.$v.$1di)return!1;else if(this.$7DG()){this.$1oH||this.$9kl();return!0}else if(this.$1n.$v.$c.get_$1Lk()&&!this.$m1()){_js.Trace.logInfo(_a.$0.$16,"Removing unedited reply forward draft if user clicks outside the form.");this.$5xY();return!0}else{this.$1n.$v.set_$1Ei(!0);var r=this.$1n;var i=r.$5m(2);i&&i.get_$5F()&&i.get_$5F().set_$3J7(!0);return!1}},$m1:function(){var n=this.$1n.$5m(7);return n.$bo},$2Fi:function(){var t=this.$1n;var f=t.$v;var o=f.$c;var l=t.$5m(7);var c=new _y.$1P(_y.$U.get_$wl(),_y.$U.get_$4DU(),_u.CommonStrings.l_SendItemMobile_Text,l.$LB);var h=_y.$1P.$SG(_nbs.NonBootStrings.l_Close1_Text,this.$5a);var u=_mcp.$ui.$AL5(t);var r=this.$AO9(o,t);var e=2;e+=u?1:0;e+=r?1:0;var n=new Array(e);var i=0;n[i++]=c;u&&(n[i++]=u);n[i++]=h;r&&(n[i++]=r);_js.Trace.logInfo(_a.$0.$16,"Creating appbar. ContextId="+o.get_$D1());var s=_y.$1i.$FE(f,n,null);s.set_$3IN("TouchNarrow"===_y.$z.$1Q.get_$U());f.$EVe(s)},$9kl:function(){var t=this.$1n;var i=t.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$16,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if(this.$m1()){_js.Trace.logInfo(_a.$0.$16,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.$7DG()){this.$9jV();_js.Trace.logInfo(_a.$0.$16,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$2Na(!0)}else if(n.get_$1Lk()){_js.Trace.logInfo(_a.$0.$16,"Removing unedited reply forward draft on close.");this.$5xY()}else{_js.Trace.logInfo(_a.$0.$16,"Navigate away due to unmodified message.");this.$26Q()}},$6LK:function(){_js.Trace.logInfo(_a.$0.$16,"Hide close confirm dialog");this.set_$2Na(!1)},$9jV:function(){if($C(this.$1ah)){_js.Trace.logInfo(_a.$0.$16,"Create close confirm dialog.");var n=new _js.$X;OwaApplication.$Oy||n.$F(new _ff.$1l(new _C(this.$$d_$4CZ,this.get_$m()),_u.CommonStrings.l_ConfirmDialog_Save_Text,_nbs.NonBootStrings.l_SaveConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$5xY,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$6LK,this.get_$m()),_bcs.BootCommonStrings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5rh(n)}},$4CZ:function(){_js.Trace.logInfo(_a.$0.$16,"User select save and close");var n=this.$1n;n.$v.set_$1Ei(!0);this.$6LK();var t=n.$5m(8);t.$7OK(this.$$d_$2WV)},$2WV:function(n){this.$26Q()},$5xY:function(){_js.Trace.logInfo(_a.$0.$16,"User select discard and close");var n=this.$1n;n.$v.set_$1Ei(!0);this.$6LK();var t=n.$5m(21);t.$5yo()},$26Q:function(){var n=this.$1n;n.$v.set_$1Ei(!0);var t=n.$5m(2);t.get_$5F().$2Si(n.$v,!1)},$AO9:function(n,t){if(n.get_$3uZ())return null;var i=new(_ff.$18.$$(_y.$2a));var f=t.$5m(5);var u=f.$8Cw();if(u&&u.length>0)for(var e=u,h=e.length,r=0;r<h;++r){var c=e[r];i.$F(c)}if(!OwaApplication.$Oy){var o=t.$5m(12);i.$F(new _y.$2a(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text,o.$4Pj));if(this.$3Y&&(this.$3Y.$2r("iOSSharePointRichTextEditor")&&_a.UserAgent.getInstance().get_$JM()||this.$3Y.$2r("AndroidCED")&&_a.UserAgent.getInstance().$YL)&&this.$1D.get_$NE()&&_a.UserAgent.getInstance().get_$8a()){f=t.$5m(5);this.$1n.$v.$c.get_$6P()==="HTML"&&i.$F(new _y.$2a(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,f.get_$8QQ()))}}if(OwaApplication.$Oy&&i.get_$1y().length===1){var s=i.get_$1y()[0];return new _y.$1P(_y.$U.get_$1Ph(),_y.$U.get_$4SE(),_u.CommonStrings.l_IncludeMenuButtonText_Text,s.get_$Z7())}else return new _y.$1P(_y.$U.get_$1Ph(),_y.$U.get_$4SE(),_u.CommonStrings.l_IncludeMenuButtonText_Text,null,i.get_$1y())}};_mcp.$1LC=function(n,t,i){this.$$d_$9DK=Function.createDelegate(this,this.$9DK);this.$$d_$7bP=Function.createDelegate(this,this.$7bP);this.$$d_$DmU=Function.createDelegate(this,this.$DmU);this.$$d_$AFC=Function.createDelegate(this,this.$AFC);this.$$d_$7dS=Function.createDelegate(this,this.$7dS);this.$$d_$DUN=Function.createDelegate(this,this.$DUN);_mcp.$1LC.initializeBase(this,[13,n]);this.$Lx=this.$1n.$v.$Lx;this.$1D=t;this.$3Y=i};_mcp.$1LC.prototype={$Lx:null,$1D:null,$3Y:null,$6VV:null,$2bf:null,$2TW:null,$7Ns:null,$7Nq:null,$7Nt:null,$4W4:null,$3eT:null,$4Li:!1,get_$7dK:function(){this.$4W4||(this.$4W4=new _C(this.$$d_$DUN,_a.$0.$16));return this.$4W4},get_$9kN:function(){var n=this.$1n.$v.$c;return this.get_$2OM()&&!n.get_$2mP()},get_$8YA:function(){var n=this.$1n.$v.$c;return this.get_$2OM()&&n.get_$2mP()&&!this.$3eT&&!n.get_$1ZM()},get_$2OM:function(){return!1},get_$CDK:function(){return this.get_$9kN()||this.get_$8YA()},$3e:function(){if(this.get_$2OM()){var t=this.$1n;var n=t.$v.$c;if(n.get_$2mP()&&n.get_$1ZM()){_js.Trace.logInfo(_a.$0.$dS,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.$7EX();_mcp.$3t.$Jx(t)}}_mcp.$14n.prototype.$3e.call(this)},$A9O:function(){_a.$6.stPT(_a.$0.$16,"MailComposeUpgrade",3);this.$2bf=_y.$2F.$1g(_a.$0.$16,"MailComposeUpgrade",!0);var i=this.$1n.$v;var n=i.$c;var u=n.get_$D1();this.$6VV=u;if(!n.get_$OV()){if(!this.get_$2OM()){var f=this;_js.$D.get_$Q().$2V(_a.$0.$16,"ShowUpgradeMessage",function(){n.get_$OV()||n.get_$1ZM()||u!==f.$6VV||f.$7FZ(i.$1d)},5e3)}var t;t=this.$1D.get_$NE()||n.get_$6P()!=="HTML"?n.get_$6P()==="Text"?_h.$f.get_$3Lk():_h.$f.get_$24Y():_h.$f.get_$6Xd();if(t===_h.$f.get_$24Y()||t===_h.$f.get_$6Xd()){t.BlockExternalImages=n.get_$IV().get_$vA();t.FilterHtmlContent=n.get_$IV().get_$vA()}var r=i.$Xj.$7hu(n,t,this.$1D);n.get_$6X()===12&&(r.$14x=new _g.$8c(new _g.$7G("internalsubmission")));r.add_$28h(this.$$d_$7dS);_js.Trace.logInfo(_a.$0.$dS,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IV()&&n.get_$IV().get_$3G()&&_g.$b.$2I?_g.$b.$2I.idToName(n.get_$IV().get_$3G()):"null"));r.$Hp="MailComposeUpgrade";if(n.get_$8Vp()){var e=new _mcp.$sN(r);i.$n.$tE(e,this.$$d_$AFC,this.$$d_$DmU,null)}else i.$n.$tE(r,this.$$d_$7bP,this.$$d_$9DK,null)}},$AFC:function(n){var t=n;this.$7bP(t.$1kM)},$DmU:function(n){var i=n;var t=i.$1kM;this.$9DK(t);this.$9Kc(n.$2H,t.$99,t.$68?t.$68.correlationId:null,this.$1n.$v.$c)},$7bP:function(n){var s=this.$1n;var e=s.$v;var r=e.$c;var t=n;var c=s.$5m(21);var u=t.$5i;var i=n.$99;var o=t.$68?t.$68.correlationId:null;var l=!!t.$MG;if(this.$Lx.$1EM(i)){_js.Trace.logInfo(_a.$0.$dS,"Check upgrade callback, resume discard for context "+i);c.$5Nk(i,u)}else if(i===r.get_$D1()){r.set_$Fd(u);_js.Trace.logInfo(_a.$0.$dS,"Context match, updated the draft id. Context:"+r.toString()+"; ResponseMessageBodyType="+(l&&t.$MG.get_$4n()?t.$MG.get_$4n().get_$6P():"null"));var f=e.get_$1XF();var h=e.get_$iH();if(!f.$GQ&&h.$bo){_js.Trace.logInfo(_a.$0.$dS,"Skipping upgrade for contextId "+i+" since send was triggered during upgrade");this.$4BB("SkipUpgrade",o,"Skip upgrade since send is in progress");h.$3XI();return}if(f.$GQ&&f.$2Yw){_js.Trace.logInfo(_a.$0.$dS,"Skipping upgrade for contextId "+i+" since save and then send was triggered during upgrade");this.$4BB("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.$5Nn();return}}if(t.$MG){_js.Trace.logInfo(_a.$0.$dS,"Check upgrade, action has response message, call complete upgrade. context: "+r.toString()+"; ActionItemId="+_h.$D1.$1d1(u));this.$7dS(n)}else if(n.$99===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dS,"Check upgrade: action has id only, updated draft id. context: "+r.toString()+"; ActionItemId="+_h.$D1.$1d1(u));this.$7nr()}},$AI1:function(n){n.$6T1()&&this.$1n.$v.$1d.$4r(3050)},$7dS:function(n){var o=this.$1n;var r=o.$v;var t=r.$c;var i=n;var c=i.$68?i.$68.correlationId:null;var e=n.$99;i.remove_$28h(this.$$d_$7dS);if(e===t.get_$D1()){t.set_$j0(i.$MG);this.$3eT=i.$MG;t.$EvV(i.$MG.get_$Bv());try{if(this.get_$2OM())if(t.get_$2mP()){_js.Trace.logInfo(_a.$0.$dS,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.$5sO();this.$3i("IsWaitingForQuotedBody","IsOnDemandUpgradePending");_mcp.$3t.$Jx(o)}else this.$4Li=!0;else this.$5sO();i.$MG.get_$1m()&&t.set_$EW(i.$MG.get_$1m().get_$7V());var s=r.get_$eM();s.$iZ()}finally{t.set_$OV(this.$4Li);t.get_$OV()&&r.$1d.$9U(3440);_js.Trace.logInfo(_a.$0.$dS,"IsUpgraded for context is "+t.get_$OV())}this.$AI1(t);_mcp.$3t.$Jx(this.$1n);_js.Trace.logInfo(_a.$0.$dS,"Complete upgrade context:"+t.toString());var u=r.get_$1XF();if(u.$GQ)u.$5Nn();else if(_a.$5N.$43){var f=this.$1n.$5m(25);var h=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){f&&f.$2BU(32)})}r.$N.$1p(_y.$13W,new _mcp.$1LD(t.get_$j0().get_$y().Id,r))}else _js.Trace.logInfo(_a.$0.$dS,"MailComposeUpgrade failed since user switched view model context. ContextId="+e+"; Context="+t.toString())},$DUN:function(){this.$2TW=_y.$2F.$1g(_a.$0.$16,"MailComposeOnDemandUpgrade",!0);var n=this.$1n.$v.$c;n.set_$2mP(!0);if(this.$3eT){_js.Trace.logInfo(_a.$0.$dS,"user requests for quoted body, upgrade was successful, complete the body merge");this.$5sO();this.$3i("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.get_$1ZM()){_js.Trace.logInfo(_a.$0.$dS,"user requests for quoted body, upgrade failed, show error message");this.$3i("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.$7EX();_mcp.$3t.$Jx(this.$1n);this.$7nz()}else{_js.Trace.logInfo(_a.$0.$dS,"user requests for quoted body, upgrade has yet to come back, show spinner");this.$3i("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},$5sO:function(){var n=this.$1n.$v.$c;var r=!1;if(this.$1D.get_$ps()){if(n.get_$T9()){n.$W2.$11();n.get_$MW()===n.get_$T9().get_$MW()&&(r=!0)}else n.$5CN=!0;n.$4v4=!0}var f=this.$1n.$5m(27);this.$4Li=!1;if(this.$1D.get_$NE()||n.get_$6P()!=="HTML"){var t=this.$3eT.get_$4n().get_$1Z();n.set_$1gL(!this.$1D.get_$ps()&&n.get_$6P()==="Text"?_a.$1J.$AKB(t):t)}else n.set_$1gL(this.$3eT.get_$Mq().get_$1Z());var i=new _cmc.$1L2(n.get_$1gL());try{f.set_$Nf(i)}finally{this.$4Li=i.$7PL}if(r){n.$W2.$11();n.get_$T9().set_$MW(n.get_$MW());var u=n.$jW;u&&n.$jW.set_$MW(n.get_$MW())}this.$7nr()},$9DK:function(n){var o=this.$1n;var i=o.$v;var r=i.$c;var h=o.$5m(21);var f=n;var u=f.$68?f.$68.correlationId:null;r.set_$1ZM(!0);var t=n.$99;if(this.$Lx.$1EM(t)){_js.Trace.logInfo(_a.$0.$dS,"Resume discard for context "+t);h.$5Nk(t,f.$5i)}else if(t===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dS,"Recording on context upgrade failed");var e=i.get_$1XF();var s=i.get_$iH();if(e.$GQ){if(e.$2Yw){_js.Trace.logInfo(_a.$0.$dS,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");this.$4BB("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.$5Nn();return}this.$7FZ(i.$1d)}else if(s.$bo){_js.Trace.logInfo(_a.$0.$dS,"Skipping upgrade for context "+t+" since send was triggered during upgrade");this.$4BB("SkipUpgrade",u,"Skip upgrade since send is in progress");s.$3XI();return}else this.$7FZ(i.$1d);if(this.get_$2OM()&&r.get_$2mP()){_js.Trace.logInfo(_a.$0.$dS,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.$3i("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.$7EX();_mcp.$3t.$Jx(this.$1n)}}n.$2H&&this.$9Kc(n.$2H,t,u,r)},$9Kc:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.$4k.$1dc(n)){f=_g.$4k.$2LB(n);u=n.FaultMessage}_js.Trace.logWarning(_a.$0.$dS,String.format("Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r.toString(),u));this.$4BB(f,i,u)},$7FZ:function(n){if(!this.get_$2OM()){n.$9U(3440);n.$4r(3440,null);_mcp.$3t.$Jx(this.$1n)}},$7EX:function(){var n=this.$1n.$v.$1d;n.$9U(3450);n.$4r(3450,null)},$4BB:function(n,t,i){this.$7Ns=n;this.$7Nq=t;this.$7Nt=i;if(this.$2bf){_y.$2F.$1G(this.$2bf,null,n,t,i);this.$2bf=null;_a.$6.endPT("MailComposeUpgrade")}this.$7nz()},$7nr:function(){if(this.$2bf){_y.$2F.$1G(this.$2bf);this.$2bf=null;_a.$6.endPT("MailComposeUpgrade")}this.$AmU()},$AmU:function(){if(this.$2TW){_y.$2F.$1G(this.$2TW);this.$2TW=null}},$7nz:function(){if(this.$2TW){_y.$2F.$1G(this.$2TW,null,this.$7Ns,this.$7Nq,this.$7Nt);this.$2TW=null}}};_mcp.$1L4=function(n,t){this.$$d_$Dcs=Function.createDelegate(this,this.$Dcs);this.$$d_$EqO=Function.createDelegate(this,this.$EqO);_mcp.$1L4.initializeBase(this,[19,n]);var i=this;t.$9(function(t){i.$zY=t.$9(n.$5m(1),n.$v.$1d);i.$zY.set_$Dct(i.$$d_$Dcs);if(i.$5Ws){i.$zY.$3e();i.$5Ws=!1}if(i.$5XJ){i.$zY.$2yR();i.$5XJ=!1}})};_mcp.$1L4.prototype={$zY:null,$5Ws:!1,$5XJ:!1,$3e:function(){this.$zY?this.$zY.$3e():this.$5Ws=!0;_mcp.$14n.prototype.$3e.call(this)},$2yR:function(){if(this.$zY){_js.Trace.logInfo(_a.$0.$16,"Prepares to submit mailtips action");this.$zY.$2yR()}else{_js.Trace.logInfo(_a.$0.$16,"Remember to submit MailTips action once the MailTipsHandler is created");this.$5XJ=!0}},$EqO:function(){var i=this.$1n;var t=i.$v;var n=t.$c;if(n.get_$3yb()){t.$1d.$9U(4400);t.$1d.$4r(4400);_mcp.$3t.$Jx(this.$1n)}if(n.get_$6X()&&n.get_$6X()!==3&&n.get_$6X()!==11){this.get_$G8()||this.$3e();this.$2yR()}},$9Mx:function(){if(this.$zY){_js.Trace.logInfo(_a.$0.$16,"Remove MailTips for deleted recipients");this.$zY.$9Mx()}else _js.Trace.logInfo(_a.$0.$16,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")},$Dcs:function(){_mcp.$3t.$Jx(this.$1n)}};_mcp.$1L8=function(n,t){this.$$d_$9gh=Function.createDelegate(this,this.$9gh);this.$$d_$9BO=Function.createDelegate(this,this.$9BO);this.$$d_$9BN=Function.createDelegate(this,this.$9BN);this.$$d_$9BL=Function.createDelegate(this,this.$9BL);this.$$d_$DgC=Function.createDelegate(this,this.$DgC);_mcp.$1L8.initializeBase(this,[25,n]);if(_a.$5N.$43){var i=this;t.$9(function(t){i.$WT=t.$9(i.$1n.$5m(1),i.$1n.$5m(5),n.$v.$1d);i.$WT.set_$DgD(i.$$d_$DgC);i.$WT.set_$9BM(i.$$d_$9BL);i.$WT.set_$9BK(i.$$d_$9BN);i.$WT.set_$9BP(i.$$d_$9BO);i.$WT.set_$9CR(i.$$d_$9gh);if(i.$5Wt){i.$WT.$3e();i.$5Wt=!1}if(i.$5X2){i.$2BU(i.$6sp);i.$5X2=!1}})}};_mcp.$1L8.prototype={$2PE:null,$WT:null,$5Wt:!1,$5X2:!1,$6sp:0,$3e:function(){if(!_a.$5N.$43){_mcp.$14n.prototype.$3e.call(this);return}this.$WT?this.$WT.$3e():this.$5Wt=!0;_mcp.$14n.prototype.$3e.call(this)},$2A:function(){this.$2PE&&(this.$2PE=_js.$D.get_$Q().$6Q(this.$2PE));_js.$Ec.prototype.$2A.call(this)},$CF6:function(){if(!_a.$5N.$43)return!1;switch(this.$3EA()){case 1:return!1;case 2:case 3:return $C(this.$1n.$v.$c.get_$uM())&&$C(this.$1n.$v.$c.get_$r3());case 4:case 5:return $C(this.$1n.$v.$c.get_$r3());default:return!1}},$Btd:function(){if(!_a.$5N.$43)return"";switch(this.$3EA()){case 2:case 3:return _u.CommonStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _u.CommonStrings.l_PolicyTipsBlockSend_Text;default:return""}},$EYQ:function(){if(_a.$5N.$43){if(!this.$WT){_js.Trace.logInfo(_a.$0.$PH,"skip setting message sent flag since handler hasn't been created yet.");return}this.$WT.set_$CMs(!0);if(!$C(this.$1n.$v.$c.get_$uM())){var n=_a.$6.$1g(_a.$0.$PH,"DlpPolicyTipOverridden",!0);_a.$6.$1G(n,"DlpPolicyTipOverridden","",null)}}},$2BU:function(n){this.$9ru(n,0)},$4J1:function(n,t,i){_js.Trace.logInfo(_a.$0.$16,"Prepares to submit policyTips action");var u;var r;if(n.get_$T9()){u=_a.$37.$3EE(n.get_$T9().get_$3o());r=_a.$37.$3EE(n.get_$T9().get_$MW())}else{u=_a.$37.$3EE(n.get_$3o());r=_a.$37.$3EE(n.get_$MW())}this.$WT.$4J1(i,n.get_$EW(),u,r,t)},$9ru:function(n,t){if(_a.$5N.$43){if(!this.$WT){_js.Trace.logInfo(_a.$0.$PH,"Remember to resume triggering policy tips once the handler is created");this.$6sp=n;this.$5X2=!0;return}var f=this.$1n;var e=f.$v;var r=e.$c;this.get_$G8()||this.$3e();this.$2PE&&(this.$2PE=_js.$D.get_$Q().$6Q(this.$2PE));var i=r.get_$Fd();if(i){_bc.$9F.$2lk(i)&&!_g.$1H.$Yv&&(i=_g.$1H.$1Q.$1d4(i));if(_bc.$9F.$2lk(i)){if(t<4){var u=this;this.$2PE=_js.$D.get_$Q().$2V(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){u.$9ru(n,t+1)},5e3)}}else this.$4J1(r,n,i)}}},$3EA:function(){this.get_$G8()||this.$3e();return this.$WT?this.$WT.$3EA():0},$DgC:function(){_mcp.$3t.$Jx(this.$1n)},$9BL:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$uM(n)},$9BN:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$r3(n)},$9BO:function(){this.$2BU(64)},$9gh:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$177(n)}};_mcp.$1L1=function(n,t){this.$$d_$AmJ=Function.createDelegate(this,this.$AmJ);this.$$d_$95u=Function.createDelegate(this,this.$95u);this.$$d_$95x=Function.createDelegate(this,this.$95x);this.$$d_$AI8=Function.createDelegate(this,this.$AI8);this.$$d_$Ary=Function.createDelegate(this,this.$Ary);this.$$d_$7W5=Function.createDelegate(this,this.$7W5);this.$$d_$Ed4=Function.createDelegate(this,this.$Ed4);_mcp.$1L1.initializeBase(this,[24,n]);this.$2kT=!1;this.$j3=t;this.$15W=new _C(this.$$d_$Ed4,_a.$0.$4W);this.$15W.set_$87(!1)};_mcp.$1L1.prototype={$2kT:!1,$65:null,$j3:null,$eo:null,$15W:null,set_$17M:function(n){if(this.$65!==n){this.$65=n;this.$4("ExtensibilityViewModel")}return n},$3e:function(){if(!this.get_$G8()){var n=this;this.$j3.$9(function(t){n.$eo=t;n.set_$17M(t.$5uk(n,n.$$d_$7W5));var i=n.$1n.$5m(3);n.$65.set_$7rk(i.$2O3);var r=n.$1n.$v.$N;r.$1k(_a.$Uq,n.$$d_$Ary);n.$65.$73();i.$p("IsIrmProtected",n.$$d_$AI8);n.$65.add_$2TO(n.$$d_$95x);n.$65.add_$5Dr(n.$$d_$95u);n.$65.get_$Ap3()?n.$15W.set_$87(n.$65.get_$2xe().$3s):n.$65.get_$2xe().add_$1aX(n.$$d_$AmJ);_mcp.$14n.prototype.$3e.call(n)})}},$AV:function(){if(this.get_$G8()){var t=this.$1n.$5m(3);t.$1B("IsIrmProtected",this.$$d_$AI8);this.$65.remove_$2TO(this.$$d_$95x);this.$65.remove_$5Dr(this.$$d_$95u);this.$65.$AJ();var n=this.$1n.$v.$N;n.$4A(_a.$Uq,this.$$d_$Ary)}_mcp.$14n.prototype.$AV.call(this)},$2L1:function(){return _y.$z.$1Q.get_$U()==="Mouse"?this.$1n.$v.$c.get_$6P():this.$1n.$v.$c.get_$NE()?"HTML":"Text"},$v7:function(){return this.$1n.$v.$c.get_$3o()},$9j4:function(n){this.$1n.$v.$c.set_$3o(n)},$8IV:function(n,t,i){i.val=0;var r=new _fm.$lq(n);this.$1n.$v.$c.set_$297(r);r.$2O2&&(i.val=9016);t.val=r.$3bb;return r.$2Wm},$9iq:function(n,t,i){i.val=0;var r=new _fm.$u2(n,!0);r.$zG=t;this.$1n.$v.$c.set_$297(r);r.$4wM?i.val=2006:r.$2O2&&(i.val=9016)},$8Hm:function(n){var t=this.$8D0(n);return t.$3X},$9s0:function(n,t){return this.$9s1(n,t,!1)},$9ib:function(n,t){this.$9s1(n,t,!0)},$4PQ:function(n,t){t.val=0;if(!this.$1n.$v.$c.get_$OV()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$1n.$5m(5);var u=_y.$7x.$5uO(n);if(r.get_$9Z()){var f=_a.$6.$1g(_a.$0.$1m,"AttachmentExtensibilityItemAttachments",!0);var i=new(_ff.$18.$$(_y.$OU));r.get_$9Z().$30r(u,i,f);if(!i.get_$A()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$E(0)}else{_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - max number exceeded.");t.val=9001;return null}},$4PL:function(n,t,i){i.val=0;if(!this.$1n.$v.$c.get_$OV()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.$1n.$5m(5);var r=f.get_$9Z();if(r){var u=this.$eo.$7iW(n,t);return r.$7SV(u)}_js.Trace.logError(_a.$0.$4W,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},$4nG:function(){return this.$1n.$v.$c.get_$5O()?this.$1n.$v.$c.get_$5O().Id:null},$8QI:function(n,t){var i=new _cmc.$MV(0,n,t);i.$2zX=!0;i.$28Y=!0;this.$5Pa(i)},$9Hq:function(n,t){var i=new _cmc.$MV(1,n,t);this.$5Pa(i)},$Ed4:function(){this.$65&&this.$65.$7E3()},$AmJ:function(n,t){this.$15W.set_$87(this.$65.get_$2xe().$3s);this.$65.get_$2xe().remove_$1aX(this.$$d_$AmJ)},$95x:function(){if(_y.$z.$1Q.get_$U()==="TouchWide"&&this.$65.get_$13S()){var n=this.$1n.$v;n.set_$2tB(6)}},$95u:function(){var n=this.$1n.$v;n.set_$2tB(4)},$5Pa:function(n){var t=this.$1n.$5m(27);t.set_$Nf(n)},$2LI:function(){return this.$1n.$v.$c.get_$Fd()?this.$1n.$v.$c.get_$Fd().Id:null},$3ES:function(){this.$1n.$v.$c.get_$nz()||this.$1n.$v.$c.set_$nz(new _js.$X);return this.$1n.$v.$c.get_$nz()},$8cC:function(){},$9o9:function(){var n=new _cmc.$Tu(null);this.$5Pa(n)},$7b4:function(n){var t=new _cmc.$Tu(n);this.$5Pa(t)},$9s1:function(n,t,i){var u=this.$8D0(n);i&&u.$AV();var f=t.get_$A();if(f+u.$3X.get_$A()>100)return!1;n===2&&this.$1n.$v.get_$ad().$4HI.$11();for(var r=0;r<f;r++){var e=t.get_$E(r);u.$5kB(e)}return!0},$Ary:function(n){if(this.$2kT){this.$2kT=!1;this.$65.$22N(!1)}},$kN:function(){var n=this.$1n.$5m(14);n&&n.$kN()},$7W5:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.$1n.$v.$N;i.$1p(_a.$eQ,new _a.$eQ(!0));this.$2kT=!0}}else if(n===2&&this.$2kT){var t=this.$1n.$v.$N;t.$1p(_a.$eQ,new _a.$eQ(!1));this.$2kT=!1}this.$kN()},$8D0:function(n){var t=this.$1n.$v.get_$ad();return n?n===1?t.$GM.$5X:n===2?t.$Gd.$5X:null:t.$GI.$5X},$AI8:function(n,t){t==="IsIrmProtected"&&this.$EeN()},$EeN:function(){var n=this.$1n.$5m(3);this.$65.set_$7rk(n.$2O3);n.$2O3&&this.$65.$22N(!1)}};_mcp.$1LD=function(n,t){this.$5zn=n;this.$6Xf=t};_mcp.$1LD.prototype={$5zn:null,$6Xf:null,get_$Fd:function(){return this.$5zn},get_$CKW:function(){return this.$6Xf}};_mcp.$1PW=function(n){this.$v=n};_mcp.$1PW.prototype={$v:null};_mcp.$1PX=function(n){this.$v=n};_mcp.$1PX.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$pc=function(n,t,i,r){this.$6QJ=n;this.$8E=t;this.$3IQ=i;this.$2Id=r};_mcp.$pc.prototype={$6QJ:!1,$8E:null,$3IQ:!1,$2Id:null,get_$8U0:function(){return this.$6QJ},get_$1xa:function(){return this.$8E},get_$4vl:function(){return this.$3IQ},get_$7sM:function(){return this.$2Id}};_mcp.$184=function(n){this.$3IQ=n};_mcp.$184.prototype={$3IQ:!1,get_$4vl:function(){return this.$3IQ}};_mcp.$1Pc=function(n){this.$v=n};_mcp.$1Pc.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$mv=function(){};_mcp.$mv.prototype={$5u1:function(n,t,i){var r=n.$c;var u=r.get_$6X();var c=3===u||2===u||1===u;var s=i.get_$ps()&&r.get_$OV();n.get_$7Np().get_$2OM()&&(s=!!(s&r.get_$2mP()));var f=null;if(c&&!s){_js.Trace.logInfo(_a.$0.$16,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$z.$1Q.get_$U()+"; disposition="+t);var l=r.$1kK(!1);var o=this.$4Xz(r,l,i);o.$M9=t;r.get_$Fd()&&t===1&&(o.$2zl=n.$2zk);o.$2eE=r.$6IV(100);o.$2Q4=_y.$1m.toString(r.get_$6X());if(r.get_$8Vp()){var a=new _mcp.$sN(o);f=a}else f=o}else if(r.get_$6TH()){_js.Trace.logInfo(_a.$0.$16,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var h=this.$ARx(t,r,i);t===1&&(h.$2zl=n.$2zk);f=h}else if(8===r.get_$6X()){_js.Trace.logInfo(_a.$0.$16,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);f=this.$Atx(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$16,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);f=this.$65Q(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$16,"CreateComposeAction: ApprovalRequestAction");f=this.$AtU(r,t,i)}else{_js.Trace.logInfo(_a.$0.$16,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var e=null;if(u===11||u===12){e=new _h.$2k(r.$5v7(!1),r.get_$2se());e.$M9=0}else{e=new _h.$2k(r.$1kK(!1),null);e.$M9=t}e.$1k2=!i.get_$NE();$C(r.get_$h4())||(e.$11x=r.get_$h4());e.$2eE=r.$6IV(100);e.$2Q4=_y.$1m.toString(r.get_$6X());f=e}f.$99=r.get_$D1();return f},$5uS:function(n,t,i){var r=new _h.$1Gs(200,n);r.$WA=t||_h.$f.get_$24Y();r.$ZI=$C(i)?"MailCompose":i;return r},$AMY:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.$1Dn([n],r,2)},$7hu:function(n,t,i){var u=null;u=n.get_$1El()?n.$5v7(!0):n.$1kK(!0);var r=this.$4Xz(n,u,i);r.$WA=t;r.$ZI=!i.get_$NE()&&n.get_$6P()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$2z0=_g.$O.get_$Q().get_$1j().get_$ce();return r},$Atx:function(n,t){var i=new _c.$kE(n.get_$14V(),1,n.get_$17L());i.$Ov=n.$1kK(!1);n.get_$h4()&&(i.$11x=n.get_$h4());return i},$4Xz:function(n,t,i){var u=n.get_$1Lf()?new _h.$6e(n.get_$14V()):n.get_$14V();var r=null;r=new _h.$Bk(this.$4p7(n.get_$6X()),u,i);r.set_$6a(t);r.$28Q=n.get_$5Gl();r.$1k2=!i.get_$NE();n.get_$h4()&&(r.$11x=n.get_$h4());r.$Dq_7=n.get_$5O();r.$kE=n.get_$3T8();r.$99=n.get_$D1();n.get_$IV()&&_g.$5w.isInstanceOfType(n.get_$IV())&&n.get_$IV().get_$Q8()&&(r.$3JR=!0);switch(n.get_$6X()){case 1:case 2:r.$4Ix=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$4Ix=_nbs.NonBootStrings.l_ForwardPrefix_Text;break}return r},$65Q:function(n,t){return _cc.$43.$65Q(n.get_$IV(),_cc.$43.$2kO(n.get_$6X()),n.$1kK(!1),t,n.get_$5KU())},$ARx:function(n,t,i){var r=null;if(t.get_$1El()){r=new _h.$49(t.$5v7(!1));r.$14x=_g.$1z.$tK(t.get_$2se());r.$M9=0}else{r=new _h.$49(t.$1kK(!1));r.$M9=n}r.$6UP=!i.get_$NE();t.get_$h4()&&(r.$11x=t.get_$h4());r.$2eE=t.$6IV(100);r.$3k5="AlwaysOverwrite";r.$2Q4=_y.$1m.toString(t.get_$6X());return r},$4p7:function(n){switch(n){case 1:return new _g.$FX;case 2:return new _g.$E6;case 3:return new _g.$F6;case 12:return new _g.$XC;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$1m.toString(n));}},$AtU:function(n,t,i){var u=n.get_$IV();var r=new _c.$sM(u,n.$1kK(!1),n.get_$6X()===9,t);r.$1k2=!i.get_$NE();return r}};_mcp.$1Kv=function(n,t,i,r,u,f,e,o,s,h,c,l){_a.$4.$z(e,"nativeBridge");this.$1n=n;this.$3Y=i;this.$1D=r;this.$N6=u;this.$F1=t;this.$2Y=f;this.$l=e;this.$6R=o;this.$WK=s;this.$16K=h;this.$11c=c;this.$CY=l};_mcp.$1Kv.prototype={$1n:null,$3Y:null,$1D:null,$N6:null,$WK:null,$F1:null,$2Y:null,$l:null,$6R:null,$16K:null,$11c:null,$CY:null,$ALx:function(n,t){switch(n){case 0:return new _mcp.$14o(this.$1n,this.$1D,!!this.$6R);case 1:return new _mcp.$HY(this.$1n);case 2:return new _mcp.$1L6(this.$1n);case 3:return new _mcp.$JQ(this.$1n);case 4:return new _mcp.$7y(this.$1n);case 5:return new _mcp.$Gn(this.$1n,this.$F1,this.$3Y,this.$1D,this.$N6,this.$WK,this.$1n.$v.$tx,this.$CY);case 6:return new _mcp.$eU(this.$1n);case 7:return new _mcp.$G6(this.$1n,this.$1D,this.$3Y,this.$1n.$v.$N);case 8:return new _mcp.$1Ku(this.$1n,this.$2Y,this.$1D);case 9:if(1===this.$1n.$v.$c.get_$5j())return new _mcp.$MZ(this.$1n,this.$1D);break;case 10:return new _mcp.$1L5(this.$1n,this.$6R,this.$3Y);case 11:if("Mouse"!==t)return new _mcp.$ui(this.$1n,this.$3Y,this.$1D);break;case 12:return new _mcp.$G7(this.$1n,this.$1D);case 13:return new _mcp.$1LC(this.$1n,this.$1D,this.$3Y);case 14:if(t==="Mouse")return new _mcp.$3t(this.$1n,this.$6R);break;case 15:if(this.$l.$8G(this.$l.get_$JQ())&&this.$l.get_$JQ().get_$14F().get_$4S4())return new _mcp.$Ma(this.$1n,this.$l);break;case 22:if(this.$l.$8G(this.$l.get_$JQ())&&this.$l.get_$JQ().get_$14F().get_$5C3())return new _mcp.$1L7(this.$1n,this.$l);break;case 16:return new _mcp.$eT(this.$1n);case 17:if("Mouse"===t)return new _mcp.$1Kx(this.$1n,this.$6R);break;case 18:if("Mouse"===t)return new _mcp.$Ow(this.$1n);break;case 20:return new _mcp.$II(this.$1n);case 19:return new _mcp.$1L4(this.$1n,this.$16K);case 25:return new _mcp.$1L8(this.$1n,this.$11c);case 21:return new _mcp.$1Kz(this.$1n);case 23:if(this.$l.$8G(this.$l.get_$15T()))return new _mcp.$1L9(this.$1n,this.$l);break;case 24:return new _mcp.$1L1(this.$1n,this.$1n.$v.$j3);case 26:if(this.$1D.get_$NE())return new _mcp.$1L3(this.$1n,this.$3Y);break;case 27:return new _mcp.$1L0(this.$1n);case 29:return new _mcp.$1LA(this.$1n)}return null}};_mcp.$1Ky=function(n,t){this.$51h=n;this.$1D=t};_mcp.$1Ky.prototype={$1D:null,$51h:null,$H5:function(n,t){var i=new _mcp.$V;if(this.$1D){i.set_$ps(this.$1D.get_$ps());i.set_$NE(this.$1D.get_$NE())}i.set_$5j(n?0:this.$51h.$6Fz());return i},$35M:function(n,t,i,r){var u=this.$H5(!1,!1);u.set_$5j(this.$51h.$6Fz());u.set_$6X(4);u.set_$Xa(!1);u.set_$Fd(n);u.set_$3xz(t);r&&!r.get_$RG()?u.set_$6P(r.get_$6P()):u.set_$6P(i===1?"Text":"HTML");return u}};_mcp.$14q=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){_a.$4.$z(k,"nativeBridge");this.$j3=n;this.$9M=t;this.$1D3=i;this.$3WB=r;this.$7F=u;this.$Xj=f;this.$4x=e;this.$I=o;this.$2TK=s;this.$Lx=h;this.$Le=c;this.$N=l;this.$3Y=v;this.$1D=y;this.$N6=p;this.$F1=a;this.$2Y=w;this.$l7=b;this.$l=k;this.$2zk=d;this.$WK=g;this.$16K=nt;this.$11c=tt;this.$tx=it;this.$1tw=rt;this.$sv=ut;this.$39Y=ft;this.$2ZO=et;this.$CY=ot;this.$F4=st};_mcp.$14q.prototype={$j3:null,$9M:null,$1D3:null,$3WB:null,$7F:null,$Xj:null,$N:null,$4x:null,$I:null,$2TK:null,$Lx:null,$Le:null,$3Y:null,$1D:null,$N6:null,$F1:null,$l7:null,$2Y:null,$tx:null,$WK:null,$l:null,$2zk:null,$16K:null,$11c:null,$1tw:null,$sv:null,$39Y:null,$2ZO:null,$CY:null,$F4:null,$wc:function(n,t,i){return this.$C7a(n,null,t,i)},$1CS:function(n,t,i){return this.$8Qt(n,null,t,i)},$C7a:function(n,t,i,r){var u=this.$7F.$H5(!1,!1);u.$6NC(n);return this.$8Qt(u,t,i,r)},$8Qt:function(n,t,i,r){var u=new _mcp.$8n(n,t,this.$j3,this.$9M,this.$1D3,this.$3WB,this.$4x,this.$I,this.$2TK,this.$Lx,this.$Le,this.$N,this.$F1,this.$3Y,this.$1D,this.$N6,this.$2Y,this.$l7,this.$l,this.$2zk,this.$Xj,i,r,this.$WK,this.$16K,this.$11c,this.$tx,this.$1tw,this.$sv,this.$39Y,this.$2ZO,this.$CY,this.$F4);u.$3e();return u}};_mcp.$147=function(){_mcp.$147.initializeBase(this)};_mcp.$147.prototype={$Ql:null,$4Wj:null,set_$iw:function(n){if(this.$Ql!==n){this.$Ql=n;this.$4("Description")}return n},set_$AJe:function(n){if(this.$4Wj!==n){this.$4Wj=n;this.$4("ConversationOwner")}return n}};_mcp.$ug=function(n){this.$$d_$95c=Function.createDelegate(this,this.$95c);_mcp.$ug.initializeBase(this);this.$n=OwaApplication.$2B;this.$2F=n};_mcp.$ug.prototype={$n:null,$2F:null,$tE:function(n,t,i,r){$C(t)||n.add_$2s(t);n.add_$2b(i||this.$$d_$95c);$C(r)||n.add_$4Q(r);this.$n.$1U(n)},$Ekk:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$Ekk(n,t,i,r,u,f):r(e)};var c=this,h=this;this.$tE(e,function(){o()},function(){u(e);i&&o()},f)},$9kY:function(n,t){var i=_nbs.NonBootStrings.l_MailComposeActionFailed_Text;this.$t6(n,i,null,i,null,t)},$2kC:function(n,t,i,r,u,f){var e=t;var o=n.$2H;if(o){if(_g.$4k.$1dc(o)){var h=o;if(_g.$4k.$8X7(h)){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning service unavailable "+_u.Strings.l_ErrorServiceUnavailable_Text+" since the specified exception was a service unavailable json fault body");e=_u.Strings.l_ErrorServiceUnavailable_Text}else if(_g.$4k.$8Wj(h)&&u){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning request timeout "+u+" since the specified exception was a request timeout json fault body");e=u}else if(_g.$4k.$8TX(h)&&i){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning disconnected "+i+" since the specified exception was a disconnected json fault body");e=i}}if(e===t){var s=_a.$4.$4or(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.$0.$oj,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.$0.$oj,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning default message "+t+" since the exception was null");_js.Trace.logInfo(_a.$0.$16,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$t6:function(n,t,i,r,u,f){var e=this.$2kC(n,t,i,r,u,null);this.$2F.$44(0,e,f)},$95c:function(n){this.$9kY(n,null);this.$6wV(n)},$6wV:function(n){this.$AQ("MailComposeActionFailed",n)}};_mcp.$V=function(){this.$$d_$Aqv=Function.createDelegate(this,this.$Aqv);_mcp.$V.initializeBase(this);this.set_$6P("Html"===_g.$O.get_$Q().get_$1j().get_$1yC()?"HTML":"Text");this.$p(_mcp.$V.$48c.$3D,this.$$d_$Aqv);this.$p(_mcp.$V.$4wk.$3D,this.$$d_$Aqv);if(_a.$c.$43&&_a.$c.get_$18l()){this.set_$PT(_g.$O.get_$Q().get_$1j().get_$2ZN());this.set_$T0(_g.$O.get_$Q().get_$1j().get_$2ZP())}};_mcp.$V.$$cctor=function(){_mcp.$V.$2ap.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$2Eq.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$2E9.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$5Zl.set_$Qz(new _a.$CA(_pc.$q));_mcp.$V.$2E2.set_$Qz(new _a.$CA(_g.Attachment));_mcp.$V.$2Hs.set_$Qz(new _a.$CA(_g.$HL))};_mcp.$V.$9F3=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$9.$o(u)?r:_js.$1I.$Ba(n,u)};_mcp.$V.$9F1=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$9.$o(r)?i:Boolean.parse(r)};_mcp.$V.$7Tf=function(n,t,i,r){if(n)for(var f=0;f<n.get_$A();f++){var u=n.get_$E(f);if(_g.$1Z.$5b(u,i)){_js.Trace.logInfo(_a.$0.$16,"Excluding original from {0}",i);continue}if(_mcp.$V.$23m(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$16,"Excluding self address {0}",_mcp.$V.$1h0||"null");continue}if(r&&r.get_$A()!==r.$HE(function(n){return _g.$1Z.$5b(u,n)})){_js.Trace.logInfo(_a.$0.$16,"Excluding address {0} already in to",u);continue}t.$F(u)}};_mcp.$V.$23m=function(n){return!_js.$9.$1h(_mcp.$V.$1h0)&&!_js.$9.$1h(n)&&(_mcp.$V.$1h0===n||_mcp.$V.$1h0.toLowerCase()===n.toLowerCase())};_mcp.$V.$6XM=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$A();u++){r.val+=_g.$1Z.$1d1(t.get_$E(u));u!==t.get_$A()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.$V.prototype={$6uK:null,$W2:null,$8P:null,$W3:null,$4pH:null,$3IB:!1,$3wt:!1,$7DT:!1,$2gf:null,$6UT:!1,$jW:null,$5CN:!1,$9kR:!1,$4v4:!1,$8Sm:!1,$1i1:0,$3kv:0,$32m:null,$52e:0,$5ZN:null,$3JE:!1,$48C:null,get_$2MB:function(){return!!this.get_$5KU()},get_$5KU:function(){return this.$w(_mcp.$V.$6vy)},set_$5KU:function(n){this.$P(_mcp.$V.$6vy,_cc.$9d.$At8(n));return n},get_$F12:function(){return this.get_$2MB()?_nbs.NonBootStrings.l_CurrentMeetingTime_Short_Text:_u.MeetingMsgStrings.l_WhenLabel_Text},get_$6Pt:function(){return this.$4v4},set_$6Pt:function(n){this.$4v4=n;return n},get_$D1:function(){return this.$w(_mcp.$V.$7Ou)},set_$D1:function(n){this.$P(_mcp.$V.$7Ou,n);return n},get_$6X:function(){return this.$w(_mcp.$V.$48c)},set_$6X:function(n){this.$P(_mcp.$V.$48c,n);return n},get_$5j:function(){return this.$w(_mcp.$V.$26G)},set_$5j:function(n){this.$P(_mcp.$V.$26G,n);return n},get_$14V:function(){return this.$w(_mcp.$V.$6rK)},set_$14V:function(n){this.$P(_mcp.$V.$6rK,n);return n},get_$5Gl:function(){return this.$w(_mcp.$V.$6rI)},set_$5Gl:function(n){this.$P(_mcp.$V.$6rI,n);return n},get_$IV:function(){this.$8P||(this.$8P=this.$w(_mcp.$V.$6rL));return this.$8P},set_$IV:function(n){this.$8P=n;this.$P(_mcp.$V.$6rL,this.$8P);return n},get_$Fd:function(){return this.$w(_mcp.$V.$5zo)},set_$Fd:function(n){if($C(this.get_$Fd())||!n)this.$P(_mcp.$V.$5zo,n);else{this.get_$Fd().Id=n.Id;this.get_$Fd().ChangeKey=n.ChangeKey}return n},get_$6TH:function(){return!!this.get_$Fd()},get_$9oB:function(){return this.$w(_mcp.$V.$7H3)},set_$9oB:function(n){this.$P(_mcp.$V.$7H3,n);return n},get_$3o:function(){return this.$w(_mcp.$V.$qH)},set_$3o:function(n){this.$P(_mcp.$V.$qH,n);return n},get_$MW:function(){return this.$w(_mcp.$V.$38L)},set_$MW:function(n){this.$P(_mcp.$V.$38L,n);return n},get_$297:function(){return this.$w(_mcp.$V.$72i)},set_$297:function(n){this.$P(_mcp.$V.$72i,n);return n},get_$3sY:function(){return this.$W2},set_$3sY:function(n){this.$W2=n;return n},get_$do:function(){return this.$w(_mcp.$V.$6wd)},set_$do:function(n){this.$P(_mcp.$V.$6wd,n);return n},set_$BsP:function(n){this.$W3=n;return n},get_$1vc:function(){return this.$w(_mcp.$V.$7JJ)},set_$1vc:function(n){this.$P(_mcp.$V.$7JJ,n);return n},get_$6P:function(){return this.$w(_mcp.$V.$5nx)},set_$6P:function(n){this.$P(_mcp.$V.$5nx,n);return n},get_$8JK:function(){return this.$4pH},set_$8JK:function(n){this.$4pH=n;return n},get_$79:function(){return this.$w(_mcp.$V.$2ap)},set_$79:function(n){this.$P(_mcp.$V.$2ap,n);return n},get_$4IU:function(){return this.$w(_mcp.$V.$5Zl)},set_$4IU:function(n){this.$P(_mcp.$V.$5Zl,n);return n},get_$10y:function(){return this.$w(_mcp.$V.$3dI)},set_$10y:function(n){this.$P(_mcp.$V.$3dI,n);return n},get_$7x:function(){return this.$w(_mcp.$V.$2Eq)},set_$7x:function(n){this.$P(_mcp.$V.$2Eq,n);return n},get_$xs:function(){return this.$w(_mcp.$V.$342)},set_$xs:function(n){this.$P(_mcp.$V.$342,n);return n},get_$AN:function(){return this.$w(_mcp.$V.$2E9)},set_$AN:function(n){this.$P(_mcp.$V.$2E9,n);return n},get_$qd:function(){return this.$w(_mcp.$V.$32n)},set_$qd:function(n){this.$P(_mcp.$V.$32n,n);return n},get_$Xa:function(){return this.$w(_mcp.$V.$5WV)},set_$Xa:function(n){this.$P(_mcp.$V.$5WV,n);return n},get_$Bv:function(){return this.$w(_mcp.$V.$3Gg)},set_$Bv:function(n){this.$P(_mcp.$V.$3Gg,n);return n},get_$1gL:function(){return this.$w(_mcp.$V.$6wP)},set_$1gL:function(n){this.$P(_mcp.$V.$6wP,n);return n},get_$9mi:function(){return this.$w(_mcp.$V.$7Fy)},set_$9mi:function(n){this.$P(_mcp.$V.$7Fy,n);return n},get_$4IE:function(){return this.$w(_mcp.$V.$7G0)},set_$4IE:function(n){this.$P(_mcp.$V.$7G0,n);return n},get_$5ZR:function(){return this.$w(_mcp.$V.$7G2)},set_$5ZR:function(n){this.$P(_mcp.$V.$7G2,n);return n},get_$1yb:function(){return this.$3kv},set_$1yb:function(n){this.$3kv=n;return n},get_$1xI:function(){return this.$32m},set_$1xI:function(n){this.$32m=n;return n},get_$2Ag:function(){return this.$1i1},set_$2Ag:function(n){this.$1i1=n;return n},get_$rt:function(){return this.$w(_mcp.$V.$6PR)},set_$rt:function(n){this.$P(_mcp.$V.$6PR,n);return n},get_$oy:function(){return this.$w(_mcp.$V.$4wk)},set_$oy:function(n){this.$P(_mcp.$V.$4wk,n);return n},get_$23N:function(){return this.$w(_mcp.$V.$6Ri)},set_$23N:function(n){this.$P(_mcp.$V.$6Ri,n);return n},get_$3yb:function(){return this.$w(_mcp.$V.$6T0)},set_$3yb:function(n){this.$P(_mcp.$V.$6T0,n);return n},get_$6E:function(){return this.$w(_mcp.$V.$3LQ)},set_$6E:function(n){this.$P(_mcp.$V.$3LQ,n);return n},get_$3Fs:function(){return this.$w(_mcp.$V.$6Kb)},set_$3Fs:function(n){this.$P(_mcp.$V.$6Kb,n);return n},get_$1pY:function(){return this.$w(_mcp.$V.$6Yl)},set_$1pY:function(n){this.$P(_mcp.$V.$6Yl,n);return n},get_$5Q:function(){return this.$w(_mcp.$V.$2Ic)},set_$5Q:function(n){this.$P(_mcp.$V.$2Ic,n);return n},get_$Em:function(){return this.$w(_mcp.$V.$73i)},set_$Em:function(n){this.$P(_mcp.$V.$73i,n);return n},get_$OV:function(){return this.$w(_mcp.$V.$6UQ)},set_$OV:function(n){this.$P(_mcp.$V.$6UQ,n);return n},get_$ow:function(){return this.$w(_mcp.$V.$6QY)},set_$ow:function(n){this.$P(_mcp.$V.$6QY,n);return n},get_$1LS:function(){return this.$w(_mcp.$V.$6P2)},set_$1LS:function(n){this.$P(_mcp.$V.$6P2,n);return n},get_$19x:function(){return this.$w(_mcp.$V.$3T9)},set_$19x:function(n){this.$P(_mcp.$V.$3T9,n);return n},get_$2se:function(){return this.$w(_mcp.$V.$6sP)},set_$2se:function(n){this.$P(_mcp.$V.$6sP,n);return n},get_$1oe:function(){return this.$w(_mcp.$V.$6SK)},set_$1oe:function(n){this.$P(_mcp.$V.$6SK,n);return n},get_$1Lf:function(){return this.$w(_mcp.$V.$6SC)},set_$1Lf:function(n){this.$P(_mcp.$V.$6SC,n);return n},get_$17L:function(){return this.$w(_mcp.$V.$62Y)},set_$17L:function(n){this.$P(_mcp.$V.$62Y,n);return n},get_$8OP:function(){return this.$w(_mcp.$V.$6Mh)},set_$8OP:function(n){this.$P(_mcp.$V.$6Mh,n);return n},get_$1TQ:function(){return this.$w(_mcp.$V.$6KI)},set_$1TQ:function(n){this.$P(_mcp.$V.$6KI,n);return n},get_$1Lk:function(){return this.$w(_mcp.$V.$6T2)},set_$1Lk:function(n){this.$P(_mcp.$V.$6T2,n);return n},get_$j0:function(){return this.$w(_mcp.$V.$5zp)},set_$j0:function(n){this.$P(_mcp.$V.$5zp,n);return n},get_$2E6:function(){return this.$w(_mcp.$V.$5mi)},set_$2E6:function(n){this.$P(_mcp.$V.$5mi,n);return n},get_$EW:function(){return this.$w(_mcp.$V.$2E2)},set_$EW:function(n){var i=null;if(n){i=new _js.$X;for(var t=0;t<n.get_$A();t++)i.$F(n.get_$E(t))}this.$P(_mcp.$V.$2E2,i);this.$9tg();return n},get_$1ZM:function(){return this.$w(_mcp.$V.$7Nr)},set_$1ZM:function(n){this.$P(_mcp.$V.$7Nr,n);return n},get_$T9:function(){return this.$w(_mcp.$V.$5nY)},set_$T9:function(n){this.$P(_mcp.$V.$5nY,n);return n},get_$8Vp:function(){return this.$3JE},get_$9i:function(){return this.$w(_mcp.$V.$70t)},set_$9i:function(n){if(n!==this.get_$9i()){this.$P(_mcp.$V.$70t,n);this.$3i("IsCopyRestricted","IsPrintRestricted")}return n},get_$h4:function(){return this.$w(_mcp.$V.$34Z)},set_$h4:function(n){this.$P(_mcp.$V.$34Z,n);return n},set_$Ebo:function(n){this.$7DT=n;return n},get_$6Q5:function(){return this.$3IB},set_$6Q5:function(n){this.$3IB=n;n&&!this.get_$T9()&&this.$7ob();return n},get_$6Q6:function(){return this.$3wt},set_$6Q6:function(n){if(this.$3wt!==n){this.$3wt=n;this.$4("IsEditorReady")}return n},set_$4c8:function(n){this.$2gf!==n&&(this.$2gf=n);return n},set_$CGI:function(n){this.$6UT=n;return n},get_$6Yf:function(){return 255},get_$23K:function(){return this.$w(_mcp.$V.$6RQ)},set_$23K:function(n){this.$P(_mcp.$V.$6RQ,n);return n},get_$1Oz:function(){return this.$w(_mcp.$V.$7PK)},set_$1Oz:function(n){this.$P(_mcp.$V.$7PK,n);return n},get_$3uZ:function(){return this.$w(_mcp.$V.$6LR)},set_$3uZ:function(n){this.$P(_mcp.$V.$6LR,n);return n},get_$3xz:function(){return this.$w(_mcp.$V.$6S1)},set_$3xz:function(n){this.$P(_mcp.$V.$6S1,n);return n},get_$3ey:function(){return this.$w(_mcp.$V.$7PM)},set_$3ey:function(n){this.$P(_mcp.$V.$7PM,n);return n},get_$CE5:function(){return!!this.get_$9i()&&!this.get_$9i().get_$RG()&&!this.get_$9i().get_$4AW()&&!this.get_$9i().get_$KU()},get_$9lW:function(){return this.get_$oy()&&_mcp.$7y.$8XW(this)},get_$2Nf:function(){return!!this.get_$9i()&&0===this.get_$9i().get_$RG()&&!this.get_$9i().get_$3ni()&&!this.get_$9i().get_$KU()},get_$3Qb:function(){return null},get_$6uR:function(){return this.get_$3o()},get_$5JL:function(){return this.$6uK},get_$a7:function(){return this.$w(_mcp.$V.$6PI)},set_$a7:function(n){this.$P(_mcp.$V.$6PI,n);return n},get_$l4:function(){return this.$w(_mcp.$V.$5qw)},set_$l4:function(n){this.$P(_mcp.$V.$5qw,n);return n},get_$uM:function(){return this.$w(_mcp.$V.$5zQ)},set_$uM:function(n){this.$P(_mcp.$V.$5zQ,n);return n},get_$r3:function(){return this.$w(_mcp.$V.$5zP)},set_$r3:function(n){this.$P(_mcp.$V.$5zP,n);return n},get_$177:function(){return this.$w(_mcp.$V.$5zO)},set_$177:function(n){this.$P(_mcp.$V.$5zO,n);return n},get_$h0:function(){return this.$w(_mcp.$V.$5qy)},set_$h0:function(n){this.$P(_mcp.$V.$5qy,n);return n},get_$eW:function(){return this.$w(_mcp.$V.$5qv)},set_$eW:function(n){this.$P(_mcp.$V.$5qv,n);return n},get_$1xt:function(){return this.$w(_mcp.$V.$5qx)},set_$1xt:function(n){this.$P(_mcp.$V.$5qx,n);return n},get_$ET:function(){return this.$w(_mcp.$V.$3XK)},set_$ET:function(n){this.$P(_mcp.$V.$3XK,n);return n},get_$Qu:function(){return this.$w(_mcp.$V.$3I6)},set_$Qu:function(n){this.$P(_mcp.$V.$3I6,n);return n},get_$Q8:function(){return this.$w(_mcp.$V.$3JS)},set_$Q8:function(n){this.$P(_mcp.$V.$3JS,n);return n},get_$EzK:function(){return this.get_$s0()},get_$4IJ:function(){return this.$w(_mcp.$V.$7G3)},set_$4IJ:function(n){this.$P(_mcp.$V.$7G3,n);return n},get_$s0:function(){return _a.$c.$43&&(this.get_$PT()||this.get_$T0())},get_$PT:function(){if(!_a.$c.$43||!_a.$c.get_$22x()||!this.$6Tg()||_g.$O.get_$Q().get_$1j().get_$tY())return!1;var n=_g.$O.get_$Q().get_$VV();return!!n&&n.AlwaysEncrypt||this.$w(_mcp.$V.$3bQ)},set_$PT:function(n){this.$P(_mcp.$V.$3bQ,n);this.$4(_mcp.$V.$4LG);_js.Trace.logInfo(_a.$0.$53,"Context.SmimeEncryptMessage is set to "+n);return n},get_$T0:function(){if(!_a.$c.$43||!_a.$c.get_$22x()||!this.$6Tg()||_g.$O.get_$Q().get_$1j().get_$tY())return!1;var n=_g.$O.get_$Q().get_$VV();return!!n&&n.AlwaysSign||this.$w(_mcp.$V.$3bT)},set_$T0:function(n){this.$P(_mcp.$V.$3bT,n);this.$4(_mcp.$V.$4LG);_js.Trace.logInfo(_a.$0.$53,"Context.SmimeSignMessage is set to "+n);return n},get_$9mk:function(){return _g.$O.get_$Q().get_$VV()&&(_g.$O.get_$Q().get_$VV().AlwaysEncrypt||_g.$O.get_$Q().get_$1j().get_$tY())||this.get_$ow()?!1:!0},get_$9ml:function(){return _g.$O.get_$Q().get_$VV()&&(_g.$O.get_$Q().get_$VV().AlwaysSign||_g.$O.get_$Q().get_$1j().get_$tY())||this.get_$ow()?!1:!0},get_$5O:function(){return this.$w(_mcp.$V.$356)},set_$5O:function(n){this.$P(_mcp.$V.$356,n);return n},get_$3T8:function(){return this.$w(_mcp.$V.$6sM)},set_$3T8:function(n){this.$P(_mcp.$V.$6sM,n);return n},get_$3Jg:function(){if(this.get_$oy()||_y.$z.$1Q.get_$lN()||this.get_$s0())return!1;var n=this.get_$9i();return!n||!!n.get_$RG()||n.get_$KU()},get_$6TI:function(){return OwaApplication.$Oy?!1:this.get_$6X()!==8&&!this.get_$1El()},get_$23e:function(){return this.$w(_mcp.$V.$6SY)},set_$23e:function(n){this.$P(_mcp.$V.$6SY,n);return n},get_$4HB:function(){return this.$9kR},get_$1El:function(){return this.get_$6X()===11||this.get_$6X()===12||this.get_$6X()===13},get_$dm:function(){return this.$w(_mcp.$V.$6sy)},set_$dm:function(n){this.$P(_mcp.$V.$6sy,n);return n},get_$1NF:function(){return this.$w(_mcp.$V.$6sx)},set_$1NF:function(n){this.$P(_mcp.$V.$6sx,n);return n},get_$2By:function(){return this.$w(_mcp.$V.$7PP)},set_$2By:function(n){this.$P(_mcp.$V.$7PP,n);return n},set_$ps:function(n){this.$P(_mcp.$V.$9Pa,n);return n},get_$NE:function(){return this.$w(_mcp.$V.$6M7)},set_$NE:function(n){this.$P(_mcp.$V.$6M7,n);return n},get_$nz:function(){return this.$w(_mcp.$V.$2Hs)},set_$nz:function(n){this.$P(_mcp.$V.$2Hs,n);return n},get_$2mP:function(){return this.$w(_mcp.$V.$6SE)},set_$2mP:function(n){this.$P(_mcp.$V.$6SE,n);return n},get_$3yg:function(){return this.$w(_mcp.$V.$6T9)},set_$3yg:function(n){this.$P(_mcp.$V.$6T9,n);return n},get_$3Fz:function(){return this.$w(_mcp.$V.$6Km)},set_$3Fz:function(n){this.$P(_mcp.$V.$6Km,n);return n},get_$9SG:function(){return this.$w(_mcp.$V.$73k)},set_$9SG:function(n){this.$P(_mcp.$V.$73k,n);return n},get_$9mj:function(){this.$5ZN||(this.$5ZN=this.$4p8());return this.$5ZN},get_$4A8:function(){return this.$w(_mcp.$V.$aZ)},set_$4A8:function(n){this.$P(_mcp.$V.$aZ,n);return n},get_$37U:function(){return this.$w(_mcp.$V.$5yO)},set_$37U:function(n){this.$P(_mcp.$V.$5yO,n);return n},get_$6pz:function(){return this.$48C},set_$6pz:function(n){this.$48C=n;return n},$6NC:function(n){this.set_$5j(_mcp.$V.$9F3(_y.$Ox,n,_mcp.$V.$26G.$3D,0));this.set_$6X(_mcp.$V.$9F3(_y.$1m,n,_mcp.$V.$48c.$3D,0));this.set_$Xa(_mcp.$V.$9F1(n,_mcp.$V.$5WV.$3D,!0));this.set_$1oe(_mcp.$V.$9F1(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$rt(!1);this.set_$9oB(n.StoreId)}this.$C50(n);this.set_$OV(0===this.get_$6X()||4===this.get_$6X())},$6ND:function(n){_g.$gg.isInstanceOfType(n)?this.set_$6X(1):_g.$gf.isInstanceOfType(n)?this.set_$6X(2):_g.$t8.isInstanceOfType(n)&&this.set_$6X(3);this.$9tm(n,n.get_$2Ss());this.set_$14V(n.get_$2u0());this.set_$5Gl(n.get_$4BH());this.set_$Fd(n.get_$y());this.set_$3o(n.get_$3o());this.set_$do(n.get_$2Ss().get_$1Z());this.set_$5Q(n.get_$5Q());this.set_$79(n.get_$79()?n.get_$79().get_$7V():null);this.set_$7x(n.get_$7x()?n.get_$7x().get_$7V():null);this.set_$AN(n.get_$AN()?n.get_$AN().get_$7V():null);this.set_$Xa(!1);this.set_$Bv(n.get_$Bv());this.$4Wq(n);this.set_$9i(n.get_$9i());this.set_$ET(n.get_$ET());this.set_$Qu(n.get_$Qu());this.set_$Q8(n.get_$Q8());this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(this.get_$9i().get_$6P()):$C(n.get_$2Ss())||(n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML"));this.$8PB(n);this.set_$OV(!1);this.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context with smart response, context:"+this.toString())},$4sg:function(n){if($C(n))throw Error.argumentNull("message");this.$9tm(n,n.get_$4n());this.set_$j0(n);this.set_$Fd(n.get_$y());this.set_$3o(n.get_$3o());this.set_$do(n.get_$t9()?n.get_$t9().get_$1Z():n.get_$4n().get_$1Z());this.set_$5O(n.get_$5O());if(_g.$5w.isInstanceOfType(n)){var t=n;this.set_$5Q(t.get_$5Q());this.set_$79(t.get_$79()?t.get_$79().$5vQ():null);this.set_$7x(t.get_$7x()?t.get_$7x().$5vQ():null);this.set_$AN(t.get_$AN()?t.get_$AN().$5vQ():null);this.set_$Qu(t.get_$Qu());this.set_$Q8(t.get_$Q8())}else if(_g.$L6.isInstanceOfType(n)){var u=n;this.set_$5Q(u.get_$5Q())}this.set_$Xa(!1);this.set_$Bv(n.get_$Bv());this.$4Wq(n);this.set_$9i(n.get_$9i());this.set_$ET(n.get_$ET());n.get_$9i()&&!n.get_$9i().get_$RG()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML");this.set_$oy(_g.$Mf.isInstanceOfType(n));if(this.get_$oy()){var i=n;this.$4cj(i.get_$Q4());this.set_$23N(_g.$9y.isInstanceOfType(i));i.get_$5Q()&&this.set_$5Q(i.get_$5Q());i.get_$Em()&&this.set_$Em(i.get_$Em())}n.get_$1Aw()&&n.get_$1Aw().get_$A()?this.set_$EW(n.get_$1Aw()?n.get_$1Aw().get_$7V():null):(!this.get_$23e()||this.get_$OV())&&this.set_$EW(n.get_$1m()?n.get_$1m().get_$7V():null);if(this.get_$EW()&&n.get_$4n().get_$6P()==="Text")for(var r=0;r<this.get_$EW().get_$A();r++)this.get_$EW().get_$E(r)&&this.get_$EW().get_$E(r).get_$CA()&&this.get_$EW().get_$E(r).set_$CA(!1);this.$8PB(n);this.set_$OV(!0);this.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context with draft, context:"+this.toString())},$1Th:function(n){this.set_$IV(n);this.$C4l(n)},$1kK:function(n){var i=new _g.$5w;var t;this.$9i1(i,t={val:n}),n=t.val;return i},$5v7:function(n){var i=new _g.$L6;var t;this.$9i1(i,t={val:n}),n=t.val;return i},$7fd:function(){var t=this.$7hS();_a.$4.$z(this.$W3,"GetRawEditorContentCommand");this.$W3.$11();var n=this.get_$do();t.set_$1Z(n);this.$52e=_js.$9.$o(n)?0:n.length;_js.Trace.logInfo(_a.$0.$16,"MailComposeContext.CreateBodyFromEditor, RawContentLength: "+this.$52e.toString());return t},$EvV:function(n){var t=this.get_$T9();if(!t||this.get_$Bv()===t.get_$Bv()){this.set_$Bv(n);t&&t.set_$Bv(n)}},$7ob:function(){if(this.$3IB&&this.$6UT){this.$W2.$11();if($C(this.get_$T9())){this.set_$T9(_mcp.$1W.$33t(this));_js.Trace.logInfo(_a.$0.$16,"Captured baseline for the first time, context:"+this.toString());if(this.$5CN&&this.$jW){this.$jW.set_$MW(this.get_$T9().get_$MW());this.$5CN=!1}if(!this.get_$Fd()||this.get_$23e()&&this.get_$1Oz()){this.$jW=_mcp.$1W.$33t(this);_js.Trace.logInfo(_a.$0.$16,"Captured initial baseline for context:"+this.toString())}}else{_mcp.$1W.$2W(this.get_$T9(),this);_js.Trace.logInfo(_a.$0.$16,"Updated baseline, context:"+this.toString())}}},$IO:function(){if($C(this.get_$T9()))return!1;this.$W2.$11();return!this.get_$T9().$7oS(this)},$6IV:function(n){this.$4pH.$11();var t=this.get_$1vc();t=t?t.length>n?this.get_$1vc().substr(0,n)+"...":t:"";return t},$2AJ:function(n,t,i,r){this.set_$79(new _js.$X);var u=n?n.Mailbox:null;if(!_mcp.$V.$1h0){var s=_g.$O.get_$Q().get_$4P();_mcp.$V.$1h0=_js.$9.$o(s.get_$1up())?s.get_$Fv()||"":s.get_$sA()||""}if(this.get_$8OP()||this.get_$6X()!==8&&(!r||!r.get_$A())&&u&&(2!==this.get_$6X()||!_mcp.$V.$23m(u.EmailAddress))){this.get_$79().$F(u);_js.Trace.logInfo(_a.$0.$16,"Adding original From to To, Operation="+this.get_$6X()+"; From="+_g.$1Z.$1d1(n)+"; Self="+_mcp.$V.$1h0)}if(this.get_$6X()===2||this.get_$6X()===8){_js.Trace.logInfo(_a.$0.$16,"Adding "+(t?t.get_$A():0)+" To recipients to To.");_mcp.$V.$7Tf(t,this.get_$79(),u,null);_js.Trace.logInfo(_a.$0.$16,"Adding "+(i?i.get_$A():0)+" Cc recipients to Cc");this.set_$7x(new _js.$X);_mcp.$V.$7Tf(i,this.get_$7x(),u,this.get_$79())}this.$7Ts();if(r&&r.get_$A()>0)if(this.get_$6X()===1){this.get_$79().$1u();for(var o=0;o<r.get_$A();o++){var c=r.get_$E(o);this.get_$79().$F(c)}}else if(this.get_$6X()===2)for(var f=0;f<r.get_$A();f++){var e=r.get_$E(f);var l=this;if(this.get_$79().get_$A()===this.get_$79().$HE(function(n){return _g.$1Z.$5b(e,n)})){var a=this;var h=this.get_$7x().$HE(function(n){return _g.$1Z.$5b(e,n)});h!==this.get_$7x().get_$A()&&this.get_$7x().$5W(h);this.get_$79().$F(e)}}if(this.get_$6X()!==8&&u&&0===this.get_$79().get_$A()&&(!this.get_$7x()||0===this.get_$7x().get_$A())){this.get_$79().$F(u);_js.Trace.logInfo(_a.$0.$16,"Adding original From since there are no recipients left, From="+_g.$1Z.$1d1(n))}},toString:function(){var n="Id="+this.get_$D1()+"; Op="+this.get_$6X()+"; Mode="+this.get_$5j()+"; Oid=";n+=this.get_$14V()?this.get_$14V().Id+":"+this.get_$14V().ChangeKey+";":this.$8P&&this.$8P.get_$y()?this.$8P.get_$y().Id+":"+this.$8P.get_$y().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$Fd()?this.get_$Fd().Id+":"+this.get_$Fd().ChangeKey+";":this.get_$j0()&&this.get_$j0().get_$y()?this.get_$j0().get_$y().Id+":"+this.get_$j0().get_$y().ChangeKey+";":"null;";n+=" Subject="+this.get_$3o()+"; RawContentLength="+(_js.$9.$o(this.get_$do())?"0":this.get_$do().length.toString())+"; ContentLength="+(_js.$9.$o(this.get_$MW())?"0":this.get_$MW().length.toString())+"; TextEditorContentLength="+(_js.$9.$o(this.get_$1vc())?"0":this.get_$1vc().length.toString())+"; BodyType="+this.get_$6P()+";";var r;_mcp.$V.$6XM("To",this.get_$79(),this.get_$10y(),r={val:n}),n=r.val;var i;_mcp.$V.$6XM("Cc",this.get_$7x(),this.get_$xs(),i={val:n}),n=i.val;var t;_mcp.$V.$6XM("Bcc",this.get_$AN(),this.get_$qd(),t={val:n}),n=t.val;n+=" AutoSig="+this.get_$Xa()+"; Imp="+this.get_$Bv()+"; QuotedBodyLength="+(_js.$9.$o(this.get_$1gL())?"0":this.get_$1gL().length.toString())+"; IsComplete="+this.get_$rt()+"; IsMeeting="+this.get_$oy()+"; IsMeetingForward="+this.get_$23N()+"; IsReplyBcc="+this.get_$3yb()+"; HasLocation="+this.get_$3Fs()+"; MeetingTime="+(this.get_$1pY()?this.get_$1pY().get_$Q9()+":"+(this.get_$1pY().get_$1T()?this.get_$1pY().get_$1T().$Er():"null")+":"+(this.get_$1pY().get_$2y()?this.get_$1pY().get_$2y().$Er():"null"):"null")+"; From="+_g.$1Z.$1d1(this.get_$5Q())+"; Sender="+_g.$1Z.$1d1(this.get_$Em())+"; IsFromShown="+this.get_$ow()+"; IsBccShown="+this.get_$1LS()+"; AttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A().toString():"0")+"; UpgradeFailed="+this.get_$1ZM()+"; HasBaseline="+(!!this.get_$T9()).toString()+"; HasInitBaseline="+(!!this.$jW).toString()+"; UserSaved="+this.get_$1TQ()+"; IsReplyForward="+this.get_$1Lk()+"; HasDraft="+(!!this.get_$j0()).toString()+"; HasRMLD="+(!!this.get_$9i()).toString()+"; Classified="+this.get_$a7()+"; Class="+this.get_$h0()+"; Sensitivity="+this.get_$ET()+"; DeliveryReceipt="+this.get_$Qu()+"; ReadReceipt="+this.get_$Q8()+"; SmimeEncryptMessage="+this.get_$PT()+"; SmimeSignMessage="+this.get_$T0()+"; ConversationId="+(this.get_$5O()?this.get_$5O().Id+":"+this.get_$5O().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$3T8()+"; IsOriCalId="+this.get_$1oe()+"; OccurrenceRefMaster="+this.get_$1Lf()+"; IsLoadedDraft="+this.get_$23K()+"; IsMovedToDraftFromOutbox="+this.get_$3xz()+"; IsUpgraded="+this.get_$OV()+"; IsCached="+this.$8Sm+";";return n},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Context reset start.");this.set_$D1(null);this.get_$6X()&&this.set_$6X(0);this.get_$5j()&&this.set_$5j(0);this.get_$14V()&&this.set_$14V(null);this.get_$IV()&&this.set_$IV(null);this.get_$Fd()&&this.set_$Fd(null);_js.$9.$o(this.get_$3o())||this.set_$3o(null);_js.$9.$o(this.get_$do())||this.set_$do("");_js.$9.$o(this.get_$MW())||this.set_$MW("");_js.$9.$o(this.get_$1vc())||this.set_$1vc("");this.get_$79()&&this.set_$79(null);_js.$9.$o(this.get_$10y())||this.set_$10y(null);this.get_$7x()&&this.set_$7x(null);_js.$9.$o(this.get_$xs())||this.set_$xs(null);this.get_$AN()&&this.set_$AN(null);_js.$9.$o(this.get_$qd())||this.set_$qd(null);this.get_$Xa()||this.set_$Xa(!0);this.get_$Bv()!=="Normal"&&this.set_$Bv("Normal");_js.$9.$o(this.get_$1gL())||this.set_$1gL(null);this.get_$rt()&&this.set_$rt(!1);this.get_$oy()&&this.set_$oy(!1);this.get_$23N()&&this.set_$23N(!1);this.get_$3yb()&&this.set_$3yb(!1);this.get_$6E()&&this.set_$6E(null);this.get_$3Fs()&&this.set_$3Fs(!1);this.get_$1pY()&&this.set_$1pY(null);this.get_$5Q()&&this.set_$5Q(null);this.get_$Em()&&this.set_$Em(null);this.get_$OV()&&this.set_$OV(!1);this.get_$ow()&&this.set_$ow(!1);this.get_$1LS()&&this.set_$1LS(!1);this.get_$EW()&&this.set_$EW(null);this.get_$1ZM()&&this.set_$1ZM(!1);this.get_$T9()&&this.set_$T9(null);this.get_$1TQ()&&this.set_$1TQ(!1);this.get_$1Lk()&&this.set_$1Lk(!1);this.get_$j0()&&this.set_$j0(null);this.get_$9i()&&this.set_$9i(null);_js.$9.$o(this.get_$h4())||this.set_$h4(null);this.get_$a7()&&this.set_$a7(!1);_js.$9.$o(this.get_$l4())||this.set_$l4(null);_js.$9.$o(this.get_$h0())||this.set_$h0(null);_js.$9.$o(this.get_$eW())||this.set_$eW(null);this.get_$1xt()&&this.set_$1xt(!1);this.get_$ET()!=="Normal"&&this.set_$ET("Normal");this.get_$Qu()&&this.set_$Qu(!1);this.get_$Q8()&&this.set_$Q8(!1);this.get_$PT()&&this.set_$PT(!1);this.get_$T0()&&this.set_$T0(!1);this.get_$5ZR()&&this.set_$5ZR(null);this.get_$5O()&&this.set_$5O(null);_js.$9.$o(this.get_$3T8())||this.set_$3T8(null);this.get_$1oe()&&this.set_$1oe(!1);this.get_$1Lf()&&this.set_$1Lf(!1);this.get_$23K()&&this.set_$23K(!1);this.get_$3xz()&&this.set_$3xz(!1);this.get_$nz()&&this.set_$nz(null);_js.Trace.logInfo(_a.$0.$16,"Context reset end.")},$6T1:function(){return!!this.get_$IV().get_$9i()&&0===this.get_$IV().get_$9i().get_$RG()&&!this.get_$IV().get_$9i().get_$4bz()&&!this.get_$IV().get_$9i().get_$4e0()},$3sl:function(){var n=null;if(this.get_$5Q()&&this.get_$5Q().Mailbox&&!_js.$9.$o(this.get_$5Q().Mailbox.EmailAddress))n=this.get_$5Q().Mailbox;else if(this.get_$Em()&&this.get_$Em().Mailbox&&!_js.$9.$o(this.get_$Em().Mailbox.EmailAddress))n=this.get_$Em().Mailbox;else if(!_js.$9.$o(_mcp.$V.$1h0)){n=new _g.$1K;n.EmailAddress=_mcp.$V.$1h0;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$6Tg:function(){if(!_a.$c.$43)return!1;switch(this.get_$6X()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$j0()&&!this.$6Tf(this.get_$j0())?!1:this.get_$IV()&&!this.$6Tf(this.get_$IV())?!1:_js.$9.$o(this.get_$37U())?!0:!1},$6Tf:function(n){if(_js.$9.$o(n.get_$CK())||n.get_$CK()==="IPM.Note"||n.get_$Mk())return!0;else{var i=this.get_$6X()===1||this.get_$6X()===2;var t=i||this.get_$6X()===3;return i&&(n.get_$CK().startsWith("IPM.Schedule.Meeting")||n.get_$CK().startsWith("IPM.Appointment"))?!0:t&&n.get_$CK().startsWith("REPORT.IPM.Note")?!0:t&&n.get_$CK().startsWith("IPM.Note.Rules")?!0:t&&n.get_$CK()==="IPM.Post"?!0:!1}},$9wP:function(n){_js.Trace.logInfo(_a.$0.$53,"Updating S/MIME options...");if(_a.$c.$43)switch(n){case 6:this.set_$PT(!0);this.set_$T0(!1);break;case 10:case 11:this.set_$PT(!1);this.set_$T0(!0);break;case 12:case 13:case 14:this.set_$PT(!0);this.set_$T0(!0);break;case-1:case 0:default:this.set_$PT(!1);this.set_$T0(!1);break}},$Eyx:function(n){_js.Trace.logInfo(_a.$0.$53,"Upgrading S/MIME options...");if(_a.$c.$43)switch(n){case 6:this.set_$PT(!0);break;case 10:case 11:this.set_$T0(!0);break;case 12:case 13:case 14:this.set_$PT(!0);this.set_$T0(!0);break;case-1:case 0:default:break}},$7CQ:function(){if(this.get_$dm()){var t=!1;var n=this;this.$6uK=function(i){if(!t&&n.get_$dm()){_y.$2F.$1G(n.get_$dm(),null,i);n.set_$dm(null);t=!0}}}},$4p8:function(n,t){var i=this.get_$5ZR();if(!i||!i.length)return null;$C(n)&&(n=0);$C(t)&&(t=i.length);for(var r=new(_ff.$18.$$(String)),h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.$9.$o(u)||r.$5l(u)||r.$F(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.$9.$o(c)||r.$5l(c)||r.$F(c)}}return r.get_$A()>0?r.get_$1y():null},$9i1:function(n,t){t.val=$C(t.val)?!1:t.val;n.set_$3o(this.get_$3o());n.set_$Bv(this.get_$Bv());n.set_$y(this.get_$Fd());n.set_$1m(new(_a.$2T.$$(_g.Attachment,_g.$Bg)));if(this.get_$s0()){var o=_g.$O.get_$Q().get_$VV().ClearSign;n.set_$CK(this.get_$PT()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.get_$CK()==="IPM.Note.SMIME.MultipartSigned"?n.set_$4n(this.$7fc(t.val)):n.set_$4n(new _g.$5E(new _g.$5d(this.get_$6P(),"")));var e=_a.$5u.$Jh(this.get_$9mi());n.set_$c4(new _g.$Wi(e))}else{n.set_$4n(this.$7fc(t.val));(this.get_$j0()&&this.get_$j0().get_$Mk()||this.get_$IV()&&this.get_$IV().get_$Mk())&&n.set_$CK("IPM.Note");this.get_$EW()&&n.get_$1m().$3y(this.get_$EW().$3Q())}n.set_$9i(this.get_$9i());n.set_$ET(this.get_$ET());n.set_$a7(this.get_$a7());n.set_$h0(this.get_$h0());n.set_$eW(this.get_$eW());n.set_$l4(this.get_$l4());n.set_$uM(this.get_$uM());n.set_$r3(this.get_$r3());n.set_$177(this.get_$177());if(this.get_$nz()){n.set_$Pp(new(_a.$2T.$$(_g.$HL,_g.$Bm)));n.get_$Pp().$3y(this.get_$nz().$3Q())}if(_g.$5w.isInstanceOfType(n)){var i=n;i.set_$5Q(this.get_$5Q());if(this.get_$s0()&&this.$1i1){if(this.$1i1===1){i.set_$79(new(_a.$u.$$(_g.$1K)));this.get_$79()&&i.get_$79().$3y(this.get_$79().$3Q());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3y(this.get_$7x().$3Q())}else if(this.$1i1===2){i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$F(this.get_$AN().get_$E(this.$3kv))}else if(this.$1i1===3){i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$3y(this.get_$AN().$3Q())}}else{i.set_$79(new(_a.$u.$$(_g.$1K)));this.get_$79()&&i.get_$79().$3y(this.get_$79().$3Q());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3y(this.get_$7x().$3Q());i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$3y(this.get_$AN().$3Q())}i.set_$Qu(this.get_$Qu());i.set_$Q8(this.get_$Q8());i.set_$PT(this.get_$PT());i.set_$T0(this.get_$T0())}else{var u=n;u.set_$3G(this.get_$2se());var f=_g.$O.get_$Q().get_$4P();var r=null;r=_js.$9.$o(f.get_$sA())?null!==this.get_$5Q()&&this.get_$5Q().Mailbox?this.get_$5Q().Mailbox.EmailAddress:_h.$2k.$4nQ(null)||f.get_$Fv():f.get_$sA();if(r){u.set_$5Q(new _g.$8w);u.get_$5Q().Mailbox=new _g.$1K;u.get_$5Q().Mailbox.EmailAddress=r}}},$Aqv:function(n,t){this.$4("ShowMeetingReadonlyFields")},$C50:function(n){var t=this.$Doz(n);switch(this.get_$6X()){case 0:case 4:this.set_$Fd(t);break;case 1:case 2:case 3:this.set_$14V(t);break}},$8PB:function(n){if(n.get_$Pp()){this.set_$nz(new _js.$X);this.get_$nz().$3y(n.get_$Pp().$3Q())}},$Doz:function(n){var t=null;if(!$C(n)&&"Id"in n){t=new _g.$1T(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},$9tm:function(n,t){0===n.get_$106()&&n.set_$106(t&&t.get_$6P()==="Text"?1:3)},$C4o:function(n){var r=_h.$2k.$4nQ(n);if(r){this.set_$5Q(new _g.$8w);this.get_$5Q().Mailbox=new _g.$1K;this.get_$5Q().Mailbox.EmailAddress=r}this.set_$1oe(!1);this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());switch(this.get_$6X()){case 1:case 2:case 12:this.$4Wq(n);if(_g.$5w.isInstanceOfType(n)){var t=n;t.get_$SB()?this.$2AJ(t.get_$5Q()||t.get_$Em(),null,null,null):this.$2AJ(t.get_$5Q()||t.get_$Em(),t.get_$79()?t.get_$79().get_$7V():null,t.get_$7x()?t.get_$7x().get_$7V():null,t.get_$5Mt()?t.get_$5Mt().get_$7V():null);this.set_$3yb(this.get_$6X()===2&&n.get_$52a()&&!t.get_$8UJ());this.set_$5Gl(n.get_$2gS())}else if(_g.$L6.isInstanceOfType(n)){var u=n;this.$2AJ(u.get_$5Q()||u.get_$Em(),null,null,null)}this.$71J(n);break;case 5:case 6:case 7:if(_g.$5w.isInstanceOfType(n)){var i=n;this.$2AJ(i.get_$5Q()||i.get_$Em(),i.get_$79()?i.get_$79().get_$7V():null,i.get_$7x()?i.get_$7x().get_$7V():null,i.get_$5Mt()?i.get_$5Mt().get_$7V():null)}break;case 3:_g.$Mf.isInstanceOfType(n)||this.$4Wq(n);this.set_$5Gl(n.get_$2gS());this.$7Ts();this.$71J(n);break;case 9:case 10:_g.$5w.isInstanceOfType(n)?this.$2AJ(n.get_$Em(),null,null,null):_g.$L6.isInstanceOfType(n)&&this.$2AJ(n.get_$Em(),null,null,null);this.$71J(n);break;default:this.$9qD();break}_js.Trace.logInfo(_a.$0.$16,"Initialized context with original email message, context:"+this.toString())},$C4l:function(n){this.set_$14V(n.get_$y());var i=this.$6T1();this.set_$9i(i?null:n.get_$9i());this.$EZJ(n.get_$14H());this.set_$ET(n.get_$ET());this.set_$do(this.get_$do()||"");this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(this.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML");if(!this.get_$OV()){this.set_$OV(!(this.get_$6X()===1||this.get_$6X()===2||this.get_$6X()===3||this.get_$6X()===12));this.get_$6X()!==3||_a.$c.$43&&n.get_$Mk()||i||this.get_$9i()&&this.get_$9i().get_$RG()||this.set_$EW(n.get_$1m()?n.get_$1m().get_$7V():null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.$5Vk();this.$C4n(t)}else if(_g.$5w.isInstanceOfType(n)||_g.$L6.isInstanceOfType(n)){if(3===this.get_$6X()&&!this.get_$OV()){this.set_$Bv(n.get_$Bv());_js.Trace.logInfo(_a.$0.$16,"Setting importance to "+this.get_$Bv()+" since we are forwarding item "+_h.$D1.$1d1(n.get_$y())+" with that importance")}this.$C4o(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.$9tg();_g.$5w.isInstanceOfType(n)&&n.$22J?this.set_$rt(!1):this.set_$rt(!0)},$Bnj:function(n){var t=null;_g.$Mg.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)?t=n.get_$5Q():n.get_$MD()?t=n.get_$MD():_js.Trace.logError(_a.$0.$16,"ICalendaring doesnt have an organizer");return t},$9tg:function(){var n=new(_ff.$18.$$(String));this.get_$23N()&&n.$3y(_g.$9y.$6Gh(this.get_$EW()));if(this.$8P&&_a.$c.$43&&this.$8P.get_$Mk()&&this.$8P.get_$3G0()){var t=this.$8P.get_$1m().get_$E(0).get_$6J().Id;n.$F(t)}this.set_$2E6(n.$3Q())},$C4n:function(n){this.set_$1oe(!0);n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());var r=this.$Bnj(n);var t;var i;if(_g.$Mg.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)){t=n.get_$79()?_g.$1Z.$3oW(n.get_$79().get_$7V()):null;i=n.get_$7x()?_g.$1Z.$3oW(n.get_$7x().get_$7V()):null}else{t=n.get_$Bm()?_g.$1Z.$3oW(_g.$2o.$7K1(n.get_$Bm().get_$7V())):null;i=n.get_$DH()?_g.$1Z.$3oW(_g.$2o.$7K1(n.get_$DH().get_$7V())):null}switch(this.get_$6X()){case 1:case 2:this.$2AJ(r,t,i,null);break;case 5:case 6:case 7:this.$2AJ(r,t,i,null);this.$4cj(n);this.set_$3uZ(!0);break;case 8:var u=n.get_$Bm().$4s();u.$3y(n.get_$EP().$3Q());t=_g.$1Z.$3oW(_g.$2o.$7K1(u.get_$7V()));this.$2AJ(r,t,i,null);this.$4cj(n);this.set_$3uZ(!0);break;case 3:if(_g.$9y.isInstanceOfType(n)||_g.$2g.isInstanceOfType(n)){this.set_$23N(!0);this.set_$5Q(r);this.$4cj(n)}break;default:this.$9qD();break}this.set_$oy(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context from original calendar item, context:"+this.toString())},$4cj:function(n){this.set_$1pY(_cc.$86.$At7(n));this.set_$6E(n.get_$6E());this.set_$3Fs(!!this.get_$6E()&&!_js.$9.$o(this.get_$6E().get_$26()))},$EZJ:function(n){var t="";switch(this.get_$6X()){case 1:case 2:case 12:t=_u.Strings.l_ReplyPrefix_Text;break;case 3:t=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:t=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:t=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:t=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:t=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:t=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:t=_nbs.NonBootStrings.l_RejectPrefix_Text;break}this.get_$2MB()&&(t=_nbs.NonBootStrings.l_NewTimeProposedPrefix_Text);var i=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,t,n);_js.Trace.logInfo(_a.$0.$16,"Formatted subject with Prefix="+t+"; Operation="+this.get_$6X());if(255<i.length){this.set_$3o(i.substr(0,255));_js.Trace.logInfo(_a.$0.$16,"Truncated subject from "+i+" to "+this.get_$3o()+" to meet the "+255+" characters rule.")}else this.set_$3o(i)},$71J:function(n){this.set_$5O(n.get_$5O());_g.$5w.isInstanceOfType(n)?this.set_$3T8(n.get_$HS()):_g.$L6.isInstanceOfType(n)&&this.set_$3T8(n.get_$HS())},$9qD:function(){var n=_js.$1I.$Gx(_y.$1m,this.get_$6X());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},$4Wq:function(n){this.set_$a7(n.get_$a7());this.set_$l4(n.get_$l4());this.set_$h0(n.get_$h0());this.set_$eW(n.get_$eW());this.set_$1xt(n.get_$1xt())},$7fc:function(n){return n?this.$7hS():this.$7fd()},$7hS:function(){var n=new _g.$5E(new _g.$5d("HTML",""));n.set_$1Z("");if(4!==this.get_$6X()&&13!==this.get_$6X()||this.get_$NE()){_js.Trace.logInfo(_a.$0.$16,"Create new body for action email message, setting body type to context body type: "+this.get_$6P());n.set_$6P(this.get_$6P())}else{_js.Trace.logInfo(_a.$0.$16,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.set_$6P("Text")}return n},$7Ts:function(){if(_y.$z.$1Q.get_$lN()){var t=this.$3sl();if(t){var i=!1;if(this.get_$7x())for(var n=0;n<this.get_$7x().get_$A();n++){var r=this.get_$7x().get_$E(n);if(t.EmailAddress.toLowerCase()===r.EmailAddress.toLowerCase()){i=!0;break}}if(!i){this.get_$7x()||this.set_$7x(new _js.$X);this.get_$7x().$F(t);_js.Trace.logInfo(_a.$0.$16,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$16,"Could not add self to CC as the address was missing")}}};_mcp.$uh=function(n){this.$1vH={};this.$Xj=n};_mcp.$uh.prototype={$Xj:null,$1EM:function(n){return n in this.$1vH},$9iG:function(n,t){if(n in this.$1vH){var i=this.$1vH[n];!i.$5Wl&&t&&(this.$1vH[n]=new _mcp.$w4(t))}else this.$1vH[n]=new _mcp.$w4(t)},$7lq:function(n,t){var u=n.$v;var i=u.$c;var r=i.get_$D1();var o=i.get_$Fd();var f=!1;if(i.get_$23K())_js.Trace.logInfo(_a.$0.$16,"Not discarding a loaded draft for context "+r);else if(i.get_$1TQ())_js.Trace.logInfo(_a.$0.$16,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$1XF().get_$C9h())_js.Trace.logInfo(_a.$0.$16,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$iH().get_$m1())_js.Trace.logInfo(_a.$0.$16,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$16,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$16,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$IO()}if(e)_js.Trace.logInfo(_a.$0.$16,"Not discarding a dirty draft for context "+r);else if(i.$jW)if(i.$jW.$5b(i.get_$T9())){if(_g.$1H.$Yv&&i.get_$1Lk()&&!i.get_$Fd()){_js.Trace.logInfo(_a.$0.$16,"Calling main window to remember the pending discard for context "+r);_g.$1H.$Yv.$9iG(r,!i.get_$1TQ());f=!0}else if(!i.get_$1El()){_js.Trace.logInfo(_a.$0.$16,"Discarding unused draft for context "+r);this.$5yr(r,o,u.$n,i.get_$1TQ());f=!0}}else _js.Trace.logInfo(_a.$0.$16,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$16,"Not discarding without an initial baseline for context "+r)}return f},$5yr:function(n,t,i,r){i||(i=new _mcp.$ug(new _bc.$3e));var u;if(this.$1vH[n]){var e=this.$1vH[n];u=e.$5Wl}else u=!r;if(t){var f=this.$Xj.$AMY(t,u);i.$tE(f,null,null,null);delete this.$1vH[n];_js.Trace.logInfo(_a.$0.$16,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$1vH[n]=new _mcp.$w4(u);_js.Trace.logInfo(_a.$0.$16,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$AWt:function(n,t){this.$5yr(n,t,new _mcp.$ug(new _bc.$3e),!1)}};_mcp.$1W=function(){_mcp.$1W.initializeBase(this)};_mcp.$1W.$$cctor=function(){_mcp.$1W.$2ap.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2Eq.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2E9.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2E2.set_$Qz(new _a.$CA(_g.Attachment));_mcp.$1W.$2Hs.set_$Qz(new _a.$CA(_g.$HL))};_mcp.$1W.$33t=function(n){var t=new _mcp.$1W;_mcp.$1W.$2W(t,n);return t};_mcp.$1W.$2W=function(n,t){n.set_$3o(t.get_$3o());n.set_$MW(t.get_$MW());if(t.get_$79()){n.set_$79(new _js.$X);n.get_$79().$3y(t.get_$79().$3Q())}else n.set_$79(null);n.set_$10y(t.get_$10y());if(t.get_$7x()){n.set_$7x(new _js.$X);n.get_$7x().$3y(t.get_$7x().$3Q())}else n.set_$7x(null);n.set_$xs(t.get_$xs());if(t.get_$AN()){n.set_$AN(new _js.$X);n.get_$AN().$3y(t.get_$AN().$3Q())}else n.set_$AN(null);if(t.get_$EW()){n.set_$EW(new _js.$X);n.get_$EW().$3y(t.get_$EW().$3Q())}else n.set_$EW(null);if(t.get_$nz()){n.set_$nz(new _js.$X);n.get_$nz().$3y(t.get_$nz().$3Q())}else n.set_$nz(null);n.set_$qd(t.get_$qd());n.set_$Bv(t.get_$Bv());n.set_$5Q(t.get_$5Q());n.set_$h4(t.get_$h4());n.set_$ET(t.get_$ET());n.set_$Qu(t.get_$Qu());n.set_$Q8(t.get_$Q8());n.set_$PT(t.get_$PT());n.set_$T0(t.get_$T0())};_mcp.$1W.$31u=function(n,t,i,r){if(i!==r&&!(_js.$9.$o(i)&&_js.$9.$o(r))||!_mcp.$1W.$7mG(n,t))return!1;if($C(n)||$C(t))return!0;for(var u=0;u<n.get_$A();u++){var e=n.get_$E(u);var f=t.get_$E(u);if(!_mcp.$1W.$5lr(e,f))return!1}return!0};_mcp.$1W.$5lr=function(n,t){return $C(n)&&!$C(t)||$C(t)&&!$C(n)?!1:$C(n)&&$C(t)?!0:_g.$1Z.$5b(n,t)};_mcp.$1W.$7mG=function(n,t){var r=_mcp.$1W.$8Dt(n);var i=_mcp.$1W.$8Dt(t);return r===i};_mcp.$1W.$8Dt=function(n){return $C(n)?0:n.get_$A()};_mcp.$1W.$7WC=function(n,t){if(!_mcp.$1W.$7mG(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$A();i++){var u=n.get_$E(i);var r=t.get_$E(i);if(!_mcp.$1W.$A7W(u,r))return!1}return!0};_mcp.$1W.$A7R=function(n,t){return _h.$Ud.$7WE(n,t)};_mcp.$1W.$A7W=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$6J()&&t.get_$6J()||!t.get_$6J()&&n.get_$6J()?!1:n.get_$6J()&&n.get_$6J().Id!==t.get_$6J().Id?!1:n.get_$1x()!==t.get_$1x()?!1:n.get_$KN()!==t.get_$KN()?!1:n.get_$SF()!==t.get_$SF()?!1:n.get_$4WV()!==t.get_$4WV()?!1:n.get_$8D()!==t.get_$8D()?!1:!n.get_$Jq()&&t.get_$Jq()||!t.get_$Jq()&&n.get_$Jq()?!1:n.get_$Jq()&&!n.get_$Jq().$5b(t.get_$Jq())?!1:n.get_$CA()!==t.get_$CA()?!1:!0};_mcp.$1W.prototype={get_$3o:function(){return this.$w(_mcp.$1W.$qH)},set_$3o:function(n){this.$P(_mcp.$1W.$qH,n);return n},get_$MW:function(){return this.$w(_mcp.$1W.$38L)},set_$MW:function(n){this.$P(_mcp.$1W.$38L,n);return n},get_$79:function(){return this.$w(_mcp.$1W.$2ap)},set_$79:function(n){this.$P(_mcp.$1W.$2ap,n);return n},get_$10y:function(){return this.$w(_mcp.$1W.$3dI)},set_$10y:function(n){this.$P(_mcp.$1W.$3dI,n);return n},get_$7x:function(){return this.$w(_mcp.$1W.$2Eq)},set_$7x:function(n){this.$P(_mcp.$1W.$2Eq,n);return n},get_$xs:function(){return this.$w(_mcp.$1W.$342)},set_$xs:function(n){this.$P(_mcp.$1W.$342,n);return n},get_$AN:function(){return this.$w(_mcp.$1W.$2E9)},set_$AN:function(n){this.$P(_mcp.$1W.$2E9,n);return n},get_$qd:function(){return this.$w(_mcp.$1W.$32n)},set_$qd:function(n){this.$P(_mcp.$1W.$32n,n);return n},get_$Bv:function(){return this.$w(_mcp.$1W.$3Gg)},set_$Bv:function(n){this.$P(_mcp.$1W.$3Gg,n);return n},get_$5Q:function(){return this.$w(_mcp.$1W.$2Ic)},set_$5Q:function(n){this.$P(_mcp.$1W.$2Ic,n);return n},get_$h4:function(){return this.$w(_mcp.$1W.$34Z)},set_$h4:function(n){this.$P(_mcp.$1W.$34Z,n);return n},get_$ET:function(){return this.$w(_mcp.$1W.$3XK)},set_$ET:function(n){this.$P(_mcp.$1W.$3XK,n);return n},get_$Qu:function(){return this.$w(_mcp.$1W.$3I6)},set_$Qu:function(n){this.$P(_mcp.$1W.$3I6,n);return n},get_$Q8:function(){return this.$w(_mcp.$1W.$3JS)},set_$Q8:function(n){this.$P(_mcp.$1W.$3JS,n);return n},get_$PT:function(){return this.$w(_mcp.$1W.$3bQ)},set_$PT:function(n){this.$P(_mcp.$1W.$3bQ,n);return n},get_$T0:function(){return this.$w(_mcp.$1W.$3bT)},set_$T0:function(n){this.$P(_mcp.$1W.$3bT,n);return n},get_$EW:function(){return this.$w(_mcp.$1W.$2E2)},set_$EW:function(n){this.$P(_mcp.$1W.$2E2,n);return n},get_$nz:function(){return this.$w(_mcp.$1W.$2Hs)},set_$nz:function(n){this.$P(_mcp.$1W.$2Hs,n);return n},$7oS:function(n){if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3o()!==n.get_$3o()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$C(this.get_$3o())?0:this.get_$3o().length,$C(n.get_$3o())?0:n.get_$3o().length);return!1}if(this.get_$h4()!==n.get_$h4()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$h4(),n.get_$h4());return!1}if(this.get_$ET()!==n.get_$ET()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$ET(),n.get_$ET());return!1}if(this.get_$Qu()!==n.get_$Qu()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$Qu(),n.get_$Qu());return!1}if(this.get_$Q8()!==n.get_$Q8()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$Q8(),n.get_$Q8());return!1}if(this.get_$PT()!==n.get_$PT()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$PT(),n.get_$PT());return!1}if(this.get_$T0()!==n.get_$T0()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$T0(),n.get_$T0());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5lr(i,t)){_js.Trace.logInfo(_a.$0.$16,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31u(this.get_$79(),n.get_$79(),this.get_$10y(),n.get_$10y())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$79())?0:this.get_$79().get_$A(),$C(n.get_$79())?0:n.get_$79().get_$A(),$C(this.get_$10y())?0:this.get_$10y().length,$C(n.get_$10y())?0:n.get_$10y().length);return!1}if(!_mcp.$1W.$31u(this.get_$7x(),n.get_$7x(),this.get_$xs(),n.get_$xs())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$7x())?0:this.get_$7x().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(this.get_$xs())?0:this.get_$xs().length,$C(n.get_$xs())?0:n.get_$xs().length);return!1}if(!_mcp.$1W.$31u(this.get_$AN(),n.get_$AN(),this.get_$qd(),n.get_$qd())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$AN())?0:this.get_$AN().get_$A(),$C(n.get_$AN())?0:n.get_$AN().get_$A(),$C(this.get_$qd())?0:this.get_$qd().length,$C(n.get_$qd())?0:n.get_$qd().length);return!1}if(!_mcp.$1W.$7WC(this.get_$EW(),n.get_$EW())){_js.Trace.logInfo(_a.$0.$16,"snapshotAttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A():0)+", contextAttachmentCount="+(n.get_$EW()?n.get_$EW().get_$A():0));return!1}if(!_mcp.$1W.$A7R(this.get_$nz(),n.get_$nz())){_js.Trace.logInfo(_a.$0.$16,"snapshotExtendedPropertyCount="+(this.get_$nz()?this.get_$nz().get_$A():0)+", contextExtendedPropertyCount="+(n.get_$nz()?n.get_$nz().get_$A():0));return!1}if(this.get_$MW()!==n.get_$MW()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$C(this.get_$MW())?0:this.get_$MW().length,$C(n.get_$MW())?0:n.get_$MW().length);return!1}_js.Trace.logInfo(_a.$0.$16,"Context is clean");return!0},$5b:function(n){if(!n){_js.Trace.logInfo(_a.$0.$16,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$16,"sourceImportance={0}, targetImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3o()!==n.get_$3o()){_js.Trace.logInfo(_a.$0.$16,"sourceSubject={0}, targetSubject={1}",this.get_$3o(),n.get_$3o());return!1}if(this.get_$h4()!==n.get_$h4()){_js.Trace.logInfo(_a.$0.$16,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$h4(),n.get_$h4());return!1}if(this.get_$ET()!==n.get_$ET()){_js.Trace.logInfo(_a.$0.$16,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$ET(),n.get_$ET());return!1}if(this.get_$Qu()!==n.get_$Qu()){_js.Trace.logInfo(_a.$0.$16,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$Qu(),n.get_$Qu());return!1}if(this.get_$Q8()!==n.get_$Q8()){_js.Trace.logInfo(_a.$0.$16,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$Q8(),n.get_$Q8());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5lr(i,t)){_js.Trace.logInfo(_a.$0.$16,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31u(this.get_$79(),n.get_$79(),this.get_$10y(),n.get_$10y())){_js.Trace.logInfo(_a.$0.$16,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$79()?this.get_$79().get_$A():0,n.get_$79()?n.get_$79().get_$A():0,this.get_$10y(),n.get_$10y());return!1}if(!_mcp.$1W.$31u(this.get_$7x(),n.get_$7x(),this.get_$xs(),n.get_$xs())){_js.Trace.logInfo(_a.$0.$16,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$7x()?this.get_$7x().get_$A():0,n.get_$7x()?n.get_$7x().get_$A():0,this.get_$xs(),n.get_$xs());return!1}if(!_mcp.$1W.$31u(this.get_$AN(),n.get_$AN(),this.get_$qd(),n.get_$qd())){_js.Trace.logInfo(_a.$0.$16,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$AN()?this.get_$AN().get_$A():0,n.get_$AN()?n.get_$AN().get_$A():0,this.get_$qd(),n.get_$qd());return!1}if(!_mcp.$1W.$7WC(this.get_$EW(),n.get_$EW())){_js.Trace.logInfo(_a.$0.$16,"sourceAttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A():0)+", targetAttachmentCount="+(n.get_$EW()?n.get_$EW().get_$A():0));return!1}if(this.get_$MW()!==n.get_$MW()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$MW()?this.get_$MW().length:0,n.get_$MW()?n.get_$MW().length:0);return!1}_js.Trace.logInfo(_a.$0.$16,"snapshot is clean");return!0}};_mcp.$1LB=function(n,t){this.$$d_$Ao4=Function.createDelegate(this,this.$Ao4);if($C(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$1iD=t;this.$8E=n};_mcp.$1LB.prototype={$1iD:0,$8E:null,$1Z5:null,$4yi:!0,$1T:function(){!this.$1Z5&&this.$4yi&&(this.$1Z5=_js.$D.get_$Q().$2V(_a.$0.$16,"MailComposeTimer",this.$$d_$Ao4,this.$1iD))},$37Z:function(){_js.Trace.logInfo(_a.$0.$16,"Disabling timer.");this.$4yi=!1;this.$1u()},$1u:function(){if(this.$1Z5){_js.Trace.logInfo(_a.$0.$16,"Clearing timer.");this.$1Z5=_js.$D.get_$Q().$6Q(this.$1Z5)}},$Ao4:function(){_js.Trace.logInfo(_a.$0.$16,"Executing timer callback.");this.$1u();this.$8E()}};_mcp.$8n=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt){this.$$d_$DNB=Function.createDelegate(this,this.$DNB);this.$$d_$94E=Function.createDelegate(this,this.$94E);this.$$d_$7dN=Function.createDelegate(this,this.$7dN);this.$$d_$DmY=Function.createDelegate(this,this.$DmY);this.$$d_$4tV=Function.createDelegate(this,this.$4tV);_mcp.$8n.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_mcp.$8n.initializeBase(this);_a.$4.$z(k,"nativeBridge");this.$1sd=4;this.$c=n;this.$2F=t||new _bc.$3e;this.$2F.set_$cC(nt);this.$1d=this.$1aw();this.$j3=i;this.$9M=r;this.$1D3=u;this.$n=new _mcp.$ug(this.$2F);this.$3WB=f;this.$2TK=s;this.$4x=e;this.$I=o;this.$Lx=h;this.$Le=c;this.$N=l;this.$3Y=v;this.$N6=p;this.$F1=a;this.$2Y=w;this.$l7=b;this.$1D=y;this.$l=k;this.$2zk=d;this.$Xj=g;this.$6R=nt;this.$mc=tt;this.$WK=it;this.$16K=rt;this.$11c=ut;this.$tx=ft;this.$1tw=et;this.$sv=ot;this.$39Y=st;this.$2ZO=ht;this.$CY=ct;this.$F4=lt;if(o){var at=o;this.$sY=at.$$d_$Ay||(at.$$d_$Ay=Function.createDelegate(at,at.$Ay))}this.$6R||(this.$3yV=!0);this.$I&&this.$I.get_$U()==="Mouse"&&this.$CIl();_js.Trace.logInfo(_a.$0.$16,"ViewModel created")};_mcp.$8n.$Atq=function(){return+new Date+":"+Math.random()};_mcp.$8n.prototype={$j3:null,$c:null,$9M:null,$1D3:null,$3WB:null,$4x:null,$2TK:null,$2F:null,$I:null,$3Y:null,$N6:null,$Lx:null,$N:null,$Le:null,$1D:null,$l:null,$2Y:null,$F4:null,$2zk:null,$Xj:null,$16K:null,$11c:null,$tx:null,$6R:null,$mc:null,$1tw:null,$sv:null,$39Y:null,$l7:null,$1n:null,$n:null,$DE:null,$1d:null,$2mm:!1,$hd:!1,$5XF:!1,$5ch:null,$5WY:!1,$1di:!1,$J6:!0,$7DF:!0,$F1:null,$WK:null,$1sd:0,$wI:null,$sY:null,$3yV:!1,$5XB:!1,$26H:null,$24Z:null,$2ZO:null,$CY:null,get_$8c:function(){return this.$c},set_$13C:function(n){if(this.$1d!==n){this.$1d=n;this.$4("InfoBarViewModel")}return n},get_$4IH:function(){_a.$4.$FY(this.$2ZO.get_$bs(),"MailComposeViewModel: Smime override factory has not been created");return this.$2ZO.get_$1Z()},get_$7G1:function(){return this.$1n.$5m(7).get_$7G1()},get_$2N1:function(){return this.$1n.$5m(0)},get_$5cv:function(){return this.$1n.$5m(11)},get_$2rD:function(){return this.$1n.$5m(2)},get_$AZs:function(){return this.$1n.$5m(14)},get_$eM:function(){return this.$1n.$5m(5)},get_$7eJ:function(){return this.$1n.$5m(17)},get_$CMC:function(){return this.$1n.$5m(4)},get_$ad:function(){return this.$1n.$5m(1)},get_$C3f:function(){return this.$1n.$5m(6)},get_$iH:function(){return this.$1n.$5m(7)},get_$1XF:function(){return this.$1n.$5m(8)},get_$2N8:function(){return this.$1n.$5m(9)},get_$3Ma:function(){return this.$1n.$5m(10)},get_$1kA:function(){return this.$1n.$5m(18)},get_$E9J:function(){return this.$1n.$5m(20)},get_$AI7:function(){return this.$1n.$5m(3)},get_$6Xr:function(){return this.$1n.$5m(19)},get_$9Go:function(){return this.$1n.$5m(25)},get_$5yp:function(){return this.$1n.$5m(21)},get_$39B:function(){return this.$1n.$5m(24)},get_$CIE:function(){return this.$1n.$5m(26)},get_$AZo:function(){return this.$1n.$5m(27)},get_$7Np:function(){return this.$1n.$5m(13)},get_$Eiy:function(){return this.$1n.$5m(29)},get_$cC:function(){return this.$6R},get_$3yL:function(){return!this.$I.get_$Cp()||!!this.$6R},set_$9kM:function(n){if(this.$5XB!==n){this.$5XB=n;this.$4("ShouldShowModernAttachmentsIntroductionPeek")}return n},get_$7jB:function(){var t=this.get_$3yL();var n=new _a.$3z;n.$Ik("P",t);n.$CX("I",t?this.get_$4wH().toString():"NA");n.$CX("ET",this.$c.$2gf);return n.toString()},get_$C2a:function(){return this.get_$3yL()||this.$I.get_$lN()},set_$CEI:function(n){if(this.$3yV!==n){this.$3yV=n;this.$4("IsReadyForViewInitialization")}return n},get_$4wH:function(){return!!this.$6R},get_$2tB:function(){return this.$1sd},set_$2tB:function(n){if(this.$1sd!==n){this.$1sd=n;this.$4("PopupPanelSize")}return n},get_$3tc:function(){return this.get_$5cv()?this.get_$5cv().$$d_$3tc:this.$$d_$4tV},get_$h1:function(){return this.$DE},set_$h1:function(n){_js.Trace.logInfo(_a.$0.$16,"Shell setting ClosePopupCommand from "+(this.$DE?"non-null":"null")+" to "+(n?"non-null":"null"));this.$DE=n;return n},get_$7lv:function(){return this.$J6},set_$7lv:function(n){this.$J6=n;return n},set_$EbT:function(n){this.$7DF=n;return n},get_$4uc:function(){return _a.UserAgent.getInstance().$22v},get_$fP:function(){return _a.UserAgent.getInstance().$YL},get_$1du:function(){return _a.UserAgent.getInstance().$zD},get_$jf:function(){return _a.UserAgent.getInstance().$a6},get_$a8:function(){return _a.UserAgent.getInstance().$Ec},get_$SA:function(){return this.$I.get_$U()==="Mouse"?0:1},get_$lN:function(){return OwaApplication.$Oy},get_$AWm:function(){return _a.UserAgent.getInstance().$6RA&&_a.UserAgent.getInstance().get_$8a()},get_$6TU:function(){return this.$2mm},set_$6TU:function(n){this.$2mm=n;return n},set_$8Un:function(n){if(this.$hd!==n){this.$hd=n;this.$4("IsInView")}return n},set_$9kQ:function(n){var t=this.get_$9jy();if(this.$5XF!==t){this.$5XF=t;this.$4("ShouldShowToolbarMessage")}return n},set_$9qs:function(n){if(this.$5ch!==n){this.$5ch=n;this.$4("ToolbarMessage")}return n},set_$EbS:function(n){var t=this.get_$9jy();if(t!==this.$5WY){this.$5WY=t;this.$4("ShouldBlockView")}return n},get_$1Ei:function(){return this.$1di},set_$1Ei:function(n){if(this.$1di!==n){this.$1di=n;this.$4("IsNavigatingAway")}return n},get_$9jy:function(){return this.get_$2N8()&&(this.get_$2N8().get_$3yn()||this.get_$2N8().get_$4y1())?!0:this.get_$iH()&&this.get_$iH().get_$m1()?!0:!1},get_$5zV:function(){return!_a.$g.get_$CE()||_a.$g.get_$CE().toLowerCase()!=="pl-pl"},set_$5EB:function(n){this.$wI=n;return n},set_$9BR:function(n){this.$sY=n;return n},get_$4LS:function(){return this.$c.get_$EzK()},$DmY:function(n,t){if(this.$c.get_$s0()){this.$2xE();this.$1n.$2xE();this.$4("SmimeInvalidRecipientsDialogViewModel")}else{this.$2F3();this.$1n.$2F3();this.$4("SmimeInvalidRecipientsDialogViewModel")}},$A56:function(){this.$c.$p(_mcp.$V.$4LG,this.$$d_$DmY)},$2xE:function(){if(this.get_$4LS()&&!this.$24Z){_js.Trace.logInfo(_a.$0.$16,"Setting mail compose viewmodel override");this.$24Z=this.get_$4IH().$AOb();this.$24Z.$3e(this.$1d)}},$2F3:function(){if(this.$24Z){this.$24Z.$AV();this.$24Z=null}},$3e:function(){this.$c.get_$D1()&&(this.$c.get_$23e()||this.$c.get_$3yg())||this.$c.set_$D1(_mcp.$8n.$Atq());_js.Trace.logInfo(_a.$0.$16,"Init:Context:"+this.$c.toString());this.$1n||(this.$1n=new _mcp.$1Kw(this,this.$F1,this.$3Y,this.$1D,this.$N6,this.$2Y,this.$l,this.$6R,this.$WK,this.$16K,this.$11c,this.$CY));if(this.get_$4LS()){_js.Trace.logInfo(_a.$0.$16,"Creating Smime override factory");this.$5vR(this.$$d_$7dN)}else this.$7dN()},$5vR:function(n){_js.Trace.logInfo(_a.$0.$16,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.$2ZO.$9(function(i){_js.Trace.logInfo(_a.$0.$16,"Smime override factory created");i.$3e(t.$c,t.$N);_js.Trace.logInfo(_a.$0.$16,"Calling createFactoryCallback");n()})},$7dN:function(){_js.Trace.logInfo(_a.$0.$16,"Completing initialization");this.$2xE();this.$A56();if(this.$1d){this.$1d.$AV();this.$N.$1p(_y.$n0,new _y.$n0);this.$c.get_$3yg()&&this.$1d.$4r(this.$c.get_$9SG(),null)}this.set_$1Ei(!1);this.$1n.$5m(0).$3e();if(!this.$6R){this.$I.remove_$Xm(this.$$d_$94E);this.$I.add_$Xm(this.$$d_$94E);_js.Trace.logInfo(_a.$0.$16,"Before unload handler has been hooked up")}},$EVe:function(n){this.set_$A1(n);_js.Trace.logInfo(_a.$0.$16,"Set screen view model appbar. ContextId="+this.$c.get_$D1())},$IX:function(){_y.$1b6.prototype.$IX.call(this);var n=this.get_$2N1();if(n.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$7Xe()}else _js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view model, not initialized yet");this.set_$8Un(!0);_a.$6.acea(null,"VM.MailCompose.Navigate");if(this.$c.get_$3yg()&&this.$c.get_$3Fz()){var i=this.$c.get_$D1();this.$N.$1p(_y.$xN,new _y.$xN(i))}this.$I.get_$U()!=="TouchNarrow"&&this.$c.$48C&&this.$c.$48C();if(this.$I.get_$U()==="Mouse"){var t=this;_js.$D.get_$Q().$6C(_a.$0.$1m,"PreloadOwaFilePicker",function(){var n=t.$1n.$5m(5);n&&n.$Dsr()})}},$Tq:function(){_js.Trace.logInfo(_a.$0.$16,"Post transition out");this.get_$iH().get_$73e()&&(this.$c.get_$3Fz()?_a.$6.$1G(this.get_$iH().get_$73e(),"MailComposeSendClose",null,null,"SentViaNotification"):_a.$6.$1G(this.get_$iH().get_$73e(),"MailComposeSendClose",null,null,"NotSentViaNotificationDueToOtherPendingFailedAsyncSend"));this.get_$iH().get_$DOa()||this.$AV(!1);this.set_$8Un(!1);_y.$1b6.prototype.$Tq.call(this)},$AV:function(n){_js.Trace.logInfo(_a.$0.$16,"Calling reset on the mail compose view model, context:"+this.$c.toString());this.$2F3();this.$c.$1B(_mcp.$V.$4LG,this.$$d_$DmY);if(this.$1n){var i=this.get_$2rD();if(i){var t=i.get_$5F();if(t&&t.get_$3J7()){this.$1n.$AV();this.$c&&!n&&this.$c.$AV();this.$1d&&this.$1d.$G6.$1u();this.get_$39B()&&this.get_$39B().$65&&this.get_$39B().$65.$22N(!1);this.$6R||this.$I.remove_$Xm(this.$$d_$94E);this.$sY=null;t.set_$3J7(!1)}else _js.Trace.logInfo(_a.$0.$16,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$16,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$16,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2mm=!1},$IO:function(){var t=this.$1n.$5m(5);if(t.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to attachment in progress");return!0}var n=this.$1n.$5m(1);n.$2zW();return this.$c.$IO()},$1aw:function(){$C(this.$1d)&&this.set_$13C(new _y.$5y);return this.$1d},$Dpc:function(){_h.$3n.$Dpa()},$E5F:function(){_h.$3n.$9PB()},$7FS:function(){this.$24Z&&this.$24Z.$7FS()},$Dgk:function(){this.set_$CEI(!0)},$DSR:function(){var n=new _y.$rM;this.$94E(n);return n.$1NP},$94E:function(n){this.get_$2rD().$4WJ(n)},$6pu:function(){},$9wk:function(){this.get_$3yL()&&this.$c&&!_js.$9.$o(this.$c.get_$3o())&&!this.$6R&&(document.title=this.$c.get_$3o())},$2A:function(){_js.Trace.logInfo(_a.$0.$16,"Disposing view model, context: "+(this.$c?this.$c.toString():"null"));this.$1n&&this.$1n.$AV();this.$26H&&this.$26H.remove_$1RA(this.$$d_$DNB);_a.$1ad.prototype.$2A.call(this)},$AGq:function(){this.$26H&&this.$26H.$110(!0)},$CIl:function(){if(this.$F4&&this.$3Y&&this.$CY&&_y.$2M.$1Lb(9)&&this.$1D.$4S6(this.$CY.AttachmentDataProviderAvailable)){var n=this;this.$F4.$9(function(t){n.$26H=t.$7k(_u.Strings.l_ModernAttachments_IntroductionPeekTitle_Text,_u.Strings.l_ModernAttachments_IntroductionPeekDescription_Text,10,null,null,9);n.set_$9kM(!0);n.$26H.add_$1RA(n.$$d_$DNB);n.$26H.$1vw()})}},$DNB:function(){this.set_$9kM(!1)},$4tV:function(n,t){return t===1?!this.$7DF:!1}};_mcp.$ur=function(n,t,i,r,u,f){this.$$d_$Bpg=Function.createDelegate(this,this.$Bpg);this.$$d_$5vI=Function.createDelegate(this,this.$5vI);this.$$d_$AQf=Function.createDelegate(this,this.$AQf);_mcp.$ur.initializeBase(this);this.$5sB=f;this.$8P=f.$8P;this.$2Y=n;this.$d=t;this.$5D=f.$5D;this.$7F=i;this.$Xj=r;this.$Bq=u};_mcp.$ur.prototype={$d:null,$2Y:null,$8P:null,$5D:null,$5sB:null,$7F:null,$Xj:null,$Bq:null,$48:null,$14T:0,$3JE:!1,$4IG:null,$Ej:null,$49Q:null,$4Lj:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cc);return this.$48},set_$5F:function(n){this.$48=n;return n},$2s7:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeReplyLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeReply",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyLoad",!0);this.$2Y.$7Ko("Inference.Reply",this.$8P.get_$y(),this.$8P.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5FY(1,n)},$274:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeReplyAllLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyAll",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyAllLoad",!0);this.$2Y.$7Ko("Inference.ReplyAll",this.$8P.get_$y(),this.$8P.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5FY(2,n)},$6pt:function(n){this.$2Y.$nF("Inference.PostReply",this.$8P.get_$y());this.$5FY(12,n)},$26s:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeForwardLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeForward",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeForwardLoad",!0);this.$2Y.$7Ko("Inference.Forward",this.$8P.get_$y(),this.$8P.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5FY(3,n)},$5Ek:function(n){this.$3JE=!0;this.$26s(n)},$9CL:function(){if(!this.$5sB.get_$4Uh())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$b.$2I.nameToId("drafts");var n=new _c.$1DN(this.$8P.get_$y().Id,t.Id);n.add_$2s(this.$$d_$AQf);n.add_$2b(this.$$d_$5vI);OwaApplication.$2B.$1U(n)},$AQf:function(n){var i=n.$26W;if(i.length>0){var t=this.$Xj.$5uS(_g.$1T.$1yV(i));t.add_$2s(this.$$d_$Bpg);t.add_$2b(this.$$d_$5vI);OwaApplication.$2B.$1U(t)}else this.$5vI(n)},$5vI:function(n){this.$5D.get_$13C().$9U(9500);this.$5D.get_$13C().$4r(9500)},$Bpg:function(n){var t=n;if(t.$Ov){this.$5D.get_$13C().$9U(9500);var i=this.$7F.$35M(t.get_$y(),!1,t.$Ov.get_$106(),t.$Ov.get_$9i());_y.$z.$1Q.get_$Cp()||i.set_$5j(0);_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(i)}else this.$5vI(n)},$5FY:function(n,t){this.$14T=n;this.$WM(t)},$WM:function(n){var u=_g.$2g.isInstanceOfType(this.$8P);n||(n=!_y.$z.$1Q.get_$Cp());var t=this.$7F.$H5(n,!1);t.set_$2By(this.$4Lj);n&&t.set_$5j(0);var r=null;switch(this.$14T){case 1:r=!t.get_$5j()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.get_$5j()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.get_$5j()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.$Ej){this.$Ej.$3D=r;t.set_$dm(this.$Ej);t.set_$1NF(this.$49Q);t.$7CQ()}t.set_$2se(this.$8P.get_$3G());this.$5D&&t.set_$19x(this.$5D.get_$19x());t.set_$6X(this.$14T);t.set_$Xa(!0);t.set_$1Lk(!0);t.$3JE=this.$3JE;var i=new _g.$8w;i.Mailbox=new _g.$1K;i.Mailbox.EmailAddress=this.$d.get_$4P().get_$Fv();i.Mailbox.Name=this.$d.get_$4P().get_$Lk();i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.set_$Em(i);if(u){var f=this.$8P;if(f.get_$1La())t.$1Th(f);else{t.set_$1oe(!0);t.set_$14V(this.$8P.get_$y());t.set_$1Lf(_g.$2g.$1Lf(f))}}else t.$1Th(this.$8P);if((_g.$5w.isInstanceOfType(this.$8P)||u)&&t.$6Tf(this.$8P)){var o=_a.$c.get_$18l();o&&t.$Eyx(this.$8P.get_$2y7());if(this.$8P.get_$X8()||t.get_$s0()&&o){var e=this;this.$uP(function(n){n.$Eu5(t,e.$8P,e.$14T)})}else{_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(t)}}else{_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(t)}},$uP:function(n){_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4IG){_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");t.$4IG=i.$AOh();t.$4IG.$3e(t,t.$d,function(n,t){var i=new _cc.$Dj(200,_cc.$Dj.$H5(n.get_$y(),t.get_$1Lf()));i.$99=t.get_$D1();return i},function(n,t,i){var r=new _mcp.$1Ou(n,t,i);return r.toString()})}_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Executing smime operation.");n(t.$4IG)})}};_mcp.$14u=function(n,t,i,r,u){this.$2Y=n;this.$d=t;this.$7F=i;this.$Xj=r;this.$Bq=u};_mcp.$14u.prototype={$2Y:null,$d:null,$7F:null,$Xj:null,$Bq:null,$7k:function(n){return new _mcp.$ur(this.$2Y,this.$d,this.$7F,this.$Xj,this.$Bq,n)}};_mcp.$nO=function(){_mcp.$nO.initializeBase(this)};_mcp.$nO.prototype={$2XF:null,$3XJ:"Normal",$3wi:!1,$3yU:!1,$1Yf:!1,$1Yg:!1,$5ZO:!1,$5ZS:!1,$48:null,$5Yp:!1,$5gk:!1,$7PH:!1,get_$E9z:function(){if($C(this.$2XF)){this.$2XF=new _js.$X;this.$2XF.$F("Normal");this.$2XF.$F("Personal");this.$2XF.$F("Private");this.$2XF.$F("Confidential")}return this.$2XF},set_$ET:function(n){if(this.$3XJ!==n){this.$3XJ=n;this.$4("Sensitivity")}return n},set_$Qu:function(n){if(this.$3wi!==n){this.$3wi=n;this.$4("IsDeliveryReceiptRequested")}return n},get_$Edn:function(){return!OwaApplication.$Oy},set_$Q8:function(n){if(this.$3yU!==n){this.$3yU=n;this.$4("IsReadReceiptRequested")}return n},get_$EfQ:function(){return!OwaApplication.$Oy},set_$Efo:function(n){if(this.$5Yp!==n){this.$5Yp=n;this.$4("ShowSmimeOptions")}return n},set_$PT:function(n){if(this.$1Yf!==n){this.$1Yf=n;this.$4("SmimeEncryptMessage")}return n},set_$T0:function(n){if(this.$1Yg!==n){this.$1Yg=n;this.$4("SmimeSignMessage")}return n},set_$9mk:function(n){if(this.$5ZO!==n){this.$5ZO=n;this.$4("SmimeEncryptMessageIsEnabled")}return n},set_$9ml:function(n){if(this.$5ZS!==n){this.$5ZS=n;this.$4("SmimeSignMessageIsEnabled")}return n},set_$F0b:function(n){if(this.$7PH!==n){this.$7PH=n;this.$4("WaitingForPreviousAction")}return n},set_$5F:function(n){if(this.$48!==n){this.$48=n;this.$4("Conductor")}return n},$1Tg:function(n){this.$5gk=n.get_$s0();this.set_$Efo(_a.$c.$43&&_a.$c.get_$22x()&&n.$6Tg());this.set_$F0b(!1);this.set_$ET(n.get_$ET());this.set_$Qu(n.get_$Qu());this.set_$Q8(n.get_$Q8());this.set_$PT(n.get_$PT());this.set_$T0(n.get_$T0());this.set_$9mk(n.get_$9mk());this.set_$9ml(n.get_$9ml())}};_mcp.$w4=function(n){this.$5Wl=n};_mcp.$w4.prototype={$5Wl:!1};_mcp.$1NA=function(n,t){this.$2yW=n;this.$3nm=t};_mcp.$1NA.prototype={$2yW:null,$3nm:null};_mcp.$1Ou=function(n,t,i){this.$9LP=new RegExp("<","g");this.$9L5=new RegExp(">","g");this.$zG=n;this.$8P=t;this.$14T=i};_mcp.$1Ou.prototype={$14T:0,$8P:null,$zG:!1,toString:function(){_js.Trace.logInfo(_a.$0.$16,"Building message headers for reply/fwd. locally.");var a=this.$v7();var t=this.$8FG(!0);var r=this.$8FG(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.Strings.l_OnBehalfOf_Text,r,t));var o=this.$8P.get_$172()||this.$8P.get_$1Ce();var w=o?o.toString():this.$8P.get_$Dwi();var h=this.$8JS(!0);var e=this.$8JS(!1);var i,n;var s,u;this.$Bvd(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.$2eO(_nbs.NonBootStrings.l_FromLabel_Text,t);var k=this.$2eO(_nbs.NonBootStrings.l_SentLabel_Text,w);var b=h?this.$2eO(_u.Strings.l_ToRecipientsLabel_Text,h.join("; ")):null;var y=e?this.$2eO(_u.Strings.l_CcRecipientsLabel_Text,e.join("; ")):null;var l=this.$2eO(_u.CommonStrings.l_SubjectLabel_Text,a);var c=i?this.$2eO(_u.MeetingMsgStrings.l_WhenLabel_Text,i):null;var v=n?this.$2eO(_u.MeetingMsgStrings.l_WhereLabel_Text,n):null;var f=this.$AAY(p,k,b,y,l,c,v);return this.$zG?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},$AAY:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new(_ff.$18.$$(String)),r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.$9.$o(i)||f.$F(i)}return f.$3Q()},$v7:function(){if(this.$8P.get_$3o())return this.$8P.get_$3o();else{var n;switch(this.$14T){case 1:case 2:case 12:n=_u.Strings.l_ReplyPrefix_Text;break;case 3:n=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:n=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:n=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:n=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:n=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:n=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:n=_nbs.NonBootStrings.l_RejectPrefix_Text;break;default:n="";break}return String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,n,this.$8P.get_$14H()||_u.Strings.l_EmptySubjectMask_Text)}},$8FG:function(n){if(_g.$5w.isInstanceOfType(this.$8P)){var r=this.$8P;var i=n?r.get_$5Q():r.get_$Em();return i?this.$3t3(i.Mailbox):null}else if(_g.$2g.isInstanceOfType(this.$8P)){var t=this.$8P;return t.get_$MD()?this.$3t3(t.get_$MD().Mailbox):null}else return null},$8JS:function(n){if(_g.$5w.isInstanceOfType(this.$8P)){var i=this.$8P;return this.$BsX(n?i.get_$79():i.get_$7x())}else if(_g.$2g.isInstanceOfType(this.$8P)){var t=this.$8P;return this.$Bk4(n?t.get_$Bm():t.get_$DH(),n)}else return null},$Bvd:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.$Mf.isInstanceOfType(this.$8P)){var f=this.$8P;i=f.get_$Q4();r=f.get_$8Ne()}else if(_g.$2g.isInstanceOfType(this.$8P)){var u=this.$8P;i=u;r=u}if(r){var e=new _cc.$To;n.val=e.$4L(r,null)||" "}i&&(t.val=i.get_$6E()?i.get_$6E().get_$26()||" ":" ")},$BsX:function(n){if(!n||!n.get_$A())return null;var t=new(_ff.$18.$$(String));var i=this;n.$Cj(function(n){t.$F(i.$3t3(n))});return t.$3Q()},$Bk4:function(n,t){if(!n||!n.get_$A())return t?[this.$3t3(this.$8P.get_$MD().Mailbox)]:null;var i=new(_ff.$18.$$(String));var r=this;n.$Cj(function(n){i.$F(r.$3t3(n.get_$AB()))});return i.$3Q()},$3t3:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},$2eO:function(n,t){return this.$zG?"<b>"+n+"</b> "+this.$4CY(t):n+" "+t},$4CY:function(n){if(!n)return null;n=n.replace(this.$9LP,"&lt;");n=n.replace(this.$9L5,"&gt;");return n}};_mcp.$187=function(){};_mcp.$187.prototype={$4L:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.NonBootStrings.l_Normal_Text;break;case"Personal":i=_nbs.NonBootStrings.l_Personal_Text;break;case"Private":i=_nbs.NonBootStrings.l_Private_Text;break;case"Confidential":i=_nbs.NonBootStrings.l_Confidential_Text;break;default:i=_nbs.NonBootStrings.l_Normal_Text;break}return i},$7ek:function(n,t){throw Error.notImplemented();}};_mcp.$se=function(n){_mcp.$se.initializeBase(this,[n])};_mcp.$se.prototype={$Za:null,$DRM:function(){},$DRL:function(){},$DaH:function(n){},$DaF:function(n){},$DaG:function(n){},$EWr:function(n){},$DaJ:function(n,t){t.val=3;this.$Za.$11();return!0}};_mcp.$1=function(){};_mcp.$1.get_$wl=function(){return _fm.$G.$9("send","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$73o=function(){return _fm.$G.$9("send-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$DsY=function(){return _fm.$G.$9("post-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$9P=function(){return _fm.$G.$9("attachment","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7VW=function(){return _fm.$G.$9("app-hero","x12","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7VX=function(){return _fm.$G.$9("app-hero-hover","x12","owa","ms-font-color-neutralDark")};_mcp.$1.get_$7Wo=function(){return _fm.$G.$9("attachment-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$9z=function(){return _fm.$G.$9("pop-out","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$1WZ=function(){return _fm.$G.$9("pop-out-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$1Bc=function(){return _fm.$G.$9("add-small","add-small","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$11T=function(){return _fm.$G.$9("add-small-hover","add-small-hover","owa","ms-font-color-neutralDark")};_mcp.$1.get_$40b=function(){return _fm.$G.$9("lock","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$5jO=function(){return _fm.$G.$9("add-circle-grey-small","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_mcp.$1.get_$5jP=function(){return _fm.$G.$9("add-circle-grey-small-pressed","x16-circle","owa","ms-bg-color-neutralSecondary ms-border-color-neutralSecondary ms-font-color-white")};_mcp.$mx=function(n){_mcp.$mx.initializeBase(this,[n])};_mcp.$mx.prototype={$3oa:null,$C2o:function(){this.$3oa&&_rw.$Ag.$6Lk(this.$3oa.get_$S(),this.$3oa.get_$S())},$4T:function(){_js.$7.prototype.$4T.call(this);this.$3oa=this.$u?this.$u.$1N("FromPersona"):null}};_mcp.$mz=function(n,t,i,r,u,f){this.$$d_$DwN=Function.createDelegate(this,this.$DwN);this.$$d_$DwO=Function.createDelegate(this,this.$DwO);this.$$d_$A62=Function.createDelegate(this,this.$A62);this.$$d_$Bz8=Function.createDelegate(this,this.$Bz8);this.$$d_$8Kz=Function.createDelegate(this,this.$8Kz);this.$$d_$8L0=Function.createDelegate(this,this.$8L0);this.$$d_$8Ky=Function.createDelegate(this,this.$8Ky);this.$$d_$8L1=Function.createDelegate(this,this.$8L1);this.$$d_$8L4=Function.createDelegate(this,this.$8L4);this.$$d_$Bz9=Function.createDelegate(this,this.$Bz9);this.$$d_$Bz7=Function.createDelegate(this,this.$Bz7);this.$$d_$DhM=Function.createDelegate(this,this.$DhM);this.$$d_$26l=Function.createDelegate(this,this.$26l);this.$$d_$DfD=Function.createDelegate(this,this.$DfD);this.$$d_$DdO=Function.createDelegate(this,this.$DdO);this.$$d_$DdN=Function.createDelegate(this,this.$DdN);this.$$d_$6o2=Function.createDelegate(this,this.$6o2);this.$$d_$DVL=Function.createDelegate(this,this.$DVL);this.$$d_$6qA=Function.createDelegate(this,this.$6qA);this.$$d_$DSH=Function.createDelegate(this,this.$DSH);this.$$d_$5Eg=Function.createDelegate(this,this.$5Eg);this.$$d_$6oj=Function.createDelegate(this,this.$6oj);this.$$d_$706=Function.createDelegate(this,this.$706);this.$$d_$95v=Function.createDelegate(this,this.$95v);this.$$d_$6nZ=Function.createDelegate(this,this.$6nZ);this.$$d_$Daa=Function.createDelegate(this,this.$Daa);this.$$d_$DaZ=Function.createDelegate(this,this.$DaZ);this.$$d_$DdL=Function.createDelegate(this,this.$DdL);this.$$d_$DTS=Function.createDelegate(this,this.$DTS);this.$$d_$DvH=Function.createDelegate(this,this.$DvH);this.$$d_$DvI=Function.createDelegate(this,this.$DvI);this.$$d_$7Xw=Function.createDelegate(this,this.$7Xw);this.$$d_$Dx8=Function.createDelegate(this,this.$Dx8);this.$$d_$4f7=Function.createDelegate(this,this.$4f7);this.$$d_$A9r=Function.createDelegate(this,this.$A9r);this.$$d_$9nW=Function.createDelegate(this,this.$9nW);this.$$d_$C2r=Function.createDelegate(this,this.$C2r);this.$$d_$DVN=Function.createDelegate(this,this.$DVN);this.$$d_$DWr=Function.createDelegate(this,this.$DWr);this.$$d_$Bzz=Function.createDelegate(this,this.$Bzz);this.$$d_$DWv=Function.createDelegate(this,this.$DWv);this.$$d_$Dmt=Function.createDelegate(this,this.$Dmt);this.$$d_$7rR=Function.createDelegate(this,this.$7rR);this.$$d_$5nf=Function.createDelegate(this,this.$5nf);this.$5q={};this.$1aq={};_mcp.$mz.initializeBase(this,[n]);this.$g3=t;this.$1E=i;this.$1D=r;this.$l=f;_js.Trace.logInfo(_a.$0.$16,"View created with layout="+this.$g3);this.$1xJ=new _C(this.$$d_$5nf,_a.$0.$16);if(t==="Mouse"&&u.$2r("Water")){this.$3KD=!0;this.set_$6Mn(this.$3KD)}};_mcp.$mz.prototype={$1E:null,$1D:null,$1xJ:null,$hB:null,$11h:null,$OL:null,$4H1:!1,$4yl:!1,$4uZ:!1,$4uK:!1,$g3:0,$3aj:!1,$2C3:!1,$hd:!1,$5gl:!1,$4Lh:!1,$3yW:!1,$6Tx:!1,$7DC:null,$l:null,$3KD:!1,$18V:!1,$zG:!1,set_$6Mn:function(n){if(this.$18V!==n){this.$18V=n;this.$3i("InContentEditableDivMode","IsReadyToShowContentInRTE")}return n},get_$CEJ:function(){return this.$3yW&&!this.$18V},set_$12N:function(n){if(this.$OL!==n){this.$OL=n;this.$Eqx()}return n},get_$3z9:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4yl},set_$3z9:function(n){if(this.$4yl!==n){this.$4yl=n;this.$4("IsToRecipientWellPeoplePickerButtonShown")}return n},get_$3wL:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4uZ},set_$3wL:function(n){if(this.$4uZ!==n){this.$4uZ=n;this.$4("IsCcRecipientWellPeoplePickerButtonShown")}return n},get_$3wE:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4uK},set_$3wE:function(n){if(this.$4uK!==n){this.$4uK=n;this.$4("IsBccRecipientWellPeoplePickerButtonShown")}return n},get_$4HC:function(){return!0},set_$6Sq:function(n){if(this.$3yW!==n){this.$3yW=n;this.$3KD&&this.$5q.Ribbon.set_$17(!(n&&this.$zG));this.$3i("IsReadyToShowContent","IsReadyToShowContentInRTE")}return n},set_$4H2:function(n){if(this.$4H1!==n){this.$4H1=n;this.$4("ShouldPreventShiftTabDefault")}return n},set_$CFY:function(n){this.$6Tx=n;this.$4("IsTabAnchorNeeded");return n},get_$AXn:function(){return this.$1D.get_$ps()},get_$m:function(){return _a.$0.$16},$9hY:function(){if(this.$OL){_js.Trace.logInfo(_a.$0.$16,"Already have focused control name, skipping set initial focus");return}if(!this.get_$k()){_js.Trace.logInfo(_a.$0.$16,"No data context yet, skipping set initial focus");return}var n=this.get_$k();if(n.get_$ad().$GI.$226()<1){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to To well. Context:"+n.$c.toString());if(this.$1E.get_$JM()||this.$1E.get_$fP())this.$1Jw("ToRecipientWellControl");else{var i=this;_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToRecipientWell",function(){i.$1Jw("ToRecipientWellControl")},500)}}else if(_js.$9.$o(this.$5q.SubjectTextBox.get_$S().val())){_js.Trace.logInfo(_a.$0.$16,"Set initial focus to subject. Context: "+n.$c.toString());this.$1Jw("SubjectTextBox");if(this.$1E.get_$Df()){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to subject for IE. Context:"+n.$c.toString());var t=this;_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToSubject",function(){t.$1Jw("SubjectTextBox")},500)}}else{_js.Trace.logInfo(_a.$0.$16,"Set initial focus to body. Context: "+n.$c.toString());if(this.$1E.get_$Df()){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to body for IE. Context:"+n.$c.toString());_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToEditor",this.$$d_$7rR,500)}else this.$7rR()}},$ma:function(n){},$IX:function(n){this.$5gl=!this.get_$k();if(this.$5gl)_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn with null DataContext.");else{var t=this.get_$k();var i=t.get_$2N1();if(i.get_$G8()){this.$4Lh=!!this.$5q.EditorControl;if(this.$4Lh){this.get_$34()?t.get_$4wH()&&!t.$3yV?t.$p("IsReadyForViewInitialization",this.$$d_$Dmt):this.$8Pr():_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view not active yet. Context:"+t.$c.toString());var r=this.$18V?this.$5q.CED:this.$5q.EditorControl;r.$IX()}else _js.Trace.logInfo(_a.$0.$16,"PostTransitionIn template not applied yet. Context:"+t.$c.toString())}else this.$9jY(i,t.$c);if(this.$g3==="Mouse"){t.$9wk();this.$706()}}this.$hd=!0},$pf:function(){this.$hd=!1;_js.Trace.logInfo(_a.$0.$16,"PreTransitionOut view");var n=this.$OL;if(n&&n in this.$5q)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.$7Yk();this.$3aj=!0;var t=this.$1aq[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.$0.$16,"Blur from "+n);t.blur()}this.$OL=null;this.$3aj=!1;break;case"EditorControl":this.$3aj=!0;this.$5q.EditorControl.$A9p();this.$OL=null;this.$3aj=!1;break}else _js.Trace.logInfo(_a.$0.$16," Skip pre-transition out focus related processing for current focused control "+n+", since it's not present in the controls dictionary");"EditorControl"in this.$5q?this.$5q.EditorControl.$pf():_js.Trace.logInfo(_a.$0.$16," Skip calling editor.PreTransitionOut since it's not present in the controls dictionary")},$Tq:function(){_js.Trace.logInfo(_a.$0.$16,"PostTransitionOut view");this.set_$3z9(!0);this.set_$3wL(!1);this.set_$3wE(!1);this.set_$6Sq(!1);var n=this.$5q.EditorControl;n&&n.$Tq()},$3S:function(){this.$1tM();return!0},$2A:function(){_js.Trace.logInfo(_a.$0.$16,"Disposing view");this.$EnK();this.$2BY();this.$1aq=null;this.$5q=null;this.$OL=null;_js.$7.prototype.$2A.call(this)},$4T:function(){_js.$7.prototype.$4T.call(this);var n=this.$u;var t=null;this.get_$k()&&(t=this.get_$k());if(n){this.$5q.SubjectTextBox=n.$1N("SubjectTextBox");this.$5q.FromFieldControl=n.$1N("FromFieldControl");this.$5q.ToRecipientWellControl=n.$1N("ToRecipientWellControl");this.$5q.CcRecipientWellControl=n.$1N("CcRecipientWellControl");this.$5q.BccRecipientWellControl=n.$1N("BccRecipientWellControl");var r=n.$1N("EditorControl");this.$5q.EditorControl=r;var i=n.$1N("CED");this.$5q.CED=i;if(i){i.$EK=!this.$18V;r.$EK=this.$18V;this.$18V&&i.$EZY()}if(this.$3KD){var u=n.$1N("Ribbon");this.$5q.Ribbon=u;if(this.$18V){u.set_$60E(i);i.$Ea3(r,this.$$d_$DWv)}}this.$5q.CancelConfirmDialog=n.$1N("CancelConfirmDialog");this.$5q.MessageBox=n.$1N("MessageBox");this.$5q.ComposeDockPanel=n.$1N("ComposeDockPanel");this.$5q.ToRecipientButton=n.$1N("ToRecipientButton");this.$5q.CcRecipientButton=n.$1N("CcRecipientButton");this.$5q.BccRecipientButton=n.$1N("BccRecipientButton");this.$5q.QuotedBodyHtmlLabel=n.$1N("QuotedBodyHtmlLabel");if(this.$g3==="Mouse"){this.$5q.SendButton=n.$1N("SendButton");this.$5q.DiscardButton=n.$1N("DiscardButton");this.$5q.InsertButton=n.$1N("InsertButton");this.$5q.AppsButton=n.$1N("AppsButton");this.$5q.AffordanceMenuButton=n.$1N("AffordanceMenuButton");this.$5q.OpenSeperateWindowButton=n.$1N("OpenSeperateWindowButton");this.$5q.ComposeAppsPane=n.$1N("ComposeAppsPane");if(t){this.$zG=t.$c.get_$6P()==="HTML";!this.$zG&&this.$18V&&this.$5nf()}}this.$7DC=new _C(this.$$d_$Bzz,this.get_$m());r.$5XI=!0;this.$Ea6();if(this.$hd&&!this.$4Lh){_js.Trace.logInfo(_a.$0.$16,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:"+(t?t.$c.toString():"null"));this.$IX(null)}else _js.Trace.logInfo(_a.$0.$16,"Applying template. Context:"+(t?t.$c.toString():"null"));this.$5q.EditorControl&&this.$5q.EditorControl.$p("IsPlainTextContent",this.$$d_$DWr)}else{_js.Trace.logInfo(_a.$0.$16,"Applying null template. Context:"+(t?t.$c.toString():"null"));this.$5q.SubjectTextBox=null;this.$5q.FromFieldControl=null;this.$5q.ToRecipientWellControl=null;this.$5q.CcRecipientWellControl=null;this.$5q.BccRecipientWellControl=null;this.$5q.EditorControl=null;this.$5q.CED=null;this.$5q.CancelConfirmDialog=null;this.$5q.MessageBox=null;this.$5q.ComposeDockPanel=null}this.$9us()},$8i:function(){_js.$F.prototype.$8i.call(this);if(this.get_$k()){var n=this.get_$k();var t=n.get_$2N1();this.$zG=n.$c.get_$6P()==="HTML";!this.$zG&&this.$18V&&this.$u&&this.$5nf();if(this.$5gl)if(t.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: "+n.$c.toString());this.$IX(null)}else this.$9jY(t,n.$c);t.$4yC?this.$7Wd():t.$p("IsSecondInitializationComplete",this.$$d_$DVN);n.get_$ad().$EXh(this.$$d_$C2r)}else _js.Trace.logInfo(_a.$0.$16,"Updated DataContext to null")},$3T:function(){_js.$7.prototype.$3T.call(this);if(this.$hd&&this.get_$k()&&this.$4Lh){var r=this.get_$k();var u=r.get_$2N1();if(u.get_$G8()){this.set_$6Sq(!0);_js.Trace.logInfo(_a.$0.$16,"Show content on activate. Context:"+r.$c.toString());this.$9hY();this.$1aL();var t=this.$5q.EditorControl;if(t){if(_z.$CS.isInstanceOfType(t)){var n=t;if(n.get_$AU7()){_js.Trace.logInfo(_a.$0.$16,"Restore extendable editor to original height on ready to show content");n.$9P6()}else if(n.get_$AU5()){_js.Trace.logInfo(_a.$0.$16,"Set extendable editor to full screen height on ready to show content");n.$EXb()}}var i=t;if(i.$1R4){_js.Trace.logInfo(_a.$0.$16,"Set editor to current scroll height if it is more than full screen on ready to show content");i.$1ON()}}_js.$D.get_$Q().$2V(_a.$0.$16,"MailCompose.Editor.Resize",this.$$d_$9nW,500)}}},$1aL:function(){var n=this.get_$k();if(this.$2C3){_js.Trace.logInfo(_a.$0.$16,"Events already bound. Context:"+n.$c.toString());return}if(this.$1E.get_$JM()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.$$d_$A9r);var u=this;_js.$D.get_$Q().$2V(_a.$0.$16,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.$$d_$A9r)},1e3)}this.$hB=new(_ff.$18.$$(_mcp.$mz.$y7));if(this.$g3==="Mouse"){this.$hB.$F(new _mcp.$mz.$y7("DiscardButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("InsertButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("AppsButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("AffordanceMenuButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("OpenSeperateWindowButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("ToRecipientButton",this.$$d_$4f7))}this.$hB.$F(new _mcp.$mz.$y7("SubjectTextBox",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("FromFieldControl",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y7("ToRecipientWellControl",this.$$d_$Dx8));this.$hB.$F(new _mcp.$mz.$y7("CcRecipientWellControl",this.$$d_$Dx8));this.$hB.$F(new _mcp.$mz.$y7("BccRecipientWellControl",this.$$d_$Dx8));this.$11h=new(_ff.$18.$$(_mcp.$mz.$y7));this.$11h.$F(new _mcp.$mz.$y7("FromFieldControl",this.$$d_$7Xw));this.$11h.$F(new _mcp.$mz.$y7("ToRecipientWellControl",this.$$d_$7Xw));this.$11h.$F(new _mcp.$mz.$y7("CcRecipientWellControl",this.$$d_$7Xw));this.$11h.$F(new _mcp.$mz.$y7("BccRecipientWellControl",this.$$d_$7Xw));if(n.get_$4wH()){n.$6R.addEventListener("focusin",this.$$d_$DvI,!0);n.$6R.addEventListener("focusout",this.$$d_$DvH,!0)}else{for(var i=0;i<this.$hB.get_$A();i++)this.$5q[this.$hB.get_$E(i).$1Ic].get_$S().bind("focusin",{uiComponent:this.$hB.get_$E(i).$1Ic},this.$hB.get_$E(i).$2cW);for(var t=0;t<this.$11h.get_$A();t++)this.$5q[this.$11h.get_$E(t).$1Ic].get_$S().bind("focusout",{uiComponent:this.$11h.get_$E(t).$1Ic},this.$11h.get_$E(t).$2cW)}this.$4Sp();this.$7nf();this.$5q.CancelConfirmDialog.$p("IsHidden",this.$$d_$DTS);this.$5q.MessageBox.$p("IsHidden",this.$$d_$DdL);n.$1d.$p("ActionPerformed",this.$$d_$DaZ);n.$1d.$p("Count",this.$$d_$Daa);n.get_$eM().add_$6nZ(this.$$d_$6nZ);if(!$C(this.$5q.ComposeAppsPane)){this.$5q.ComposeAppsPane.$p("IsHidden",this.$$d_$95v);_y.$z.$1Q.add_$1Go(this.$$d_$706);_g.$O.get_$Q().get_$6r().add_$1zu(this.$$d_$6oj)}if(this.$l.$8G(this.$l.get_$IF())&&this.$g3==="TouchWide"){var r=n.get_$39B().$65;if(r){r.add_$2Ta(this.$$d_$5Eg);r.add_$3Ru(this.$$d_$DSH)}}n.$c.$p("SelectedDataCallContext",this.$$d_$6qA);this.$2C3=!0},$2BY:function(){if(this.$5q){"CancelConfirmDialog"in this.$5q&&this.$5q.CancelConfirmDialog.$1B("IsHidden",this.$$d_$DTS);"MessageBox"in this.$5q&&this.$5q.MessageBox.$1B("IsHidden",this.$$d_$DdL);var u=this.get_$k();if(u&&u.get_$4wH()){u.$6R.removeEventListener("focusin",this.$$d_$DvI,!0);u.$6R.removeEventListener("focusout",this.$$d_$DvH,!0)}else{for(var i=0;i<this.$hB.get_$A();i++)this.$hB.get_$E(i).$1Ic in this.$5q&&this.$5q[this.$hB.get_$E(i).$1Ic].get_$S().unbind("focusin",this.$hB.get_$E(i).$2cW);for(var t=0;t<this.$11h.get_$A();t++)this.$11h.get_$E(t).$1Ic in this.$5q&&this.$5q[this.$11h.get_$E(t).$1Ic].get_$S().unbind("focusout",this.$11h.get_$E(t).$2cW)}"EditorControl"in this.$5q&&this.$5q.EditorControl.$1B("IsPlainTextContent",this.$$d_$DWr);this.$Err()}if(this.get_$k()){var n=this.get_$k();_js.Trace.logInfo(_a.$0.$16,"Unbind view events on view model. Context:"+n.$c.toString());var e=n.get_$2N1();e.$1B("IsInitialized",this.$$d_$DVL);e.$1B("IsSecondInitializationComplete",this.$$d_$DVN);n.get_$1kA()&&n.get_$1kA().get_$Tg()&&n.get_$1kA().get_$Tg().$1B("IsShown",this.$$d_$6o2);var r=n.get_$3Ma();if(r){r.$1B("DialogViewModel",this.$$d_$DdN);r.$E6&&r.$E6.$1B("IsShown",this.$$d_$DdO)}var o=n.get_$ad();o&&o.$1B("IsPeoplePickerShown",this.$$d_$DfD);n.$1d.$1B("ActionPerformed",this.$$d_$DaZ);n.$1d.$1B("Count",this.$$d_$Daa);n.get_$eM().remove_$6nZ(this.$$d_$6nZ);n.$1B("IsReadyForViewInitialization",this.$$d_$Dmt);n.get_$eM().get_$9Z()&&n.get_$eM().get_$9Z().remove_$26l(this.$$d_$26l);if(this.$l.$8G(this.$l.get_$IF())&&this.$g3==="TouchWide"){var f=n.get_$39B().$65;if(f){f.remove_$2Ta(this.$$d_$5Eg);f.remove_$3Ru(this.$$d_$DSH)}}n.$c.$1B("SelectedDataCallContext",this.$$d_$6qA)}if(!$C(this.$5q.ComposeAppsPane)){this.$5q.ComposeAppsPane.$1B("IsHidden",this.$$d_$95v);_y.$z.$1Q.remove_$1Go(this.$$d_$706);_g.$O.get_$Q().get_$6r().remove_$1zu(this.$$d_$6oj)}this.$2C3=!1},$Bz7:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in the RTE");this.set_$12N("EditorControl")},$Bz8:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in the Water");this.set_$12N("CED")},$4f7:function(n){var i=n.data;var t=i.uiComponent;this.$7rH(t)},$Dx8:function(n){this.$4f7(n);this.$6K4()},$7Xw:function(n){_js.Trace.logInfo(_a.$0.$16,"User blured from "+this.$OL);if(this.get_$k()&&_mcp.$8n.isInstanceOfType(this.get_$k())&&!this.$3aj&&!this.get_$k().$1di){if(this.$OL==="FromFieldControl"){var t=this.get_$k().get_$ad();if(t&&t.get_$1Ru()){var u=t.get_$1Ru().get_$By();_js.$9.$o(u)||t.$4GQ(u,!0)}}var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed MailTips retrieval",function(){if(r.get_$k()){var n=r.get_$k().get_$6Xr();n.get_$G8()||n.$3e();n.$2yR()}},100);if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed PolicyTips retrieval",function(){if(i.get_$k()){var n=i.get_$k().get_$9Go();n.$2BU(1)}},100)}}},$1tM:function(){if(this.$5q&&this.get_$34()&&this.$hd&&this.$OL&&this.get_$k()&&!this.get_$k().$1di){_js.Trace.logInfo(_a.$0.$16,"Restore focus to "+this.$OL);this.$1Jw(this.$OL)}else _js.Trace.logInfo(_a.$0.$16,"Skip restore focus, controls="+(this.$5q?"non-null":"null")+"; Active="+this.get_$34().toString()+"; InView="+this.$hd.toString()+"; Name="+this.$OL+"; VM="+(this.get_$k()?"non-null":"null"))},$1Jw:function(n){this.$7Yk();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":this.$1aq[n].focus();this.set_$12N(n);this.$6K4();break;case"EditorControl":case"CED":this.$5q[n].$3S();this.set_$12N(n);break}},$7Yk:function(){if(this.$1aq&&!("SubjectTextBox"in this.$1aq)){this.$1aq.SubjectTextBox=this.$5q.SubjectTextBox.get_$S();this.$1aq.FromFieldControl=this.$5q.FromFieldControl.get_$S().find("input");this.$1aq.ToRecipientWellControl=this.$5q.ToRecipientWellControl.get_$S().find("input");this.$1aq.CcRecipientWellControl=this.$5q.CcRecipientWellControl.get_$S().find("input");this.$1aq.BccRecipientWellControl=this.$5q.BccRecipientWellControl.get_$S().find("input")}},$A9r:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.$0.$16,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},$Ea6:function(){this.$5q.FromFieldControl.add_$10A(this.$$d_$DhM);this.$5q.ToRecipientWellControl.add_$10A(this.$$d_$DhM);this.$5q.CcRecipientWellControl.add_$10A(this.$$d_$DhM);this.$5q.BccRecipientWellControl.add_$10A(this.$$d_$DhM)},$95v:function(n,t){var i=this.$5q.ComposeAppsPane;i.get_$17()&&this.$1Jw("ToRecipientWellControl")},$6qA:function(n,t){var i=this.get_$k();if(this.$OL==="SubjectTextBox"){i.$c.get_$297().set_$1Ho("subject");this.$5q.SubjectTextBox.set_$16W(i.$c.get_$297())}else if(this.$OL==="EditorControl"){"EditorControl"in this.$5q&&this.$5q.EditorControl.set_$16W(i.$c.get_$297());i.$c.get_$297().set_$1Ho("body")}else i.$c.get_$297().set_$6R9(!0)},$EnK:function(){var i=this.$5q.FromFieldControl;var r=this.$5q.ToRecipientWellControl;var n=this.$5q.CcRecipientWellControl;var t=this.$5q.BccRecipientWellControl;i&&i.remove_$10A(this.$$d_$DhM);r&&r.remove_$10A(this.$$d_$DhM);n&&n.remove_$10A(this.$$d_$DhM);t&&t.remove_$10A(this.$$d_$DhM)},$DhM:function(n){if(this.$5q.FromFieldControl===n){var u=n.get_$S().find("input");u.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}else if(this.$5q.ToRecipientWellControl===n){var r=n.get_$S().find("input");r.attr("aria-label",_nbs.NonBootStrings.l_ToRecipients_AT_TextBox_Text);r.attr("role","combobox");r.attr("aria-haspopup","true")}else if(this.$5q.CcRecipientWellControl===n){var t=n.get_$S().find("input");t.attr("aria-label",_nbs.NonBootStrings.l_CcRecipients_AT_TextBox_Text);t.attr("role","combobox");t.attr("aria-haspopup","true")}else if(this.$5q.BccRecipientWellControl===n){var i=n.get_$S().find("input");i.attr("aria-label",_nbs.NonBootStrings.l_BccRecipients_AT_TextBox_Text);i.attr("role","combobox");i.attr("aria-haspopup","true")}},$C2r:function(){var n=this.$5q.FromFieldControl;n&&n.$C2o()},$6K4:function(){switch(this.$OL){case"ToRecipientWellControl":this.set_$3z9(!0);this.set_$3wL(!1);this.set_$3wE(!1);break;case"CcRecipientWellControl":this.set_$3wL(!0);this.set_$3z9(!1);this.set_$3wE(!1);break;case"BccRecipientWellControl":this.set_$3wE(!0);this.set_$3wL(!1);this.set_$3z9(!1);break}},$Bzz:function(){var n=!0;if(this.$4H1){if(this.$OL==="DiscardButton"){this.$5q.SendButton.$3S();this.set_$12N("SendButton")}else if(this.$OL==="InsertButton"){this.$5q.DiscardButton.$3S();this.set_$12N("DiscardButton");n=!1}else if(this.$OL==="AppsButton"){this.$5q.InsertButton.$3S();this.set_$12N("InsertButton");n=!1}else if(this.$OL==="AffordanceMenuButton"){var i=this.$5q.AppsButton;if(i.get_$17()){this.$5q.InsertButton.$3S();this.set_$12N("InsertButton")}else{i.$3S();this.set_$12N("AppsButton")}n=!1}else if(this.$OL==="OpenSeperateWindowButton"){this.$5q.AffordanceMenuButton.$3S();this.set_$12N("AffordanceMenuButton");n=!1}else if(this.$OL==="ToRecipientButton"){var t=this.get_$k();if(t.get_$ad().$4vj||t.$1d.get_$A())this.set_$4H2(!1);else{var u=this.$5q.ComposeAppsPane;if(u.get_$17()){this.$5q.OpenSeperateWindowButton.$3S();this.set_$12N("OpenSeperateWindowButton");n=!1}else this.set_$4H2(!1)}}else if(this.$OL==="ToRecipientWellControl")if(this.$g3==="Mouse"){this.$5q.ToRecipientButton.$3S();this.set_$12N("ToRecipientButton");n=!1}else this.set_$4H2(!1);else if(this.$OL==="CcRecipientWellControl"){this.$5q.CcRecipientButton.$3S();this.set_$12N("CcRecipientButton")}else if(this.$OL==="BccRecipientWellControl"){this.$5q.BccRecipientButton.$3S();this.set_$12N("BccRecipientButton")}if(n){var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.set_$4H2(!1)},100)}}},$Eqx:function(){if(this.$Ebh()){var n=this.get_$k();switch(this.$OL){case"ToRecipientWellControl":n.get_$ad().$GM.$2BV();n.get_$ad().$Gd.$2BV();break;case"CcRecipientWellControl":n.get_$ad().$GI.$2BV();n.get_$ad().$Gd.$2BV();break;case"BccRecipientWellControl":n.get_$ad().$GI.$2BV();n.get_$ad().$GM.$2BV();break;default:n.get_$ad().$GI.$2BV();n.get_$ad().$GM.$2BV();n.get_$ad().$Gd.$2BV();break}}},$Ebh:function(){return this.$g3!=="Mouse"&&this.get_$k()?!0:!1},$DTS:function(n,t){if(this.$5q.CancelConfirmDialog.get_$17()&&this.get_$k()&&!this.get_$k().$1di){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of cancel confirm dialog.");this.$1tM()}},$DdL:function(n,t){if(this.$5q.MessageBox.get_$17()){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of message box.");this.$1tM()}},$DVL:function(n,t){var i=this.get_$k();i.get_$2N1().$1B("IsInitialized",this.$$d_$DVL);_js.Trace.logInfo(_a.$0.$16,"Calling PostTransitionIn on initialize of Data Context.");this.$IX(null)},$DVN:function(n,t){var i=this.get_$k();i.get_$2N1().$1B("IsSecondInitializationComplete",this.$$d_$DVN);this.$7Wd();this.$g3==="Mouse"&&i.get_$1kA().get_$Tg()&&i.get_$1kA().get_$Tg().$p("IsShown",this.$$d_$6o2);var r=i.get_$3Ma();r.$E6?r.$E6.$p("IsShown",this.$$d_$DdO):r.$p("DialogViewModel",this.$$d_$DdN);var u=i.get_$ad();u&&u.$p("IsPeoplePickerShown",this.$$d_$DfD)},$7Wd:function(){if(this.$g3==="Mouse"){var n=this.get_$k();n&&this.$18V&&(n.get_$7eJ().$1xJ=this.$1xJ)}},$6o2:function(n,t){var i=this.get_$k();if(!i.get_$1kA().get_$Tg().$3W){var r=i.get_$3Ma();var u=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnContextMenuShownChanged",function(){var t=!r.$E6||!r.$E6.$3W;var n=!i.$2F||!i.$2F.$3W;if(t&&n){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of context menu");u.$1tM()}},100)}},$DdN:function(n,t){var r=this.get_$k();var i=r.get_$3Ma();i.$1B("DialogViewModel",this.$$d_$DdN);i.$E6.$p("IsShown",this.$$d_$DdO)},$DdO:function(n,t){var r=this.get_$k();var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.get_$3Ma().$E6.$3W){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of message options dialog");i.$1tM()}},100)},$DfD:function(n,t){var i=this.get_$k();if(!i.get_$ad().$6SR){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of people picker");this.$1tM()}},$DaZ:function(n,t){this.$1tM()},$Daa:function(n,t){this.$9us();this.$9nW()},$9us:function(){var a=this.$u.$1N("InfoBarControl");if(a){var f=this.get_$k();if(f.$1d.$G6.get_$A()>0){for(var l=new _y.$ty,o=_nbs.NonBootStrings.l_Infobar_AT_Region_Text+". ",n,r=0;r<f.$1d.$G6.get_$A();r++){n="";var t=f.$1d.$G6.get_$E(r);if(_y.$dt.isInstanceOfType(t)){var h=t;h&&(n=h.$3V)}else if(_y.$du.isInstanceOfType(t)){var e=t;e&&(n=e.$3V)}else if(_y.$W4.isInstanceOfType(t)){var i=t;if(i&&_y.$1Ij.isInstanceOfType(i.$Fc)){var u=i.$Fc;u&&u.get_$1F8()&&(n=u.get_$1F8())}}if(n===""){var s=t;s&&(n=l.$4L(s.$5h,null))}o+=n+". "}var c=this.$u.$1N("InfoBarControl").get_$S();c.attr("aria-label",o)}}},$6nZ:function(n){n.get_$9Z().add_$26l(this.$$d_$26l)},$26l:function(n){if(n.get_$8O3()){n.set_$8O3(!1);this.set_$12N("EditorControl")}this.$1tM()},$9jY:function(n,t){if(n.$BsH("IsInitialized"))_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:"+t.toString());else{_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:"+t.toString());n.$p("IsInitialized",this.$$d_$DVL)}},$4Sp:function(){if("EditorControl"in this.$5q&&this.$5q.EditorControl){var t=this.$5q.EditorControl;t.add_$1s6(this.$$d_$Bz7);t.add_$1fh(this.$$d_$Bz9);t.add_$2sD(this.$$d_$8L4);t.add_$3SF(this.$$d_$8L1);t.add_$XN(this.$$d_$8Ky);t.add_$3SD(this.$$d_$8L0);t.add_$3S8(this.$$d_$8Kz)}if("CED"in this.$5q&&this.$5q.CED){var n=this.$5q.CED;n.add_$1s6(this.$$d_$Bz8);n.add_$1fh(this.$$d_$Bz9);n.add_$2sD(this.$$d_$8L4);n.add_$3SF(this.$$d_$8L1);n.add_$XN(this.$$d_$8Ky);n.add_$3SD(this.$$d_$8L0);n.add_$3S8(this.$$d_$8Kz)}if(this.$1E.get_$Df()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().bind("focusin",this.$$d_$A62)}},$Err:function(){if("EditorControl"in this.$5q&&this.$5q.EditorControl){var t=this.$5q.EditorControl;t.remove_$1s6(this.$$d_$Bz7);t.remove_$1fh(this.$$d_$Bz9);t.remove_$2sD(this.$$d_$8L4);t.remove_$3SF(this.$$d_$8L1);t.remove_$XN(this.$$d_$8Ky);t.remove_$3SD(this.$$d_$8L0);t.remove_$3S8(this.$$d_$8Kz)}if("CED"in this.$5q&&this.$5q.CED){var n=this.$5q.CED;n.remove_$1s6(this.$$d_$Bz8);n.remove_$1fh(this.$$d_$Bz9);n.remove_$2sD(this.$$d_$8L4);n.remove_$3SF(this.$$d_$8L1);n.remove_$XN(this.$$d_$8Ky);n.remove_$3SD(this.$$d_$8L0);n.remove_$3S8(this.$$d_$8Kz)}if(this.$1E.get_$Df()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().unbind("focusin")}},$DWr:function(n,t){if(_z.$Ap.isInstanceOfType(n)){var i=n;this.$zG=!i.$Et;i&&this.$zG&&this.get_$k().$c.set_$1vc(i.get_$1K());this.$7nf();if(this.$3KD){var r=this.$5q.Ribbon;r&&r.set_$17(!this.$zG)}}},$A62:function(n){var t=new _a.$7D(n);this.$1Jw("EditorControl");t.$Dz()},$Bz9:function(n){var t=this.get_$k();t.$c.get_$9lW()?this.$1Jw("CcRecipientWellControl"):this.$1Jw("SubjectTextBox");n.set_$Dz(!0)},$8L4:function(n){var t=this.get_$k();if(t){t.$c.set_$Ebo(n.get_$Ebp());t.$c.set_$4c8(n.get_$4c8());t.$c.set_$6Q5(n.get_$G8());t.$c.set_$6Q6(n.get_$dJ())}},$8L1:function(n){var t=this.get_$k();t&&t.$1n.$5m(5).$Ez2(n.get_$1m())},$8Ky:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z().get_$13C();t.$9U(n.get_$4d9());t.$4r(n.get_$4d9())}},$8L0:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z();t.set_$4Vb(n.get_$4Vb());t.set_$4Vc(n.get_$4Vc());t.set_$2e1(n.get_$2e1());t.get_$2dB().$11()}},$8Kz:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z();t.set_$eq(n.get_$lu());t.get_$2dB().$11()}},$9nW:function(){var n=this.$5q.EditorControl;n.$5XI=!1;n.$Jx()},$6oj:function(n,t){this.$706()},$706:function(){},$5Eg:function(){var n=this.$5q.QuotedBodyHtmlLabel;if(n){this.$5q.QuotedBodyHtmlLabel.get_$H1().on("touchstart",null,null,this.$$d_$DwO);this.$5q.QuotedBodyHtmlLabel.get_$H1().on("touchend",null,null,this.$$d_$DwN)}},$DSH:function(){var n=this.$5q.QuotedBodyHtmlLabel;if(n){this.$5q.QuotedBodyHtmlLabel.get_$H1().off("touchstart",null,this.$$d_$DwO);this.$5q.QuotedBodyHtmlLabel.get_$H1().off("touchend",null,this.$$d_$DwN)}},$DwN:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.$l.get_$IF().$2PX(t);n.stopImmediatePropagation();n.preventDefault()}},$DwO:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},$8Pr:function(){var n=this.get_$k();this.set_$6Sq(!0);_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn active view. Context: "+n.$c.toString());this.$9hY();this.$1aL();_js.$D.get_$Q().$2V(_a.$0.$16,"MailCompose.Editor.Resize",this.$$d_$9nW,500)},$Dmt:function(n,t){var i=n;i.$1B("IsReadyForViewInitialization",this.$$d_$Dmt);this.$8Pr()},$5nf:function(){if(this.$18V){var t=this.$5q.CED;var n=this.$5q.EditorControl;var i=this.$5q.Ribbon;i.set_$60E(n);i.set_$17(!0);if(t&&n){n.$EK=!1;n.set_$mf(t.get_$mf());t.$7bo()}this.set_$6Mn(!1);if(n){n.$IX();n.$Jx()}}},$7rR:function(){this.$18V?this.$1Jw("CED"):this.$1Jw("EditorControl")},$DWv:function(){this.set_$6Mn(!1)},$DvI:function(n){for(var t=0;t<this.$hB.get_$A();t++){var r=this.$hB.get_$E(t);var i=this.$5q[r.$1Ic];if(n.target===i.$O||i.get_$S().has(n.target).length){this.$7rH(r.$1Ic);this.$6K4();break}}return!0},$DvH:function(n){for(var t=0;t<this.$11h.get_$A();t++){var r=this.$11h.get_$E(t);var i=this.$5q[r.$1Ic];if(n.target===i.$O||i.get_$S().has(n.target).length){r.$2cW(null);break}}return!0},$7rH:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in "+n);this.set_$12N(n);this.set_$4H2(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.get_$k()&&_mcp.$8n.isInstanceOfType(this.get_$k())){var i=this.get_$k();if(this.$OL==="FromFieldControl"){var t=i.get_$ad();t&&t.set_$9kB(!1)}this.$OL==="InsertButton"&&i.$AGq()}},$7nf:function(){var n=this.get_$k();n&&this.set_$CFY(this.$1E.get_$Df()&&n.$c.get_$6P()==="Text"?!0:!1)}};_mcp.$mz.$y7=function(n,t){this.$1Ic=n;this.$2cW=t};_mcp.$mz.$y7.prototype={$1Ic:null,$2cW:null};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var l="IrmDialogView";new _A(l,function(){_mcp._TI.$1[l]===undefined&&(_mcp._TI.$1[l]=[[[-1,0,["Description"],[_mcp._TI.$D2R],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.$D2Q],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.$A(n.children[1]);var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$147,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var a="MailComposeView._tid1._tid3";new _A(a,function(){_mcp._TI.$1[a]===undefined&&(_mcp._TI.$1[a]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z5("_mcp_v ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.BasicDetailsPopup");n.set_$7K("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var h="MailComposeView._tid1._tid4";new _A(h,function(){_mcp._TI.$1[h]===undefined&&(_mcp._TI.$1[h]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.$Ei,_mcp._TI.$8up],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.$I6(t.children[0],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_ff.$M));n.set_$7K("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var c="MailComposeView._tid1";new _A(c,function(){_mcp._TI.$1[c]===undefined&&(_mcp._TI.$1[c]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$nG()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_FromSendAsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_FromAddressSelector_AT_Button_Text],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3P2,_mcp._TI.$3Oy,_mcp._TI.$2p],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,new _js.$x([_mcp._TI.get_$24(),_mcp._TI.get_$K()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.$Ei,_mcp._TI.$8uq],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.$7(t.children[3]);u.set_$6("MailComposeView._tid1._tid4");var f=new _js.$7(t.children[2]);var r=new _js.$7(t.children[1]);r.set_$6("MailComposeView._tid1._tid3");var n=new _fc.$H(t.children[0]);n.set_$6("MailComposeView.FromButtonTemplate");n.set_$3E("MailCompose.FromRecipientWellButton");n.set_$g(0);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));i.$M(_E.$D(["SendAsContextMenuComponent","Menu"],[_mcp._TI.$3P2,_mcp._TI.$3Oy],null,"MenuDataContext",null,_mcp._TI.$3q,1)).$M(_E.$D(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3P2,_mcp._TI.$3Oy,_mcp._TI.$2p],_mcp._TI.$49,"IsShown",_mcp._TI.$3n,_mcp._TI.$3m,2,null,null,!1));i.$58=3;i.$7Y=1;n.set_$12([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.$8n,_mcp.$mx,!1,!0,!1,0,_mcp._TI.$1);var p="MailComposeView._tid8";new _A(p,function(){_mcp._TI.$1[p]===undefined&&(_mcp._TI.$1[p]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,0,["Context","Subject"],[_mcp._TI.$EB,_mcp._TI.$57P],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var w="MailComposeView._tid9._tida";new _A(w,function(){_mcp._TI.$1[w]===undefined&&(_mcp._TI.$1[w]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.$1VO,_mcp._TI.$8ul],_mcp._TI.$8um,"DataContext",_mcp._TI.$2S,_mcp._TI.$Z,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VO,_mcp._TI.$58l],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.$2J(i.children[1],_js.$2.Instance.$2(_a.$1x));t.set_$Z5("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.set_$6("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.$2J(i.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z5("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.$8n,_b.$8M,!1,!0,!1,0,_mcp._TI.$1);var v="MailComposeView._tid9._tidb";new _A(v,function(){_mcp._TI.$1[v]===undefined&&(_mcp._TI.$1[v]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VO,_mcp._TI.$58l],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z5("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var y="MailComposeView._tid9";new _A(y,function(){_mcp._TI.$1[y]===undefined&&(_mcp._TI.$1[y]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_FromLabel_Text]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.$zl,0,null,null,null,_u.Strings.l_OnBehalfOf_Text],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VO,_mcp._TI.$58m],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VO,_mcp._TI.$58m],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.$7(_B.$3(n,[1,1]));i.set_$6("MailComposeView._tid9._tidb");var t=new _b.$8M(_B.$3(n,[1,0]));t.set_$6("MailComposeView._tid9._tida");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var s="MailComposeView._tidc";new _A(s,function(){_mcp._TI.$1[s]===undefined&&(_mcp._TI.$1[s]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.$EB,_mcp._TI.$8uh],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["Context","MeetingCalendarTimePeriod"],[_mcp._TI.$EB,_mcp._TI.$8ug],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$2on(),null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var i="MailComposeView._tidd";new _A(i,function(){_mcp._TI.$1[i]===undefined&&(_mcp._TI.$1[i]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_ProposeNewTimeLabel_Short_Text]],[[-1,0,["Context","ProposedNewTime"],[_mcp._TI.$EB,_mcp._TI.$8pm],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$42P(),null,null]]]);var n=_mcp._TI._hf.childNodes[9].cloneNode(!0);var r=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,r])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var r="MailComposeView._tide";new _A(r,function(){_mcp._TI.$1[r]===undefined&&(_mcp._TI.$1[r]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.MeetingMsgStrings.l_WhereLabel_Text]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.$1VO,_mcp._TI.$8uk],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _cmm.$WU(_B.$3(t,[1,0]));n.set_$3zT(!0);n.set_$4S(!0);var i=new _fc.$A(t.children[0]);return new _B(t,[i,n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var n="MailComposeView._tidf";new _A(n,function(){_mcp._TI.$1[n]===undefined&&(_mcp._TI.$1[n]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$qq()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.$1o,0,null,null,null,_n.$1.get_$1J9()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_n.$1.get_$1J9()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.$2Rv,_mcp._TI.$8us],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.$2Rv,_mcp._TI.$8uv],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.$BU,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.$2Rv,_mcp._TI.$8uu],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var i=_mcp._TI._hf.childNodes[11].cloneNode(!0);var t=new _fce.$20(i.children[1],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));t.$74=0;t.set_$g(-1);var r=new _fc.$H(i.children[0]);r.set_$g(0);return new _B(i,[r,t])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var t="MailComposeView.FromButtonTemplate";new _A(t,function(){_mcp._TI.$1[t]===undefined&&(_mcp._TI.$1[t]=[[[-1,1,["Text"],[_mcp._TI.$Tn],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.$7A],null,"Id",null,_mcp._TI.$14,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var r=new _fc.$Y(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var i=new _fc.$A(n.children[0]);return new _B(n,[i,r]).R({Label:i,Image:r})},Object,_fc.$H,!1,!1,!1,0,_mcp._TI.$1);var e="MailComposeView";new _A(e,function(){_mcp._TI.$1[e]===undefined&&(_mcp._TI.$1[e]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25g],null,"IsBusy",null,_mcp._TI.$AD,1,_mcp._TI.get_$K(),null,!1]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25g],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.$8ux],null,"_mcp_N",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.$3P0,_mcp._TI.$3Ov,_mcp._TI.$zo],null,"_mcp_V",null,null,0,_mcp._TI.get_$K(),null,null],[-1,5,["GenericMailMode"],[_mcp._TI.$8ux],null,"_mcp_Q",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.$D2l],null,"_mcp_J",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.$8v3],null,"BusyText",null,_mcp._TI.$BU,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.$6i4],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25g],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.$6i1],null,"DataSource",null,_mcp._TI.$OW,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.$6i3],null,"_mcp_R",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.$8vD],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.$EB,_mcp._TI.$8pl],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_ToRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_ToRecipients_AT_Button_Text],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jO()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jP()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vG],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i2],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_CcRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_CcRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jO()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jP()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vF],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i2],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.$EB,_mcp._TI.$8pk],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_BccRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_BccRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jO()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jP()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vE],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$1VN],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i2],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VM],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$40b()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.$58n,_mcp._TI.$D2U],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.$58n,_mcp._TI.$8uc],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$14,0,null,null,null,_n.$1.get_$4CL()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.$EB,_mcp._TI.$8pq],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$14,0,null,null,null,_n.$1.get_$Y()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.$EB,_mcp._TI.$8pp],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.$8uy,_mcp._TI.$8ui],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.$EB,_mcp._TI.$8pj],null,"Id",null,_mcp._TI.$14,1,_mcp._TI.get_$vz(),null,null]],[[-1,0,["Context","Subject"],[_mcp._TI.$EB,_mcp._TI.$57P],_mcp._TI.$8ps,"Text",_mcp._TI.$5L,_mcp._TI.$5G,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.$EB,_mcp._TI.$8uf],null,"MaxLength",null,_mcp._TI.$Ym,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.$EB,_mcp._TI.$8po],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,0,["Context","HasProposedNewTime"],[_mcp._TI.$EB,_mcp._TI.$8ue],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["Context","HasLocation"],[_mcp._TI.$EB,_mcp._TI.$8pi],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.$44U,_mcp._TI.$6hj,_mcp._TI.$8pB],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.$44U,_mcp._TI.$6hj],_mcp._TI.$D2S,"DataContext",_mcp._TI.$2S,_mcp._TI.$Z,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_PrintRestricted_Text],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.$1pw,0,null,null,null,_nbs.NonBootStrings.l_MessageBody_AT_TextBox_Text],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25g],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"IsCopyRestricted",null,_mcp._TI.$XF,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"ShouldRestrictFramePrinting",null,_mcp._TI.$6df,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fU],_mcp._TI.$6fX,"Content",_mcp._TI.$2p6,_mcp._TI.$2p7,2,null,null,null],[-1,0,["Context","RawEditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fV],_mcp._TI.$6fY,"RawContent",_mcp._TI.$1pv,_mcp._TI.$1ea,2,null,null,null],[-1,0,["Context","TextEditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fW],_mcp._TI.$6fZ,"TextContent",_mcp._TI.$6dX,_mcp._TI.$6dh,2,null,null,null],[-1,0,["ContentConversionComponent","SwitchToHtmlContent"],[_mcp._TI.$44V,_mcp._TI.$8ud],null,"SwitchToHtmlContent",null,_mcp._TI.$8mM,1,null,null,null],[-1,0,["ContentConversionComponent","SwitchToPlainTextContent"],[_mcp._TI.$44V,_mcp._TI.$6hk],null,"SwitchToPlainTextContent",null,_mcp._TI.$6dg,1,null,null,null],[-1,0,["EditorResizeComponent","ResizeEditorCommand"],[_mcp._TI.$D2m,_mcp._TI.$D2Y],_mcp._TI.$D2Z,"ResizeCommand",_mcp._TI.$43E,_mcp._TI.$43F,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.$EB,_mcp._TI.$8ph],_mcp._TI.$8pr,"IsPlainTextContent",_mcp._TI.$43D,_mcp._TI.$8mL,2,_mcp._TI.get_$8mC(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.$6i0,_mcp._TI.$6hm],_mcp._TI.$6hn,"CallContext",_mcp._TI.$3Nx,_mcp._TI.$3Ny,2,null,null,null],[-1,0,["Context","IsEditorInitialized"],[_mcp._TI.$EB,_mcp._TI.$Cnh],null,"IsInitialized",null,_mcp._TI.$Cea,1,null,null,!1],[-1,0,["TouchComponent","CloseCommand"],[_mcp._TI.$58o,_mcp._TI.$8ur],null,"DiscardCommand",null,_mcp._TI.$2p8,1,null,null,null],[-1,0,["SaveComponent","SaveCommand"],[_mcp._TI.$44W,_mcp._TI.$43o],null,"SaveCommand",null,_mcp._TI.$2p9,1,null,null,null],[-1,0,["SendComponent","SendCommand"],[_mcp._TI.$1VP,_mcp._TI.$2pj],null,"SendCommand",null,_mcp._TI.$3O0,1,null,null,null],[-1,0,["SendComponent","AltSSendCommand"],[_mcp._TI.$1VP,_mcp._TI.$44T],null,"AltSSendCommand",null,_mcp._TI.$560,1,null,null,null],[-1,0,["RecipientComponent","ResolveCommand"],[_mcp._TI.$Ei,_mcp._TI.$44S],null,"ResolveCommand",null,_mcp._TI.$3Nz,1,null,null,null],[-1,0,["LinkPreviewComponent","IsLinkPreviewEnabled"],[_mcp._TI.$k5,_mcp._TI.$6hp],null,"IsLinkPreviewEnabled",null,_mcp._TI.$6db,1,null,null,!1],[-1,0,["LinkPreviewComponent","GetLinkPreviewRequest"],[_mcp._TI.$k5,_mcp._TI.$6ho],_mcp._TI.$6hu,"GetLinkPreviewRequest",_mcp._TI.$6dV,_mcp._TI.$6da,2,null,null,null],[-1,0,["LinkPreviewComponent","LinkPreviewResponse"],[_mcp._TI.$k5,_mcp._TI.$6hq],null,"LinkPreviewResponse",null,_mcp._TI.$6dc,1,null,null,null],[-1,0,["LinkPreviewComponent","YouTubePlayerAnchorClicked"],[_mcp._TI.$k5,_mcp._TI.$6ht],_mcp._TI.$6hx,"YouTubePlayerAnchorClicked",_mcp._TI.$6dZ,_mcp._TI.$6dj,2,null,null,null],[-1,0,["LinkPreviewComponent","OEmbedVideoPlayerAnchorClicked"],[_mcp._TI.$k5,_mcp._TI.$6hr],_mcp._TI.$6hv,"OEmbedVideoPlayerAnchorClicked",_mcp._TI.$6dW,_mcp._TI.$6dd,2,null,null,null],[-1,0,["LinkPreviewComponent","VideoPlayerHtmlLookup"],[_mcp._TI.$k5,_mcp._TI.$6hs],_mcp._TI.$6hw,"VideoPlayerHtmlLookup",_mcp._TI.$6dY,_mcp._TI.$6di,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25g],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.$2Rv,_mcp._TI.$8ut],null,"_mcp_I",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.$8vD],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"TextSelectionType",null,_mcp._TI.$3C,1,_mcp._TI.get_$dW(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"IsCopyRestricted",null,_mcp._TI.$XF,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EB,_mcp._TI.$8pn],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EB,_mcp._TI.$8pn],null,"Html",null,_mcp._TI.$Ix,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.$3P0,_mcp._TI.$3Ov],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.$zo],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.$8v0],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.$FV,0,null,null,null,_nbs.NonBootStrings.l_CloseMessageConfirmDialogTitle_Text],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.$58o,_mcp._TI.$Cnk],null,"ButtonDataList",null,_mcp._TI.$FU,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.$58o,_mcp._TI.$Cnl],_mcp._TI.$Cnm,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.$58n,_mcp._TI.$D2T],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.$9p],_mcp._TI.$Dj,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$Ha],null,"DialogTitle",null,_mcp._TI.$Dw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Eh],null,"CloseCommand",null,_mcp._TI.$BV,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HH],null,"ContentDataContext",null,_mcp._TI.$GA,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DS],null,"ButtonDataList",null,_mcp._TI.$DT,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.$8v1,_mcp._TI.$8un],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.$43g],_mcp._TI.$8os,"IsBusy",_mcp._TI.$6k4,_mcp._TI.$90Z,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.$9p],_mcp._TI.$Dj,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$Ha],null,"DialogTitle",null,_mcp._TI.$Dw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Eh],null,"CloseCommand",null,_mcp._TI.$BV,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HH],null,"ContentDataContext",null,_mcp._TI.$GA,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DS],null,"ButtonDataList",null,_mcp._TI.$DT,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.$D2p],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var fi=new _js.$F(n.children[8]);var dt=new _fce.$5M(n.children[7],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));dt.set_$B1("MessageOptionsView");var kt=new _fce.$5M(n.children[6],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));kt.set_$B1("IrmDialogView");var ft=new _b.$5L(n.children[5],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$J));ft.set_$iS(!1);var ot=new _js.$7(n.children[4]);ot.set_$6("MessageBoxDefaultView");var ct=new _js.$7(n.children[3]);ct.set_$6("ComposeExtensibilityView");var yt=new _b.$4C(_B.$3(n,[2,1,4,0]));var ti=new _js.$F(_B.$3(n,[2,1,4]));var vt=new _js.$7(_B.$3(n,[2,1,3]));vt.set_$6("MailComposeView._tidf");var t=_js.$2.Instance.$2(_js.$5P.$$(_z.$Ap)).$9(_B.$3(n,[2,1,2]));t.set_$1zP("_mcp_y ms-font-weight-regular ms-font-color-neutralPrimary");t.set_$3IH(!0);t.set_$4S(!0);t.set_$g(-1);t.set_$3n0("0");var si=new _fc.$A(_B.$3(n,[2,1,1,7]));var f=new _js.$7(_B.$3(n,[2,1,1,6,0,0]));f.set_$6("AttachmentWellViewWrapper");f.set_$rk(!0);f.set_$4S(!0);var bi=new _js.$F(_B.$3(n,[2,1,1,6]));var at=new _js.$7(_B.$3(n,[2,1,1,5,4]));at.set_$6("MailComposeView._tide");var wt=new _js.$7(_B.$3(n,[2,1,1,5,3]));wt.set_$6("MailComposeView._tidd");var lt=new _js.$7(_B.$3(n,[2,1,1,5,2]));lt.set_$6("MailComposeView._tidc");var ht=new _js.$7(_B.$3(n,[2,1,1,5,1]));ht.set_$6("MailComposeView._tid9");var bt=new _js.$7(_B.$3(n,[2,1,1,5,0]));bt.set_$6("MailComposeView._tid8");var wi=new _js.$F(_B.$3(n,[2,1,1,5]));var et=new _fc.$1C(_B.$3(n,[2,1,1,4,1,4,0]));et.set_$g(0);var li=new _fc.$Y(_B.$3(n,[2,1,1,4,1,3]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var hi=new _fc.$Y(_B.$3(n,[2,1,1,4,1,2]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var ai=new _fc.$Y(_B.$3(n,[2,1,1,4,1,1]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var yi=new _fc.$H(_B.$3(n,[2,1,1,4,1,0]));var gt=new _fc.$A(_B.$3(n,[2,1,1,4,0]));gt.set_$g(-1);var vi=new _js.$F(_B.$3(n,[2,1,1,4]));var c=new _js.$7(_B.$3(n,[2,1,1,3,2,0]));c.set_$6("ReadOnlyRecipientWellView");c.set_$rk(!0);c.set_$4S(!0);var pi=new _js.$F(_B.$3(n,[2,1,1,3,2]));var k=new _js.$7(_B.$3(n,[2,1,1,3,1,1]));k.set_$6("ReadWriteRecipientWellView");k.set_$rk(!0);var s=new _fc.$H(_B.$3(n,[2,1,1,3,1,0,0]));s.$MK=!0;s.set_$g(-1);s.set_$2v(!0);var ci=new _js.$F(_B.$3(n,[2,1,1,3,1,0]));var ri=new _js.$F(_B.$3(n,[2,1,1,3,1]));var b=new _fc.$H(_B.$3(n,[2,1,1,3,0]));b.set_$g(-1);var ni=new _js.$F(_B.$3(n,[2,1,1,3]));var o=new _js.$7(_B.$3(n,[2,1,1,2,2,0]));o.set_$6("ReadOnlyRecipientWellView");o.set_$rk(!0);o.set_$4S(!0);var nr=new _js.$F(_B.$3(n,[2,1,1,2,2]));var u=new _js.$7(_B.$3(n,[2,1,1,2,1,1]));u.set_$6("ReadWriteRecipientWellView");u.set_$rk(!0);u.set_$4S(!0);var h=new _fc.$H(_B.$3(n,[2,1,1,2,1,0,0]));h.$MK=!0;h.set_$g(-1);h.set_$2v(!0);var tr=new _js.$F(_B.$3(n,[2,1,1,2,1,0]));var ir=new _js.$F(_B.$3(n,[2,1,1,2,1]));var it=new _fc.$H(_B.$3(n,[2,1,1,2,0]));it.set_$g(-1);var pt=new _js.$F(_B.$3(n,[2,1,1,2]));var nt=new _js.$7(_B.$3(n,[2,1,1,1,2,0]));nt.set_$6("ReadOnlyRecipientWellView");nt.set_$4S(!0);var gi=new _js.$F(_B.$3(n,[2,1,1,1,2]));var r=new _js.$7(_B.$3(n,[2,1,1,1,1,1]));r.set_$6("ReadWriteRecipientWellView");r.set_$4S(!0);var i=new _fc.$H(_B.$3(n,[2,1,1,1,1,0,0]));i.$MK=!0;i.set_$g(-1);i.set_$2v(!0);var ki=new _js.$F(_B.$3(n,[2,1,1,1,1,0]));var di=new _js.$F(_B.$3(n,[2,1,1,1,1]));var g=new _fc.$H(_B.$3(n,[2,1,1,1,0]));g.set_$g(0);var d=new _mcp.$mx(_B.$3(n,[2,1,1,0,0]));d.set_$6("MailComposeView._tid1");var ii=new _js.$F(_B.$3(n,[2,1,1]));var rt=_js.$2.Instance.$2(_js.$5P.$$(_b.$9I)).$9(_B.$3(n,[2,1,0]));rt.set_$g(0);var ut=new _js.$F(_B.$3(n,[2,1]));ut.set_$g(-1);var st=new _fc.$17;var tt=new _fc.$N;tt.$M(_E.$D(["TouchComponent","CloseCommand"],[_mcp._TI.$58o,_mcp._TI.$8ur],null,"Command",null,_mcp._TI.$i,1));tt.set_$Y("ESC");var p=new _fc.$N;p.$M(_E.$D(["SaveComponent","SaveCommand"],[_mcp._TI.$44W,_mcp._TI.$43o],null,"Command",null,_mcp._TI.$i,1));p.set_$Y("S");p.$2c=2;var l=new _fc.$N;l.$M(_E.$D(["SendComponent","AltSSendCommand"],[_mcp._TI.$1VP,_mcp._TI.$44T],null,"Command",null,_mcp._TI.$i,1)).$M(_E.$D(["DoesSupportAltSForSend"],[_mcp._TI.$8uw],null,"PreventDefault",null,_mcp._TI.$2SE,1,null,null,!1));l.set_$Y("S");l.$2c=4;var y=new _fc.$N;y.$M(_E.$D(["SendComponent","SendCommand"],[_mcp._TI.$1VP,_mcp._TI.$2pj],null,"Command",null,_mcp._TI.$i,1));y.set_$Y("ENTER");y.$2c=2;var v=new _fc.$N;v.$M(_E.$D(["RecipientComponent","ResolveCommand"],[_mcp._TI.$Ei,_mcp._TI.$44S],null,"Command",null,_mcp._TI.$i,1));v.set_$Y("K");v.$2c=2;var a=new _fc.$N;a.$W(_E.$D(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$6i6],null,"Command",null,_mcp._TI.$i,1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3P3],null,"PreventDefault",null,_mcp._TI.$2SE,1,null,null,!1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3P3],null,"StopPropagation",null,_mcp._TI.$6kG,1,null,null,!1));a.set_$Y("TAB");a.$2c=1;st.set_$2h([tt,p,l,y,v,a]);ut.set_$12([st]);var ei=new _fce.$20(_B.$3(n,[2,0]),_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));var oi=new _fce.$1F(n.children[2],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$M));var ui=new _js.$F(n.children[1]);var w=new _fce.$20(n.children[0],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));w.$74=0;w.set_$Lp("");return new _B(n,[w,ui,oi,ei,ut,rt,ii,d,g,di,ki,i,r,gi,nt,pt,it,ir,tr,h,u,nr,o,ni,b,ri,ci,s,k,pi,c,vi,gt,yi,ai,hi,li,et,wi,bt,ht,lt,wt,at,bi,f,si,t,vt,ti,yt,ct,ot,ft,kt,dt,fi]).R({InfoBarControl:rt,FromFieldControl:d,ToRecipientButton:g,ToRecipientWellControl:r,CcRecipientWellControl:pt,CcRecipientButton:it,BccRecipientWellControl:ni,BccRecipientButton:b,SubjectTextBox:et,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:ot,CancelConfirmDialog:ft})},_mcp.$8n,_mcp.$mz,!1,!1,!1,0,_mcp._TI.$1);var o="MessageOptionsView._tidC";new _A(o,function(){_mcp._TI.$1[o]===undefined&&(_mcp._TI.$1[o]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_Smime_EncryptMessage_Text],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.$D2u],_mcp._TI.$D2y,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.$D2v],null,"IsEnabled",null,_mcp._TI.$9y,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_Smime_SignMessage_Text],[-1,0,["SmimeSignMessage"],[_mcp._TI.$D2w],_mcp._TI.$D2z,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.$D2x],null,"IsEnabled",null,_mcp._TI.$9y,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[29].cloneNode(!0);var i=new _fc.$2p(n.children[1],_js.$2.Instance.$2(_ff.$C));var t=new _fc.$2p(n.children[0],_js.$2.Instance.$2(_ff.$C));return new _B(n,[t,i])},_mcp.$nO,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var u="MessageOptionsView.SensitivityTemplate";new _A(u,function(){_mcp._TI.$1[u]===undefined&&(_mcp._TI.$1[u]=[[[-1,1,["DataContext"],[_mcp._TI.$2S],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$8ua(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},Object,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var f="MessageOptionsView";new _A(f,function(){_mcp._TI.$1[f]===undefined&&(_mcp._TI.$1[f]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_Sensitivity_Text]],[[-1,0,["SensitivityOptions"],[_mcp._TI.$8v7],null,"Options",null,_mcp._TI.$Cd,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.$8v6],_mcp._TI.$8vC,"SelectedValue",_mcp._TI.$CQ,_mcp._TI.$CR,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_RequestDeliveryReceipt_Text],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.$8v4],_mcp._TI.$8vA,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.$8v8],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_RequestReadReceipt_Text],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.$8v5],_mcp._TI.$8vB,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.$8v9],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.$D2t],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[30].cloneNode(!0);var i=new _js.$7(n.children[4]);i.set_$6("MessageOptionsView._tidC");var u=new _fc.$2p(n.children[3],_js.$2.Instance.$2(_ff.$C));var e=new _fc.$2p(n.children[2],_js.$2.Instance.$2(_ff.$C));var t=new _fce.$39(n.children[1]);t.set_$CT("MessageOptionsView.SensitivityTemplate");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,e,u,i])},_mcp.$nO,_js.$7,!1,!1,!1,0,_mcp._TI.$1)};_mcp._TI.$9S=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_s ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_u'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_q'></span> <span class='_mcp_q'></span> </div><div> <span class='_mcp_q'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_n _mcp_o _mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_7'></span> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_D'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_F'> <div class='_mcp_G ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_M'></div> <div class='_mcp_K'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_L _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <span class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_k'></span> <div class='_mcp_r'> <button type='button' class='_mcp_w _mcp_m'></button> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <div class='_mcp_x'> <input autoid=\"_mcp_3\" class='_mcp_s _mcp_t ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div autoid=\"_mcp_4\" class='_mcp_K ms-bg-color-white'></div> <div class='_mcp_H ms-border-color-neutralTertiary'></div> <div class='_mcp_K ms-bg-color-white'> <span class='_mcp_z ms-font-weight-regular'></span> </div> </div> </div> <div class='_mcp_T _mcp_U'></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_E'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_t1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_h1'></button> <div class='_mcp_w1'></div> <div class='_mcp_e1'></div> <div class='_mcp_e1'></div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_l\" class='_mcp_m1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_C1'></span> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <div> <span class='_mcp_C1 _mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_D1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_m\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_n\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black _mcp_n1'></span> <div class='_mcp_p1'> <span class='_mcp_a1'></span> </div> </div><div> <button autoid=\"_mcp_o\" type='button'></button> <div></div> </div><div> <span class='_mcp_j1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_i1'></span> </div><div> <iframe autoid=\"_mcp_s\" class='_mcp_Y1'></iframe> </div><div> <div class='_mcp_Z1'> <span></span> </div> </div><div> <div class='_mcp_R1'></div> <span class='_mcp_R1'></span> <div class='_mcp_11 ms-bg-color-white'> <div class='_mcp_31'>  <span class='_mcp_51'> <div class='_mcp_M1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_H1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_H1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_H1 ms-font-weight-regular _mcp_K1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> <span class='_mcp_61'> <button autoid=\"_mcp_b\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_41 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_Y'> <div class='_mcp_Z _mcp_X1'></div> <div class='_mcp_Z'> <div class='_mcp_01 ms-bg-color-white customScrollBar'>  <div class='_mcp_71 ms-font-weight-regular'></div> <div class='_mcp_81 _mcp_d1 ms-border-color-neutralTertiary'></div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div autoid=\"_mcp_f\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='peoplePickerContainer'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> </div> <div class='_mcp_81 _mcp_91 _mcp_d1 ms-border-color-neutralTertiary'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1'></span> <div class='_mcp_p1'> <span class='_mcp_Q1'></span> <span autoid=\"_mcp_i\" class='_mcp_P1'></span> <span autoid=\"_mcp_j\" class='_mcp_P1'></span> <span class='_mcp_P1'></span> <div class='_mcp_O1'> <input autoid=\"_mcp_k\" class='_mcp_t1 _mcp_u1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> </div> <div class='_mcp_y1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_z1'></div> </div> <span></span> <span></span> <div class='_mcp_W ms-bg-color-white'></div> <div class='_mcp_E1 _mcp_F1 ms-font-color-neutralDark'></div> <div class='_mcp_E1 ms-bg-color-white'></div> <div class='_mcp_02 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_S1 ms-bg-color-white'></div> <div autoid=\"_mcp_p\"></div> <div></div> <div></div>  <div autoid=\"_mcp_q\"></div> <div autoid=\"_mcp_r\"></div>     </div><div> <button autoid=\"_mcp_w\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_x\" type='button' class='_mcp_32'></button> </div><div> <span class='_mcp_12 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_t\" class='_mcp_22'></div> <button autoid=\"_mcp_u\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_v\" type='button' class='_mcp_32'></button>  <div></div> <div class='_mcp_42'></div>  </div><div> <span class='_mcp_52 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_62'></div> <button type='button' class='_mcp_72'></button> <button type='button' class='_mcp_72'></button>  </div>";_js.$F.get_$9G().appendChild(n);return n};_mcp._TI.$D2R=function(n){return n.$Ql};_mcp._TI.$D2Q=function(n){return n.$4Wj};_mcp._TI.$Ei=function(n){return n.get_$ad()};_mcp._TI.$2Rt=function(n){return n.$o5};_mcp._TI.$8up=function(n){return n.get_$1Ru()};_mcp._TI.$3P2=function(n){return n.get_$E9J()};_mcp._TI.$3Oy=function(n){return n.get_$Tg()};_mcp._TI.$2p=function(n){return n.$3W};_mcp._TI.$3n=function(n){return n.get_$1C()};_mcp._TI.$8uq=function(n){return n.$5Wq};_mcp._TI.$EB=function(n){return n.$c};_mcp._TI.$57P=function(n){return n.get_$3o()};_mcp._TI.$1VO=function(n){return n.get_$CMC()};_mcp._TI.$8ul=function(n){return n.get_$2va()};_mcp._TI.$2S=function(n){return n.get_$k()};_mcp._TI.$58l=function(n){return n.get_$4fr()};_mcp._TI.$58m=function(n){return n.get_$6Rg()};_mcp._TI.$8uh=function(n){return n.get_$F12()};_mcp._TI.$8ug=function(n){return n.get_$1pY()};_mcp._TI.$8pm=function(n){return n.get_$5KU()};_mcp._TI.$8uk=function(n){return n.get_$51H()};_mcp._TI.$2Rv=function(n){return n.get_$7Np()};_mcp._TI.$8us=function(n){return n.get_$7dK()};_mcp._TI.$8uv=function(n){return n.get_$9kN()};_mcp._TI.$8uu=function(n){return n.get_$8YA()};_mcp._TI.$Tn=function(n){return n.$3V};_mcp._TI.$7A=function(n){return n.get_$ZY()};_mcp._TI.$25g=function(n){return n.$3yW};_mcp._TI.$8ux=function(n){return n.get_$lN()};_mcp._TI.$3P0=function(n){return n.get_$39B()};_mcp._TI.$3Ov=function(n){return n.$65};_mcp._TI.$zo=function(n){return n.get_$1Pb()};_mcp._TI.$D2l=function(n){return n.get_$AWm()};_mcp._TI.$8v3=function(n){return n.$5ch};_mcp._TI.$6i4=function(n){return n.$5XF};_mcp._TI.$58o=function(n){return n.get_$5cv()};_mcp._TI.$8ur=function(n){return n.$5a};_mcp._TI.$44W=function(n){return n.get_$1XF()};_mcp._TI.$43o=function(n){return n.get_$1AP()};_mcp._TI.$1VP=function(n){return n.get_$iH()};_mcp._TI.$44T=function(n){return n.$1a3};_mcp._TI.$8uw=function(n){return n.get_$5zV()};_mcp._TI.$2pj=function(n){return n.get_$2XB()};_mcp._TI.$44S=function(n){return n.$1Nc};_mcp._TI.$e=function(n){return n.$7Q};_mcp._TI.$6i6=function(n){return n.$7DC};_mcp._TI.$3P3=function(n){return n.$4H1};_mcp._TI.$6i1=function(n){return n.$1d};_mcp._TI.$1Fj=function(n){return n.get_$jf()};_mcp._TI.$6i3=function(n){return n.get_$a8()};_mcp._TI.$8vD=function(n){return n.get_$AXn()};_mcp._TI.$8pl=function(n){return n.get_$ow()};_mcp._TI.$2Ru=function(n){return n.$GI};_mcp._TI.$1VN=function(n){return n.get_$E5m()};_mcp._TI.$fu=function(n){return n.get_$4uc()};_mcp._TI.$1VM=function(n){return n.$NH};_mcp._TI.$8vG=function(n){return n.get_$3z9()};_mcp._TI.$6i2=function(n){return n.get_$fP()};_mcp._TI.$3Ox=function(n){return n.$5X};_mcp._TI.$3OC=function(n){return n.get_$fP()};_mcp._TI.$3Ow=function(n){return n.$RC};_mcp._TI.$2Rs=function(n){return n.$GM};_mcp._TI.$8vF=function(n){return n.get_$3wL()};_mcp._TI.$8pk=function(n){return n.get_$1LS()};_mcp._TI.$2Rr=function(n){return n.$Gd};_mcp._TI.$8vE=function(n){return n.get_$3wE()};_mcp._TI.$3OJ=function(n){return n.get_$23N()};_mcp._TI.$58n=function(n){return n.get_$AI7()};_mcp._TI.$D2U=function(n){return n.$4HZ};_mcp._TI.$8uc=function(n){return n.$2O3};_mcp._TI.$8pq=function(n){return n.get_$T0()};_mcp._TI.$8pp=function(n){return n.get_$PT()};_mcp._TI.$8uy=function(n){return n.get_$C3f()};_mcp._TI.$8ui=function(n){return n.$4x7};_mcp._TI.$8pj=function(n){return n.get_$Bv()};_mcp._TI.$5L=function(n){return n.get_$1K()};_mcp._TI.$8uf=function(n){return n.get_$6Yf()};_mcp._TI.$8po=function(n){return n.get_$9lW()};_mcp._TI.$8ue=function(n){return n.get_$2MB()};_mcp._TI.$8pi=function(n){return n.get_$3Fs()};_mcp._TI.$44U=function(n){return n.get_$eM()};_mcp._TI.$6hj=function(n){return n.get_$9Z()};_mcp._TI.$8pB=function(n){return n.get_$kd()};_mcp._TI.$1qk=function(n){return n.get_$CE5()};_mcp._TI.$44R=function(n){return n.get_$2Nf()};_mcp._TI.$6fU=function(n){return n.get_$MW()};_mcp._TI.$2p6=function(n){return n.get_$DY()};_mcp._TI.$6fV=function(n){return n.get_$do()};_mcp._TI.$1pv=function(n){return n.get_$mf()};_mcp._TI.$6fW=function(n){return n.get_$1vc()};_mcp._TI.$6dX=function(n){return n.get_$7JI()};_mcp._TI.$44V=function(n){return n.get_$7eJ()};_mcp._TI.$8ud=function(n){return n.$7I5};_mcp._TI.$6hk=function(n){return n.$7I7};_mcp._TI.$D2m=function(n){return n.get_$AZs()};_mcp._TI.$D2Y=function(n){return n.get_$3W0()};_mcp._TI.$43E=function(n){return n.$10W};_mcp._TI.$8ph=function(n){return n.get_$6P()};_mcp._TI.$43D=function(n){return n.$Et};_mcp._TI.$6i0=function(n){return n.get_$AZo()};_mcp._TI.$6hm=function(n){return n.$r4};_mcp._TI.$3Nx=function(n){return n.$1QA};_mcp._TI.$Cnh=function(n){return n.get_$6Q5()};_mcp._TI.$k5=function(n){return n.get_$CIE()};_mcp._TI.$6hp=function(n){return n.$Sc};_mcp._TI.$6ho=function(n){return n.$rc};_mcp._TI.$6dV=function(n){return n.$rc};_mcp._TI.$6hq=function(n){return n.$24J};_mcp._TI.$6ht=function(n){return n.$ck};_mcp._TI.$6dZ=function(n){return n.$ck};_mcp._TI.$6hr=function(n){return n.$c7};_mcp._TI.$6dW=function(n){return n.$c7};_mcp._TI.$6hs=function(n){return n.$Va};_mcp._TI.$6dY=function(n){return n.$Va};_mcp._TI.$8ut=function(n){return n.get_$CDK()};_mcp._TI.$8pn=function(n){return n.get_$1gL()};_mcp._TI.$8v0=function(n){return n.$2F};_mcp._TI.$Cnk=function(n){return n.get_$5rh()};_mcp._TI.$Cnl=function(n){return n.get_$2Na()};_mcp._TI.$4w=function(n){return n.get_$1C()};_mcp._TI.$D2T=function(n){return n.$E6};_mcp._TI.$9p=function(n){return n.$3W};_mcp._TI.$Ha=function(n){return n.$7w};_mcp._TI.$Eh=function(n){return n.$5a};_mcp._TI.$HH=function(n){return n.$Vo};_mcp._TI.$DS=function(n){return n.$9B};_mcp._TI.$8v1=function(n){return n.get_$3Ma()};_mcp._TI.$8un=function(n){return n.$E6};_mcp._TI.$43g=function(n){return n.$G7};_mcp._TI.$6k4=function(n){return n.$G7};_mcp._TI.$D2p=function(n){return n.$1di};_mcp._TI.$3P1=function(n){return n.get_$1du()};_mcp._TI.$8uo=function(n){return n.$5xo};_mcp._TI.$D2d=function(n){return n.$1Zi};_mcp._TI.$D2a=function(n){return n.$1W3};_mcp._TI.$8uz=function(n){return n.get_$2N1()};_mcp._TI.$8uj=function(n){return n.$4UR};_mcp._TI.$6hy=function(n){return n.get_$CDv()};_mcp._TI.$3Oz=function(n){return n.get_$5yp()};_mcp._TI.$58k=function(n){return n.$Fp};_mcp._TI.$Cng=function(n){return n.get_$3uZ()};_mcp._TI.$8ub=function(n){return n.get_$Tg()};_mcp._TI.$D2r=function(n){return n.$5XB};_mcp._TI.$8v2=function(n){return n.$26H};_mcp._TI.$k2=function(n){return n.get_$22o()};_mcp._TI.$1eh=function(n){return n.get_$1C()};_mcp._TI.$1eY=function(n){return n.get_$1C()};_mcp._TI.$fp=function(n){return n.get_$S()};_mcp._TI.$8pT=function(n){return n.get_$2xe()};_mcp._TI.$8pU=function(n){return n.get_$5XY()};_mcp._TI.$6hz=function(n){return n.get_$1kA()};_mcp._TI.$6hl=function(n){return n.get_$Tg()};_mcp._TI.$D2n=function(n){return n.get_$C2a()};_mcp._TI.$D2o=function(n){return n.get_$2N8()};_mcp._TI.$Cnj=function(n){return n.get_$DnF()};_mcp._TI.$Cmv=function(n){return n.get_$3hN()};_mcp._TI.$sG=function(n){return n.$G6};_mcp._TI.$EM=function(n){return n.get_$A()};_mcp._TI.$D2j=function(n){return n.get_$CFn()};_mcp._TI.$D2k=function(n){return n.get_$Eog()};_mcp._TI.$D2i=function(n){return n.get_$C9F()};_mcp._TI.$D2h=function(n){return n.get_$AEF()};_mcp._TI.$D2g=function(n){return n.get_$A9J()};_mcp._TI.$Cni=function(n){return n.get_$19x()};_mcp._TI.$D32=function(n){return n.$6Tx};_mcp._TI.$D30=function(n){return n.$18V};_mcp._TI.$D31=function(n){return n.get_$CEJ()};_mcp._TI.$D2q=function(n){return n.$5WY};_mcp._TI.$D2V=function(n){return n.$1kw};_mcp._TI.$D2W=function(n){return n.$233};_mcp._TI.$1ef=function(n){return n.$6R};_mcp._TI.$D2s=function(n){return n.get_$7G1()};_mcp._TI.$D2c=function(n){return n.$1YY};_mcp._TI.$D2b=function(n){return n.$1YW};_mcp._TI.$D2u=function(n){return n.$1Yf};_mcp._TI.$61=function(n){return n.$HT};_mcp._TI.$D2v=function(n){return n.$5ZO};_mcp._TI.$D2w=function(n){return n.$1Yg};_mcp._TI.$D2x=function(n){return n.$5ZS};_mcp._TI.$8v7=function(n){return n.get_$E9z()};_mcp._TI.$8v6=function(n){return n.$3XJ};_mcp._TI.$CQ=function(n){return n.get_$BK()};_mcp._TI.$8v4=function(n){return n.$3wi};_mcp._TI.$8v8=function(n){return n.get_$Edn()};_mcp._TI.$8v5=function(n){return n.$3yU};_mcp._TI.$8v9=function(n){return n.get_$EfQ()};_mcp._TI.$D2t=function(n){return n.$5Yp};_mcp._TI.$H=function(n,t){n.set_$1K(t)};_mcp._TI.$Z=function(n,t){n.set_$k(t)};_mcp._TI.$x=function(n,t){n.set_$BI(t)};_mcp._TI.$1W=function(n,t){n.set_$1K(t)};_mcp._TI.$2n=function(n,t){n.set_$4E(t)};_mcp._TI.$3q=function(n,t){n.set_$KX(t)};_mcp._TI.$49=function(n,t){n.set_$1C(t)};_mcp._TI.$3m=function(n,t){n.set_$1C(t)};_mcp._TI.$8=function(n,t){n.set_$17(t)};_mcp._TI.$8um=function(n,t){n.set_$2va(t)};_mcp._TI.$zl=function(n,t){n.set_$1lg(t)};_mcp._TI.$a=function(n,t){n.set_$4k(t)};_mcp._TI.$1o=function(n,t){n.set_$Es(t)};_mcp._TI.$5o=function(n,t){n.set_$aa(t)};_mcp._TI.$5z=function(n,t){n.set_$NV(t)};_mcp._TI.$BU=function(n,t){n.set_$Lp(t)};_mcp._TI.$14=function(n,t){n.set_$2O(t)};_mcp._TI.$AD=function(n,t){n.set_$7d(t)};_mcp._TI.$i=function(n,t){n.$6G=t};_mcp._TI.$2SE=function(n,t){n.$QO=t};_mcp._TI.$6kG=function(n,t){n.$GG=t};_mcp._TI.$OW=function(n,t){n.set_$20(t)};_mcp._TI.$8ps=function(n,t){n.set_$3o(t)};_mcp._TI.$5G=function(n,t){n.set_$1K(t)};_mcp._TI.$Ym=function(n,t){n.set_$D6(t)};_mcp._TI.$D2S=function(n,t){n.set_$9Z(t)};_mcp._TI.$XF=function(n,t){n.set_$2Nf(t)};_mcp._TI.$6df=function(n,t){n.set_$Ec7(t)};_mcp._TI.$6fX=function(n,t){n.set_$MW(t)};_mcp._TI.$2p7=function(n,t){n.set_$DY(t)};_mcp._TI.$6fY=function(n,t){n.set_$do(t)};_mcp._TI.$1ea=function(n,t){n.set_$mf(t)};_mcp._TI.$6fZ=function(n,t){n.set_$1vc(t)};_mcp._TI.$6dh=function(n,t){n.set_$7JI(t)};_mcp._TI.$8mM=function(n,t){n.set_$7I6(t)};_mcp._TI.$6dg=function(n,t){n.set_$7I8(t)};_mcp._TI.$D2Z=function(n,t){n.set_$3W0(t)};_mcp._TI.$43F=function(n,t){n.set_$705(t)};_mcp._TI.$8pr=function(n,t){n.set_$6P(t)};_mcp._TI.$8mL=function(n,t){n.set_$4xU(t)};_mcp._TI.$6hn=function(n,t){n.set_$Nf(t)};_mcp._TI.$3Ny=function(n,t){n.set_$16W(t)};_mcp._TI.$Cea=function(n,t){n.set_$G8(t)};_mcp._TI.$1pw=function(n,t){n.$2HQ=t};_mcp._TI.$2p8=function(n,t){n.$Fp=t};_mcp._TI.$2p9=function(n,t){n.$E0=t};_mcp._TI.$3O0=function(n,t){n.$LB=t};_mcp._TI.$560=function(n,t){n.$1a3=t};_mcp._TI.$3Nz=function(n,t){n.$1Nc=t};_mcp._TI.$6db=function(n,t){n.$Sc=t};_mcp._TI.$6hu=function(n,t){n.set_$4o7(t)};_mcp._TI.$6da=function(n,t){n.set_$4o7(t)};_mcp._TI.$6dc=function(n,t){n.set_$3LC(t)};_mcp._TI.$6hx=function(n,t){n.set_$1wT(t)};_mcp._TI.$6dj=function(n,t){n.set_$1wT(t)};_mcp._TI.$6hv=function(n,t){n.set_$1rz(t)};_mcp._TI.$6dd=function(n,t){n.set_$1rz(t)};_mcp._TI.$6hw=function(n,t){n.set_$1ZX(t)};_mcp._TI.$6di=function(n,t){n.set_$1ZX(t)};_mcp._TI.$3C=function(n,t){n.set_$VY(t)};_mcp._TI.$Ix=function(n,t){n.set_$Sa(t)};_mcp._TI.$FV=function(n,t){n.set_$ID(t)};_mcp._TI.$FU=function(n,t){n.set_$IA(t)};_mcp._TI.$Cnm=function(n,t){n.set_$2Na(t)};_mcp._TI.$4g=function(n,t){n.set_$1C(t)};_mcp._TI.$Dj=function(n,t){n.set_$1C(t)};_mcp._TI.$Dw=function(n,t){n.set_$ID(t)};_mcp._TI.$BV=function(n,t){n.set_$H4(t)};_mcp._TI.$GA=function(n,t){n.set_$FD(t)};_mcp._TI.$DT=function(n,t){n.set_$IA(t)};_mcp._TI.$8os=function(n,t){n.set_$7d(t)};_mcp._TI.$90Z=function(n,t){n.set_$7d(t)};_mcp._TI.$LY=function(n,t){n.set_$Br(t)};_mcp._TI.$1l=function(n,t){n.set_$4E(t)};_mcp._TI.$da=function(n,t){n.set_$2t(t)};_mcp._TI.$aJ=function(n,t){n.set_$1A2(t)};_mcp._TI.$1ei=function(n,t){n.set_$1C(t)};_mcp._TI.$1eZ=function(n,t){n.set_$1C(t)};_mcp._TI.$Yg=function(n,t){n.set_$T5(t)};_mcp._TI.$1b=function(n,t){n.set_$3u(t)};_mcp._TI.$6i5=function(n,t){n.$Za=t};_mcp._TI.$8h=function(n,t){n.set_$g(t)};_mcp._TI.$D2X=function(n,t){n.set_$2lq(t)};_mcp._TI.$1fA=function(n,t){n.set_$cC(t)};_mcp._TI.$D2f=function(n,t){n.set_$3bI(t)};_mcp._TI.$D2e=function(n,t){n.set_$3b5(t)};_mcp._TI.$D2y=function(n,t){n.set_$PT(t)};_mcp._TI.$4p=function(n,t){n.set_$8x(t)};_mcp._TI.$9y=function(n,t){n.set_$2t(t)};_mcp._TI.$D2z=function(n,t){n.set_$T0(t)};_mcp._TI.$Cd=function(n,t){n.set_$B5(t)};_mcp._TI.$8vC=function(n,t){n.set_$ET(t)};_mcp._TI.$CR=function(n,t){n.set_$BK(t)};_mcp._TI.$8vA=function(n,t){n.set_$Qu(t)};_mcp._TI.$8vB=function(n,t){n.set_$Q8(t)};_mcp._TI.get_$24=function(){_mcp._TI.$47||(_mcp._TI.$47=new _fc.$6Q);return _mcp._TI.$47};_mcp._TI.get_$K=function(){_mcp._TI.$2L||(_mcp._TI.$2L=new _fc.$42);return _mcp._TI.$2L};_mcp._TI.get_$2on=function(){_mcp._TI.$11B||(_mcp._TI.$11B=new _cc.$To);return _mcp._TI.$11B};_mcp._TI.get_$42P=function(){_mcp._TI.$11A||(_mcp._TI.$11A=new _cc.$Zr);return _mcp._TI.$11A};_mcp._TI.get_$vz=function(){_mcp._TI.$Xi||(_mcp._TI.$Xi=new _n.$RQ);return _mcp._TI.$Xi};_mcp._TI.get_$8mC=function(){_mcp._TI.$4Mq||(_mcp._TI.$4Mq=new _b.$1BV);return _mcp._TI.$4Mq};_mcp._TI.get_$dW=function(){_mcp._TI.$1PE||(_mcp._TI.$1PE=new _n.$rQ);return _mcp._TI.$1PE};_mcp._TI.get_$7s=function(){_mcp._TI.$DL||(_mcp._TI.$DL=new _fce.$ES);return _mcp._TI.$DL};_mcp._TI.get_$ft=function(){_mcp._TI.$Pd||(_mcp._TI.$Pd=new _n.$MW);return _mcp._TI.$Pd};_mcp._TI.get_$8ua=function(){_mcp._TI.$4NV||(_mcp._TI.$4NV=new _mcp.$187);return _mcp._TI.$4NV};MailComposeComponent.registerClass("MailComposeComponent",null,_a.$1X7);_mcp.$sN.registerClass("_mcp.$sN",_h.$TS.$$(_g.$ac,_g.$WF));_mcp.$14n.registerClass("_mcp.$14n",_js.$Ec);_mcp.$Gn.registerClass("_mcp.$Gn",_mcp.$14n,_y.$1WH,IMailComposeOverridable);_mcp.$Kn.registerClass("_mcp.$Kn",_mcp.$14n,IMailComposeSaveComponent,IMailComposeOverridable);_mcp.$1Ku.registerClass("_mcp.$1Ku",_mcp.$Kn);_mcp.$JQ.registerClass("_mcp.$JQ",_mcp.$14n);_mcp.$1Kw.registerClass("_mcp.$1Kw");_mcp.$1Kx.registerClass("_mcp.$1Kx",_mcp.$14n);_mcp.$Ow.registerClass("_mcp.$Ow",_mcp.$14n);_mcp.$1Kz.registerClass("_mcp.$1Kz",_mcp.$14n);_mcp.$1L0.registerClass("_mcp.$1L0",_mcp.$14n);_mcp.$eU.registerClass("_mcp.$eU",_mcp.$14n);_mcp.$1L3.registerClass("_mcp.$1L3",_mcp.$14n);_mcp.$eT.registerClass("_mcp.$eT",_mcp.$14n);_mcp.$14o.registerClass("_mcp.$14o",_mcp.$14n);_mcp.$MZ.registerClass("_mcp.$MZ",_mcp.$14n,_y.$1Vj);_mcp.$7y.registerClass("_mcp.$7y",_mcp.$14n);_mcp.$1L5.registerClass("_mcp.$1L5",_mcp.$14n);_mcp.$1L6.registerClass("_mcp.$1L6",_mcp.$14n,_y.$1Vu);_mcp.$1L7.registerClass("_mcp.$1L7",_mcp.$14n);_mcp.$Ma.registerClass("_mcp.$Ma",_mcp.$14n);_mcp.$HY.registerClass("_mcp.$HY",_mcp.$14n,_y.$1YS);_mcp.$JR.registerClass("_mcp.$JR",_js.$Ec);_mcp.$3t.registerClass("_mcp.$3t",_mcp.$14n);_mcp.$II.registerClass("_mcp.$II",_mcp.$14n);_mcp.$G6.registerClass("_mcp.$G6",_mcp.$14n,IMailComposeSendComponent,IMailComposeOverridable);_mcp.$1LA.registerClass("_mcp.$1LA",_mcp.$14n);_mcp.$1L9.registerClass("_mcp.$1L9",_mcp.$14n);_mcp.$G7.registerClass("_mcp.$G7",_mcp.$14n);_mcp.$ui.registerClass("_mcp.$ui",_mcp.$14n,IMailComposeTouchComponent);_mcp.$1LC.registerClass("_mcp.$1LC",_mcp.$14n);_mcp.$1L4.registerClass("_mcp.$1L4",_mcp.$14n);_mcp.$1L8.registerClass("_mcp.$1L8",_mcp.$14n);_mcp.$1L1.registerClass("_mcp.$1L1",_mcp.$14n,_y.$1Vn,_y.$1Vo,_y.$1Vk);_mcp.$1LD.registerClass("_mcp.$1LD",null,_y.$13W);_mcp.$1PW.registerClass("_mcp.$1PW",null,ISendEvent);_mcp.$1PX.registerClass("_mcp.$1PX",null,ISendFailedEvent);_mcp.$pc.registerClass("_mcp.$pc",null,ISendFailedO365Event);_mcp.$184.registerClass("_mcp.$184",null,ISendFailureRemoveO365Event);_mcp.$1Pc.registerClass("_mcp.$1Pc",null,ISendSucceededEvent);_mcp.$mv.registerClass("_mcp.$mv",null,IMailComposeActionFactory);_mcp.$1Kv.registerClass("_mcp.$1Kv");_mcp.$1Ky.registerClass("_mcp.$1Ky",null,IMailComposeContextFactory);_mcp.$14q.registerClass("_mcp.$14q",null,IMailComposeViewModelFactory,_bc.$1Jj);_mcp.$147.registerClass("_mcp.$147",_a.$En);_mcp.$ug.registerClass("_mcp.$ug",_js.$Ec,_y.$1Vt);_mcp.$V.registerClass("_mcp.$V",_a.$1ad,_g.$1Yi,_y.$1Vr,_bc.$1Uj);_mcp.$uh.registerClass("_mcp.$uh",null,IMailComposeDiscardManager);_mcp.$1W.registerClass("_mcp.$1W",_a.$10v);_mcp.$1LB.registerClass("_mcp.$1LB");_mcp.$8n.registerClass("_mcp.$8n",_y.$1b6,_y.$Cz,_y.$ID,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$13q,_y.$tg,_bc.$Kk,_bc.$e2,_y.$IC,IMailComposeOverridable);_mcp.$ur.registerClass("_mcp.$ur",_a.$En,_y.$1Vq);_mcp.$14u.registerClass("_mcp.$14u",null,IMailResponseViewModelFactory);_mcp.$nO.registerClass("_mcp.$nO",_a.$En);_mcp.$w4.registerClass("_mcp.$w4");_mcp.$1NA.registerClass("_mcp.$1NA");_mcp.$1Ou.registerClass("_mcp.$1Ou");_mcp.$187.registerClass("_mcp.$187",null,_js.$1KJ);_mcp.$se.registerClass("_mcp.$se",_js.$F,_b.$1J7);_mcp.$1.registerClass("_mcp.$1");_mcp.$mx.registerClass("_mcp.$mx",_js.$7);_mcp.$mz.registerClass("_mcp.$mz",_js.$7,_ff.$FA);_mcp.$mz.$y7.registerClass("_mcp.$mz.$y7");_mcp._TI.registerClass("_mcp._TI");_mcp.$Gn.$5mm=new _H("AttachmentWellViewModel",_y.$1IQ,_mcp.$Gn);_mcp.$Gn.$24k=new _H("Menu",_fm.$1u,_mcp.$14n);_mcp.$JQ.$6Wt=new _y.$2a(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);_mcp.$Ow.$24k=new _H("Menu",_fm.$1u,_mcp.$Ow);_mcp.$eT.$3Tw=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.$MZ.$wR=[84,85,86,87];_mcp.$7y.$655=new _H("FromDetailsViewModel",_pe.$96,_mcp.$7y);_mcp.$7y.$73h=new _H("SenderDetailsViewModel",_pe.$96,_mcp.$7y);_mcp.$7y.$6XB=new _H("LocationViewModel",_cc.$Cb,_mcp.$7y);_mcp.$7y.$6Rh=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.$7y);_mcp.$7y.$DxK=new _H("RecurrencePatternDataObject",_cc.$Cj,_mcp.$7y);_mcp.$JR.$2to=7;_mcp.$JR.$5LB=1;_mcp.$3t.$707=new _H("ResizeEditorCommand",_js.$Ct,_mcp.$3t);_mcp.$Kn.$wR=[60,40,43,1001,700,50,800,88,89];_mcp.$II.$24k=new _H("Menu",_fm.$1u,_mcp.$II);_mcp.$G6.$6Yc=10;_mcp.$G6.$8bl="MailSatisfactionSurvey";_mcp.$G6.$wR=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_mcp.$G7.$9mR=_a.UserAgent.getInstance().$Ec?_js.$9.$5K("{0}{0}","<P></P>"):_js.$9.$5K("{0}{0}","<P><BR></P>");_mcp.$G7.$9L3=new RegExp("[\n\r]+","g");_mcp.$V.$7Ou=new _H("ViewModelId",String,_mcp.$V);_mcp.$V.$48c=new _H("Operation",_y.$1m,_mcp.$V);_mcp.$V.$26G=new _H("Mode",_y.$Ox,_mcp.$V);_mcp.$V.$6rK=new _H("OriginalId",_g.$1T,_mcp.$V);_mcp.$V.$6rI=new _H("OriginalDocumentId",Number,_mcp.$V);_mcp.$V.$6rL=new _H("OriginalItem",_g.$11,_mcp.$V);_mcp.$V.$5zo=new _H("DraftId",_g.$1T,_mcp.$V);_mcp.$V.$7H3=new _H("StoreId",String,_mcp.$V);_mcp.$V.$qH=new _H("Subject",String,_mcp.$V,"");_mcp.$V.$72i=new _H("SelectedDataCallContext",_fm.$1In,_mcp.$V);_mcp.$V.$38L=new _H("EditorContent",String,_mcp.$V,"");_mcp.$V.$6wd=new _H("RawEditorContent",String,_mcp.$V);_mcp.$V.$7JJ=new _H("TextEditorContent",String,_mcp.$V);_mcp.$V.$5nx=new _H("BodyType",String,_mcp.$V);_mcp.$V.$2ap=new _H("ToRecipients",_js.$IB,_mcp.$V);_mcp.$V.$5Zl=new _H("SpeechResultRecipients",_js.$IB,_mcp.$V);_mcp.$V.$3dI=new _H("ToQueryString",String,_mcp.$V);_mcp.$V.$2Eq=new _H("CcRecipients",_js.$IB,_mcp.$V);_mcp.$V.$342=new _H("CcQueryString",String,_mcp.$V);_mcp.$V.$2E9=new _H("BccRecipients",_js.$IB,_mcp.$V);_mcp.$V.$32n=new _H("BccQueryString",String,_mcp.$V);_mcp.$V.$5WV=new _H("AutoAddSignature",Boolean,_mcp.$V,!0);_mcp.$V.$3Gg=new _H("Importance",String,_mcp.$V,"Normal");_mcp.$V.$6wP=new _H("QuotedBody",String,_mcp.$V);_mcp.$V.$7Fy=new _H("SmimeContent",String,_mcp.$V);_mcp.$V.$7G0=new _H("SmimeErrorCode",Number,_mcp.$V);_mcp.$V.$7G2=new _H("SmimeRecipientCerts",Array,_mcp.$V);_mcp.$V.$7G3=new _H("SmimeSigningCert",String,_mcp.$V);_mcp.$V.$6PR=new _H("IsComplete",Boolean,_mcp.$V);_mcp.$V.$4wk=new _H("IsMeeting",Boolean,_mcp.$V);_mcp.$V.$6Ri=new _H("IsMeetingForward",Boolean,_mcp.$V);_mcp.$V.$6T0=new _H("IsReplyAllOnBcc",Boolean,_mcp.$V);_mcp.$V.$3LQ=new _H("Location",_g.$3Q,_mcp.$V);_mcp.$V.$6Kb=new _H("HasLocation",Boolean,_mcp.$V);_mcp.$V.$6Yl=new _H("MeetingCalendarTimePeriod",_cc.$86,_mcp.$V);_mcp.$V.$6vy=new _H("ProposedNewTime",_cc.$9d,_mcp.$V);_mcp.$V.$2Ic=new _H("From",_g.$8w,_mcp.$V);_mcp.$V.$73i=new _H("Sender",_g.$8w,_mcp.$V);_mcp.$V.$6UQ=new _H("IsUpgraded",Boolean,_mcp.$V);_mcp.$V.$6QY=new _H("IsFromShown",Boolean,_mcp.$V);_mcp.$V.$6P2=new _H("IsBccShown",Boolean,_mcp.$V);_mcp.$V.$3T9=new _H("ParentFolderNameToPost",String,_mcp.$V);_mcp.$V.$6sP=new _H("ParentFolderIdToPost",_g.$38,_mcp.$V);_mcp.$V.$2E2=new _H("AttachmentCollection",_js.$X,_mcp.$V);_mcp.$V.$5mi=new _H("AttachmentsToHide",Array,_mcp.$V);_mcp.$V.$7Nr=new _H("UpgradeFailed",Boolean,_mcp.$V);_mcp.$V.$5nY=new _H("Baseline",_mcp.$1W,_mcp.$V);_mcp.$V.$6KI=new _H("HasBeenSavedByUser",Boolean,_mcp.$V);_mcp.$V.$6T2=new _H("IsReplyForward",Boolean,_mcp.$V);_mcp.$V.$5zp=new _H("Draft",_g.$11,_mcp.$V);_mcp.$V.$70t=new _H("RightsManagementLicenseData",_g.$gn,_mcp.$V);_mcp.$V.$34Z=new _H("ComplianceId",String,_mcp.$V);_mcp.$V.$6PI=new _H("IsClassified",Boolean,_mcp.$V);_mcp.$V.$5qw=new _H("ClassificationGuid",String,_mcp.$V);_mcp.$V.$5qy=new _H("Classification",String,_mcp.$V);_mcp.$V.$5qv=new _H("ClassificationDescription",String,_mcp.$V);_mcp.$V.$5qx=new _H("ClassificationKeep",Boolean,_mcp.$V);_mcp.$V.$3XK=new _H("Sensitivity",String,_mcp.$V,"Normal");_mcp.$V.$3I6=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3JS=new _H("IsReadReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3bQ=new _H("SmimeEncryptMessage",Boolean,_mcp.$V);_mcp.$V.$3bT=new _H("SmimeSignMessage",Boolean,_mcp.$V);_mcp.$V.$356=new _H("ConversationId",_g.$1T,_mcp.$V);_mcp.$V.$6sM=new _H("ParentConversationNodeId",String,_mcp.$V);_mcp.$V.$6SK=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.$V);_mcp.$V.$6SC=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.$V);_mcp.$V.$6SY=new _H("IsPoppedOutFromInline",Boolean,_mcp.$V);_mcp.$V.$6RQ=new _H("IsLoadedDraft",Boolean,_mcp.$V);_mcp.$V.$7PK=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.$V);_mcp.$V.$6LR=new _H("HideIncludeEntrypoint",Boolean,_mcp.$V,!1);_mcp.$V.$7PM=new _H("WasSavingBeforePopout",Boolean,_mcp.$V,!1);_mcp.$V.$6S1=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.$V,!1);_mcp.$V.$6sy=new _H("PerfContext",_a.$5V,_mcp.$V,null);_mcp.$V.$6sx=new _H("PerfContextE2E",_a.$5V,_mcp.$V,null);_mcp.$V.$7PP=new _H("WaterfallTraceStarted",Boolean,_mcp.$V,null);_mcp.$V.$9Pa=new _H("RichTextEditorSupported",Boolean,_mcp.$V,null);_mcp.$V.$6M7=new _H("HtmlSupportedProperty",Boolean,_mcp.$V,null);_mcp.$V.$5zQ=new _H("DlpSenderOverride",String,_mcp.$V,null);_mcp.$V.$5zP=new _H("DlpFalsePositive",String,_mcp.$V,null);_mcp.$V.$5zO=new _H("DlpDetectedClassification",String,_mcp.$V,null);_mcp.$V.$62Y=new _H("ExplicitLogonUser",String,_mcp.$V,null);_mcp.$V.$6Mh=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.$V,!1);_mcp.$V.$2Hs=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$V,null);_mcp.$V.$6SE=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.$V,!1);_mcp.$V.$6T9=new _H("IsResumingSendFailure",Boolean,_mcp.$V,!1);_mcp.$V.$6Km=new _H("HasSentViaNotification",Boolean,_mcp.$V,!1);_mcp.$V.$73k=new _H("SendFailureInfobarMessageId",_bc.InfoBarMessageId,_mcp.$V,45);_mcp.$V.$aZ=new _H("PopoutPerfContext",_a.$5V,_mcp.$V);_mcp.$V.$5yO=new _H("DiagnosticContent",String,_mcp.$V);_mcp.$V.$4LG="UseOverride";_mcp.$V.$1h0=null;_mcp.$V.$$cctor();_mcp.$1W.$qH=new _H("Subject",String,_mcp.$1W,"");_mcp.$1W.$38L=new _H("EditorContent",String,_mcp.$1W,"");_mcp.$1W.$2ap=new _H("ToRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$3dI=new _H("ToQueryString",String,_mcp.$1W);_mcp.$1W.$2Eq=new _H("CcRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$342=new _H("CcQueryString",String,_mcp.$1W);_mcp.$1W.$2E9=new _H("BccRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$32n=new _H("BccQueryString",String,_mcp.$1W);_mcp.$1W.$3Gg=new _H("Importance",String,_mcp.$1W,"Normal");_mcp.$1W.$2Ic=new _H("From",_g.$1K,_mcp.$1W);_mcp.$1W.$34Z=new _H("ComplianceId",String,_mcp.$1W);_mcp.$1W.$3XK=new _H("Sensitivity",String,_mcp.$1W,"Normal");_mcp.$1W.$3I6=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3JS=new _H("IsReadReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3bQ=new _H("SmimeEncryptMessage",Boolean,_mcp.$1W);_mcp.$1W.$3bT=new _H("SmimeSignMessage",Boolean,_mcp.$1W);_mcp.$1W.$2E2=new _H("AttachmentCollection",_js.$X,_mcp.$1W);_mcp.$1W.$2Hs=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$1W,null);_mcp.$1W.$4cK=new _a.$CA(_g.$1K);_mcp.$1W.$$cctor();_mcp.$ur.$L=_a.$0.$16;_mcp._TI._hf=_mcp._TI.$9S();_mcp._TI.$47=null;_mcp._TI.$2L=null;_mcp._TI.$11B=null;_mcp._TI.$11A=null;_mcp._TI.$Xi=null;_mcp._TI.$4Mq=null;_mcp._TI.$1PE=null;_mcp._TI.$DL=null;_mcp._TI.$Pd=null;_mcp._TI.$4NV=null;_mcp._TI.$1={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
